/*! For license information please see npm-xg-plugin.8a6561e8bd7318869323.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9336],{60541:(e,t,i)=>{var r;window,e.exports=(r=i(13438),function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){function r(e,t,i){function r(e,t){var i=parseInt(e.slice(t,t+2),16);return i>>>7==0?[1,i]:i>>>6==2?(i=(63&i)<<8,[2,i+=parseInt(e.slice(t+2,t+4),16)]):(i=(63&i)<<16,[3,i+=parseInt(e.slice(t+2,t+6),16)])}var n,a=0,o=[],s=[],l=parseInt(e.slice(0,8),16),d=parseInt(e.slice(8,16),16);if(1213091658!==l||1077891651!==d)throw new Error("mhe");if(0!==parseInt(e.slice(16,18),16))throw new Error("ve");for(n=0;n<4;++n)a+=(3&parseInt(e.slice(24+2*n,26+2*n),16))<<2*n;var c=parseInt(e.slice(32,40),16),u=2*parseInt(e.slice(48,56),16);for(n=56;n<u+56;n+=2)o.push(parseInt(e.slice(n,n+2),16));var h=u+56,f=parseInt(e.slice(h,h+4),16);for(h+=4,n=0;n<f;++n){var m=r(e,h);h+=2*m[0];for(var p="",b=0;b<m[1];++b){var y=r(e,h);p+=String.fromCharCode(a^y[1]),h+=2*y[0]}s.push(p)}return t.p=null,function e(t,i,r,n,a){var l,d,c,u,h,f=-1,m=[],p=[0,null],b=null,y=[i];for(d=Math.min(i.length,r),c=0;c<d;++c)y.push(i[c]);y.p=n;for(var g=[];;)try{var v=o[t++];if(v<38)if(v<14)v<5?v<3?m[++f]=0===v||null:3===v?(l=o[t++],m[++f]=l<<24>>24):(l=(o[t]<<8)+o[t+1],t+=2,m[++f]=l<<16>>16):v<8?5===v?(l=((l=((l=o[t++])<<8)+o[t++])<<8)+o[t++],m[++f]=(l<<8)+o[t++]):(l=(o[t]<<8)+o[t+1],t+=2,m[++f]=s[l]):m[++f]=v<11?void 0:11===v?a:{};else if(v<20)if(v<18)if(14===v)l=(o[t]<<8)+o[t+1],t+=2,d=s[l],c=m[f--],m[f][d]=c;else{for(d=o[t++],c=o[t++],u=y;d>0;--d)u=u.p;m[++f]=u[c]}else 18===v?(l=(o[t]<<8)+o[t+1],t+=2,d=s[l],m[f]=m[f][d]):(d=m[f--],m[f]=m[f][d]);else if(v<24)if(20===v){for(d=o[t++],c=o[t++],u=y;d>0;--d)u=u.p;u[c]=m[f--]}else l=(o[t]<<8)+o[t+1],t+=2,d=s[l],c=m[f--],u=m[f--],c[d]=u;else v<29?(d=m[f--],m[f]+=d):29===v?m[f]=-m[f]:(d=m[f--],m[f]=m[f]===d);else if(v<62)v<55?v<51?38===v?(d=m[f--],m[f]=m[f]!==d):m[f]=!m[f]:51===v?(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,m[f]?--f:t+=l):(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,m[f]?t+=l:--f):v<59?55===v?(d=m[f--],m[f]=m[f]instanceof d):m[f]=void 0:v<60?(l=o[t++],d=m[f--],(c=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)})._v=[d,l,y],c._u=e,m[++f]=c):60===v?(l=o[t++],d=m[f--],(u=[c=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)}]).p=y,c._v=[d,l,u],c._u=e,m[++f]=c):(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=g[g.length-1])[1]=t+l);else if(v<68)if(v<66)if(62===v)l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=g[g.length-1])&&!d[1]?(d[0]=3,d.push(t)):g.push([1,0,t]),t+=l;else if(c=(d=g.pop())[0],u=p[0],1===c)t=d[1];else if(0===c)if(0===u)t=d[1];else{if(1!==u)throw p[1];if(!b)return p[1];t=b[1],a=b[2],y=b[3],g=b[4],m[++f]=p[1],p=[0,null],b=b[0]}else t=d[2],d[0]=0,g.push(d);else if(66===v){for(d=m[f--],c=null;u=g.pop();)if(2===u[0]||3===u[0]){c=u;break}if(c)p=[1,d],t=c[2],c[0]=0,g.push(c);else{if(!b)return d;t=b[1],a=b[2],y=b[3],g=b[4],m[++f]=d,p=[0,null],b=b[0]}}else f-=l=o[t++],c=m.slice(f+1,f+l+1),d=m[f--],u=m[f--],d._u===e?(d=d._v,b=[b,t,a,y,g],t=d[0],null==u&&(u=function(){return this}()),a=u,(y=[c].concat(c)).length=Math.min(d[1],l)+1,y.p=d[2],g=[]):m[++f]=d.apply(u,c);else if(v<71)if(68===v){for(l=o[t++],u=[void 0],h=l;h>0;--h)u[h]=m[f--];c=m[f--],d=Function.bind.apply(c,u),m[++f]=new d}else t+=2+(l=(l=(o[t]<<8)+o[t+1])<<16>>16);else v<73?(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=m[f--])||(t+=l)):73===v?--f:(d=m[f],m[++f]=d)}catch(e){for(p=[0,null];(l=g.pop())&&!l[0];);if(!l){e:for(;b;){for(d=b[4];l=d.pop();)if(l[0])break e;b=b[0]}if(!b)throw e;t=b[1],a=b[2],y=b[3],g=b[4],b=b[0]}1===(d=l[0])?(t=l[2],l[0]=0,g.push(l),m[++f]=e):2===d?(t=l[2],l[0]=0,g.push(l),p=[3,e]):(t=l[3],l[0]=2,g.push(l),m[++f]=e)}}(c,[],0,t,i)}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=m(i(2)),s=m(i(3)),l=i(4),d=m(l),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(5)),u=m(i(6)),h=m(i(7)),f=m(i(8));function m(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=o.default.Util||o.default.util,v=function(e,t,i,r){s.default.url(e,t).then((function(e){var t=[],r=e.Data||e;r&&r.PlayInfoList&&r.PlayInfoList.length>0?(t=r.PlayInfoList,i({videoList:t,rawData:e})):(console.error("HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHRECK THE TOKEN."),i({videoList:[],rawData:e}))})).catch((function(e){r&&"function"==typeof r&&r(e)}))},Z=function(e){function t(e){p(this,t);var i=e.autoplay;e.autoplay&&(e.autoplay=!1),e.expireDetectType=[].concat(e.expireDetectType||[]),e.videoInit=!1;var r=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r._autoplay=i,r._curDefinitionIndex=0,r._errReqCount=0,r.hlsOpts=e.hlsOpts||{};var n=r,a=function(e){function t(e){p(this,t);var i=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=i.load.bind(i);return i.load=function(e,t,i){var a=i.onError;i.onError=function(e,t,i){403===e.code&&(n._errReqCount++,n._errReqCount>2&&n.emitExpireEvent()),a(e,t,i)},r(e,t,i)},i}return y(t,d.default.DefaultConfig.loader),t}();return r.hlsOpts.fLoader=a,r.versionNum>=3?r.hlsjs=r.hlsAlias={}:r.hls=r.hlsAlias={},r.hlsNext(0,"startPlay",e),r.config.checkHlsOffline&&u.default.on(r,"timeupdate",(function(){r.hlsAlias&&r.video&&!r.video.videoHeight?(r.hlsAlias.hlsOfflineCount=void 0===r.hlsAlias.hlsOfflineCount?1:r.hlsAlias.hlsOfflineCount+1,r.hlsAlias.hlsOfflineCount>3&&(r.pause(),r.emit("error",{msg:"OFFLINE",errorCode:-9997}),r.onError())):r.hlsAlias&&(r.hlsAlias.hlsOfflineCount=0)}),"destroy"),r.hlsTimer=new h.default,r.hlsTimer.repeat((function(){e.expireDetectType.indexOf("getUrlTime")>-1&&r.getUrlTime&&r.duration&&(new Date).getTime()/1e3>r.getUrlTime+3300+r.duration&&(r.getUrlTime=0,r.emitExpireEvent()),e.expireDetectType.indexOf("xhrStatus")>-1&&r.hlsAlias&&r.hlsAlias.manifestUrl&&Math.random()<1/7.5&&new f.default({url:r.hlsAlias.manifestUrl,type:""}).catch((function(e){e&&void 0!==e.status&&(r.hlsAlias.hlsExpireCount=void 0===r.hlsAlias.hlsExpireCount?1:r.hlsAlias.hlsExpireCount+1,r.hlsAlias.hlsExpireCount>3&&(r.hlsAlias.hlsExpireCount=0,r.emitExpireEvent()))})),e.expireDetectType.indexOf("urlExpire")>-1&&r.urlExpireTimestamp&&(new Date).getTime()/1e3>=r.urlExpireTimestamp&&(r.urlExpireTimestamp=c.MAX_TIMESTAMP,r.emitExpireEvent())}),e.checkExpireInterval||400),u.default.on(r,"destroy",(function(){r.hlsTimer&&(r.hlsTimer.clear(),r.hlsTimer=null)}),"destroy"),r}return y(t,o.default),a(t,[{key:"emitExpireEvent",value:function(){var e=(new Date).getTime()/1e3;this.emitExpireTimestamp?e-this.emitExpireTimestamp>c.MIN_EXPIRE_INTERVAL&&(this.emitExpireTimestamp=e,this.emit("MEDIA_EXPIRED")):(this.emitExpireTimestamp=e,this.emit("MEDIA_EXPIRED"))}},{key:"hlsNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NEXT",r=arguments[2],n=this,a=n.config||{};if(n._errReqCount=0,r)for(var o in r)a[o]=r[o];if("startPlay"===i||a.preload||n.unloadSource(),e&&(a.startTime=e),a&&a.startTime&&u.default.once(n,"canplay",(function(){n.currentTime=a.startTime})),n.url=r.url,!r.url||!/\.(mp3|m4a)/.test(r.url)&&!/(mp3|m4a)/.test(r.type))return r.url?("startPlay"!==i&&(a.autoplay?(a.autoplay=!1,n._autoplay=!0):n._autoplay=!1),n.init(),void n.emit("can_start")):void((r.playAuthToken||r.vid)&&("startPlay"!==i&&(a.autoplay?(a.autoplay=!1,this._autoplay=!0):n._autoplay=!1),v(r.playAuthToken,r.playDomain,(function(i){var o=i.videoList,s=i.rawData;if(n.emit("get_play_info",s),o&&o.length>0&&(o[0].MainPlayUrl||o[0].src)){if(o.sort((function(e,t){return t.Bitrate-e.Bitrate})),o[0].Bitrate){var l=0;o.every((function(e,t){return o[0].Bitrate===e.Bitrate&&(l=t,!0)})),l>0&&o.splice(l)}n.emit("resourceReady",o.sort((function(e,t){return t.Bitrate-e.Bitrate})).map((function(e){return e.MainPlayUrl=r.testUrl||e.MainPlayUrl,{name:e.Definition||"标清",url:e.MainPlayUrl||e.src}}))),o[0].UrlExpire&&(n.urlExpireTimestamp=r.testUrlExpire||o[0].UrlExpire),n.getUrlTime=(new Date).getTime()/1e3,e&&u.default.once(n,"playing",(function(){n.currentTime=e,n.play()}));var d=o[0].MainPlayUrl||o[0].src;n.url=a.url=d;for(var c=0;c<o.length;c++)o[c].Definition.toLocaleLowerCase()===a.defaultDefinition&&(n._curDefinitionIndex=c,d=o[c].MainPlayUrl||o[c].src,n.url=a.url=d);var h=o[0].Format;if(o[0]&&o[0].type&&/(mp3|m4a|mp4)/.test(o[0].type))return void n.emit("can_start");if(h&&"m3u8"!=h&&"hls"!=h)return void n.emit("can_start");t.init(),n.emit("can_start")}else{var f=s||{ResponseMetadata:{Error:{CodeN:0,Message:""},RequestId:""}};n.emit("playInterfaceInfo",{code:f.ResponseMetadata.Error.CodeN,message:f.ResponseMetadata.Error.Message,logid:f.ResponseMetadata.RequestId}),n.emit("error",{msg:"HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHRECK THE TOKEN.",errorCode:-9998})}}),(function(e){n.emit("error",{msg:e,errorCode:-9999})}))));n.emit("can_start")}},{key:"switchURL",value:function(e){var t=this,i=t.config||{};t.url=e,i.url=e;var r=t.currentTime;g.addClass(t.root,"xgplayer-is-enter"),u.default.once(t,"playing",(function(){g.removeClass(t.root,"xgplayer-is-enter")})),u.default.once(t,"canplay",(function(){t.currentTime=r,t.play()})),"object"===n(t.hlsAlias)&&(t.hlsAlias.originUrl=e,t.hlsAlias.mobile&&"function"==typeof t._start?t._start():t.src=e)}},{key:"init",value:function(){var e=this,t=g,i=this,r=i.config||{},n=i.start;if(this.browser=u.default.getBrowserVersion(),void 0===r.useHls){var a=!1;if(navigator.userAgent.toLocaleLowerCase().indexOf("ipad")>-1?(navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform||!u.default.checkMediaSourceSupport())&&(a=!0):navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform&&!u.default.checkMediaSourceSupport()&&(a=!0),a)return i.hlsAlias={originUrl:i.definitionList?i.definitionList[i._curDefinitionIndex||0].url:r.definitionList?r.definitionList[i._curDefinitionIndex||0].url:r.url||"",mobile:!0},i.versionNum>=3?i.hlsjs=i.hlsAlias:i.hls=i.hlsAlias,i._start=function(){i.loadSource(r.url,(function(e){if(e.length)i.root.querySelector("video")&&(i.video.querySelector("source")||i.video.src)?(i.autoplay=r.autoplay=!0,i.src=e):n.call(i,e);else{var t=new FileReader;t.onload=function(){i.root.querySelector("video")&&(i.video.querySelector("source")||i.video.src)?(i.autoplay=r.autoplay=!0,i.src=t.result):n.call(i,t.result)},t.readAsDataURL(e)}}))},r.autoplay=i._autoplay,i._autoplay&&(i.video.autoplay=!0),void i._start();i._start=i.start,i.start=function(){}}else r.useHls||i.loadSource(r.url,(function(e){if(e.length)i.root.querySelector("video")&&(i.video.querySelector("source")||i.video.src)?(i.autoplay=r.autoplay=!0,i.src=e):n.call(i,e);else{var t=new FileReader;t.onload=function(){var e=t.result;i.root.querySelector("video")&&(i.video.querySelector("source")||i.video.src)?(i.autoplay=r.autoplay=!0,i.src=e):n.call(i,e)},t.readAsDataURL(e)}}));if(i.root.querySelector("video")&&(i.video.querySelector("source")||i.video.src))i.src=r.url;else{var o=void 0;o=new d.default(this.hlsOpts),this.hlsAlias=o,i.versionNum>=3?i.hlsjs=i.hlsAlias:i.hls=i.hlsAlias,this.hlsAlias.originUrl=r.url||"",Object.defineProperty(i,"src",{get:function(){return i.currentSrc},set:function(e){r.url=e,t.removeClass(i.root,"xgplayer-is-live");var n=document.querySelector(".xgplayer-live");n&&n.parentNode.removeChild(n),i.autoplay=!0,i.paused||i.pause(),i.hlsAlias.stopLoad(),i.hlsAlias.detachMedia(),i.hlsAlias.destroy(),i.hlsAlias=new d.default(i.hlsOpts),i.hlsAlias.originUrl=r.url||"",i.versionNum>=3?i.hlsjs=i.hlsAlias:i.hls=i.hlsAlias,i.register(),i._autoplay?(i.video.setAttribute("autoplay",!0),i._autoplay&&u.default.once(i,"canplay",(function(){i.play().catch((function(e){}))}))):i.video.removeAttribute("autoplay"),i.hlsAlias.attachMedia(i.video)},configurable:!0}),this.hasStart=!0,this.register(),u.default.once(this,"complete",(function(){if((e.config.autoplay||e._autoplay)&&u.default.once(i,"canplay",(function(){i.play().catch((function(e){}))})),o.attachMedia(i.video),r.isLive){g.addClass(i.root,"xgplayer-is-live");var t=g.createDom("xg-live","LIVE",{},"xgplayer-live");i.controls.appendChild(t)}})),this.config.autoplay=this._autoplay,this.root.insertBefore(this.video,this.root.firstChild),this.emit("complete"),u.default.once(this,"destroy",(function(){o.stopLoad()}))}}},{key:"updateM3U8",value:function(e,t,i){var r=this.config||{},n=this.hlsAlias;"TOP"!==r.getKeyType&&(e=window.atob(e));var a=void 0;try{a=new Blob([e],{type:"text/html"})}catch(t){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(a=new BlobBuilder).append(e),a=a.getBlob()}var o=URL.createObjectURL(a);t=t.replace(/,URI="([^"]+)"/,',URI="'+o+'"');var s=u.default.isRelativeURL(this.url)?u.default.getAbsoluteURL(this.url):this.url,l=s.match(/((http|https):?\/\/.+)\/\w+\.\w+/)||[],d=s&&l.length>1?l[1]+"/":"";t=t.replace(/(#EXTINF:)(\d+\.?\d*)(?:,(?:[^\r|\n]*)(?:\r|\n)*)(.*(?!#))/g,(function(e,t,i,r){return/(http|https)?\:?\/\//.test(r)?t+i+",\n"+r:t+i+",\n"+d+r}));var c=void 0;try{c=new Blob([t],{type:"application/x-mpegURL"})}catch(e){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(c=new BlobBuilder).append(t),c=c.getBlob()}var h=URL.createObjectURL(c);n&&(!0===n.mobile?(r.url=h,i&&i(c)):(n.loadSource(h),i&&i(c)))}},{key:"loadSource",value:function e(t,i){return r("484e4f4a403f5243002620129d4951a8000003797fcf5816000003cc1100011200081400021100024a12000911020b07000a440143014700da1100024a12000911020b07000b440143010301131400031102021200034a12000c110003430114000411000433000611000412000d47009111010212000e07000f254700591102021200034a12001011010212001143014700121102034a12001211010212001143014500061101021200111400050700131101021200143400030700041807001518110005180700161811000412000d1814000345002b1101021200173400030700040700181811000412000d1807001918110102120011340003070004181400030d1100030e001a1100020e001b4245004a11010347004411010312001c002547001611020a33000c0211020a1101021200064301494500231101034a12001d11010212000643014911020a33000c0211020a11010212000643014908421100013234000711000112001a32470002084211000112001a14000211000112001b14000305000002203c0114000411010212001133001c11010212000e07000f2547000911010212001445000611010212001747006511010112002d07002e264700261102011200030d1100020e000607002f0e000544014a12000705000003473b0143014945002f11020744001400051100054a1200300700311100024302491100054a12003243004905000003533b0011000515003445001f1101021200354700161101014a12002c11010212003511000311020a43034908420300381400023e00571400091103014a12001e07001f0d070020110009180e002104270c1d0e00224302490d1104021200034a120010110001120008430147000911000112000845000f1104034a12002311000112000843010e0024140002413d00ac1104044a120025110001120008430114000211030212000e07000f2547001211000212002612002711000215002445007a110303110405120003373247005711000212002414000302030049110406120025110003430114000411000412002814000511000412002914000611000412002a1400070203004911040612002b11000511000611000743031400081100081100021500241104034a1200231100021200244301110002150024411103014a12002c11000212002411020311040a43034908420211010411000143014908421101051200330400c82534000a1101051200330400ce2547000a0211010411010543014908420b1400011100011200003400010d1400020b1200011400031101091100031500021101011200030d0700040e00051101090e000644014a12000705000000003b0143014a12000705000001433b014301490842003606767a7b737c72087d796654797c74660b78747b7c7370666140677907717073746079610004616c65700360677904617d707b0c677066657a7b667041706d6105787461767d1536504d41384d385e504c2f3d49623e2849623e3c3e0e3940475c28373d4e4b37483e3c3708657467667040677902747e0a7270615e706c416c657003415a45087c66577466702321087e706c417a7e707b0474617a77023a3a0a6579746c517a78747c7b012a1233467a60677670287f7467637c6633547e28097e706c517a78747c7b223a7e71663a74657c3a63263a7e706c662a667a60677670287f7467637c6633747e280733617a7e707b28067e706c4067790376616d06787a777c79700a797a7471467a606776700470787c61057067677a67156670766770615e706c356574676670357067677a6703786672097067677a67567a71700477617a74047174617405657467667006477066607961094670766770615e706c07707b7651746174037e706c027c6307717076676c65610a6065717461705826402d0777677a62667067055c503524240461706d61047a65707b037270610466707b7106666174616066067a7b797a7471087e706c4374796070",{get 0(){return e},get 1(){return f},get 2(){return u},get 3(){return window},4:JSON,get 5(){return d},get 6(){return l},get 7(){return XMLHttpRequest},8:arguments,9:t,10:i,11:RegExp},this)}},{key:"unloadSource",value:function(){this.hlsAlias instanceof d.default&&this.hls.detachMedia(),this.video&&(this.video.removeAttribute("src"),this.video.load())}},{key:"register",value:function(){var e=this.hlsAlias,t=g,i=this,r=i.config||{};i.once("playing",(function(){var e=!1,t=i.video.querySelector("track");t&&("hidden"===t.track.mode&&(e=!0),t.track.mode="hidden",i.video.removeChild(t)),r.textTrack&&r.textTrack.length>0&&r.textTrack.some((function(t){if(t.src&&t.label&&t.default){var r=document.createElement("track");return r.src=t.src,r.kind=t.kind,r.label=t.label,r.srclang=t.srclang,r.default=!0,i.video.appendChild(r),e&&(r.track.mode="hidden"),!0}}))})),e.once(d.default.Events.MEDIA_ATTACHED,(function(){i.loadSource(r.url)})),e.on(d.default.Events.LEVEL_LOADED,(function(r,n){if(!e.inited&&(e.inited=!0,n&&n.details&&n.details.live)){t.addClass(i.root,"xgplayer-is-live");var a=t.createDom("xg-live","LIVE",{},"xgplayer-live");i.controls.appendChild(a)}})),e.on(d.default.Events.ERROR,(function(e,t){t.fatal&&i.emit("error",t)}))}},{key:"versionNum",get:function(){return this.version&&this.version[0]&&parseInt(this.version[0])}}]),t}();Z.isSupported=function(e){e=e||navigator.userAgent.toLocaleLowerCase();var t=/(iphone)/.test(e)||/(ipad)/.test(e),i=/(android)/.test(e),r=/(windows phone)/.test(e),n=!(t||i||r),a=/(xiaomi)/.test(e),o=/(quark)/.test(e);return!(a||(n||i?!window.MediaSource||!window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'):!t||o||e.indexOf("iphone os 11_4")>-1||e.indexOf("iphone os 11_2")>-1))},Z.HlsJs=d.default,t.default=Z,e.exports=t.default},function(e,t){e.exports=r},function(e,t){e.exports=function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=22)}([function(e,t,i){"use strict";var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,i){"use strict";var r=i(12)("wks"),n=i(13),a=i(0).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:n)("Symbol."+e))}).store=r},function(e,t,i){"use strict";var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(e,t,i){"use strict";var r=i(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":r(e))?null!==e:"function"==typeof e}},function(e,t,i){"use strict";var r=i(6);e.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,n){return e.call(t,i,r,n)}}return function(){return e.apply(t,arguments)}}},function(e,t,i){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,i){"use strict";e.exports=!i(15)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,i){"use strict";var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,i){"use strict";var r=i(3),n=i(26),a=i(27),o=Object.defineProperty;t.f=i(7)?Object.defineProperty:function(e,t,i){if(r(e),t=a(t,!0),r(i),n)try{return o(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},function(e,t,i){"use strict";e.exports=!1},function(e,t,i){"use strict";var r=i(8),n=i(1)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,i,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),n))?i:a?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,i){"use strict";var r=i(2),n=i(0),a=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:i(10)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,i){"use strict";var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,i){"use strict";var r=i(9),n=i(28);e.exports=i(7)?function(e,t,i){return r.f(e,t,n(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,i){"use strict";var r=i(4),n=i(0).document,a=r(n)&&r(n.createElement);e.exports=function(e){return a?n.createElement(e):{}}},function(e,t,i){"use strict";var r=i(0),n=i(14),a=i(18),o=i(13)("src"),s=i(29),l=(""+s).split("toString");i(2).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,i,s){var d="function"==typeof i;d&&(a(i,"name")||n(i,"name",t)),e[t]!==i&&(d&&(a(i,o)||n(i,o,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=i:s?e[t]?e[t]=i:n(e,t,i):(delete e[t],n(e,t,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||s.call(this)}))},function(e,t,i){"use strict";var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,i){"use strict";e.exports={}},function(e,t,i){"use strict";var r,n,a,o=i(5),s=i(38),l=i(39),d=i(16),c=i(0),u=c.process,h=c.setImmediate,f=c.clearImmediate,m=c.MessageChannel,p=c.Dispatch,b=0,y={},g=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},v=function(e){g.call(e.data)};h&&f||(h=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return y[++b]=function(){s("function"==typeof e?e:Function(e),t)},r(b),b},f=function(e){delete y[e]},"process"==i(8)(u)?r=function(e){u.nextTick(o(g,e,1))}:p&&p.now?r=function(e){p.now(o(g,e,1))}:m?(a=(n=new m).port2,n.port1.onmessage=v,r=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",v,!1)):r="onreadystatechange"in d("script")?function(e){l.appendChild(d("script")).onreadystatechange=function(){l.removeChild(this),g.call(e)}}:function(e){setTimeout(o(g,e,1),0)}),e.exports={set:h,clear:f}},function(e,t,i){"use strict";var r=i(6);function n(e){var t,i;this.promise=new e((function(e,r){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=r})),this.resolve=r(t),this.reject=r(i)}e.exports.f=function(e){return new n(e)}},function(e,t,i){e.exports=i(23)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(24);var r,n=(r=i(48))&&r.__esModule?r:{default:r};t.default={url:n.default},e.exports=t.default},function(e,t,i){"use strict";var r,n,a,o,s=i(10),l=i(0),d=i(5),c=i(11),u=i(25),h=i(4),f=i(6),m=i(30),p=i(31),b=i(37),y=i(20).set,g=i(40)(),v=i(21),Z=i(41),T=i(42),L=i(43),S=l.TypeError,x=l.process,k=x&&x.versions,I=k&&k.v8||"",X=l.Promise,R="process"==c(x),w=function(){},G=n=v.f,W=!!function(){try{var e=X.resolve(1),t=(e.constructor={})[i(1)("species")]=function(e){e(w,w)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(w)instanceof t&&0!==I.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(e){}}(),E=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},_=function(e,t){if(!e._n){e._n=!0;var i=e._c;g((function(){for(var r=e._v,n=1==e._s,a=0,o=function(t){var i,a,o,s=n?t.ok:t.fail,l=t.resolve,d=t.reject,c=t.domain;try{s?(n||(2==e._h&&V(e),e._h=1),!0===s?i=r:(c&&c.enter(),i=s(r),c&&(c.exit(),o=!0)),i===t.promise?d(S("Promise-chain cycle")):(a=E(i))?a.call(i,l,d):l(i)):d(r)}catch(e){c&&!o&&c.exit(),d(e)}};i.length>a;)o(i[a++]);e._c=[],e._n=!1,t&&!e._h&&C(e)}))}},C=function(e){y.call(l,(function(){var t,i,r,n=e._v,a=P(e);if(a&&(t=Z((function(){R?x.emit("unhandledRejection",n,e):(i=l.onunhandledrejection)?i({promise:e,reason:n}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",n)})),e._h=R||P(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},P=function(e){return 1!==e._h&&0===(e._a||e._c).length},V=function(e){y.call(l,(function(){var t;R?x.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},M=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),_(t,!0))},K=function e(t){var i,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw S("Promise can't be resolved itself");(i=E(t))?g((function(){var n={_w:r,_d:!1};try{i.call(t,d(e,n,1),d(M,n,1))}catch(e){M.call(n,e)}})):(r._v=t,r._s=1,_(r,!1))}catch(e){M.call({_w:r,_d:!1},e)}}};W||(X=function(e){m(this,X,"Promise","_h"),f(e),r.call(this);try{e(d(K,this,1),d(M,this,1))}catch(e){M.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(44)(X.prototype,{then:function(e,t){var i=G(b(this,X));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=R?x.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&_(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new r;this.promise=e,this.resolve=d(K,e,1),this.reject=d(M,e,1)},v.f=G=function(e){return e===X||e===o?new a(e):n(e)}),u(u.G+u.W+u.F*!W,{Promise:X}),i(45)(X,"Promise"),i(46)("Promise"),o=i(2).Promise,u(u.S+u.F*!W,"Promise",{reject:function(e){var t=G(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(s||!W),"Promise",{resolve:function(e){return L(s&&this===o?X:this,e)}}),u(u.S+u.F*!(W&&i(47)((function(e){X.all(e).catch(w)}))),"Promise",{all:function(e){var t=this,i=G(t),r=i.resolve,n=i.reject,a=Z((function(){var i=[],a=0,o=1;p(e,!1,(function(e){var s=a++,l=!1;i.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,i[s]=e,--o||r(i))}),n)})),--o||r(i)}));return a.e&&n(a.v),i.promise},race:function(e){var t=this,i=G(t),r=i.reject,n=Z((function(){p(e,!1,(function(e){t.resolve(e).then(i.resolve,r)}))}));return n.e&&r(n.v),i.promise}})},function(e,t,i){"use strict";var r=i(0),n=i(2),a=i(14),o=i(17),s=i(5),l=function e(t,i,l){var d,c,u,h,f=t&e.F,m=t&e.G,p=t&e.P,b=t&e.B,y=m?r:t&e.S?r[i]||(r[i]={}):(r[i]||{}).prototype,g=m?n:n[i]||(n[i]={}),v=g.prototype||(g.prototype={});for(d in m&&(l=i),l)u=((c=!f&&y&&void 0!==y[d])?y:l)[d],h=b&&c?s(u,r):p&&"function"==typeof u?s(Function.call,u):u,y&&o(y,d,u,t&e.U),g[d]!=u&&a(g,d,h),p&&v[d]!=u&&(v[d]=u)};r.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,i){"use strict";e.exports=!i(7)&&!i(15)((function(){return 7!=Object.defineProperty(i(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,i){"use strict";var r=i(4);e.exports=function(e,t){if(!r(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!r(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t,i){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,i){"use strict";e.exports=i(12)("native-function-to-string",Function.toString)},function(e,t,i){"use strict";e.exports=function(e,t,i,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(i+": incorrect invocation!");return e}},function(e,t,i){"use strict";var r=i(5),n=i(32),a=i(33),o=i(3),s=i(34),l=i(36),d={},c={},u=e.exports=function(e,t,i,u,h){var f,m,p,b,y=h?function(){return e}:l(e),g=r(i,u,t?2:1),v=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(a(y)){for(f=s(e.length);f>v;v++)if((b=t?g(o(m=e[v])[0],m[1]):g(e[v]))===d||b===c)return b}else for(p=y.call(e);!(m=p.next()).done;)if((b=n(p,g,m.value,t))===d||b===c)return b};u.BREAK=d,u.RETURN=c},function(e,t,i){"use strict";var r=i(3);e.exports=function(e,t,i,n){try{return n?t(r(i)[0],i[1]):t(i)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,i){"use strict";var r=i(19),n=i(1)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[n]===e)}},function(e,t,i){"use strict";var r=i(35),n=Math.min;e.exports=function(e){return e>0?n(r(e),9007199254740991):0}},function(e,t,i){"use strict";var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,i){"use strict";var r=i(11),n=i(1)("iterator"),a=i(19);e.exports=i(2).getIteratorMethod=function(e){if(null!=e)return e[n]||e["@@iterator"]||a[r(e)]}},function(e,t,i){"use strict";var r=i(3),n=i(6),a=i(1)("species");e.exports=function(e,t){var i,o=r(e).constructor;return void 0===o||null==(i=r(o)[a])?t:n(i)}},function(e,t,i){"use strict";e.exports=function(e,t,i){var r=void 0===i;switch(t.length){case 0:return r?e():e.call(i);case 1:return r?e(t[0]):e.call(i,t[0]);case 2:return r?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},function(e,t,i){"use strict";var r=i(0).document;e.exports=r&&r.documentElement},function(e,t,i){"use strict";var r=i(0),n=i(20).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,l="process"==i(8)(o);e.exports=function(){var e,t,i,d=function(){var r,n;for(l&&(r=o.domain)&&r.exit();e;){n=e.fn,e=e.next;try{n()}catch(r){throw e?i():t=void 0,r}}t=void 0,r&&r.enter()};if(l)i=function(){o.nextTick(d)};else if(!a||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);i=function(){c.then(d)}}else i=function(){n.call(r,d)};else{var u=!0,h=document.createTextNode("");new a(d).observe(h,{characterData:!0}),i=function(){h.data=u=!u}}return function(r){var n={fn:r,next:void 0};t&&(t.next=n),e||(e=n,i()),t=n}}},function(e,t,i){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,i){"use strict";var r=i(0).navigator;e.exports=r&&r.userAgent||""},function(e,t,i){"use strict";var r=i(3),n=i(4),a=i(21);e.exports=function(e,t){if(r(e),n(t)&&t.constructor===e)return t;var i=a.f(e);return(0,i.resolve)(t),i.promise}},function(e,t,i){"use strict";var r=i(17);e.exports=function(e,t,i){for(var n in t)r(e,n,t[n],i);return e}},function(e,t,i){"use strict";var r=i(9).f,n=i(18),a=i(1)("toStringTag");e.exports=function(e,t,i){e&&!n(e=i?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,i){"use strict";var r=i(0),n=i(9),a=i(7),o=i(1)("species");e.exports=function(e){var t=r[e];a&&t&&!t[o]&&n.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t,i){"use strict";var r=i(1)("iterator"),n=!1;try{var a=[7][r]();a.return=function(){n=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var i=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:i=!0}},a[r]=function(){return o},e(a)}catch(e){}return i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e){try{e=JSON.parse(n.default.base64decode(e))}catch(e){return Promise.reject("base64 decode error")}var o=[];for(var s in i)o.push(s+"="+i[s]);var l="//"+t+"?"+e.GetPlayInfoToken+"&ssl=true";return o.length>0&&(l+="&"+o.join("&")),new a.default({type:"json",method:"GET",url:l}).then((function(e){return e&&e.response?"string"==typeof e.response?JSON.parse(e.response).Result:"object"===r(e.response)?e.response.Result:e.response:e}))}return Promise.reject("vid, host and token can't be empty")};var n=o(i(49)),a=o(i(50));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={base64decode:function(e){var t,i,r,n,a,o,s,l=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(o=e.length,a=0,s="";a<o;){do{t=l[255&e.charCodeAt(a++)]}while(a<o&&-1===t);if(-1===t)break;do{i=l[255&e.charCodeAt(a++)]}while(a<o&&-1===i);if(-1===i)break;s+=String.fromCharCode(t<<2|(48&i)>>4);do{if(61==(r=255&e.charCodeAt(a++)))return s;r=l[r]}while(a<o&&-1===r);if(-1===r)break;s+=String.fromCharCode((15&i)<<4|(60&r)>>2);do{if(61==(n=255&e.charCodeAt(a++)))return s;n=l[n]}while(a<o&&-1===n);if(-1===n)break;s+=String.fromCharCode((3&r)<<6|n)}return s}};t.default=r,e.exports=t.default},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.url,n=t.method,a=void 0===n?"GET":n,o=(t.type,t.data),s=void 0===o?{}:o,l=t.headers,d=void 0===l?{}:l;return r(this,e),new Promise((function(e,t){var r=new window.XMLHttpRequest,n=a.toUpperCase(),o=[];for(var l in s)o.push(l+"="+s[l]);if("GET"!==n)throw new Error("xhr "+n+" is not supported");for(var c in r.open(n,""+i,!0),r.responseType="",d)r.setRequestHeader(c,""+d[c]);r.send(),r.onload=function(){200===r.status||206===r.status?e(r):t(r)},r.onerror=function(){t(r)}}))},e.exports=t.default}])},function(e,t,i){var r;"undefined"!=typeof window&&(r=function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s="./src/hls-wrapper.ts")}({"../crypt/dist/jsvmp.js":function(e,t){!function(e,t,i){function r(e,t){var i=parseInt(e.slice(t,t+2),16);return i>>>7==0?[1,i]:i>>>6==2?(i=(63&i)<<8,[2,i+=parseInt(e.slice(t+2,t+4),16)]):(i=(63&i)<<16,[3,i+=parseInt(e.slice(t+2,t+6),16)])}var n,a=0,o=[],s=[],l=parseInt(e.slice(0,8),16),d=parseInt(e.slice(8,16),16);if(1213091658!==l||1077891651!==d)throw new Error("mhe");if(0!==parseInt(e.slice(16,18),16))throw new Error("ve");for(n=0;n<4;++n)a+=(3&parseInt(e.slice(24+2*n,26+2*n),16))<<2*n;var c=parseInt(e.slice(32,40),16),u=2*parseInt(e.slice(48,56),16);for(n=56;n<u+56;n+=2)o.push(parseInt(e.slice(n,n+2),16));var h=u+56,f=parseInt(e.slice(h,h+4),16);for(h+=4,n=0;n<f;++n){var m=r(e,h);h+=2*m[0];for(var p="",b=0;b<m[1];++b){var y=r(e,h);p+=String.fromCharCode(a^y[1]),h+=2*y[0]}s.push(p)}t.p=null,function e(t,i,r,n,a){var l,d,c,u,h,f=-1,m=[],p=[0,null],b=null,y=[i];for(d=Math.min(i.length,r),c=0;c<d;++c)y.push(i[c]);y.p=n;for(var g=[];;)try{var v=o[t++];if(v<39)if(v<19)if(v<7)v<3?m[++f]=v<1||1!==v&&null:v<5?3===v?(l=o[t++],m[++f]=l<<24>>24):(l=(o[t]<<8)+o[t+1],t+=2,m[++f]=l<<16>>16):5===v?(l=((l=((l=o[t++])<<8)+o[t++])<<8)+o[t++],m[++f]=(l<<8)+o[t++]):(l=(o[t]<<8)+o[t+1],t+=2,m[++f]=+s[l]);else if(v<13)v<11?7===v?(l=(o[t]<<8)+o[t+1],t+=2,m[++f]=s[l]):m[++f]=void 0:11===v?m[++f]=a:(l=(o[t]<<8)+o[t+1],t+=2,f=f-l+1,d=m.slice(f,f+l),m[f]=d);else if(v<17)13===v?m[++f]={}:(l=(o[t]<<8)+o[t+1],t+=2,d=s[l],c=m[f--],m[f][d]=c);else if(17===v){for(d=o[t++],c=o[t++],u=y;d>0;--d)u=u.p;m[++f]=u[c]}else l=(o[t]<<8)+o[t+1],t+=2,d=s[l],m[f]=m[f][d];else if(v<26)if(v<22)if(v<20)d=m[f--],m[f]=m[f][d];else if(20===v){for(d=o[t++],c=o[t++],u=y;d>0;--d)u=u.p;u[c]=m[f--]}else l=(o[t]<<8)+o[t+1],t+=2,d=s[l],c=m[f--],u=m[f--],c[d]=u;else if(v<24)if(22===v)d=m[f--],c=m[f--],u=m[f--],c[d]=u;else{for(d=o[t++],c=o[t++],u=y,u=y;d>0;--d)u=u.p;m[++f]=u,m[++f]=c}else 24===v?(d=m[f--],m[f]+=d):(d=m[f--],m[f]-=d);else v<33?v<28?26===v?(d=m[f--],m[f]*=d):(d=m[f--],m[f]/=d):28===v?(d=m[f--],m[f]%=d):m[f]=-m[f]:v<37?33===v?(d=m[f--],c=m[f--],m[++f]=c[d]++):(d=m[f--],m[f]=m[f]==d):37===v?(d=m[f--],m[f]=m[f]===d):(d=m[f--],m[f]=m[f]!==d);else if(v<55)v<47?v<43?v<40?(d=m[f--],m[f]=m[f]<d):40===v?(d=m[f--],m[f]=m[f]<=d):(d=m[f--],m[f]=m[f]>d):v<45?43===v?(d=m[f--],m[f]=m[f]<<d):(d=m[f--],m[f]=m[f]>>d):45===v?(d=m[f--],m[f]=m[f]>>>d):(d=m[f--],m[f]=m[f]&d):v<51?v<49?47===v?(d=m[f--],m[f]=m[f]|d):m[f]=~m[f]:49===v?(d=m[f--],m[f]=m[f]^d):m[f]=!m[f]:v<53?51===v?(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,m[f]?--f:t+=l):(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,m[f]?t+=l:--f):53===v?(d=m[f--],(c=m[f--])[d]=m[f]):(d=m[f--],m[f]=m[f]in d);else if(v<65)if(v<60)v<58?55===v?(d=m[f--],m[f]=m[f]instanceof d):m[f]=void 0:58===v?m[f]=typeof m[f]:(l=o[t++],d=m[f--],(c=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)})._v=[d,l,y],c._u=e,m[++f]=c);else if(v<62)60===v?(l=o[t++],d=m[f--],(u=[c=function e(){var t=e._v;return(0,e._u)(t[0],arguments,t[1],t[2],this)}]).p=y,c._v=[d,l,u],c._u=e,m[++f]=c):(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=g[g.length-1])[1]=t+l);else{if(62!==v)throw d=m[f--];l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=g[g.length-1])&&!d[1]?(d[0]=3,d.push(t)):g.push([1,0,t]),t+=l}else if(v<69)if(v<67)if(65===v)if(c=(d=g.pop())[0],u=p[0],1===c)t=d[1];else if(0===c)if(0===u)t=d[1];else{if(1!==u)throw p[1];if(!b)return p[1];t=b[1],a=b[2],y=b[3],g=b[4],m[++f]=p[1],p=[0,null],b=b[0]}else t=d[2],d[0]=0,g.push(d);else{for(d=m[f--],c=null;u=g.pop();)if(2===u[0]||3===u[0]){c=u;break}if(c)p=[1,d],t=c[2],c[0]=0,g.push(c);else{if(!b)return d;t=b[1],a=b[2],y=b[3],g=b[4],m[++f]=d,p=[0,null],b=b[0]}}else if(67===v)f-=l=o[t++],c=m.slice(f+1,f+l+1),d=m[f--],u=m[f--],d._u===e?(d=d._v,b=[b,t,a,y,g],t=d[0],null==u&&(u=function(){return this}()),a=u,(y=[c].concat(c)).length=Math.min(d[1],l)+1,y.p=d[2],g=[]):m[++f]=d.apply(u,c);else{for(l=o[t++],u=[void 0],h=l;h>0;--h)u[h]=m[f--];c=m[f--],d=Function.bind.apply(c,u),m[++f]=new d}else v<73?69===v?t+=2+(l=(l=(o[t]<<8)+o[t+1])<<16>>16):(l=(l=(o[t]<<8)+o[t+1])<<16>>16,t+=2,(d=m[f--])||(t+=l)):73===v?--f:(d=m[f],m[++f]=d)}catch(e){for(p=[0,null];(l=g.pop())&&!l[0];);if(!l){e:for(;b;){for(d=b[4];l=d.pop();)if(l[0])break e;b=b[0]}if(!b)throw e;t=b[1],a=b[2],y=b[3],g=b[4],b=b[0]}1===(d=l[0])?(t=l[2],l[0]=0,g.push(l),m[++f]=e):2===d?(t=l[2],l[0]=0,g.push(l),p=[3,e]):(t=l[3],l[0]=2,g.push(l),m[++f]=e)}}(c,[],0,t,i)}("484e4f4a403f5243003e182907004791000046b65190830a00004cfc070001490700021102003a2333000b0700031102001200043a2347000a050000003d3b0145000705000000423b011701013549021101011100014301421100013a421100013300080700021103003a2333000a1100011200051103002533000a110001110300120006264700060700034500041100013a421102033a07000d2633000611020312000e47000c11020312000e14010245000a05000000b03c031401021101024a1200120b1100004302420211030311000111000243021400041100043247000208421104014a12000f110004110002430214000511000512000e47002211000512000e4a120010110000120011030327470006110001450003110003430142110005120009421102011200061200134a12001011000111000243023247001a021101081100014301140001110001022547000345000345ffcd110001421100023a0700022633000511000202264700091102040700144401401102014a1200151100023300061100021200060d0d1100010e0009000e0016000e00170e000543021100011500061102014a1200071100010700060d010e001643034911000247000d0211010b11000111000243024908420211010a430014000205000001c83c0042021103081102014301140001110202470025021103080b43011200051400031104034a12001811000111000011000343031400024500101100014a1200120b1100004302140002021103060b110002430242110002330018021101011100024301070019253400081100023a07000225470007110002424500131100020300382647000911020407001a440140021101071100014301421100010300382547000911020507001b4401401100014211020112001c47000911020112001d450007050000029c3c011401080211010811000143014211000112001e34000c1104014a12001d1100014301420211010a430047000c11020312001814010945000a05000002df3c031401091101094a12001202110000430242020c000114000411000412001f4a1200121100041100024302491104061200204a120012110001110004430214000511000544001400061100034700100211030b110006110003120006430249110006421102033a07000d2534000711020312001832470002014211020312001812002147000201421102073a0700022547000200423e00061400010142413d00291102081200061200224a1200101102034a1200181102080c000005000003993b0043034301490042410842084211020112001c34000705000003bb3c0214010b0211010b11000111000243024211000211000115001e110001421100011100023732470009110204070023440140084203001400031100031100021200112747005011000211000313140004110004120024340001011100041500240011000415001707000911000436470007001100041500161102014a120007110001110004120025110004430349170003214945ffa308421100024700100211010d11000112000611000243024911000347000d0211010d1100011100034302491102014a1200071100010700060d010e00164303491100014205000004d53b001400010211010e1100010d0700260e002505000004e23c010e00090d0700280e002505000004f03c000e00090c00020d0700150e0025050000050b3c000e00090c0001430349110001420211020c0b11010143024908421104014a1200270b1100014302420b12000544001400011104014a1200271100010b4302491100014211000012001114000111040911000144011400020300140003110003110001274700161100001100031311000211000316170003214945ffe0021103090b11000243024205000005db3b00140003021101041100031100014302490211010511000343011400020211010e1100030d07002e0e002505000007553c000e00090d0700300e002505000007863c010e00090d0700310e0025050000086c3c000e00090d0700280e002505000008b73c000e00090c00040d0700350e002505000008ed3c010e00090c00014303491100034211000012001103002933000811000003001308264700091100000300134500030c0000140002110000120011030129330008110000030113082647000911000003011345000911000212001103041a1400030211020c0b1101034302491101024a1200100b430114000111000214000411000411030a3747000b11030b110004440114000411000411030c3734000711000411030d3734000711000411030e3734000711000411030f373400071100041103103734000711000411031137340007110004110312373400071100041103133747001a11030b11000412002911000412002a11000412002b440314000411000411030b3747006b11000412002b1400050c000014000603001400071100071100052747003811000611000703022d1311000411000713031811000703041c03081a192b2f11000611000703022d3549110007030118170007354945ffbe11000611000115002c11000511000115002d45001211000211000115002c11000311000115002d1100014211000012001103002933000811000003001308264700091100000300134500031103111400011100014a12002f0b4301420b12002c14000211000112002c1400030b12002d14000411000112002d1400050b4a12003143004911000403041c47007003001400061100061100052747005e11000311000603022d13031811000603041c03081a192d0400ff2e1400071100021100041100061803022d1311000703181100041100061803041c03081a192b2f1100021100041100061803022d3549110006030118170006354945ff9845003503001400081100081100052747002611000311000803022d131100021100041100081803022d16110008030418170008354945ffd00b12002d110005180b07002d35490b420b12002c1400010b12002d14000211000111000203022d13060032032011000203041c03081a192b2e11000111000203022d35491104144a12003311000203041b43011100011500110842021103020211030811020312000643010700280b43034a1200100b43011400010b12002c4a1200340300430111000115002c110001420c000014000205000009683c01140003030014000411000411000127470050021100031100053400091104144a12003543000600361a4301140006021100064300053ade67b71a1400051100024a12001f0211000643000600361a03002f430149110004030418170004354945ffa6110203110002110001440242110001140002053ade68b114000306003214000405000009843b00420500009069110103050000ffff2e1a11010303102c181101042e140103044650110102050000ffff2e1a11010203102c181101042e14010211010303102b110102181101042e1400011100010600361b17000135491100010600371817000135491100011107144a120035430006003729470005030145000303011d1a4211000112002c14000211000112002d1400030c000014000403001400051100051100032747005c11000211000503022d13031811000503041c03081a192d0400ff2e1400061100044a12001f11000603042d4a12002e031043014301491100044a12001f110006030f2e4a12002e03104301430149110005030118170005354945ff9a1100044a1200380700394301421100011200111400020c000014000303001400041100041100022747004711000311000403032d13021103151100014a12003a1100040302430203104302031811000403081c03041a192b2f11000311000403032d3549110004030218170004354945ffaf11021011000311000203021b44024211000112002c14000211000112002d1400030c000014000403001400051100051100032747004211000211000503022d13031811000503041c03081a192d0400ff2e1400061100044a12001f1103164a12003b1100064301430149110005030118170005354945ffb41100044a1200380700394301421100011200111400020c000014000303001400041100041100022747004111000311000403022d131100014a12003c11000443010400ff2e031811000403041c03081a192b2f11000311000403022d3549110004030118170004354945ffb51102101100031100024402423e000d14000211031907003d440140413d001a02110317021103181102124a12002f110001430143014301424108421102124a12000c0211031a0211031b110001430143014301420500000ca73b00140003021101041100031100014302490211010511000343011400020211010e1100030d07003f0e00250500000ccb3c000e00090d0700420e00250500000cdc3c010e00090d0700440e00250500000d1d3c010e00090d0700280e00250500000e013c000e00090c0004430249110003420211020c0b1101034302491101024a1200100b4301140001030011000115003e1100014211031044000b15004003000b15004108421100011400021100023a0700432547000f1103134a12000c11000243011400020b1200404a1200301100024301490b12004111000212002d180b070041354908420b1200401400030b12004514000411000312002c14000511000312002d14000611000403041a1400071100061100071b1400081100014700121104144a12003311000843011400084500191104144a12004611000803002f0b12003e19030043021400081100081100041a1400091104144a12004711000903041a110006430214000a11000947004f030014000b11000b1100092747001d0b4a12004811000511000b43024911000b1100041817000b354945ffd91100054a1200490300110009430214000211000312002d11000a1911000307002d354911031011000211000a440242021103020211030811020312000643010700280b43034a1200100b43011400010b1200404a1200284300110001150040110001420500000ec13b01140003021101041100031100014302490211010511000343011400020211010e1100030d07003f0e00250500000f0a3c000e00090d07004c0e00250500000f323c010e00090d07004d0e00250500000f473c010e00090c00030d07004f0e00250500000f663c010e00090d0700500e00250500000f803c010e00090c0002430349110003420211020c0b1101034302491101024a1200100b430114000204020003201b1100021500451103014a12002711020f4400110001430211000215004a1100024a12003f430049110002420211030202110308110203120006430107003f0b43034a1200100b4301490b4a12004b43004908420b4a1200421100014301490b4a1200444300490b4211000147000b0b4a1200421100014301490b4a12004e4300140002110002420500000f6e3b024211010111000244014a12004d1100014301420500000f883b024211041611010111000244024a12004d11000143014205000010043b02140003021101041100031100014302490211010511000343011400020211010e1100030d07003f0e002505000011283c000e00090d07004c0e002505000011493c010e00090d07004d0e002505000011593c010e00090c0003430249110003420211020c0b1101034302491101024a1200100b430114000311000144001400041100041100031500511100021400051100053a0700432547000f1102134a12000c110005430114000511000412004514000611000603041a14000711000512002d1100072947000f1100044a12004d11000243011400051100054a1200314300491100054a12002843001400081100081100031500521100054a120028430014000911000911000315005311000812002c14000a11000912002c14000b030014000c11000c1100062747003811000a11000c13055c5c5c5c3111000a11000c354911000b11000c1305363636363111000b11000c354911000c03011817000c354945ffbe11000711000815002d11000711000915002d1100034a12003f430049110003420b1200511400011100014a12003f4300491100014a12004c0b12005343014908420b1200514a12004c1100014301490b420b1200511400021100024a12004d11000143011400031100024a12003f4300491100024a12004d0b1200524a12002843004a12003011000343014301140004110004420c0000140004030014000503001400061100061100022747009211000603041c47007b1100031100014a12003c11000603011943011311000603041c03021a2b1400071100031100014a12003c110006430113030611000603041c03021a192d1400081100071100082f14000911000411000503022d13110009031811000503041c03081a192b2f11000411000503022d35491100050301181700053549110006030118170006354945ff641102104a12001511000411000543024211000112002c14000211000112002d1400030b1200541400041100014a1200314300490c00001400050300140006110006110003274700d911000211000603022d13031811000603041c03081a192d0400ff2e14000711000211000603011803022d13031811000603011803041c03081a192d0400ff2e14000811000211000603021803022d13031811000603021803041c03081a192d0400ff2e14000911000703102b11000803082b2f1100092f14000a030014000b11000b03042733000f11000611000b0600551a18110003274700311100054a12001f1100044a12005611000a0306030311000b191a2d033f2e430143014911000b03011817000b354945ffb4110006030318170006354945ff1d1100044a1200560340430114000c11000c47001c11000512001103041c4700101100054a12001f11000c43014945ffe41100054a1200380700394301421100011200111400020b1200541400030b120057140004110004324700410c00000b1500570b1200571400040300140005110005110003120011274700211100051100041100034a12003c110005430116110005030118170005354945ffd21100034a1200560340430114000611000647001f1100014a120058110006430114000711000703011d26470006110007140002021102171100011100021100044303421100011100021100032e110002301100042e2f1811000518110007181400081100081100062b1100080320110006192d2f11000218421100011100021100042e110003110004302e2f1811000518110007181400081100081100062b1100080320110006192d2f110002184211000111000211000331110004311811000518110007181400081100081100062b1100080320110006192d2f1100021842110001110003110002110004302f311811000518110007181400081100081100062b1100080320110006192d2f1100021842050000158f3b00140003021101041100031100014302490211010511000343011400020211010e1100030d07004b0e002505000015a83c000e00090d0700480e002505000015c63c020e00090d07004e0e00250500001f743c000e00090d0700280e002505000020c63c000e00090c0004430249110003420211020c0b1101034302491101024a1200120b110000430242110310056745230106005c06005d05103254760c000444010b15005e0842110001140003030014000411000403102747004e110002110004181400051100011100051314000611000603082b11000603182d2f0500ff00ff2e11000603182b11000603082d2f06005f2e2f11000311000516110004030118170004354945ffa90b12005e12002c14000711000311000203001813140008110003110002030118131400091100031100020302181314000a1100031100020303181314000b1100031100020304181314000c1100031100020305181314000d1100031100020306181314000e1100031100020307181314000f1100031100020308181314001011000311000203091813140011110003110002030a1813140012110003110002030b1813140013110003110002030c1813140014110003110002030d1813140015110003110002030e1813140016110003110002030f181314001711000703001314001811000703011314001911000703021314001a11000703031314001b0211031b11001811001911001a11001b110008030711031903001343071400180211031b11001b11001811001911001a110009030c110319030113430714001b0211031b11001a11001b11001811001911000a0311110319030213430714001a0211031b11001911001a11001b11001811000b031611031903031343071400190211031b11001811001911001a11001b11000c030711031903041343071400180211031b11001b11001811001911001a11000d030c110319030513430714001b0211031b11001a11001b11001811001911000e0311110319030613430714001a0211031b11001911001a11001b11001811000f031611031903071343071400190211031b11001811001911001a11001b110010030711031903081343071400180211031b11001b11001811001911001a110011030c110319030913430714001b0211031b11001a11001b1100181100191100120311110319030a13430714001a0211031b11001911001a11001b1100181100130316110319030b1343071400190211031b11001811001911001a11001b1100140307110319030c1343071400180211031b11001b11001811001911001a110015030c110319030d13430714001b0211031b11001a11001b1100181100191100160311110319030e13430714001a0211031b11001911001a11001b1100181100170316110319030f1343071400190211031c11001811001911001a11001b110009030511031903101343071400180211031c11001b11001811001911001a11000e0309110319031113430714001b0211031c11001a11001b110018110019110013030e110319031213430714001a0211031c11001911001a11001b110018110008031411031903131343071400190211031c11001811001911001a11001b11000d030511031903141343071400180211031c11001b11001811001911001a1100120309110319031513430714001b0211031c11001a11001b110018110019110017030e110319031613430714001a0211031c11001911001a11001b11001811000c031411031903171343071400190211031c11001811001911001a11001b110011030511031903181343071400180211031c11001b11001811001911001a1100160309110319031913430714001b0211031c11001a11001b11001811001911000b030e110319031a13430714001a0211031c11001911001a11001b1100181100100314110319031b1343071400190211031c11001811001911001a11001b1100150305110319031c1343071400180211031c11001b11001811001911001a11000a0309110319031d13430714001b0211031c11001a11001b11001811001911000f030e110319031e13430714001a0211031c11001911001a11001b1100181100140314110319031f1343071400190211031d11001811001911001a11001b11000d030411031903201343071400180211031d11001b11001811001911001a110010030b110319032113430714001b0211031d11001a11001b1100181100191100130310110319032213430714001a0211031d11001911001a11001b110018110016031711031903231343071400190211031d11001811001911001a11001b110009030411031903241343071400180211031d11001b11001811001911001a11000c030b110319032513430714001b0211031d11001a11001b11001811001911000f0310110319032613430714001a0211031d11001911001a11001b110018110012031711031903271343071400190211031d11001811001911001a11001b110015030411031903281343071400180211031d11001b11001811001911001a110008030b110319032913430714001b0211031d11001a11001b11001811001911000b0310110319032a13430714001a0211031d11001911001a11001b11001811000e0317110319032b1343071400190211031d11001811001911001a11001b1100110304110319032c1343071400180211031d11001b11001811001911001a110014030b110319032d13430714001b0211031d11001a11001b1100181100191100170310110319032e13430714001a0211031d11001911001a11001b11001811000a0317110319032f1343071400190211031e11001811001911001a11001b110008030611031903301343071400180211031e11001b11001811001911001a11000f030a110319033113430714001b0211031e11001a11001b110018110019110016030f110319033213430714001a0211031e11001911001a11001b11001811000d031511031903331343071400190211031e11001811001911001a11001b110014030611031903341343071400180211031e11001b11001811001911001a11000b030a110319033513430714001b0211031e11001a11001b110018110019110012030f110319033613430714001a0211031e11001911001a11001b110018110009031511031903371343071400190211031e11001811001911001a11001b110010030611031903381343071400180211031e11001b11001811001911001a110017030a110319033913430714001b0211031e11001a11001b11001811001911000e030f110319033a13430714001a0211031e11001911001a11001b1100181100150315110319033b1343071400190211031e11001811001911001a11001b11000c0306110319033c1343071400180211031e11001b11001811001911001a110013030a110319033d13430714001b0211031e11001a11001b11001811001911000a030f110319033e13430714001a0211031e11001911001a11001b1100181100110315110319033f1343071400191100070300131100181803002f1100070300161100070301131100191803002f11000703011611000703021311001a1803002f11000703021611000703031311001b1803002f11000703031608420b12004014000111000112002c1400020b12004103081a14000311000112002d03081a14000411000211000403052d13040080031811000403201c192b2f11000211000403052d35491104144a1200601100030600361b430114000511000314000611000503082b11000503182d2f0500ff00ff2e11000503182b11000503082d2f06005f2e2f11000211000403401803092d03042b030f181611000603082b11000603182d2f0500ff00ff2e11000603182b11000603082d2f06005f2e2f11000211000403401803092d03042b030e181611000212001103011803041a11000115002d0b4a1200444300490b12005e14000711000712002c14000803001400091100090304274700441100081100091314000a11000a03082b11000a03182d2f0500ff00ff2e11000a03182b11000a03082d2f06005f2e2f11000811000916110009030118170009354945ffb311000742021103020211030811020312000643010700280b43034a1200100b43011400010b12005e4a120028430011000115005e11000142050000213f3b01140003021101041100031100014302490211010511000343011400020211010e1100030d0700640e002505000021873c020e00090c0001430249110003420211020c0b1101034302491101024a1200100b43011400021103014a12002711020f44000d04008003201b0e006111021f0e006203010e0063110001430311000215004a110002420b12004a1400041100041200624a12001543001400051103104a120015430014000611000612002c1400071100041200611400081100041200631400091100071200111100082747007b11000347000d1100054a12004c1100034301491100054a12004c11000143014a12004d11000243011400031100054a12003f430049030114000a11000a110009274700271100054a12004d11000343011400031100054a12003f43004911000a03011817000a354945ffcf1100064a12003011000343014945ff7811000803041a11000615002d1100064205000022f93b03140003021101041100031100014302490211010511000343011400020211010e1100030d07003f0e002505000023483c000e00090d0700670e002505000023703c010e00090d07004d0e002505000023833c010e00090c00030d0700680e002505000023a23c020e00090d07006a0e002505000023b43c020e00090d07004f0e002505000023c63c010e00090c0003430349110003420211020c0b1101034302491101024a1200100b43011400041103014a12002711020f4400110003430211000415004a1100011100041500651100021100041500661100044a12003f430049110004420211030202110308110203120006430107003f0b43034a1200100b4301490b4a12004b43004908420b4a1200421100014301490b4a12004443004211000147000b0b4a1200421100014301490b4a12004e4300140002110002420b4a1200150b1200691100011100024303420b4a1200150b12006b11000111000243034205000023e63c011400020d05000023f93c030e006c05000024153c030e000a421100013a0700432547000411052b42110529420211020211000243014a12006c1102011100011100021100034304420211020211000243014a12000a11020111000111000211000343044205000024883b02140003021101041100031100014302490211010511000343011400020211010e110003020d0700680e002505000024b63c020e00090d07006a0e002505000024c73c020e00090c0002430349110003420211020c0b1101034302491101024a1200100b430114000311000111000315006e11000211000315006f110003420b1200704a1200151100011100024302420b1200714a1200151100011100024302421100011400040b12006f14000611000647000e110006140005080b15006f4500070b12007214000503001400071100071100032747002d11000411000211000718131100051100071331110004110002110007183549110007030118170007354945ffc90842050000256b3b00140003021101041100031100014302490211010511000343011400020211010e1100034301420211020c0b1101034302491101024a1200120b11000043024205000025c93b00140003021101041100031100014302490211010511000343011400020211010e1100030d0700730e002505000025e23c020e00090c0001430249110003420211020c0b1101034302491101024a1200120b1100004302420b12006e1400031100031200451400041103234a1200100b1100011100021100044304491100034a1200741100011100024302491100014a1200341100021100021100041843020b150072084205000026743b00140003021101041100031100014302490211010511000343011400020211010e1100030d0700730e0025050000268d3c020e00090c0001430249110003420211020c0b1101034302491101024a1200120b1100004302420b12006e1400031100031200451400041100014a1200341100021100021100041843021400051100034a1200751100011100024302491103234a1200100b1100011100021100044304491100050b150072084211000203041a14000311000311000112002d1100031c1914000411000403182b11000403102b2f11000403082b2f1100042f1400050c000014000603001400071100071100042747001b1100064a12001f110005430149110007030418170007354945ffdb1102104a12001511000611000443021400081100014a120030110008430149084211000114000211000212002c11000212002d03011903022d130400ff2e14000311000212002d1100031911000207002d3549084205000028013b03140003021101041100031100014302490211010511000343011400020211010e1100030d07003f0e002505000028483c000e00090d0700480e002505000028d23c020e00090d07004e0e002505000028e53c000e00090c0003430249110003420211020c0b1101034302491101024a1200100b1100011100021103014a1200270d1102240e00781102250e00791100034302430414000404008003201b110004150045110004420211030202110308110203120006430107003f0b43034a1200100b4301490b12004a14000211000212007a1400031100021200781400040b1200650b1200051200692547000c11000412006814000145000f11000412006a14000103010b15003e1100014a1200101100040b11000333000611000312002c43030b15007b1100010b12007b15007c08420b12007b4a12007311000111000243024908420b12004a1200791400020b1200650b120005120069254700241100024a1200760b1200400b1200454302490b4a12004407007d3232430114000145001c0b4a12004407007d323243011400011100024a1200771100014301491100014205000029873b01140003021101041100031100014302490211010511000343011400020211010e1100030d07002e0e002505000029b03c010e00090c0001430249110003420211020c0b1101034302491101024a1200100b43011400021100024a120026110001430149110002421100013400040b12007e4a12002f0b43014211000112007f14000311000112008014000411000447002e1102104a1200150553616c740565645f5f0c000243014a12003011000443014a12003011000343011400024500061100031400021100024a12002e1102184301421102184a12000c110001430114000311000312002c1400041100040300130553616c742533000c1100040301130565645f5f254700381102104a1200151100044a12003403020304430243011400021100044a1200490300030443024911000312002d03101911000307002d35491102274a1200150d1100030e007f1100020e00804301420500002b083b00140003021101041100031100014302490211010511000343011400020211010e110003020d07006c0e00250500002b213c040e00090d07000a0e00250500002bad3c040e00090d0700830e00250500002c003c020e00090c0003430349110003420211020c0b1101034302491101024a1200120b1100004302421104014a12002711030f44000b12004a11000443031400051100014a12006811000311000543021400061100064a12004d110002430114000711000612004a1400081103274a1200150d1100070e007f1100030e002511000812007a0e007a1100010e00811100081200780e00781100081200790e00791100061200450e00451100051200820e007e4301421100021400051104014a12002711030f44000b12004a11000443031400060b4a12008311000511000612008243021400051100014a12006a11000311000643024a12004d11000512007f4301140007110007421100013a0700432547000e1100024a12000c1100010b43024211000142110004140005110005324700111102104a120035034003081b43011400051102204a1200150d110002110003180e006143014a12006411000111000543021400061102104a12001511000612002c4a120034110002430111000303041a430214000711000203041a11000615002d1102274a1200150d1100060e00251100070e007a1100050e00804301420500002cff3b00140003021101041100031100014302490211010511000343011400020211010e110003020d07006c0e00250500002d183c040e00090d07000a0e00250500002d8a3c040e00090c0002430349110003420211020c0b1101034302491101024a1200120b1100004302421104014a12002711030f44000b12004a11000443031400051100051200854a12008411000311000112006111000112006d430314000611000612007a11000515007a11032912006c4a1200100b11000111000211000612002511000543051400071100074a120026110006430149110007421100021400051104014a12002711030f44000b12004a11000443031400060b4a12008311000511000612008243021400051100061200854a12008411000311000112006111000112006d110005120080430414000711000712007a11000615007a11032912000a4a1200100b1100011100051100071200251100064305140008110008420500002e863b00140003021101041100031100014302490211010511000343011400020211010e1100030d07004b0e00250500002e9f3c000e00090d0700740e002505000030f03c020e00090d0700750e002505000031133c020e00090d07008a0e002505000031983c080e00090c0004430249110003420211020c0b1101034302491101024a1200120b1100004302420b1200863300090b1200870b1200662547000208420b1200660b1500870b12008714000211000212002c14000311000212002d03041b1400041100040306180b1500860b12008614000511000503011803041a1400060c00000b1500880b12008814000703001400081100081100062747011a1100081100042747001111000311000813110007110008164500f1110007110008030119131400011100081100041c3247006d11000103082b11000103182d2f14000111032c11000103182d1303182b11032c11000103102d0400ff2e1303102b2f11032c11000103082d0400ff2e1303082b2f11032c1100010400ff2e132f1400011100011103401100081100041b03002f1303182b31170001354945005611000403062933000a1100081100041c03042547004011032c11000103182d1303182b11032c11000103102d0400ff2e1303102b2f11032c11000103082d0400ff2e1303082b2f11032c1100010400ff2e132f14000111000711000811000419131100013111000711000816110008030118170008354945fedc0c00000b1500890b120089140009030014000a11000a110006274700a511000611000a1914000b11000a03041c47000d11000711000b1314000145000d11000711000b0304191314000111000a03042734000611000b03042847000d11000111000911000a1645004b11033211032c11000103182d131311033311032c11000103102d0400ff2e13133111033411032c11000103082d0400ff2e13133111033511032c1100010400ff2e13133111000911000a1611000a03011817000a354945ff5108420b4a12008a1100011100020b12008811032e11032f11033011033111032c4308490842110001140003110003110002030118131400041100031100020303181311000311000203011816110004110003110002030318160b4a12008a1100031100020b12008911033211033311033411033511032d4308491100031100020301181314000411000311000203031813110003110002030118161100041100031100020303181608421100011400090b12008614000a110009110002131100030300133114000b110009110002030118131100030301133114000c110009110002030218131100030302133114000d110009110002030318131100030303133114000e030414000f030114001011001011000a2747014e11000411000b03182d1311000511000c03102d0400ff2e133111000611000d03082d0400ff2e133111000711000e0400ff2e133111000311000f133114001111000f03011817000f354911000411000c03182d1311000511000d03102d0400ff2e133111000611000e03082d0400ff2e133111000711000b0400ff2e133111000311000f133114001211000f03011817000f354911000411000d03182d1311000511000e03102d0400ff2e133111000611000b03082d0400ff2e133111000711000c0400ff2e133111000311000f133114001311000f03011817000f354911000411000e03182d1311000511000b03102d0400ff2e133111000611000c03082d0400ff2e133111000711000d0400ff2e133111000311000f133114001411000f03011817000f354911001114000b11001214000c11001314000d11001414000e110010030118170010354945fea811000811000b03182d1303182b11000811000c03102d0400ff2e1303102b2f11000811000d03082d0400ff2e1303082b2f11000811000e0400ff2e132f11000311000f133114001511000f03011817000f354911000811000c03182d1303182b11000811000d03102d0400ff2e1303102b2f11000811000e03082d0400ff2e1303082b2f11000811000b0400ff2e132f11000311000f133114001611000f03011817000f354911000811000d03182d1303182b11000811000e03102d0400ff2e1303102b2f11000811000b03082d0400ff2e1303082b2f11000811000c0400ff2e132f11000311000f133114001711000f03011817000f354911000811000e03182d1303182b11000811000b03102d0400ff2e1303102b2f11000811000c03082d0400ff2e1303082b2f11000811000d0400ff2e132f11000311000f133114001811000f03011817000f35491100151100091100021611001611000911000203011816110017110009110002030218161100181100091100020303181608421101134a12000c11000243011400041101134a12000c11000343011400051101184a12000c11000143011400061101184a12002f11000643011400071101424a12000a1100071100040d1100050e007a43031400081100084a12002e1101134301421100013a070043254700651100014a12008b07008c43011400021100021200110302254700481100020300131400031100034a12008d031043011400041100041100034a12008d030003104302181400051100020301131400060d1100040e007a1100050e00251100060e008e420d420d4211020a110001120011440114000211020b110002440114000303001400041100041100011200112747001b1100014a12003c110004430111000311000416170004214945ffd81100024211020a4a12008f110001430147000911000112002914000111021612003b4a1200120211020b110001440143024211020b1200061200344700121100014a120034110002110003430245001d11020b1102091200061200344a120010110001110002110003430344014205000036793b0214000105000036893b0211000112000615000a110001421100010b1500901100020b15009108420b1200904a12000a0d0700920e00930b1200910e007a11000211000143034211000112002b14000211000233001711021c11000112002944014a12009411000203011943011400031100034700130211014711000103001100021100031943034211000142050000374c3b0014000105000037f13b0111000112000615009d05000038363b0011000112000615009b0500003a883b011100011200061500a10500003d6b3b011100011200061500a20500003d933b0311000112000615000a1100014203000301030203040308031003200340040080031b03360c000b0b15009511031104010044011103110401004401110311040100440111031104010044010c00040b15009611031104010044011103110401004401110311040100440111031104010044010c00040b15009711031104010044010b15009811031104010044010b150099110311030044010b15002503000b15009a03000b1500610b4a12009b430049084211031c110001440114000211031103044401140003030014000411000403042747001e1100024a12009c11000403041a430111000311000416170004214945ffd9110003420b1200981400010b1200991400020b1200961400031100030300131400041100030301131400051100030302131400061100030303131400070b12009714000811000803001314000911000803011314000a11000803021314000b11000803031314000c110311040100440114000d030014000e030014000f030014001003001700103549110010040100274700331100100400802747001011001003012b11000d1100101645001111001003012b04011b3111000d11001016170010214945ffc3030017001035491100100401002747017d11000f11000f03012b3111000f03022b3111000f03032b3111000f03042b3114001111001103082d1100110400ff2e3103633114001111001111000111000e1611000e1100021100111611000d11000e1314001211000d1100121314001311000d1100131314001411000d110011130401011a11001105010101001a3114001511001503182b11001503082d2f11000411000e1611001503102b11001503102d2f11000511000e1611001503082b11001503182d2f11000611000e1611001511000711000e1611001405010101011a11001305000100011a311100120401011a3111000e05010101001a3114001511001503182b11001503082d2f1100091100111611001503102b11001503102d2f11000a1100111611001503082b11001503182d2f11000b1100111611001511000c1100111611000e3247000c030117000f3514000e45002e11001211000d11000d11000d110014110012311313133114000e11000f11000d11000d11000f13133117000f3549170010214945fe7908420b4a12009d11000143011400020014000303001400041100041100021200112733000311000347001b110002110004130b1200251100041325140003170004214945ffd211000347000208421100020b1500251100021200110b0700613514000511000503042633000611000503062633000611000503082647000d11031907009e1100051844014011000503061803011803041a0b07009a3514000611031111000644010b07009f3514000911031111000644010b0700a03514000a0b12009814000b0b12009514000c0b12009714000d11000d03001314000e11000d03011314000f11000d03021314001011000d03031314001103001700073549110007110006274701191100071100052747001411000211000713110009110007351400124500f31100121400131100071100051c03002547006d11001303082b11001303182d2f14001311000b11001303182d1303182b11000b11001303102d0400ff2e1303102b2f11000b11001303082d0400ff2e1303082b2f11000b1100130400ff2e132f14001311001311000c1100071100051b03002f1303182b31170013354945005611000503062933000a1100071100051c03042547004011000b11001303182d1303182b11000b11001303102d0400ff2e1303102b2f11000b11001303082d0400ff2e1303082b2f11000b1100130400ff2e132f14001311000911000711000519131100133103002d1700123511000911000716170007214945fedd03001700083549110008110006274700b01100061100081914000711000803032e47000d1100091100071314001345000d1100091100070304191314001311000803042734000611000703042847000d11001311000a1100081645004b11000e11000b11001303182d131311000f11000b11001303102d0400ff2e13133111001011000b11001303082d0400ff2e13133111001111000b1100130400ff2e13133111000a1100081611000a1100081303002d11000a11000816170008214945ff46084211000103182b110001050000ff002e03082b2f1100010500ff00002e03082c2f11000103182d2f420b1200610306181400040b1200a01400050b1200991400060b12009714000711000703001314000811000703011314000911000703021314000a11000703031314000b0b4a12009d110003430114000c11000c03001314000d11000c03011314000e11000c03021314000f11000c030313140010110310110001440114001111031011001112001144011400120b1200a2140021110002110011120011274703670211002111001111000213430114001b0211002111001111000203011813430114001c0211002111001111000203021813430114001d0211002111001111000203031813430114001e11001b1100050300133114001711001e1100050301133114001811001d1100050302133114001911001c1100050303133114001a030414001f030117002035491100201100042747012e11000811001703182d1311000911001803102c0400ff2e133111000a11001903082c0400ff2e133111000b11001a0400ff2e133111000511001f133114001311000811001803182d1311000911001903102c0400ff2e133111000a11001a03082c0400ff2e133111000b1100170400ff2e133111000511001f030118133114001411000811001903182d1311000911001a03102c0400ff2e133111000a11001703082c0400ff2e133111000b1100180400ff2e133111000511001f030218133114001511000811001a03182d1311000911001703102c0400ff2e133111000a11001803082c0400ff2e133111000b1100190400ff2e133111000511001f030318133114001611001314001711001414001811001514001911001614001a11001f03041814001f170020214945fec811000611001703182d1303182b11000611001803102c0400ff2e1303102b3111000611001903082c0400ff2e1303082b3111000611001a0400ff2e133111000511001f133114001311000611001803182d1303182b11000611001903102c0400ff2e1303102b3111000611001a03082c0400ff2e1303082b311100061100170400ff2e133111000511001f030118133114001411000611001903182d1303182b11000611001a03102c0400ff2e1303102b3111000611001703082c0400ff2e1303082b311100061100180400ff2e133111000511001f030218133114001511000611001a03182d1303182b11000611001703102c0400ff2e1303102b3111000611001803082c0400ff2e1303082b311100061100190400ff2e133111000511001f03031813311400160211002111001311000d314301110012110002160211002111001611000e314301110012110002030118160211002111001511000f31430111001211000203021816021100211100141100103143011100121100020303181611001b14000d11001c14000e11001d14000f11001e14001011000203041814000245fc8c1100121200294205000041c03b0214000105000041d03b001100011200061500a1110001421100010b1500901100020b15002508420b1200904a1200a30700a40b1200250d0700920e00930107006c07000a0c000243054211020b1100011200111100021200111844011400031100034a1200a51100014301491100034a1200a51100021100011200114302491100034205000042ea3b03140001050000439e3b001100011200061500b205000043a53b001100011200061500b305000043ad3b0011000112000615007d05000043ed3b0011000112000615003f050000440a3b011100011200061500b405000044473b0411000112000615000a05000044a83b031100011200061500b505000045843b031100011200061500b6050000463b3b041100011200061500be05000046593b011100011200061500ba05000046a53b011100011200061500b811000142110003030038254700040d4500031100031400041100041200a61400051100050300382547000400450003110005140006000b1500a7020b150090020b1500a8020b150025020b1500a9020b1500aa020b1500ab020b1500ac1100010b1500ad1100020b1500ae1100060b1500a611000647002d3e0004140008413d002311031d1200af1400071100074700131100071200903400061100071200b00b150090410b1200900225470008000b1200ae1500b10842020b1500ad08420b1200ae1200b1420b1200ac1400011100013247000a0b4a12003f430049084211030b11000144011400020b4a12003f4300490b1200a647000a0211024911000243014211000242020b1500ac020b1500ab020b1500aa0b1200a8470005020b1500a808420211024611000143011400020211024411000243011400030211024311000312008e11000312002511000312007a4303140004021102451100044301420b1200ae1200b14700360b4a1200b511030b11000144011100021100034303490b4a12007d430014000511000547000d0211000411000512002943014945001f0b4a1200b611030b110001440111000211000343034a1200b711000443014908420b4a1200b411000243011400020b1400041100041200ab1400051100041200ac1400061100041200aa1400070b4a1200b80700b94301491100074700140211024d1100071100014302140001020b1500aa0b4a1200ba11000143011400081100081200113247000202421100054700061100051400030b1200a81400091100093247000d11024a44000b0700a8351400091100094a1200a111000243014911000614000a1100094a12000a110008120029030011000343030b1500ac0211024711000803101d43021200290b1500ab11000a32470002024211000a420b1400040b4a1200b411000243011400020b1200901400050b120025110002263400050b1200a9324700161100020b15002511024b11000511000244020b1500a90b1200a94a1200a143004a1200b705000045eb3b0143014a0700bd1305000046253b014301421101053247001211041e4a1200bb1104190700bc440143014211034811010511010344021400021100024a12000a1101011200291100014302421101044a1200be110001110101110102110103430442000b1200ae1500b1000b1500a70b4a1200b511000211000311000443034211000114000211000112001111000112001111024c1c191400031100031100011200112647002102110247110001030011000343031400020211024711000111000343020b1500aa110002420b1200a7324700020842010b1500a7084205000000003b0114000105000000783b00140002050000010c3b0214000305000001433b0214000405000001b73b01140005050000021a3b02140006050000025f3b0114000705000002763b0114000805000002b23b0314000905000003303b0014000a050000039b3b0214000b05000003c83b0214000c05000003de3b0214000d05000004423b0314000e05000024d83b0314002305000034d33b0314004305000035353b0114004405000035a73b0114004505000035f13b01140046050000361f3b0314004705000036a83b0114004905000041f33b0214004d070000491101014a1200071101020700080d000e000943034911004311010215000a03003811010207000b1611004411010215000c0205000004843b00430014000f02050000054f3b0111000f43011400100d0500000a023c010e002f0500000a923c010e000c1400110d0500000b063c010e002f0500000b7c3c010e000c1400120d0500000be73c010e002f0500000c163c010e000c140013020500000c2f3b0111000f4301140014020500000e353b011100144301140015020500000f9d3b0111000f4301140016050000119c3c031400170d05000012583c010e002f05000013a63c010e000c0700590e00541400180c0000140019030014001a11001a0340274700341101144a12005a1101144a12005b11001a030118430143010600361a03002f11001911001a1611001a03011817001a354945ffc305000014483c0714001b050000147e3c0714001c05000014b43c0714001d05000014e53c0714001e0205000015173b01110015430114001f0205000020fa3b0111000f430114002002050000225c3b0111001443011400210301110021150069030211002115006b04008003201b11002115006104008003201b11002115006d0205000024313b0111000f430114002202050000253e3b0111002243011400240205000025843b01110024430111002415007002050000262f3b0111002443011100241500710d05000026e03c020e007605000027663c010e007714002502050000279a3b0111002143011400260205000029423b0111000f43011400270d05000029c23c010e002f0500002a1b3c010e000c140028020500002aa03b0111000f43011400291101014a12002711000f44000d1100280e0082430211002915004a0d0500002c1d3c040e008414002a020500002ca83b01110029430114002b1101014a12002711002912004a0d11002a0e0085430211002b15004a0c000014002c0c000014002d0c000014002e0c000014002f0c00001400300c00001400310c00001400320c00001400330c00001400340c00001400350c00001400360300140037110037040100274700391100370400802747001011003703012b1100361100371645001111003703012b04011b3111003611003716110037030118170037354945ffbd03001400380300140039030014003a11003a0401002747018511003911003903012b3111003903022b3111003903032b3111003903042b3114003b11003b03082d11003b0400ff2e3103633114003b11003b11002c1100381611003811002d11003b161100361100381314003c11003611003c1314003d11003611003d1314003e11003611003b130401011a11003b05010101001a3114003f11003f03182b11003f03082d2f11002e1100381611003f03102b11003f03102d2f11002f1100381611003f03082b11003f03182d2f1100301100381611003f1100311100381611003e05010101011a11003d05000100011a3111003c0401011a3111003805010101001a3114003f11003f03182b11003f03082d2f11003211003b1611003f03102b11003f03102d2f11003311003b1611003f03082b11003f03182d2f11003411003b1611003f11003511003b161100383247000e030114003911003914003845002e11003c11003611003611003611003e11003c3113131331140038110039110036110036110039131331170039354911003a03011817003a354945fe7103000301030203040308031003200340040080031b03360c000b140040020500002e0e3b01110026430114004104010003201b1100411500611100264a12004f110041430114004202050000365b3b0043001400480205000036ee3b00430014004a0205000041a23b00430014004b031014004c02050000422c3b00430014004e11004e11010207000b16084200bf0a060016530007011a10071733111211161f5c1b161f03160100535e53070a03161c150815061d10071a1c1d06000a1e111c1f081a07160112071c010b101c1d0007010610071c010903011c071c070a03160e1716151a1d1623011c031601070a0a2c2c16003e1c17061f160505121f061607171610010a03070717161512061f0705031201001609061d1716151a1d161703141607181416073c041d23011c031601070a37160010011a03071c010410121f1f061f161d14071b051203031f0a0e1b12003c041d23011c031601070a32200603160153160b03011600001a1c1d531e06000753161a071b1601531116531d061f1f531c0153125315061d10071a1c1d061001161207160804011a0712111f160c101c1d151a14060112111f1609101c1d000701061007061c1119161007383716011a05161753101c1d0007010610071c0100531e120a531c1d1f0a5301160706011d531c1119161007531c0153061d1716151a1d161739071b1a00531b12001d5407531116161d531a1d1a071a121f1a001617535e5300060316015b5a531b12001d5407531116161d5310121f1f16170e00160723011c071c070a03163c150e14160723011c071c070a03163c15092c2c03011c071c2c2c040306001b04111a1d1704001b121e0705121f06163c152130121d1d1c075310121f1f531253101f12000053120053125315061d10071a1c1d0a161d061e160112111f160318160a051e1a0b3a1d061200001a141d05101f1c1d16061106151516010a110a07163c15150016070a110a07163f161d14071b05041c01170008001a14310a07160008071c2007011a1d14090007011a1d141a150a06101c1d10120705101f121e030a47414a474a4544414a460410161a1f05001f1a10160601121d171c1e0a47414a474a4544414a4503435d4604191c1a1d00060006110007010c15011c1e301b1201301c17160a101b1201301c17163207143e121f151c011e1617532627355e4b53171207120e2c1e1a1d310615151601201a0916050116001607052c171207120b2c1d37120712310a071600072c120303161d17060007011a1d14082c03011c1016000009111f1c1018201a0916031e120b031e1a1d0f2c171c23011c10160000311f1c10180600031f1a101603101514082c171c21160016070606031712071608151a1d121f1a09160b2c171c351a1d121f1a09160d2c1001161207163b161f031601112c1001161207163b1e12103b161f031601072c1b12001b1601052c1c38160a052c1a38160a042c1e120304435d444606101b120132070b2c011605160100163e1203071a1d17160b3c1541323130373635343b3a39383f3e3d3c23222120272625242b2a29121110171615141b1a19181f1e1d1c03020100070605040b0a0943424140474645444b4a585c4e0312110003001a1d0a474341404140404742440a41464541404b40424341052c1b12001b0a4741444b41464640454305151f1c1c010718160a201a0916061b12001b16010a1a07160112071a1c1d0007101c1e030607160a2c0b151c011e3e1c1716042c18160a0703011c101600000f100116120716361d10010a03071c010f2c363d302c2b353c213e2c3e3c37360f100116120716371610010a03071c010f2c3736302c2b353c213e2c3e3c373607161d10010a0307061a05201a0916072c101a031b1601032c1a0509361d10010a03071c0109371610010a03071c010a2c03011605311f1c10180c03011c10160000311f1c10180c161d10010a0307311f1c10180c171610010a0307311f1c10180303121705061d031217041e1c171607031217171a1d14021a05052c1e1c1716092c2c10011612071c0105151f06001b09151c011e12070716010a101a031b160107160b070400121f0709121f141c011a071b1e06151c011e1207062c031201001607160b161006071603181715082c1d211c061d17000e2c18160a23011a1c0121160016070c2c18160a20101b1617061f160f2c1a1d0538160a20101b1617061f160d2c171c30010a0307311f1c10180500031f1a070149090006110007011a1d1407161d1037120712061a00251a160406000611071f16051216003a25073236205e303130041d121e1608141607261a1d074b0401101c1d060006113e1a0b091a1d052006113e1a0b0400311c0b071a1d0520311c0b061800211c0400091a1d1a072712111f1609141607261a1d07404118061a1d074b320101120a271c261a1d074041320101120a2c153a1d05121f1a17531216005318160a53001a09164e0b18160a20101b1617061f160e1a1d0538160a20101b1617061f1609160b03121d1738160a161d1607041c0118271c3b1c00073c0117160120041203091a1e031c010738160a03011204030016071201161e1c05162338302044231217171a1d140a1f1c14361d12111f161711001c150704120116371610010a030716010a1512000732160038160a0d01161e121a1d171601371207120910060101161d073a250d10060101161d07211600061f07081c1100160105160106101c1d151a140610010a03071c0c041611181a07200611071f1611161d12111f16201c1507041201163236200717160007011c0a061a00200a1d101103011a0512071638160a371610010a03070f001c150704120116371610010a03071004161130010a03071c371610010a030704071b161d071f1c143c1d10160e39205332362053171610010a03070d14160725121f1a17301b061d18060116191610071a0416115310010a03071c531d1c07531a1d1a071a121f1a09161705101207101b101c1d24161130010a03071c3601011c01",{0:Symbol,1:Object,get 2(){return t},3:Reflect,4:TypeError,5:ReferenceError,6:Function,7:Proxy,8:Boolean,9:Array,10:ArrayBuffer,11:Uint8Array,12:Int8Array,13:Uint8ClampedArray,14:Int16Array,15:Uint16Array,16:Int32Array,17:Uint32Array,18:Float32Array,19:Float64Array,20:Math,21:parseInt,22:String,23:decodeURIComponent,get 24(){return escape},25:Error,get 26(){return unescape},27:encodeURIComponent,28:DataView,get 29(){return self},30:Promise},this)},"./node_modules/eventemitter3/index.js":function(e,t,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function a(){}function o(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function s(e,t,i,r,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new o(i,r||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function d(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),d.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)r.call(e,t)&&i.push(n?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},d.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},d.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},d.prototype.emit=function(e,t,i,r,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var l,d,c=this._events[s],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,a),!0;case 6:return c.fn.call(c.context,t,i,r,a,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h,f=c.length;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c[d].fn.apply(c[d].context,l)}}return!0},d.prototype.on=function(e,t,i){return s(this,e,t,i,!1)},d.prototype.once=function(e,t,i){return s(this,e,t,i,!0)},d.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||l(this,a);else{for(var s=0,d=[],c=o.length;s<c;s++)(o[s].fn!==t||r&&!o[s].once||i&&o[s].context!==i)&&d.push(o[s]);d.length?this._events[a]=1===d.length?d[0]:d:l(this,a)}return this},d.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,i){var r,n,a,o,s;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var d={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(d.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,u=c.substring(0,c.lastIndexOf("/")+1)+a.path;d.path=s.normalizePath(u)}else d.path=o.path,a.params||(d.params=o.params,a.query||(d.query=o.query));return null===d.path&&(d.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(d)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},"./node_modules/webworkify-webpack/index.js":function(e,t,i){function r(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var r=i(i.s=ENTRY_MODULE);return r.default||r}function n(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,r){var a={};a[r]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var l,d=s[1],c=new RegExp("(\\\\n|\\W)"+n(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");l=c.exec(o);)"dll-reference"!==l[3]&&a[r].push(l[3]);for(c=new RegExp("\\("+n(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");l=c.exec(o);)e[l[2]]||(a[r].push(l[1]),e[l[2]]=i(l[1]).m),a[l[2]]=a[l[2]]||[],a[l[2]].push(l[4]);for(var u,h=Object.keys(a),f=0;f<h.length;f++)for(var m=0;m<a[h[f]].length;m++)u=a[h[f]][m],isNaN(1*u)||(a[h[f]][m]=1*a[h[f]][m]);return a}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var n={main:i.m},s=t.all?{main:Object.keys(n.main)}:function(e,t){for(var i={main:[t]},r={main:[]},n={main:{}};o(i);)for(var s=Object.keys(i),l=0;l<s.length;l++){var d=s[l],c=i[d].pop();if(n[d]=n[d]||{},!n[d][c]&&e[d][c]){n[d][c]=!0,r[d]=r[d]||[],r[d].push(c);for(var u=a(e,e[d][c],d),h=Object.keys(u),f=0;f<h.length;f++)i[h[f]]=i[h[f]]||[],i[h[f]]=i[h[f]].concat(u[h[f]])}}return r}(n,e),l="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),u=new window.Worker(c);return u.objectURL=c,u}},"./repo/src/config.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"hlsDefaultConfig",(function(){return y})),i.d(t,"mergeConfig",(function(){return g})),i.d(t,"enableStreamingMode",(function(){return v}));var r=i("./repo/src/controller/abr-controller.ts"),n=i("./repo/src/empty.js"),a=i.n(n),o=i("./repo/src/controller/buffer-controller.ts"),s=i("./repo/src/controller/cap-level-controller.ts"),l=i("./repo/src/controller/fps-controller.ts"),d=i("./repo/src/utils/xhr-loader.ts"),c=i("./repo/src/utils/fetch-loader.ts"),u=i("./repo/src/utils/mediakeys-helper.ts"),h=i("./repo/src/utils/logger.ts");function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){b(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var y=p(p({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:d.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:r.default,bufferController:o.default,capLevelController:s.default,fpsController:l.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:u.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},{cueHandler:a.a,enableCEA708Captions:!1,enableWebVTT:!1,enableIMSC1:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:void 0,subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0,cmcdController:void 0});function g(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return f({},e,t)}function v(e){var t=e.loader;t!==c.default&&t!==d.default?(h.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):Object(c.fetchSupported)()&&(e.loader=c.default,e.progressive=!0,e.enableSoftwareAES=!0,h.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./repo/src/controller/abr-controller.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/utils/ewma-bandwidth-estimator.ts"),a=i("./repo/src/events.ts"),o=i("./repo/src/utils/buffer-helper.ts"),s=i("./repo/src/errors.ts"),l=i("./repo/src/types/loader.ts"),d=i("./repo/src/utils/logger.ts");function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(e){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;var t=e.config;this.bwEstimator=new n.default(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var t,i,u=e.prototype;return u.registerListeners=function(){var e=this.hls;e.on(a.Events.FRAG_LOADING,this.onFragLoading,this),e.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(a.Events.ERROR,this.onError,this)},u.unregisterListeners=function(){var e=this.hls;e.off(a.Events.FRAG_LOADING,this.onFragLoading,this),e.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(a.Events.ERROR,this.onError,this)},u.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},u.onFragLoading=function(e,t){var i,r=t.frag;r.type===l.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=r,this.partCurrent=null!=(i=t.part)?i:null,this.timer=self.setInterval(this.onCheck,100)))},u.onLevelLoaded=function(e,t){var i=this.hls.config;t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},u._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,i=this.hls,n=i.autoLevelEnabled,s=i.config,l=i.media;if(e&&l){var c=t?t.stats:e.stats,u=t?t.duration:e.duration;if(c.aborted)return d.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(n&&!l.paused&&l.playbackRate&&l.readyState){var h=performance.now()-c.loading.start,f=Math.abs(l.playbackRate);if(!(h<=500*u/f)){var m=i.levels,p=i.minAutoLevel,b=m[e.level],y=c.total||Math.max(c.loaded,Math.round(u*b.maxBitrate/8)),g=Math.max(1,c.bwEstimate?c.bwEstimate/8:1e3*c.loaded/h),v=(y-c.loaded)/g,Z=l.currentTime,T=(o.BufferHelper.bufferInfo(l,Z,s.maxBufferHole).end-Z)/f;if(!(T>=2*u/f||v<=T)){var L,S=Number.POSITIVE_INFINITY;for(L=e.level-1;L>p&&!((S=u*m[L].maxBitrate/(6.4*g))<T);L--);if(!(S>=v)){var x=this.bwEstimator.getEstimate();d.logger.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+L+"\n      Current BW estimate: "+(Object(r.isFiniteNumber)(x)?(x/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+v.toFixed(3)+" s\n      Estimated load time for the next fragment: "+S.toFixed(3)+" s\n      Time to underbuffer: "+T.toFixed(3)+" s"),i.nextLoadLevel=L,this.bwEstimator.sample(h,c.loaded),this.clearTimer(),e.loader&&(this.fragCurrent=this.partCurrent=null,e.loader.abort()),i.trigger(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:c})}}}}}},u.onFragLoaded=function(e,t){var i=t.frag,n=t.part;if(i.type===l.PlaylistLevelType.MAIN&&Object(r.isFiniteNumber)(i.sn)){var o=n?n.stats:i.stats,s=n?n.duration:i.duration;if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var d=this.hls.levels[i.level],c=(d.loaded?d.loaded.bytes:0)+o.loaded,u=(d.loaded?d.loaded.duration:0)+s;d.loaded={bytes:c,duration:u},d.realBitrate=Math.round(8*c/u)}if(i.bitrateTest){var h={stats:o,frag:i,part:n,id:i.type};this.onFragBuffered(a.Events.FRAG_BUFFERED,h),i.bitrateTest=!1}}},u.onFragBuffered=function(e,t){var i=t.frag,r=t.part,n=r?r.stats:i.stats;if(!n.aborted&&i.type===l.PlaylistLevelType.MAIN&&"initSegment"!==i.sn){var a=n.parsing.end-n.loading.start;this.bwEstimator.sample(a,n.loaded),n.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},u.onError=function(e,t){switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},u.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},u.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,i=this.hls,r=i.maxAutoLevel,n=i.config,a=i.minAutoLevel,s=i.media,l=t?t.duration:e?e.duration:0,c=s?s.currentTime:0,u=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,h=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(o.BufferHelper.bufferInfo(s,c,n.maxBufferHole).end-c)/u,m=this.findBestLevel(h,a,r,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor);if(m>=0)return m;d.logger.trace((f?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var p=l?Math.min(l,n.maxStarvationDelay):n.maxStarvationDelay,b=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;if(!f){var g=this.bitrateTestDelay;g&&(p=(l?Math.min(l,n.maxLoadingDelay):n.maxLoadingDelay)-g,d.logger.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),b=y=1)}return m=this.findBestLevel(h,a,r,f+p,b,y),Math.max(m,0)},u.findBestLevel=function(e,t,i,r,n,a){for(var o,s=this.fragCurrent,l=this.partCurrent,c=this.lastLoadedFragLevel,u=this.hls.levels,h=u[c],f=!(null==h||null===(o=h.details)||void 0===o||!o.live),m=null==h?void 0:h.codecSet,p=l?l.duration:s?s.duration:0,b=i;b>=t;b--){var y=u[b];if(y&&(!m||y.codecSet===m)){var g,v=y.details,Z=(l?null==v?void 0:v.partTarget:null==v?void 0:v.averagetargetduration)||p;g=b<=c?n*e:a*e;var T=u[b].maxBitrate,L=T*Z/g;if(d.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(g)+"/"+T+"/"+Z+"/"+r+"/"+L),g>T&&(!L||f&&!this.bitrateTestDelay||L<r))return b}}return-1},t=e,(i=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this.getNextABRAutoLevel();return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}}])&&c(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=u},"./repo/src/controller/base-playlist-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/types/level.ts"),a=i("./repo/src/controller/level-helper.ts"),o=i("./repo/src/utils/logger.ts"),s=i("./repo/src/errors.ts"),l=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=o.logger.log.bind(o.logger,t+":"),this.warn=o.logger.warn.bind(o.logger,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.onError=function(e,t){t.fatal&&t.type===s.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t){var i=null==t?void 0:t.renditionReports;if(i)for(var a=0;a<i.length;a++){var o=i[a],s=""+o.URI;if(s===e.substr(-s.length)){var l=parseInt(o["LAST-MSN"]),d=parseInt(o["LAST-PART"]);if(t&&this.hls.config.lowLatencyMode){var c=Math.min(t.age-t.partTarget,t.targetduration);void 0!==d&&c>t.partTarget&&(d+=1)}if(Object(r.isFiniteNumber)(l))return new n.HlsUrlParameters(l,Object(r.isFiniteNumber)(d)?d:void 0,n.HlsSkip.No)}}},t.loadPlaylist=function(e){},t.shouldLoadTrack=function(e){return this.canLoad&&e&&!!e.url&&(!e.details||e.details.live)},t.playlistLoaded=function(e,t,i){var r=this,n=t.details,o=t.stats,s=o.loading.end?Math.max(0,self.performance.now()-o.loading.end):0;if(n.advancedDateTime=Date.now()-s,n.live||null!=i&&i.live){if(n.reloaded(i),i&&this.log("live playlist "+e+" "+(n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:"MISSED")),i&&n.fragments.length>0&&Object(a.mergeDetails)(i,n),!this.canLoad||!n.live)return;var l,d=void 0,c=void 0;if(n.canBlockReload&&n.endSN&&n.advanced){var u=this.hls.config.lowLatencyMode,h=n.lastPartSn,f=n.endSN,m=n.lastPartIndex,p=h===f;-1!==m?(d=p?f+1:h,c=p?u?0:m:m+1):d=f+1;var b=n.age,y=b+n.ageHeader,g=Math.min(y-n.partTarget,1.5*n.targetduration);if(g>0){if(i&&g>i.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+i.tuneInGoal+" to: "+g+" with playlist age: "+n.age),g=0;else{var v=Math.floor(g/n.targetduration);d+=v,void 0!==c&&(c+=Math.round(g%n.targetduration/n.partTarget)),this.log("CDN Tune-in age: "+n.ageHeader+"s last advanced "+b.toFixed(2)+"s goal: "+g+" skip sn "+v+" to part "+c)}n.tuneInGoal=g}if(l=this.getDeliveryDirectives(n,t.deliveryDirectives,d,c),u||!p)return void this.loadPlaylist(l)}else l=this.getDeliveryDirectives(n,t.deliveryDirectives,d,c);var Z=Object(a.computeReloadInterval)(n,o);void 0!==d&&n.canBlockReload&&(Z-=n.partTarget||1),this.log("reload live playlist "+e+" in "+Math.round(Z)+" ms"),this.timer=self.setTimeout((function(){return r.loadPlaylist(l)}),Z)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,i,r){var a=Object(n.getSkipValue)(e,i);return null!=t&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,a=n.HlsSkip.No),new n.HlsUrlParameters(i,r,a)},t.retryLoadingOrFail=function(e){var t,i=this,r=this.hls.config,n=this.retryCount<r.levelLoadingMaxRetry;if(n)if(this.retryCount++,e.details.indexOf("LoadTimeOut")>-1&&null!==(t=e.context)&&void 0!==t&&t.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+e.details+'"'),this.loadPlaylist();else{var a=Math.min(Math.pow(2,this.retryCount)*r.levelLoadingRetryDelay,r.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((function(){return i.loadPlaylist()}),a),this.warn("retry playlist loading #"+this.retryCount+" in "+a+' ms after "'+e.details+'"')}else this.warn('cannot recover from error "'+e.details+'"'),this.clearTimer(),e.fatal=!0;return n},e}()},"./repo/src/controller/base-stream-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"State",(function(){return L})),i.d(t,"default",(function(){return S}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/task-loop.ts"),a=i("./repo/src/controller/fragment-tracker.ts"),o=i("./repo/src/utils/buffer-helper.ts"),s=i("./repo/src/utils/logger.ts"),l=i("./repo/src/events.ts"),d=i("./repo/src/errors.ts"),c=i("./repo/src/types/transmuxer.ts"),u=i("./repo/src/utils/mp4-tools.ts"),h=i("./repo/src/utils/discontinuities.ts"),f=i("./repo/src/controller/fragment-finders.ts"),m=i("./repo/src/controller/level-helper.ts"),p=i("./repo/src/loader/fragment-loader.ts"),b=i("../crypt/dist/jsvmp.js"),y=i.n(b),g=i("./repo/src/utils/time-ranges.ts"),v=i("./repo/src/types/loader.ts");function Z(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},S=function(e){var t,i;function n(t,i,r){var n;return(n=e.call(this)||this).hls=void 0,n.fragPrevious=null,n.fragCurrent=null,n.fragmentTracker=void 0,n.transmuxer=null,n._state=L.STOPPED,n.media=void 0,n.mediaBuffer=void 0,n.config=void 0,n.bitrateTest=!1,n.lastCurrentTime=0,n.nextLoadPosition=0,n.startPosition=0,n.loadedmetadata=!1,n.fragLoadError=0,n.retryDate=0,n.levels=null,n.fragmentLoader=void 0,n.levelLastLoaded=null,n.startFragRequested=!1,n.decrypter=void 0,n.initPTS=[],n.onvseeking=null,n.onvended=null,n.logPrefix="",n.log=void 0,n.warn=void 0,n.logPrefix=r,n.log=s.logger.log.bind(s.logger,r+":"),n.warn=s.logger.warn.bind(s.logger,r+":"),n.hls=t,n.fragmentLoader=new p.default(t.config),n.fragmentTracker=i,n.config=t.config,n.decrypter=new y.a(t,t.config),t.on(l.Events.KEY_LOADED,n.onKeyLoaded,function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,T(t,i);var b,S,x=n.prototype;return x.doTick=function(){this.onTickEnd()},x.onTickEnd=function(){},x.startLoad=function(e){},x.stopLoad=function(){this.fragmentLoader.abort();var e=this.fragCurrent;e&&this.fragmentTracker.removeFragment(e),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},x._streamEnded=function(e,t){var i=this.fragCurrent,r=this.fragmentTracker;if(!t.live&&i&&i.sn>=t.endSN&&!e.nextStart){var n=t.partList;if(null!=n&&n.length){var s=n[n.length-1];return o.BufferHelper.isBuffered(this.media,s.start+s.duration/2)}var l=r.getState(i);return l===a.FragmentState.PARTIAL||l===a.FragmentState.OK}return!1},x.onMediaAttached=function(e,t){var i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(r.startPosition)},x.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},x.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,i=this.media,n=this.mediaBuffer,a=this.state,s=i?i.currentTime:0,l=o.BufferHelper.bufferInfo(n||i,s,e.maxBufferHole);if(this.log("media seeking to "+(Object(r.isFiniteNumber)(s)?s.toFixed(3):s)+", state: "+a),a===L.ENDED)this.resetLoadingState();else if(t&&!l.len){var d=e.maxFragLookUpTolerance,c=t.start-d,u=s>t.start+t.duration+d;(s<c||u)&&(u&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.loader.abort()),this.resetLoadingState())}i&&(this.lastCurrentTime=s),this.loadedmetadata||l.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()},x.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},x.onKeyLoaded=function(e,t){if(this.state===L.KEY_LOADING&&t.frag===this.fragCurrent&&this.levels){this.state=L.IDLE;var i=this.levels[t.frag.level].details;i&&this.loadFragment(t.frag,i,t.frag.start)}},x.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},x.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(l.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},x.loadKey=function(e,t){this.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=L.KEY_LOADING,this.fragCurrent=e,this.hls.trigger(l.Events.KEY_LOADING,{frag:e})},x.loadFragment=function(e,t,i){this._loadFragForPlayback(e,t,i)},x._loadFragForPlayback=function(e,t,i){var r=this;this._doFragLoad(e,t,i,(function(t){if(r.fragContextChanged(e))return r.warn("Fragment "+e.sn+(t.part?" p: "+t.part.index:"")+" of level "+e.level+" was dropped during download."),void r.fragmentTracker.removeFragment(e);e.stats.chunkCount++,r._handleFragmentLoadProgress(t)})).then((function(t){if(t){r.fragLoadError=0;var i=r.state;if(!r.fragContextChanged(e))return"payload"in t&&(r.log("Loaded fragment "+e.sn+" of level "+e.level),r.hls.trigger(l.Events.FRAG_LOADED,t),r.state===L.BACKTRACKING)?(r.fragmentTracker.backtrack(e,t),void r.resetFragmentLoading(e)):void r._handleFragmentLoadComplete(t);(i===L.FRAG_LOADING||i===L.BACKTRACKING||!r.fragCurrent&&i===L.PARSING)&&(r.fragmentTracker.removeFragment(e),r.state=L.IDLE)}})).catch((function(t){r.warn(t),r.resetFragmentLoading(e)}))},x.flushMainBuffer=function(e,t,i){if(void 0===i&&(i=null),e-t){var r={startOffset:e,endOffset:t,type:i};this.fragLoadError=0,this.hls.trigger(l.Events.BUFFER_FLUSHING,r)}},x._loadInitSegment=function(e){var t=this;this._doFragLoad(e).then((function(i){if(!i||t.fragContextChanged(e)||!t.levels)throw new Error("init load aborted");return i})).then((function(i){var r=t.hls,n=i.payload,a=e.decryptdata;if(n&&n.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var o=self.performance.now();return t.decrypter.webCryptoDecrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).then((function(t){var n=self.performance.now();return r.trigger(l.Events.FRAG_DECRYPTED,{frag:e,payload:t,stats:{tstart:o,tdecrypt:n}}),i.payload=t,i}))}return i})).then((function(i){var r=t.fragCurrent,n=t.hls,a=t.levels;if(!a)throw new Error("init load aborted, missing levels");var o=a[e.level].details;console.assert(o,"Level details are defined when init segment is loaded");var s=e.stats;t.state=L.IDLE,t.fragLoadError=0,e.data=new Uint8Array(i.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),i.frag===r&&n.trigger(l.Events.FRAG_BUFFERED,{stats:s,frag:r,part:null,id:e.type}),t.tick()})).catch((function(i){t.warn(i),t.resetFragmentLoading(e)}))},x.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId},x.fragBufferedComplete=function(e,t){var i=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level+" "+g.default.toString(o.BufferHelper.getBuffered(i))),this.state=L.IDLE,this.tick()},x._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var i=e.frag,r=e.part,n=e.partsLoaded,a=!n||0===n.length||n.some((function(e){return!e})),o=new c.ChunkMetadata(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}},x._handleFragmentLoadProgress=function(e){},x._doFragLoad=function(e,t,i,n){var a=this;if(void 0===i&&(i=null),!this.levels)throw new Error("frag load aborted, missing levels");if(i=Math.max(e.start,i||0),this.config.lowLatencyMode&&t){var o=t.partList;if(o&&n){i>e.end&&t.fragmentHint&&(e=t.fragmentHint);var s=this.getNextPart(o,e,i);if(s>-1){var d=o[s];return this.log("Loading part sn: "+e.sn+" p: "+d.index+" cc: "+e.cc+" of playlist ["+t.startSN+"-"+t.endSN+"] parts [0-"+s+"-"+(o.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(i.toFixed(3))),this.nextLoadPosition=d.start+d.duration,this.state=L.FRAG_LOADING,this.hls.trigger(l.Events.FRAG_LOADING,{frag:e,part:o[s],targetBufferTime:i}),this.doFragPartsLoad(e,o,s,n).catch((function(e){return a.handleFragLoadError(e)}))}if(!e.url||this.loadedEndOfParts(o,i))return Promise.resolve(null)}}return this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(t?"of ["+t.startSN+"-"+t.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(i.toFixed(3))),Object(r.isFiniteNumber)(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=L.FRAG_LOADING,this.hls.trigger(l.Events.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragmentLoader.load(e,n).catch((function(e){return a.handleFragLoadError(e)}))},x.doFragPartsLoad=function(e,t,i,r){var n=this;return new Promise((function(a,o){var s=[];!function i(d){var c=t[d];n.fragmentLoader.loadPart(e,c,r).then((function(r){s[c.index]=r;var o=r.part;n.hls.trigger(l.Events.FRAG_LOADED,r);var u=t[d+1];if(!u||u.fragment!==e)return a({frag:e,part:o,partsLoaded:s});i(d+1)})).catch(o)}(i)}))},x.handleFragLoadError=function(e){var t=e.data;return t&&t.details===d.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(l.Events.ERROR,t),null},x._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===L.PARSING){var i=t.frag,r=t.part,n=t.level,a=self.performance.now();i.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(i,r,n,e.partial)}else this.fragCurrent||(this.state=L.IDLE)},x.getCurrentContext=function(e){var t=this.levels,i=e.level,r=e.sn,n=e.part;if(!t||!t[i])return this.warn("Levels object was unset while buffering fragment "+r+" of level "+i+". The current chunk will not be buffered."),null;var a=t[i],o=n>-1?Object(m.getPartWith)(a,r,n):null,s=o?o.fragment:Object(m.getFragmentWithSN)(a,r,this.fragCurrent);return s?{frag:s,part:o,level:a}:null},x.bufferFragmentData=function(e,t,i,r){if(e&&this.state===L.PARSING){var n=e.data1,a=e.data2,o=n;if(n&&a&&(o=Object(u.appendUint8Array)(n,a)),o&&o.length){var s={type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:o};this.hls.trigger(l.Events.BUFFER_APPENDING,s),e.dropped&&e.independent&&!i&&this.flushBufferGap(t)}}},x.flushBufferGap=function(e){var t=this.media;if(t)if(o.BufferHelper.isBuffered(t,t.currentTime)){var i=t.currentTime,r=o.BufferHelper.bufferInfo(t,i,0),n=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*n),s=Math.max(Math.min(e.start-a,r.end-a),i+a);e.start-s>a&&this.flushMainBuffer(s,e.start)}else this.flushMainBuffer(0,e.start)},x.getFwdBufferInfo=function(e,t){var i=this.config,n=this.getLoadPosition();if(!Object(r.isFiniteNumber)(n))return null;var a=o.BufferHelper.bufferInfo(e,n,i.maxBufferHole);if(0===a.len&&void 0!==a.nextStart){var s=this.fragmentTracker.getBufferedFrag(n,t);if(s&&a.nextStart<s.end)return o.BufferHelper.bufferInfo(e,n,Math.max(a.nextStart,i.maxBufferHole))}return a},x.getMaxBufferLength=function(e){var t,i=this.config;return t=e?Math.max(8*i.maxBufferSize/e,i.maxBufferLength):i.maxBufferLength,Math.min(t,i.maxMaxBufferLength)},x.reduceMaxBufferLength=function(e){var t=this.config,i=e||t.maxBufferLength;return t.maxMaxBufferLength>=i&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},x.getNextFragment=function(e,t){var i,r,n=t.fragments,a=n.length;if(!a)return null;var o,s=this.config,l=n[0].start;if(t.live){var d=s.initialLiveManifestSize;if(a<d)return this.warn("Not enough fragments to start playback (have: "+a+", need: "+d+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(o=this.getInitialLiveFragment(t,n),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=l&&(o=n[0]);if(!o){var c=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,c,t)}return null===(i=o)||void 0===i||!i.initSegment||null!==(r=o)&&void 0!==r&&r.initSegment.data||this.bitrateTest||(o=o.initSegment),o},x.getNextPart=function(e,t,i){for(var r=-1,n=!1,a=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(a=a&&!l.independent,r>-1&&i<l.start)break;var d=l.loaded;!d&&(n||l.independent||a)&&l.fragment===t&&(r=o),n=d}return r},x.loadedEndOfParts=function(e,t){var i=e[e.length-1];return i&&t>i.start&&i.loaded},x.getInitialLiveFragment=function(e,t){var i=this.fragPrevious,r=null;if(i){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),r=Object(f.findFragmentByPDT)(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){var n=i.sn+1;if(n>=e.startSN&&n<=e.endSN){var a=t[n-e.startSN];i.cc===a.cc&&(r=a,this.log("Live playlist, switching playlist, load frag with next SN: "+r.sn))}r||(r=Object(f.findFragWithCC)(t,i.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+r.sn)}}else{var o=this.hls.liveSyncPosition;null!==o&&(r=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r},x.getFragmentAtPosition=function(e,t,i){var r,n=this.config,o=this.fragPrevious,s=i.fragments,l=i.endSN,d=i.fragmentHint,c=n.maxFragLookUpTolerance,u=!!(n.lowLatencyMode&&i.partList&&d);if(u&&d&&!this.bitrateTest&&(s=s.concat(d),l=d.sn),e<t){var h=e>t-c?0:c;r=Object(f.findFragmentByPTS)(o,s,e,h)}else r=s[s.length-1];if(r){var m=r.sn-i.startSN,p=o&&r.level===o.level,b=s[m+1];if(this.fragmentTracker.getState(r)===a.FragmentState.BACKTRACKED){r=null;for(var y=m;s[y]&&this.fragmentTracker.getState(s[y])===a.FragmentState.BACKTRACKED;)r=o?s[y--]:s[--y];r||(r=b)}else o&&r.sn===o.sn&&!u&&p&&(r.sn<l&&this.fragmentTracker.getState(b)!==a.FragmentState.OK?(this.log("SN "+r.sn+" just loaded, load next one: "+b.sn),r=b):r=null)}return r},x.synchronizeToLiveEdge=function(e){var t=this.config,i=this.media;if(i){var r=this.hls.liveSyncPosition,n=i.currentTime,a=e.fragments[0].start,o=e.edge,s=n>=a-t.maxFragLookUpTolerance&&n<=o;if(null!==r&&i.duration>r&&(n<r||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&i.readyState<4||n<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=r),i.readyState&&(this.warn("Playback: "+n.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+r.toFixed(3)),i.currentTime=r))}}},x.alignPlaylists=function(e,t){var i=this.levels,n=this.levelLastLoaded,a=this.fragPrevious,o=null!==n?i[n]:null,s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;var l=e.fragments[0].start,d=!t,c=e.alignedSliding&&Object(r.isFiniteNumber)(l);if(d||!c&&!l){Object(h.alignStream)(a,o,e);var u=e.fragments[0].start;return this.log("Live playlist sliding: "+u.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(a?a.sn:"na")+" fragments: "+s),u}return l},x.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},x.setStartPosition=function(e,t){var i=this.startPosition;if(i<t&&(i=-1),-1===i||-1===this.lastCurrentTime){var n=e.startTimeOffset;Object(r.isFiniteNumber)(n)?(i=t+n,n<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log("Start time offset "+n+" found in playlist, adjust startPosition to "+i),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i},x.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},x.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part"+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},x.resetFragmentLoading=function(e){this.fragCurrent&&this.fragContextChanged(e)||(this.state=L.IDLE)},x.onFragmentOrKeyLoadError=function(e,t){if(!t.fatal){var i=t.frag;if(i&&i.type===e){var r=this.fragCurrent;console.assert(r&&i.sn===r.sn&&i.level===r.level&&i.urlId===r.urlId,"Frag load error must match current frag to retry");var n=this.config;if(this.fragLoadError+1<=n.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(i.level))return;var a=Math.min(Math.pow(2,this.fragLoadError)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);this.warn("Fragment "+i.sn+" of "+e+" "+i.level+" failed to load, retrying in "+a+"ms"),this.retryDate=self.performance.now()+a,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else t.levelRetry?(e===v.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(s.logger.error(t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},x.afterBufferFlushed=function(e,t,i){if(e){var r=o.BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===L.ENDED&&this.resetLoadingState()}},x.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},x.resetLiveStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[e].details:null;if(null!=t&&t.live)return this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},x.updateLevelTiming=function(e,t,i,r){var n=this,a=i.details;console.assert(!!a,"level.details must be defined"),Object.keys(e.elementaryStreams).reduce((function(t,o){var s=e.elementaryStreams[o];if(s){var d=s.endPTS-s.startPTS;if(d<=0)return n.warn("Could not parse fragment "+e.sn+" "+o+" duration reliably ("+d+") resetting transmuxer to fallback to playlist timing"),n.resetTransmuxer(),t||!1;var c=r?0:Object(m.updateFragPTSDTS)(a,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return n.hls.trigger(l.Events.LEVEL_PTS_UPDATED,{details:a,level:i,drift:c,type:o,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1)?(this.state=L.PARSED,this.hls.trigger(l.Events.FRAG_PARSED,{frag:e,part:t})):this.resetLoadingState()},x.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},b=n,(S=[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}])&&Z(b.prototype,S),Object.defineProperty(b,"prototype",{writable:!1}),n}(n.default)},"./repo/src/controller/buffer-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return f}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/events.ts"),a=i("./repo/src/utils/logger.ts"),o=i("./repo/src/errors.ts"),s=i("./repo/src/utils/buffer-helper.ts"),l=i("./repo/src/utils/mediasource-helper.ts"),d=i("./repo/src/loader/fragment.ts"),c=i("./repo/src/controller/buffer-operation-queue.ts"),u=Object(l.getMediaSource)(),h=/([ha]vc.)(?:\.[^.,]+)+/,f=function(){function e(e){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var e=t.hls,i=t.media,r=t.mediaSource;a.logger.log("[buffer-controller]: Media source opened"),i&&(t.updateMediaElementDuration(),e.trigger(n.Events.MEDIA_ATTACHED,{media:i})),r&&r.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){a.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){a.logger.log("[buffer-controller]: Media source ended")},this.hls=e,this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null},t.registerListeners=function(){var e=this.hls;e.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(n.Events.BUFFER_RESET,this.onBufferReset,this),e.on(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(n.Events.BUFFER_EOS,this.onBufferEos,this),e.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(n.Events.FRAG_PARSED,this.onFragParsed,this),e.on(n.Events.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(n.Events.BUFFER_RESET,this.onBufferReset,this),e.off(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(n.Events.BUFFER_EOS,this.onBufferEos,this),e.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(n.Events.FRAG_PARSED,this.onFragParsed,this),e.off(n.Events.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new c.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},t.onManifestParsed=function(e,t){var i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.details=null,a.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var i=this.media=t.media;if(i&&u){var r=this.mediaSource=new u;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(r),this._objectUrl=i.src}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,i=this._objectUrl;if(t){if(a.logger.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){a.logger.warn("[buffer-controller]: onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):a.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(n.Events.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach((function(t){var i=e.sourceBuffer[t];try{i&&(e.removeBufferListeners(t),e.mediaSource&&e.mediaSource.removeSourceBuffer(i),e.sourceBuffer[t]=void 0)}catch(e){a.logger.warn("[buffer-controller]: Failed to reset the "+t+" buffer",e)}})),this._initSourceBuffer()},t.onBufferCodecs=function(e,t){var i=this,r=this.getSourceBufferTypes().length;Object.keys(t).forEach((function(e){if(r){var n=i.tracks[e];if(n&&"function"==typeof n.buffer.changeType){var o=t[e],s=o.id,l=o.codec,d=o.levelCodec,c=o.container,u=o.metadata,f=(n.levelCodec||n.codec).replace(h,"$1"),m=(d||l).replace(h,"$1");if(f!==m){var p=c+";codecs="+(d||l);i.appendChangeType(e,p),a.logger.log("[buffer-controller]: switching codec "+f+" to "+m),i.tracks[e]={buffer:n.buffer,codec:l,container:c,levelCodec:d,metadata:u,id:s}}}}else i.pendingTracks[e]=t[e]})),r||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.appendChangeType=function(e,t){var i=this,r=this.operationQueue,n={execute:function(){var n=i.sourceBuffer[e];n&&(a.logger.log("[buffer-controller]: changing "+e+" sourceBuffer type to "+t),n.changeType(t)),r.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){a.logger.warn("[buffer-controller]: Failed to change "+e+" SourceBuffer type",t)}};r.append(n,e)},t.onBufferAppending=function(e,t){var i=this,r=this.hls,l=this.operationQueue,d=this.tracks,c=t.data,u=t.type,h=t.frag,f=t.part,m=t.chunkMeta,p=m.buffering[u],b=self.performance.now();p.start=b;var y=h.stats.buffering,g=f?f.stats.buffering:null;0===y.start&&(y.start=b),g&&0===g.start&&(g.start=b);var v=d.audio,Z="audio"===u&&1===m.id&&"audio/mpeg"===(null==v?void 0:v.container),T={execute:function(){if(p.executeStart=self.performance.now(),Z){var e=i.sourceBuffer[u];if(e){var t=h.start-e.timestampOffset;Math.abs(t)>=.1&&(a.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+h.start+" (delta: "+t+") sn: "+h.sn+")"),e.timestampOffset=h.start)}}i.appendExecutor(c,u)},onStart:function(){},onComplete:function(){var e=self.performance.now();p.executeEnd=p.end=e,0===y.first&&(y.first=e),g&&0===g.first&&(g.first=e);var t=i.sourceBuffer,r={};for(var a in t)r[a]=s.BufferHelper.getBuffered(t[a]);i.appendError=0,i.hls.trigger(n.Events.BUFFER_APPENDED,{type:u,frag:h,part:f,chunkMeta:m,parent:h.type,timeRanges:r})},onError:function(e){a.logger.error("[buffer-controller]: Error encountered while trying to append to the "+u+" SourceBuffer",e);var t={type:o.ErrorTypes.MEDIA_ERROR,parent:h.type,details:o.ErrorDetails.BUFFER_APPEND_ERROR,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=o.ErrorDetails.BUFFER_FULL_ERROR:(i.appendError++,t.details=o.ErrorDetails.BUFFER_APPEND_ERROR,i.appendError>r.config.appendErrorMaxRetry&&(a.logger.error("[buffer-controller]: Failed "+r.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0)),r.trigger(n.Events.ERROR,t)}};l.append(T,u)},t.onBufferFlushing=function(e,t){var i=this,r=this.operationQueue,o=function(e){return{execute:i.removeExecutor.bind(i,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){i.hls.trigger(n.Events.BUFFER_FLUSHED,{type:e})},onError:function(t){a.logger.warn("[buffer-controller]: Failed to remove from "+e+" SourceBuffer",t)}}};t.type?r.append(o(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){r.append(o(e),e)}))},t.onFragParsed=function(e,t){var i=this,r=t.frag,o=t.part,s=[],l=o?o.elementaryStreams:r.elementaryStreams;l[d.ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(l[d.ElementaryStreamTypes.AUDIO]&&s.push("audio"),l[d.ElementaryStreamTypes.VIDEO]&&s.push("video")),0===s.length&&a.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+r.type+" level: "+r.level+" sn: "+r.sn),this.blockBuffers((function(){var e=self.performance.now();r.stats.buffering.end=e,o&&(o.stats.buffering.end=e);var t=o?o.stats:r.stats;i.hls.trigger(n.Events.FRAG_BUFFERED,{frag:r,part:o,stats:t,id:r.type})}),s)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=function(e,t){var i=this;this.getSourceBufferTypes().reduce((function(e,r){var n=i.sourceBuffer[r];return t.type&&t.type!==r||n&&!n.ended&&(n.ended=!0,a.logger.log("[buffer-controller]: "+r+" sourceBuffer now EOS")),e&&!(n&&!n.ended)}),!0)&&this.blockBuffers((function(){var e=i.mediaSource;e&&"open"===e.readyState&&e.endOfStream()}))},t.onLevelUpdated=function(e,t){var i=t.details;i.fragments.length&&(this.details=i,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.flushBackBuffer=function(){var e=this.hls,t=this.details,i=this.media,a=this.sourceBuffer;if(i&&null!==t){var o=this.getSourceBufferTypes();if(o.length){var l=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(Object(r.isFiniteNumber)(l)&&!(l<0)){var d=i.currentTime,c=t.levelTargetDuration,u=Math.max(l,c),h=Math.floor(d/c)*c-u;o.forEach((function(i){var r=a[i];if(r){var o=s.BufferHelper.getBuffered(r);o.length>0&&h>o.start(0)&&(e.trigger(n.Events.BACK_BUFFER_REACHED,{bufferEnd:h}),t.live&&e.trigger(n.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:h}),e.trigger(n.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:h,type:i}))}}))}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,i=this.media,n=this.mediaSource,o=e.fragments[0].start+e.totalduration,s=i.duration,l=Object(r.isFiniteNumber)(n.duration)?n.duration:0;e.live&&t.config.liveDurationInfinity?(a.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),n.duration=1/0,this.updateSeekableRange(e)):(o>l&&o>s||!Object(r.isFiniteNumber)(s))&&(a.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),n.duration=o)}},t.updateSeekableRange=function(e){var t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&null!=t&&t.setLiveSeekableRange){var r=Math.max(0,i[0].start),n=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,n)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,i=this.pendingTracks,r=Object.keys(i).length;if(r&&!e||2===r){this.createSourceBuffers(i),this.pendingTracks={};var a=this.getSourceBufferTypes();if(0===a.length)return void this.hls.trigger(n.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});a.forEach((function(e){t.executeNext(e)}))}},t.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");var r=0;for(var s in e)if(!t[s]){var l=e[s];if(!l)throw Error("source buffer exists for track "+s+", however track does not");var d=l.levelCodec||l.codec,c=l.container+";codecs="+d;a.logger.log("[buffer-controller]: creating sourceBuffer("+c+")");try{var u=t[s]=i.addSourceBuffer(c),h=s;this.addBufferListener(h,"updatestart",this._onSBUpdateStart),this.addBufferListener(h,"updateend",this._onSBUpdateEnd),this.addBufferListener(h,"error",this._onSBUpdateError),this.tracks[s]={buffer:u,codec:d,container:l.container,levelCodec:l.levelCodec,metadata:l.metadata,id:l.id},r++}catch(e){a.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+e.message),this.hls.trigger(n.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:c})}}r&&this.hls.trigger(n.Events.BUFFER_CREATED,{tracks:this.tracks})},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t=this.operationQueue;t.current(e).onComplete(),t.shiftAndExecuteNext(e)},t._onSBUpdateError=function(e,t){a.logger.error("[buffer-controller]: "+e+" SourceBuffer error",t),this.hls.trigger(n.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var i=this.operationQueue.current(e);i&&i.onError(t)},t.removeExecutor=function(e,t,i){var n=this.media,o=this.mediaSource,s=this.operationQueue,l=this.sourceBuffer[e];if(!n||!o||!l)return a.logger.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void s.shiftAndExecuteNext(e);var d=Object(r.isFiniteNumber)(n.duration)?n.duration:1/0,c=Object(r.isFiniteNumber)(o.duration)?o.duration:1/0,u=Math.max(0,t),h=Math.min(i,d,c);h>u?(a.logger.log("[buffer-controller]: Removing ["+u+","+h+"] from the "+e+" SourceBuffer"),console.assert(!l.updating,e+" sourceBuffer must not be updating"),l.remove(u,h)):s.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var i=this.operationQueue,r=this.sourceBuffer[t];if(!r)return a.logger.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void i.shiftAndExecuteNext(t);r.ended=!1,console.assert(!r.updating,t+" sourceBuffer must not be updating"),r.appendBuffer(e)},t.blockBuffers=function(e,t){var i=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return a.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(e);var r=this.operationQueue,n=t.map((function(e){return r.appendBlocker(e)}));Promise.all(n).then((function(){e(),t.forEach((function(e){var t=i.sourceBuffer[e];t&&t.updating||r.shiftAndExecuteNext(e)}))}))},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,i){var r=this.sourceBuffer[e];if(r){var n=i.bind(this,e);this.listeners[e].push({event:t,listener:n}),r.addEventListener(t,n)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))},e}()},"./repo/src/controller/buffer-operation-queue.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return n}));var r=i("./repo/src/utils/logger.ts"),n=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t){var i=this.queues[t];i.push(e),1===i.length&&this.buffers[t]&&this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,i=new Promise((function(e){t=e})),r={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(r,e),i},t.executeNext=function(e){var t=this.buffers,i=this.queues,n=t[e],a=i[e];if(a.length){var o=a[0];try{o.execute()}catch(t){r.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(t),n&&n.updating||(a.shift(),this.executeNext(e))}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}()},"./repo/src/controller/cap-level-controller.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/events.ts");function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t,i,a=e.prototype;return a.setStreamController=function(e){this.streamController=e},a.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},a.registerListeners=function(){var e=this.hls;e.on(r.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(r.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},a.unregisterListener=function(){var e=this.hls;e.off(r.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(r.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},a.onFpsDropLevelCapping=function(t,i){e.isLevelAllowed(i.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(i.droppedLevel)},a.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null},a.onManifestParsed=function(e,t){var i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()},a.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},a.onMediaDetaching=function(){this.stopCapping()},a.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var e=this.hls.levels;if(e.length){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},a.getMaxLevel=function(t){var i=this,r=this.hls.levels;if(!r.length)return-1;var n=r.filter((function(r,n){return e.isLevelAllowed(n,i.restrictedLevels)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},a.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},a.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},a.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,t.width||t.height||(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t},e.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},e.getMaxLevelByMediaSize=function(e,t,i){if(!e||!e.length)return-1;for(var r,n,a=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=i)&&(r=s,!(n=e[o+1])||r.width!==n.width||r.height!==n.height)){a=o;break}}return a},t=e,(i=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=a},"./repo/src/controller/fps-controller.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/events.ts"),n=i("./repo/src/utils/logger.ts"),a=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(r.Events.MEDIA_ATTACHING,this.onMediaAttaching)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var i=this.hls.config;if(i.capLevelOnFPSDrop){var r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,i){var a=performance.now();if(t){if(this.lastTime){var o=a-this.lastTime,s=i-this.lastDroppedFrames,l=t-this.lastDecodedFrames,d=1e3*s/o,c=this.hls;if(c.trigger(r.Events.FPS_DROP,{currentDropped:s,currentDecoded:l,totalDroppedFrames:i}),d>0&&s>c.config.fpsDroppedMonitoringThreshold*l){var u=c.currentLevel;n.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=u)&&(u-=1,c.trigger(r.Events.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}();t.default=a},"./repo/src/controller/fragment-finders.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"findFragmentByPDT",(function(){return a})),i.d(t,"findFragmentByPTS",(function(){return o})),i.d(t,"fragmentWithinToleranceTest",(function(){return s})),i.d(t,"pdtWithinToleranceTest",(function(){return l})),i.d(t,"findFragWithCC",(function(){return d}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/utils/binary-search.ts");function a(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!Object(r.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(var n=0;n<e.length;++n){var a=e[n];if(l(t,i,a))return a}return null}function o(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var a=null;return e?a=t[e.sn-t[0].sn+1]||null:0===i&&0===t[0].start&&(a=t[0]),a&&0===s(i,r,a)?a:n.default.search(t,s.bind(null,i,r))||a}function s(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=e?1:i.start-r>e&&i.start?-1:0}function l(e,t,i){var r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-r>e}function d(e,t){return n.default.search(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}},"./repo/src/controller/fragment-tracker.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"FragmentState",(function(){return r})),i.d(t,"FragmentTracker",(function(){return o}));var r,n=i("./repo/src/events.ts"),a=i("./repo/src/types/loader.ts");!function(e){e.NOT_LOADED="NOT_LOADED",e.BACKTRACKED="BACKTRACKED",e.APPENDING="APPENDING",e.PARTIAL="PARTIAL",e.OK="OK"}(r||(r={}));var o=function(){function e(e){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(n.Events.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(n.Events.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){if(t===a.PlaylistLevelType.MAIN){var i=this.activeFragment,r=this.activeParts;if(!i)return null;if(r)for(var n=r.length;n--;){var o=r[n],s=o?o.end:i.appendedPTS;if(o.start<=e&&void 0!==s&&e<=s)return n>9&&(this.activeParts=r.slice(n-9)),o}else if(i.start<=e&&void 0!==i.appendedPTS&&e<=i.appendedPTS)return i}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var i=this.fragments,r=Object.keys(i),n=r.length;n--;){var a=i[r[n]];if((null==a?void 0:a.body.type)===t&&a.buffered){var o=a.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,i){var r=this;Object.keys(this.fragments).forEach((function(n){var a=r.fragments[n];if(a)if(a.buffered){var o=a.range[e];o&&o.time.some((function(e){var i=!r.isTimeBuffered(e.startPTS,e.endPTS,t);return i&&r.removeFragment(a.body),i}))}else a.body.type===i&&r.removeFragment(a.body)}))},t.detectPartialFragments=function(e){var t=this,i=this.timeRanges,r=e.frag,n=e.part;if(i&&"initSegment"!==r.sn){var a=l(r),o=this.fragments[a];o&&(Object.keys(i).forEach((function(e){var a=r.elementaryStreams[e];if(a){var s=i[e],l=null!==n||!0===a.partial;o.range[e]=t.getBufferedTimes(r,n,l,s)}})),o.backtrack=o.loaded=null,Object.keys(o.range).length?o.buffered=!0:this.removeFragment(o.body))}},t.fragBuffered=function(e){var t=l(e),i=this.fragments[t];i&&(i.backtrack=i.loaded=null,i.buffered=!0)},t.getBufferedTimes=function(e,t,i,r){for(var n={time:[],partial:i},a=t?t.start:e.start,o=t?t.end:e.end,s=e.minEndPTS||o,l=e.maxStartPTS||a,d=0;d<r.length;d++){var c=r.start(d)-this.bufferPadding,u=r.end(d)+this.bufferPadding;if(l>=c&&s<=u){n.time.push({startPTS:Math.max(a,r.start(d)),endPTS:Math.min(o,r.end(d))});break}if(a<u&&o>c)n.partial=!0,n.time.push({startPTS:Math.max(a,r.start(d)),endPTS:Math.min(o,r.end(d))});else if(o<=c)break}return n},t.getPartialFragment=function(e){var t,i,r,n=null,a=0,o=this.bufferPadding,l=this.fragments;return Object.keys(l).forEach((function(d){var c=l[d];c&&s(c)&&(i=c.body.start-o,r=c.body.end+o,e>=i&&e<=r&&(t=Math.min(e-i,r-e),a<=t&&(n=c.body,a=t)))})),n},t.getState=function(e){var t=l(e),i=this.fragments[t];return i?i.buffered?s(i)?r.PARTIAL:r.OK:i.backtrack?r.BACKTRACKED:r.APPENDING:r.NOT_LOADED},t.backtrack=function(e,t){var i=l(e),r=this.fragments[i];if(!r||r.backtrack)return null;var n=r.backtrack=t||r.loaded;return r.loaded=null,n},t.getBacktrackData=function(e){var t=l(e),i=this.fragments[t];if(i){var r,n=i.backtrack;if(null!=n&&null!==(r=n.payload)&&void 0!==r&&r.byteLength)return n;this.removeFragment(e)}return null},t.isTimeBuffered=function(e,t,i){for(var r,n,a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,n=i.end(a)+this.bufferPadding,e>=r&&t<=n)return!0;if(t<=r)return!1}return!1},t.onFragLoaded=function(e,t){var i=t.frag,r=t.part;if("initSegment"!==i.sn&&!i.bitrateTest&&!r){var n=l(i);this.fragments[n]={body:i,loaded:t,backtrack:null,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var i=this,r=t.frag,n=t.part,o=t.timeRanges;if(r.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=r,n){var s=this.activeParts;s||(this.activeParts=s=[]),s.push(n)}else this.activeParts=null;this.timeRanges=o,Object.keys(o).forEach((function(e){var t=o[e];if(i.detectEvictedFragments(e,t),!n)for(var a=0;a<t.length;a++)r.appendedPTS=Math.max(t.end(a),r.appendedPTS||0)}))},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=l(e);return!!this.fragments[t]},t.removeFragmentsInRange=function(e,t,i){var r=this;Object.keys(this.fragments).forEach((function(n){var a=r.fragments[n];if(a&&a.buffered){var o=a.body;o.type===i&&o.start<t&&o.end>e&&r.removeFragment(o)}}))},t.removeFragment=function(e){var t=l(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),delete this.fragments[t]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},e}();function s(e){var t,i;return e.buffered&&((null===(t=e.range.video)||void 0===t?void 0:t.partial)||(null===(i=e.range.audio)||void 0===i?void 0:i.partial))}function l(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn}},"./repo/src/controller/gap-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"STALL_MINIMUM_DURATION_MS",(function(){return s})),i.d(t,"MAX_START_GAP_JUMP",(function(){return l})),i.d(t,"SKIP_BUFFER_HOLE_STEP_SECONDS",(function(){return d})),i.d(t,"SKIP_BUFFER_RANGE_START",(function(){return c})),i.d(t,"default",(function(){return u}));var r=i("./repo/src/utils/buffer-helper.ts"),n=i("./repo/src/errors.ts"),a=i("./repo/src/events.ts"),o=i("./repo/src/utils/logger.ts"),s=250,l=2,d=.1,c=.05,u=function(){function e(e,t,i,r){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r}var t=e.prototype;return t.destroy=function(){this.hls=this.fragmentTracker=this.media=null},t.poll=function(e){var t=this.config,i=this.media,n=this.stalled,a=i.currentTime,d=i.seeking,c=this.seeking&&!d,u=!this.seeking&&d;if(this.seeking=d,a===e){if((u||c)&&(this.stalled=null),!i.paused&&!i.ended&&0!==i.playbackRate&&r.BufferHelper.getBuffered(i).length){var h=r.BufferHelper.bufferInfo(i,a,0),f=h.len>0,m=h.nextStart||0;if(f||m){if(d){var p=h.len>l,b=!m||m-a>l&&!this.fragmentTracker.getPartialFragment(a);if(p||b)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var y,g=Math.max(m,h.start||0)-a,v=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,Z=(null==v||null===(y=v.details)||void 0===y?void 0:y.live)?2*v.details.targetduration:l;if(g>0&&g<=Z)return void this._trySkipBufferHole(null)}var T=self.performance.now();if(null!==n){var L=T-n;!d&&L>=s&&this._reportStall(h.len);var S=r.BufferHelper.bufferInfo(i,a,t.maxBufferHole);this._tryFixBufferStall(S,L)}else this.stalled=T}}}else if(this.moved=!0,null!==n){if(this.stallReported){var x=self.performance.now()-n;o.logger.warn("playback not stuck anymore @"+a+", after "+Math.round(x)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var i=this.config,r=this.fragmentTracker,n=this.media.currentTime,a=r.getPartialFragment(n);a&&this._trySkipBufferHole(a)||e.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(o.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,o.logger.warn("Playback stalling at @"+i.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,i=this.hls,s=this.media,l=s.currentTime,u=0,h=r.BufferHelper.getBuffered(s),f=0;f<h.length;f++){var m=h.start(f);if(l+t.maxBufferHole>=u&&l<m){var p=Math.max(m+c,s.currentTime+d);return o.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+p),this.moved=!0,this.stalled=null,s.currentTime=p,e&&i.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+p,frag:e}),p}u=h.end(f)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,r=this.nudgeRetry,s=i.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){var l=s+(r+1)*e.nudgeOffset;o.logger.warn("Nudging 'currentTime' from "+s+" to "+l),i.currentTime=l,t.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else o.logger.error("Playhead still not moving while enough data buffered @"+s+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}()},"./repo/src/controller/id3-track-controller.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/events.ts"),n=i("./repo/src/utils/texttrack-utils.ts"),a=i("./repo/src/demux/id3.ts"),o=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners()},t._registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},t._unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(Object(n.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Object(n.sendAddTrackEvent)(i,this.media),i}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var i=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,o=0;o<r.length;o++){var s=a.getID3Frames(r[o].data);if(s){var l=r[o].pts,d=o<r.length-1?r[o+1].pts:i.end;d-l<=0&&(d=l+.25);for(var c=0;c<s.length;c++){var u=s[c];if(!a.isTimeStampFrame(u)){var h=new n(l,d,"");h.value=u,this.id3Track.addCue(h)}}}}}},t.onBufferFlushing=function(e,t){var i=t.startOffset,r=t.endOffset,a=t.type;if(!a||"audio"===a){var o=this.id3Track;o&&Object(n.removeCuesInRange)(o,i,r)}},e}();t.default=o},"./repo/src/controller/latency-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return s}));var r=i("./repo/src/errors.ts"),n=i("./repo/src/events.ts"),a=i("./repo/src/utils/logger.ts");function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t,i,s=e.prototype;return s.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},s.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(n.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(n.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(n.Events.ERROR,this.onError)},s.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},s.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},s.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},s.onLevelUpdated=function(e,t){var i=t.details;this.levelDetails=i,i.advanced&&this.timeupdate(),!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},s.onError=function(e,t){t.details===r.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,a.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},s.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var i=this.computeLatency();if(null!==i){this._latency=i;var r=this.config,n=r.lowLatencyMode,a=r.maxLiveSyncPlaybackRate;if(n&&1!==a){var o=this.targetLatency;if(null!==o){var s=i-o,l=s<Math.min(this.maxLatency,o+t.targetduration);if(t.live&&l&&s>.05&&this.forwardBufferLength>1){var d=Math.min(2,Math.max(1,a)),c=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(d,Math.max(1,c))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},s.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},s.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},t=e,(i=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,i=e.partHoldBack,r=e.targetduration,n=this.config,a=n.liveSyncDuration,o=n.liveSyncDurationCount,s=n.lowLatencyMode,l=this.hls.userConfig,d=s&&i||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===d)&&(d=void 0!==a?a:o*r);var c=r;return d+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(null===e||null===t||null===i)return null;var r=i.edge,n=e-t-this.edgeStalled,a=r-i.totalduration,o=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,n),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}}])&&o(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./repo/src/controller/level-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return m}));var r=i("./repo/src/types/level.ts"),n=i("./repo/src/events.ts"),a=i("./repo/src/errors.ts"),o=i("./repo/src/utils/codecs.ts"),s=i("./repo/src/controller/level-helper.ts"),l=i("./repo/src/controller/base-playlist-controller.ts"),d=i("./repo/src/types/loader.ts");function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),m=function(e){var t,i;function l(t){var i;return(i=e.call(this,t,"[level-controller]")||this)._levels=[],i._firstLevel=-1,i._startLevel=void 0,i.currentLevelIndex=-1,i.manualLevelIndex=-1,i.onParsedComplete=void 0,i._registerListeners(),i}i=e,(t=l).prototype=Object.create(i.prototype),t.prototype.constructor=t,h(t,i);var m,p,b=l.prototype;return b._registerListeners=function(){var e=this.hls;e.on(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(n.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(n.Events.ERROR,this.onError,this)},b._unregisterListeners=function(){var e=this.hls;e.off(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(n.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(n.Events.ERROR,this.onError,this)},b.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,e.prototype.destroy.call(this)},b.startLoad=function(){this._levels.forEach((function(e){e.loadError=0})),e.prototype.startLoad.call(this)},b.onManifestLoaded=function(e,t){var i,l,d=[],c=[],u=[],h={},m=!1,p=!1,b=!1;if(t.levels.forEach((function(e){var t=e.attrs;m=m||!(!e.width||!e.height),p=p||!!e.videoCodec,b=b||!!e.audioCodec,f&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0);var i=e.bitrate+"-"+e.attrs.RESOLUTION+"-"+e.attrs.CODECS;(l=h[i])?l.url.push(e.url):(l=new r.Level(e),h[i]=l,d.push(l)),t&&(t.AUDIO&&Object(s.addGroupId)(l,"audio",t.AUDIO),t.SUBTITLES&&Object(s.addGroupId)(l,"text",t.SUBTITLES))})),(m||p)&&b&&(d=d.filter((function(e){var t=e.videoCodec,i=e.width,r=e.height;return!!t||!(!i||!r)}))),d=d.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||Object(o.isCodecSupportedInMp4)(t,"audio"))&&(!i||Object(o.isCodecSupportedInMp4)(i,"video"))})),t.audioTracks&&(c=t.audioTracks.filter((function(e){return!e.audioCodec||Object(o.isCodecSupportedInMp4)(e.audioCodec,"audio")})),Object(s.assignTrackIdsByGroup)(c)),t.subtitles&&(u=t.subtitles,Object(s.assignTrackIdsByGroup)(u)),d.length>0){i=d[0].bitrate,d.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=d;for(var y=0;y<d.length;y++)if(d[y].bitrate===i){this._firstLevel=y,this.log("manifest loaded, "+d.length+" level(s) found, first bitrate: "+i);break}var g=b&&!p,v={levels:d,audioTracks:c,subtitleTracks:u,firstLevel:this._firstLevel,stats:t.stats,audio:b,video:p,altAudio:!g&&c.some((function(e){return!!e.url}))};this.hls.trigger(n.Events.MANIFEST_PARSED,v),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,reason:"no level with compatible codecs found in manifest"})},b.onError=function(t,i){if(e.prototype.onError.call(this,t,i),!i.fatal){var r=i.context,n=this._levels[this.currentLevelIndex];if(r&&(r.type===d.PlaylistContextType.AUDIO_TRACK&&n.audioGroupIds&&r.groupId===n.audioGroupIds[n.urlId]||r.type===d.PlaylistContextType.SUBTITLE_TRACK&&n.textGroupIds&&r.groupId===n.textGroupIds[n.urlId]))this.redundantFailover(this.currentLevelIndex);else{var o,s=!1,l=!0;switch(i.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:case a.ErrorDetails.KEY_LOAD_ERROR:case a.ErrorDetails.KEY_LOAD_TIMEOUT:if(i.frag){var c=this._levels[i.frag.level];c?(c.fragmentError++,c.fragmentError>this.hls.config.fragLoadingMaxRetry&&(o=i.frag.level)):o=i.frag.level}break;case a.ErrorDetails.LEVEL_LOAD_ERROR:case a.ErrorDetails.LEVEL_LOAD_TIMEOUT:r&&(r.deliveryDirectives&&(l=!1),o=r.level),s=!0;break;case a.ErrorDetails.REMUX_ALLOC_ERROR:o=i.level,s=!0}void 0!==o&&this.recoverLevel(i,o,s,l)}}},b.recoverLevel=function(e,t,i,r){var n=e.details,a=this._levels[t];if(a.loadError++,i){if(!this.retryLoadingOrFail(e))return void(this.currentLevelIndex=-1);e.levelRetry=!0}if(r){var o=a.url.length;if(o>1&&a.loadError<o)e.levelRetry=!0,this.redundantFailover(t);else if(-1===this.manualLevelIndex){var s=0===t?this._levels.length-1:t-1;this.currentLevelIndex!==s&&0===this._levels[s].loadError&&(this.warn(n+": switch to "+s),e.levelRetry=!0,this.hls.nextAutoLevel=s)}}},b.redundantFailover=function(e){var t=this._levels[e],i=t.url.length;if(i>1){var r=(t.urlId+1)%i;this.warn("Switching to redundant URL-id "+r),this._levels.forEach((function(e){e.urlId=r})),this.level=e}},b.onFragLoaded=function(e,t){var i=t.frag;if(void 0!==i&&i.type===d.PlaylistLevelType.MAIN){var r=this._levels[i.level];void 0!==r&&(r.fragmentError=0,r.loadError=0)}},b.onLevelLoaded=function(e,t){var i,r,n=t.level,a=t.details,o=this._levels[n];if(!o)return this.warn("Invalid level index "+n),void(null!==(r=t.deliveryDirectives)&&void 0!==r&&r.skip&&(a.deltaUpdateFailed=!0));n===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0,this.retryCount=0),this.playlistLoaded(n,t,o.details)):null!==(i=t.deliveryDirectives)&&void 0!==i&&i.skip&&(a.deltaUpdateFailed=!0)},b.onAudioTrackSwitched=function(e,t){var i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var r=-1,n=this.hls.audioTracks[t.id].groupId,a=0;a<i.audioGroupIds.length;a++)if(i.audioGroupIds[a]===n){r=a;break}r!==i.urlId&&(i.urlId=r,this.startLoad())}},b.loadPlaylist=function(e){var t=this.currentLevelIndex,i=this._levels[t];if(this.canLoad&&i&&i.url.length>0){var r=i.urlId,a=i.url[r];if(e)try{a=e.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Attempt loading level index "+t+(e?" at sn "+e.msn+" part "+e.part:"")+" with URL-id "+r+" "+a),this.clearTimer(),this.hls.trigger(n.Events.LEVEL_LOADING,{url:a,level:t,id:r,deliveryDirectives:e||null})}},b.removeLevel=function(e,t){var i=function(e,i){return i!==t},r=this._levels.filter((function(r,n){return n!==e||r.url.length>1&&void 0!==t&&(r.url=r.url.filter(i),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(i)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(i)),r.urlId=0,!0)})).map((function(e,t){var i=e.details;return null!=i&&i.fragments&&i.fragments.forEach((function(e){e.level=t})),e}));this._levels=r,this.hls.trigger(n.Events.LEVELS_UPDATED,{levels:r})},m=l,(p=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t,i=this._levels;if(0!==i.length&&(this.currentLevelIndex!==e||null===(t=i[e])||void 0===t||!t.details)){if(e<0||e>=i.length){var r=e<0;if(this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:r,reason:"invalid level idx"}),r)return;e=Math.min(e,i.length-1)}this.clearTimer();var o=this.currentLevelIndex,s=i[o],l=i[e];this.log("switching to level "+e+" from "+o),this.currentLevelIndex=e;var d=c({},l,{level:e,maxBitrate:l.maxBitrate,uri:l.uri,urlId:l.urlId});delete d._urlId,this.hls.trigger(n.Events.LEVEL_SWITCHING,d);var u=l.details;if(!u||u.live){var h=this.switchParams(l.uri,null==s?void 0:s.details);this.loadPlaylist(h)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&u(m.prototype,p),Object.defineProperty(m,"prototype",{writable:!1}),l}(l.default)},"./repo/src/controller/level-helper.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"addGroupId",(function(){return a})),i.d(t,"assignTrackIdsByGroup",(function(){return o})),i.d(t,"updatePTS",(function(){return s})),i.d(t,"updateFragPTSDTS",(function(){return d})),i.d(t,"mergeDetails",(function(){return c})),i.d(t,"mapPartIntersection",(function(){return u})),i.d(t,"mapFragmentIntersection",(function(){return h})),i.d(t,"adjustSliding",(function(){return f})),i.d(t,"addSliding",(function(){return m})),i.d(t,"computeReloadInterval",(function(){return p})),i.d(t,"getFragmentWithSN",(function(){return b})),i.d(t,"getPartWith",(function(){return y}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/utils/logger.ts");function a(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function o(e){var t={};e.forEach((function(e){var i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++}))}function s(e,t,i){l(e[t],e[i])}function l(e,t){var i=t.startPTS;if(Object(r.isFiniteNumber)(i)){var n,a=0;t.sn>e.sn?(a=i-e.start,n=e):(a=e.start-i,n=t),n.duration!==a&&(n.duration=a)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function d(e,t,i,a,o,s){a-i<=0&&(n.logger.warn("Fragment should have a positive duration",t),a=i+t.duration,s=o+t.duration);var d=i,c=a,u=t.startPTS,h=t.endPTS;if(Object(r.isFiniteNumber)(u)){var f=Math.abs(u-i);Object(r.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(f,t.deltaPTS):t.deltaPTS=f,d=Math.max(i,u),i=Math.min(i,u),o=Math.min(o,t.startDTS),c=Math.min(a,h),a=Math.max(a,h),s=Math.max(s,t.endDTS)}t.duration=a-i;var m=i-t.start;t.appendedPTS=a,t.start=t.startPTS=i,t.maxStartPTS=d,t.startDTS=o,t.endPTS=a,t.minEndPTS=c,t.endDTS=s;var p,b=t.sn;if(!e||b<e.startSN||b>e.endSN)return 0;var y=b-e.startSN,g=e.fragments;for(g[y]=t,p=y;p>0;p--)l(g[p],g[p-1]);for(p=y;p<g.length-1;p++)l(g[p],g[p+1]);return e.fragmentHint&&l(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,m}function c(e,t){for(var i=null,a=e.fragments,o=a.length-1;o>=0;o--){var s=a[o].initSegment;if(s){i=s;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var l,c=0;if(h(e,t,(function(e,n){e.relurl&&(c=e.cc-n.cc),Object(r.isFiniteNumber)(e.startPTS)&&Object(r.isFiniteNumber)(e.endPTS)&&(n.start=n.startPTS=e.startPTS,n.startDTS=e.startDTS,n.appendedPTS=e.appendedPTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.duration=e.endPTS-e.startPTS,n.duration&&(l=n),t.PTSKnown=t.alignedSliding=!0),n.elementaryStreams=e.elementaryStreams,n.loader=e.loader,n.stats=e.stats,n.urlId=e.urlId,e.initSegment&&(n.initSegment=e.initSegment,i=e.initSegment)})),i&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((function(e){var t;e.initSegment&&e.initSegment.relurl!==(null===(t=i)||void 0===t?void 0:t.relurl)||(e.initSegment=i)})),t.skippedSegments&&(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed)){n.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var m=t.skippedSegments;m--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}var p=t.fragments;if(c){n.logger.warn("discontinuity sliding from playlist, take drift into account");for(var b=0;b<p.length;b++)p[b].cc+=c}t.skippedSegments&&(t.startCC=t.fragments[0].cc),u(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),l?d(t,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS):f(e,t),p.length&&(t.totalduration=t.edge-p[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var y=t.advancedDateTime;if(t.advanced&&y){var g=t.edge;t.driftStart||(t.driftStartTime=y,t.driftStart=g),t.driftEndTime=y,t.driftEnd=g}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function u(e,t,i){if(e&&t)for(var r=0,n=0,a=e.length;n<=a;n++){var o=e[n],s=t[n+r];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?i(o,s):r--}}function h(e,t,i){for(var r=t.skippedSegments,n=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=n;d<=a;d++){var c=l[o+d],u=s[d];r&&!u&&d<r&&(u=t.fragments[d]=c),c&&u&&i(c,u)}}function f(e,t){var i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;i<0||i>=r.length||m(t,r[i].start)}function m(e,t){if(t){for(var i=e.fragments,r=e.skippedSegments;r<i.length;r++)i[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function p(e,t){var i,r=1e3*e.levelTargetDuration,n=r/2,a=e.age,o=a>0&&a<3*r,s=t.loading.end-t.loading.start,l=e.availabilityDelay;if(!1===e.updated)if(o){var d=333*e.misses;i=Math.max(Math.min(n,2*s),d),e.availabilityDelay=(e.availabilityDelay||0)+i}else i=n;else o?(l=Math.min(l||r/2,a),e.availabilityDelay=l,i=l+r-a):i=r-s;return Math.round(i)}function b(e,t,i){if(!e||!e.details)return null;var r=e.details,n=r.fragments[t-r.startSN];return n||((n=r.fragmentHint)&&n.sn===t?n:t<r.startSN&&i&&i.sn===t?i:null)}function y(e,t,i){if(!e||!e.details)return null;var r=e.details.partList;if(r)for(var n=r.length;n--;){var a=r[n];if(a.index===i&&a.fragment.sn===t)return a}return null}},"./repo/src/controller/stream-controller.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return g}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/controller/base-stream-controller.ts"),a=i("./repo/src/is-supported.ts"),o=i("./repo/src/events.ts"),s=i("./repo/src/utils/buffer-helper.ts"),l=i("./repo/src/controller/fragment-tracker.ts"),d=i("./repo/src/types/loader.ts"),c=i("./repo/src/loader/fragment.ts"),u=i("./repo/src/demux/transmuxer-interface.ts"),h=i("./repo/src/types/transmuxer.ts"),f=i("./repo/src/controller/gap-controller.ts"),m=i("./repo/src/errors.ts"),p=i("./repo/src/utils/logger.ts");function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){var t,i;function g(t,i){var r;return(r=e.call(this,t,i,"[stream-controller]")||this).audioCodecSwap=!1,r.gapController=null,r.level=-1,r._forceStartLoad=!1,r.altAudio=!1,r.audioOnly=!1,r.fragPlaying=null,r.onvplaying=null,r.onvseeked=null,r.fragLastKbps=0,r.stalled=!1,r.couldBacktrack=!1,r.audioCodecSwitch=!1,r.videoBuffer=null,r._registerListeners(),r}i=e,(t=g).prototype=Object.create(i.prototype),t.prototype.constructor=t,y(t,i);var v,Z,T=g.prototype;return T._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(o.Events.ERROR,this.onError,this),e.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},T._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(o.Events.ERROR,this.onError,this),e.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},T.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},T.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=i.startLevel;-1===r&&(i.config.testBandwidth?(r=0,this.bitrateTest=!0):r=i.nextAutoLevel),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=n.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=n.State.STOPPED},T.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},T.doTick=function(){switch(this.state){case n.State.IDLE:this.doTickIdle();break;case n.State.WAITING_LEVEL:var e,t=this.levels,i=this.level,r=null==t||null===(e=t[i])||void 0===e?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=n.State.IDLE;break}break;case n.State.FRAG_LOADING_WAITING_RETRY:var a,o=self.performance.now(),s=this.retryDate;(!s||o>=s||null!==(a=this.media)&&void 0!==a&&a.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=n.State.IDLE)}this.onTickEnd()},T.onTickEnd=function(){e.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},T.doTickIdle=function(){var e,t,i=this.hls,r=this.levelLastLoaded,a=this.levels,s=this.media,u=i.config,h=i.nextLoadLevel;if(null!==r&&(s||!this.startFragRequested&&u.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&a&&a[h]){var f=a[h];this.level=i.nextLoadLevel=h;var m=f.details;if(!m||this.state===n.State.WAITING_LEVEL||m.live&&this.levelLastLoaded!==h)this.state=n.State.WAITING_LEVEL;else{var p=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:s,d.PlaylistLevelType.MAIN);if(null!==p&&!(p.len>=this.getMaxBufferLength(f.maxBitrate))){if(this._streamEnded(p,m)){var b={};return this.altAudio&&(b.type="video"),this.hls.trigger(o.Events.BUFFER_EOS,b),void(this.state=n.State.ENDED)}var y=p.end,g=this.getNextFragment(y,m);if(this.couldBacktrack&&!this.fragPrevious&&g&&"initSegment"!==g.sn){var v=g.sn-m.startSN;v>1&&(g=m.fragments[v-1],this.fragmentTracker.removeFragment(g))}if(g&&this.fragmentTracker.getState(g)===l.FragmentState.OK&&this.nextLoadPosition>y){var Z=this.audioOnly&&!this.altAudio?c.ElementaryStreamTypes.AUDIO:c.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(s,Z,d.PlaylistLevelType.MAIN),g=this.getNextFragment(this.nextLoadPosition,m)}g&&(!g.initSegment||g.initSegment.data||this.bitrateTest||(g=g.initSegment),"identity"!==(null===(e=g.decryptdata)||void 0===e?void 0:e.keyFormat)||null!==(t=g.decryptdata)&&void 0!==t&&t.key?this.loadFragment(g,m,y):this.loadKey(g,m))}}}},T.loadFragment=function(t,i,r){var n,a=this.fragmentTracker.getState(t);if(this.fragCurrent=t,a===l.FragmentState.BACKTRACKED){var o=this.fragmentTracker.getBacktrackData(t);if(o)return this._handleFragmentLoadProgress(o),void this._handleFragmentLoadComplete(o);a=l.FragmentState.NOT_LOADED}a===l.FragmentState.NOT_LOADED||a===l.FragmentState.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t):this.bitrateTest?(t.bitrateTest=!0,this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t)):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,i,r)):a===l.FragmentState.APPENDING?this.reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t):0===(null===(n=this.media)||void 0===n?void 0:n.buffered.length)&&this.fragmentTracker.removeAllFragments()},T.getAppendedFrag=function(e){var t=this.fragmentTracker.getAppendedFrag(e,d.PlaylistLevelType.MAIN);return t&&"fragment"in t?t.fragment:t},T.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,d.PlaylistLevelType.MAIN)},T.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},T.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},T.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var i,r=this.getAppendedFrag(t.currentTime);if(r&&r.start>1&&this.flushMainBuffer(0,r.start-1),!t.paused&&e){var n=e[this.hls.nextLoadLevel],a=this.fragLastKbps;i=a&&this.fragCurrent?this.fragCurrent.duration*n.maxBitrate/(1e3*a)+1:0}else i=0;var o=this.getBufferedFrag(t.currentTime+i);if(o){var s=this.followingBufferedFrag(o);if(s){this.abortCurrentFrag();var l=s.maxStartPTS?s.maxStartPTS:s.start,d=s.duration,c=Math.max(o.end,l+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,.5*d),.75*d));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},T.abortCurrentFrag=function(){var e=this.fragCurrent;this.fragCurrent=null,null!=e&&e.loader&&e.loader.abort(),this.state===n.State.KEY_LOADING&&(this.state=n.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},T.flushMainBuffer=function(t,i){e.prototype.flushMainBuffer.call(this,t,i,this.altAudio?"video":null)},T.onMediaAttached=function(t,i){e.prototype.onMediaAttached.call(this,t,i);var r=i.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new f.default(this.config,r,this.fragmentTracker,this.hls)},T.onMediaDetaching=function(){var t=this.media;t&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),e.prototype.onMediaDetaching.call(this)},T.onMediaPlaying=function(){this.tick()},T.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;Object(r.isFiniteNumber)(t)&&this.log("Media seeked to "+t.toFixed(3)),this.tick()},T.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(o.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},T.onManifestParsed=function(e,t){var i,r=!1,n=!1;t.levels.forEach((function(e){(i=e.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(r=!0),-1!==i.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n&&!Object(a.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},T.onLevelLoading=function(e,t){var i=this.levels;if(i&&this.state===n.State.IDLE){var r=i[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=n.State.WAITING_LEVEL)}},T.onLevelLoaded=function(e,t){var i,r=this.levels,a=t.level,s=t.details,l=s.totalduration;if(r){this.log("Level "+a+" loaded ["+s.startSN+","+s.endSN+"], cc ["+s.startCC+", "+s.endCC+"] duration:"+l);var d=this.fragCurrent;!d||this.state!==n.State.FRAG_LOADING&&this.state!==n.State.FRAG_LOADING_WAITING_RETRY||d.level!==t.level&&d.loader&&(this.state=n.State.IDLE,d.loader.abort());var c=r[a],u=0;if(s.live||null!==(i=c.details)&&void 0!==i&&i.live){if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed)return;u=this.alignPlaylists(s,c.details)}if(c.details=s,this.levelLastLoaded=a,this.hls.trigger(o.Events.LEVEL_UPDATED,{details:s,level:a}),this.state===n.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(s))return;this.state=n.State.IDLE}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,u),this.tick()}else this.warn("Levels were reset while loading level "+a)},T._handleFragmentLoadProgress=function(e){var t,i=e.frag,r=e.part,n=e.payload,a=this.levels;if(a){var o=a[i.level],s=o.details;if(s){var l=o.videoCodec,c=s.PTSKnown||!s.live,f=null===(t=i.initSegment)||void 0===t?void 0:t.data,m=this._getAudioCodec(o),p=this.transmuxer=this.transmuxer||new u.default(this.hls,d.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),b=r?r.index:-1,y=-1!==b,g=new h.ChunkMetadata(i.level,i.sn,i.stats.chunkCount,n.byteLength,b,y),v=this.initPTS[i.cc];p.push(n,f,m,l,i,r,s.totalduration,c,g,v)}else this.warn("Dropping fragment "+i.sn+" of level "+i.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+i.sn+" of level "+i.level+" will not be buffered")},T.onAudioTrackSwitching=function(e,t){var i=this.altAudio,r=!!t.url,n=t.id;if(!r){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;null!=a&&a.loader&&(this.log("Switching to main audio track, cancel main fragment load"),a.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var s=this.hls;i&&s.trigger(o.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),s.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:n})}},T.onAudioTrackSwitched=function(e,t){var i=t.id,r=!!this.hls.audioTracks[i].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()},T.onBufferCreated=function(e,t){var i,r,n=t.tracks,a=!1;for(var o in n){var s=n[o];if("main"===s.id){if(r=o,i=s,"video"===o){var l=n[o];l&&(this.videoBuffer=l.buffer)}}else a=!0}a&&i?(this.log("Alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},T.onFragBuffered=function(e,t){var i=t.frag,r=t.part;if(!i||i.type===d.PlaylistLevelType.MAIN){if(this.fragContextChanged(i))return this.warn("Fragment "+i.sn+(r?" p: "+r.index:"")+" of level "+i.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===n.State.PARSED&&(this.state=n.State.IDLE));var a=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}},T.onError=function(e,t){switch(t.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(d.PlaylistLevelType.MAIN,t);break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==n.State.ERROR&&(t.fatal?(this.warn(""+t.details),this.state=n.State.ERROR):t.levelRetry||this.state!==n.State.WAITING_LEVEL||(this.state=n.State.IDLE));break;case m.ErrorDetails.BUFFER_FULL_ERROR:if("main"===t.parent&&(this.state===n.State.PARSING||this.state===n.State.PARSED)){var i=!0,r=this.getFwdBufferInfo(this.media,d.PlaylistLevelType.MAIN);r&&r.len>.5&&(i=!this.reduceMaxBufferLength(r.len)),i&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},T.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){var i=s.BufferHelper.getBuffered(e);!this.loadedmetadata&&i.length?(this.loadedmetadata=!0,this.seekToStartPos()):t.poll(this.lastCurrentTime),this.lastCurrentTime=e.currentTime}},T.onFragLoadEmergencyAborted=function(){this.state=n.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},T.onBufferFlushed=function(e,t){var i=t.type;if(i!==c.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var r=(i===c.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,i,d.PlaylistLevelType.MAIN)}},T.onLevelsUpdated=function(e,t){this.levels=t.levels},T.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},T.seekToStartPos=function(){var e=this.media,t=e.currentTime,i=this.startPosition;if(i>=0&&t<i){if(e.seeking)return void p.logger.log("could not seek to "+i+", already seeking at "+t);var r=s.BufferHelper.getBuffered(e),n=(r.length?r.start(0):0)-i;n>0&&(n<this.config.maxBufferHole||n<this.config.maxFragLookUpTolerance)&&(p.logger.log("adjusting start position by "+n+" to match buffer start"),i+=n,this.startPosition=i),this.log("seek to target start position "+i+" from current time "+t),e.currentTime=i}},T._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},T._loadBitrateTestFrag=function(e){var t=this;this._doFragLoad(e).then((function(i){var r=t.hls;if(i&&!r.nextLoadLevel&&!t.fragContextChanged(e)){t.fragLoadError=0,t.state=n.State.IDLE,t.startFragRequested=!1,t.bitrateTest=!1;var a=e.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),r.trigger(o.Events.FRAG_LOADED,i)}}))},T._handleTransmuxComplete=function(e){var t,i="main",a=this.hls,s=e.remuxResult,l=e.chunkMeta,d=this.getCurrentContext(l);if(!d)return this.warn("The loading context changed while buffering fragment "+l.sn+" of level "+l.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(l.level);var u=d.frag,h=d.part,f=d.level,m=s.video,p=s.text,b=s.id3,y=s.initSegment,g=this.altAudio?void 0:s.audio;if(!this.fragContextChanged(u)){if(this.state=n.State.PARSING,y){y.tracks&&(this._bufferInitSegment(f,y.tracks,u,l),a.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:u,id:i,tracks:y.tracks}));var v=y.initPTS,Z=y.timescale;Object(r.isFiniteNumber)(v)&&(this.initPTS[u.cc]=v,a.trigger(o.Events.INIT_PTS_FOUND,{frag:u,id:i,initPTS:v,timescale:Z}))}if(m&&!1!==s.independent){if(f.details){var T=m.startPTS,L=m.endPTS,S=m.startDTS,x=m.endDTS;if(h)h.elementaryStreams[m.type]={startPTS:T,endPTS:L,startDTS:S,endDTS:x};else if(m.firstKeyFrame&&m.independent&&(this.couldBacktrack=!0),m.dropped&&m.independent){if(this.getLoadPosition()+this.config.maxBufferHole<T)return void this.backtrack(u);u.setElementaryStreamInfo(m.type,u.start,L,u.start,x,!0)}u.setElementaryStreamInfo(m.type,T,L,S,x),this.bufferFragmentData(m,u,h,l)}}else if(!1===s.independent)return void this.backtrack(u);if(g){var k=g.startPTS,I=g.endPTS,X=g.startDTS,R=g.endDTS;h&&(h.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:k,endPTS:I,startDTS:X,endDTS:R}),u.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,k,I,X,R),this.bufferFragmentData(g,u,h,l)}if(null!=b&&null!==(t=b.samples)&&void 0!==t&&t.length){var w={frag:u,id:i,samples:b.samples};a.trigger(o.Events.FRAG_PARSING_METADATA,w)}if(p){var G={frag:u,id:i,samples:p.samples};a.trigger(o.Events.FRAG_PARSING_USERDATA,G)}}},T._bufferInitSegment=function(e,t,i,r){var a=this;if(this.state===n.State.PARSING){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var s=t.audio,l=t.video,d=t.audiovideo;if(s){var c=e.audioCodec,u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==s.metadata.channelCount&&-1===u.indexOf("firefox")&&(c="mp4a.40.5")),-1!==u.indexOf("android")&&"audio/mpeg"!==s.container&&(c="mp4a.40.2",this.log("Android: force audio codec to "+c)),e.audioCodec&&e.audioCodec!==c&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+c+'"'),s.levelCodec=c,s.id="main",this.log("Init audio buffer, container:"+s.container+", codecs[selected/level/parsed]=["+(c||"")+"/"+(e.audioCodec||"")+"/"+s.codec+"]")}l&&(l.levelCodec=e.videoCodec,l.id="main",this.log("Init video buffer, container:"+l.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+l.codec+"]")),d&&this.log("Init audiovideo buffer, container:"+d.container+", codecs[level/parsed]=["+(e.attrs.CODECS||"")+"/"+d.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var n=t[e].initSegment;null!=n&&n.byteLength&&a.hls.trigger(o.Events.BUFFER_APPENDING,{type:e,data:n,frag:i,part:null,chunkMeta:r,parent:i.type})})),this.tick()}},T.backtrack=function(e){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(e);var t=this.fragmentTracker.backtrack(e);this.fragPrevious=null,this.nextLoadPosition=e.start,t?this.resetFragmentLoading(e):this.state=n.State.BACKTRACKING},T.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var i=e.currentTime;if(s.BufferHelper.isBuffered(e,i)?t=this.getAppendedFrag(i):s.BufferHelper.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){var r=this.fragPlaying,n=t.level;r&&t.sn===r.sn&&r.level===n&&t.urlId===r.urlId||(this.hls.trigger(o.Events.FRAG_CHANGED,{frag:t}),r&&r.level===n||this.hls.trigger(o.Events.LEVEL_SWITCHED,{level:n}),this.fragPlaying=t)}}},v=g,(Z=[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getAppendedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;if(e){var t=this.getAppendedFrag(e.currentTime);return this.followingBufferedFrag(t)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&b(v.prototype,Z),Object.defineProperty(v,"prototype",{writable:!1}),g}(n.default)},"./repo/src/demux/aacdemuxer.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/demux/base-audio-demuxer.ts"),n=i("./repo/src/demux/adts.ts"),a=i("./repo/src/utils/logger.ts"),o=i("./repo/src/demux/id3.ts");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,i;function r(t,i){var r;return(r=e.call(this)||this).observer=void 0,r.config=void 0,r.observer=t,r.config=i,r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,s(t,i);var l=r.prototype;return l.resetInitSegment=function(t,i,r,n){e.prototype.resetInitSegment.call(this,t,i,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:i,duration:n,inputTimeScale:9e4,dropped:0}},r.probe=function(e){if(!e)return!1;for(var t=(o.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(n.probe(e,t))return a.logger.log("ADTS sync word found !"),!0;return!1},l.canParse=function(e,t){return n.canParse(e,t)},l.appendFrame=function(e,t,i){n.initTrackConfig(e,this.observer,t,i,e.manifestCodec);var r=n.appendFrame(e,t,i,this.initPTS,this.frameIndex);if(r&&0===r.missing)return r},r}(r.default);l.minProbeByteLength=9,t.default=l},"./repo/src/demux/adts.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"getAudioConfig",(function(){return o})),i.d(t,"isHeaderPattern",(function(){return s})),i.d(t,"getHeaderLength",(function(){return l})),i.d(t,"getFullFrameLength",(function(){return d})),i.d(t,"canGetFrameLength",(function(){return c})),i.d(t,"isHeader",(function(){return u})),i.d(t,"canParse",(function(){return h})),i.d(t,"probe",(function(){return f})),i.d(t,"initTrackConfig",(function(){return m})),i.d(t,"getFrameDuration",(function(){return p})),i.d(t,"parseFrameHeader",(function(){return b})),i.d(t,"appendFrame",(function(){return y}));var r=i("./repo/src/utils/logger.ts"),n=i("./repo/src/errors.ts"),a=i("./repo/src/events.ts");function o(e,t,i,o){var s,l,d,c,u=navigator.userAgent.toLowerCase(),h=o,f=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=1+((192&t[i+2])>>>6);var m=(60&t[i+2])>>>2;if(!(m>f.length-1))return d=(1&t[i+2])<<2,d|=(192&t[i+3])>>>6,r.logger.log("manifest codec:"+o+", ADTS type:"+s+", samplingIndex:"+m),/firefox/i.test(u)?m>=6?(s=5,c=new Array(4),l=m-3):(s=2,c=new Array(2),l=m):-1!==u.indexOf("android")?(s=2,c=new Array(2),l=m):(s=5,c=new Array(4),o&&(-1!==o.indexOf("mp4a.40.29")||-1!==o.indexOf("mp4a.40.5"))||!o&&m>=6?l=m-3:((o&&-1!==o.indexOf("mp4a.40.2")&&(m>=6&&1===d||/vivaldi/i.test(u))||!o&&1===d)&&(s=2,c=new Array(2)),l=m)),c[0]=s<<3,c[0]|=(14&m)>>1,c[1]|=(1&m)<<7,c[1]|=d<<3,5===s&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:f[m],channelCount:d,codec:"mp4a.40."+s,manifestCodec:h};e.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+m})}function s(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function c(e,t){return t+5<e.length}function u(e,t){return t+1<e.length&&s(e,t)}function h(e,t){return c(e,t)&&s(e,t)&&d(e,t)<=e.length-t}function f(e,t){if(u(e,t)){var i=l(e,t);if(t+i>=e.length)return!1;var r=d(e,t);if(r<=i)return!1;var n=t+r;return n===e.length||u(e,n)}return!1}function m(e,t,i,n,a){if(!e.samplerate){var s=o(t,i,n,a);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,r.logger.log("parsed codec:"+e.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function p(e){return 9216e4/e}function b(e,t,i,r,n){var a=l(e,t),o=d(e,t);if((o-=a)>0)return{headerLength:a,frameLength:o,stamp:i+r*n}}function y(e,t,i,r,n){var a=b(t,i,r,n,p(e.samplerate));if(a){var o,s=a.frameLength,l=a.headerLength,d=a.stamp,c=l+s,u=Math.max(0,i+c-t.length);u?(o=new Uint8Array(c-l)).set(t.subarray(i+l,t.length),0):o=t.subarray(i+l,i+c);var h={unit:o,pts:d};return u||e.samples.push(h),{sample:h,length:c,missing:u}}}},"./repo/src/demux/base-audio-demuxer.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"initPTSFn",(function(){return d}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/demux/id3.ts"),a=i("./repo/src/demux/dummy-demuxed-track.ts"),o=i("./repo/src/utils/mp4-tools.ts"),s=i("./repo/src/utils/typed-array.ts"),l=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(){},t.resetContiguity=function(){},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,i){},t.demux=function(e,t){this.cachedData&&(e=Object(o.appendUint8Array)(this.cachedData,e),this.cachedData=null);var i,r,l=n.getID3Data(e,0),c=l?l.length:0,u=this._audioTrack,h=this._id3Track,f=l?n.getTimeStamp(l):void 0,m=e.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=d(f,t)),l&&l.length>0&&h.samples.push({pts:this.initPTS,dts:this.initPTS,data:l}),r=this.initPTS;c<m;){if(this.canParse(e,c)){var p=this.appendFrame(u,e,c);p?(this.frameIndex++,r=p.sample.pts,i=c+=p.length):c=m}else n.canParse(e,c)?(l=n.getID3Data(e,c),h.samples.push({pts:r,dts:r,data:l}),i=c+=l.length):c++;if(c===m&&i!==m){var b=Object(s.sliceUint8)(e,i);this.cachedData?this.cachedData=Object(o.appendUint8Array)(this.cachedData,b):this.cachedData=b}}return{audioTrack:u,videoTrack:Object(a.dummyTrack)(),id3Track:h,textTrack:Object(a.dummyTrack)()}},t.demuxSampleAes=function(e,t,i){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),this.frameIndex=0,{audioTrack:this._audioTrack,videoTrack:Object(a.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(a.dummyTrack)()}},t.destroy=function(){},e}(),d=function(e,t){return Object(r.isFiniteNumber)(e)?90*e:9e4*t};t.default=l},"./repo/src/demux/chunk-cache.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return r}));var r=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,i=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var i=new Uint8Array(t),r=0,n=0;n<e.length;n++){var a=e[n];i.set(a,r),r+=a.length}return i}(t,i),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}()},"./repo/src/demux/dummy-demuxed-track.ts":function(e,t,i){"use strict";function r(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}i.r(t),i.d(t,"dummyTrack",(function(){return r}))},"./repo/src/demux/exp-golomb.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/utils/logger.ts"),n=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");r.set(e.subarray(i,i+n)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,i=8,r=0;r<e;r++)0!==i&&(i=(t+this.readEG()+256)%256),t=0===i?t:i},t.readSPS=function(){var e,t,i,r=0,n=0,a=0,o=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),d=this.readUEG.bind(this),c=this.readBoolean.bind(this),u=this.skipBits.bind(this),h=this.skipEG.bind(this),f=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);s();var p=s();if(l(5),u(3),s(),f(),100===p||110===p||122===p||244===p||44===p||83===p||86===p||118===p||128===p){var b=d();if(3===b&&u(1),f(),f(),u(1),c())for(t=3!==b?8:12,i=0;i<t;i++)c()&&m(i<6?16:64)}f();var y=d();if(0===y)d();else if(1===y)for(u(1),h(),h(),e=d(),i=0;i<e;i++)h();f(),u(1);var g=d(),v=d(),Z=l(1);0===Z&&u(1),u(1),c()&&(r=d(),n=d(),a=d(),o=d());var T=[1,1];if(c()&&c())switch(s()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(g+1)-2*r-2*n),height:(2-Z)*(v+1)*16-(Z?2:4)*(a+o),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=n},"./repo/src/demux/id3.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"isHeader",(function(){return n})),i.d(t,"isFooter",(function(){return a})),i.d(t,"getID3Data",(function(){return o})),i.d(t,"canParse",(function(){return l})),i.d(t,"getTimeStamp",(function(){return d})),i.d(t,"isTimeStampFrame",(function(){return c})),i.d(t,"getID3Frames",(function(){return h})),i.d(t,"decodeFrame",(function(){return f})),i.d(t,"utf8ArrayToStr",(function(){return g})),i.d(t,"testables",(function(){return v}));var r,n=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},a=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o=function(e,t){for(var i=t,r=0;n(e,t);)r+=10,r+=s(e,t+6),a(e,t+10)&&(r+=10),t+=r;if(r>0)return e.subarray(i,i+r)},s=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},l=function(e,t){return n(e,t)&&s(e,t+6)+10<=e.length-t},d=function(e){for(var t=h(e),i=0;i<t.length;i++){var r=t[i];if(c(r))return y(r)}},c=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},u=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=s(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}},h=function(e){for(var t=0,i=[];n(e,t);){for(var r=s(e,t+6),o=(t+=10)+r;t+8<o;){var l=u(e.subarray(t)),d=f(l);d&&i.push(d),t+=l.size+10}a(e,t)&&(t+=10)}return i},f=function(e){return"PRIV"===e.type?m(e):"W"===e.type[0]?b(e):p(e)},m=function(e){if(!(e.size<2)){var t=g(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}}},p=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,i=g(e.data.subarray(t),!0);t+=i.length+1;var r=g(e.data.subarray(t));return{key:e.type,info:i,data:r}}var n=g(e.data.subarray(1));return{key:e.type,data:n}}},b=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,i=g(e.data.subarray(t),!0);t+=i.length+1;var r=g(e.data.subarray(t));return{key:e.type,info:i,data:r}}var n=g(e.data);return{key:e.type,data:n}},y=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,i&&(r+=47721858.84),Math.round(r)}},g=function(e,t){void 0===t&&(t=!1);var i=Z();if(i){var r=i.decode(e);if(t){var n=r.indexOf("\0");return-1!==n?r.substring(0,n):r}return r.replace(/\0/g,"")}for(var a,o,s,l=e.length,d="",c=0;c<l;){if(0===(a=e[c++])&&t)return d;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(a);break;case 12:case 13:o=e[c++],d+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[c++],s=e[c++],d+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&s)<<0)}}return d},v={decodeTextFrame:p};function Z(){return r||void 0===self.TextDecoder||(r=new self.TextDecoder("utf-8")),r}},"./repo/src/demux/mp3demuxer.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/demux/base-audio-demuxer.ts"),n=i("./repo/src/demux/id3.ts"),a=i("./repo/src/utils/logger.ts"),o=i("./repo/src/demux/mpegaudio.ts");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,i;function r(){return e.apply(this,arguments)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,s(t,i);var l=r.prototype;return l.resetInitSegment=function(t,i,r,n){e.prototype.resetInitSegment.call(this,t,i,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:i,duration:n,inputTimeScale:9e4,dropped:0}},r.probe=function(e){if(!e)return!1;for(var t=(n.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(o.probe(e,t))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},l.canParse=function(e,t){return o.canParse(e,t)},l.appendFrame=function(e,t,i){if(null!==this.initPTS)return o.appendFrame(e,t,i,this.initPTS,this.frameIndex)},r}(r.default);l.minProbeByteLength=4,t.default=l},"./repo/src/demux/mp4demuxer.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/utils/mp4-tools.ts"),a=i("./repo/src/demux/dummy-demuxed-track.ts"),o=/\/emsg[-/]ID3/i,s=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,i,r){var o=Object(n.parseInitSegment)(e),s=this.videoTrack=Object(a.dummyTrack)("video",1),l=this.audioTrack=Object(a.dummyTrack)("audio",1),d=this.txtTrack=Object(a.dummyTrack)("text",1);if(this.id3Track=Object(a.dummyTrack)("id3",1),this.timeOffset=0,o.video){var c=o.video,u=c.id,h=c.timescale,f=c.codec;s.id=u,s.timescale=d.timescale=h,s.codec=f}if(o.audio){var m=o.audio,p=m.id,b=m.timescale,y=m.codec;l.id=p,l.timescale=b,l.codec=y}d.id=n.RemuxerTrackIdConfig.text,s.sampleDuration=0,s.duration=l.duration=r},t.resetContiguity=function(){},e.probe=function(e){return e=e.length>16384?e.subarray(0,16384):e,Object(n.findBox)(e,["moof"]).length>0},t.demux=function(e,t){this.timeOffset=t;var i=e,r=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Object(n.appendUint8Array)(this.remainderData,e));var o=Object(n.segmentValidRange)(i);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=i;var s=this.extractID3Track(r,t);return a.samples=Object(n.parseSamples)(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var r=this.extractID3Track(t,this.timeOffset);return i.samples=Object(n.parseSamples)(e,t),{videoTrack:t,audioTrack:Object(a.dummyTrack)(),id3Track:r,textTrack:Object(a.dummyTrack)()}},t.extractID3Track=function(e,t){var i=this.id3Track;if(e.samples.length){var a=Object(n.findBox)(e.samples,["emsg"]);a&&a.forEach((function(e){var a=Object(n.parseEmsg)(e);if(o.test(a.schemeIdUri)){var s=Object(r.isFiniteNumber)(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale,l=a.payload;i.samples.push({data:l,len:l.byteLength,dts:s,pts:s})}}))}return i},t.demuxSampleAes=function(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}();s.minProbeByteLength=1024,t.default=s},"./repo/src/demux/mpegaudio.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"appendFrame",(function(){return l})),i.d(t,"parseHeader",(function(){return d})),i.d(t,"isHeaderPattern",(function(){return c})),i.d(t,"isHeader",(function(){return u})),i.d(t,"canParse",(function(){return h})),i.d(t,"probe",(function(){return f}));var r=null,n=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],a=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],o=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],s=[0,1,1,4];function l(e,t,i,r,n){if(!(i+24>t.length)){var a=d(t,i);if(a&&i+a.frameLength<=t.length){var o=r+n*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(i,i+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),{sample:s,length:a.frameLength,missing:0}}}}function d(e,t){var i=e[t+1]>>3&3,l=e[t+1]>>1&3,d=e[t+2]>>4&15,c=e[t+2]>>2&3;if(1!==i&&0!==d&&15!==d&&3!==c){var u=e[t+2]>>1&1,h=e[t+3]>>6,f=1e3*n[14*(3===i?3-l:3===l?3:4)+d-1],m=a[3*(3===i?0:2===i?1:2)+c],p=3===h?1:2,b=o[i][l],y=s[l],g=8*b*y,v=Math.floor(b*f/m+u)*y;if(null===r){var Z=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);r=Z?parseInt(Z[1]):0}return!!r&&r<=87&&2===l&&f>=224e3&&0===h&&(e[t+3]=128|e[t+3]),{sampleRate:m,channelCount:p,frameLength:v,samplesPerFrame:g}}}function c(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function u(e,t){return t+1<e.length&&c(e,t)}function h(e,t){return c(e,t)&&4<=e.length-t}function f(e,t){if(t+1<e.length&&c(e,t)){var i=d(e,t),r=4;null!=i&&i.frameLength&&(r=i.frameLength);var n=t+r;return n===e.length||u(e,n)}return!1}},"./repo/src/demux/sample-aes.ts":function(e,t,i){"use strict";i.r(t);var r=i("../crypt/dist/jsvmp.js"),n=i.n(r),a=i("./repo/src/demux/tsdemuxer.ts"),o=function(){function e(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new n.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,t)},t.decryptAacSample=function(e,t,i,r){var n=e[t].unit;if(!(n.length<=16)){var a=n.subarray(16,n.length-n.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,(function(a){var o=new Uint8Array(a);n.set(o,16),r||s.decryptAacSamples(e,t+1,i)}))}},t.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),r=0,n=32;n<e.length-16;n+=160,r+=16)i.set(e.subarray(n,n+16),r);return i},t.getAvcDecryptedUnit=function(e,t){for(var i=new Uint8Array(t),r=0,n=32;n<e.length-16;n+=160,r+=16)e.set(i.subarray(r,r+16),n);return e},t.decryptAvcSample=function(e,t,i,r,n,o){var s=Object(a.discardEPB)(n.data),l=this.getAvcEncryptedData(s),d=this;this.decryptBuffer(l.buffer,(function(a){n.data=d.getAvcDecryptedUnit(s,a),o||d.decryptAvcSamples(e,t,i+1,r)}))},t.decryptAvcSamples=function(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length)return void r();for(var n=e[t].units;!(i>=n.length);i++){var a=n[i];if(!(a.data.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,r,a,o),!o)return}}}},e}();t.default=o},"./repo/src/demux/transmuxer-interface.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return u}));var r=i("./node_modules/webworkify-webpack/index.js"),n=i("./repo/src/events.ts"),a=i("./repo/src/demux/transmuxer.ts"),o=i("./repo/src/utils/logger.ts"),s=i("./repo/src/errors.ts"),l=i("./repo/src/utils/mediasource-helper.ts"),d=i("./node_modules/eventemitter3/index.js"),c=Object(l.getMediaSource)()||{isTypeSupported:function(){return!1}},u=function(){function e(e,t,i,l){var u=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=e,this.id=t,this.onTransmuxComplete=i,this.onFlush=l;var h=e.config,f=function(t,i){(i=i||{}).frag=u.frag,i.id=u.id,e.trigger(t,i)};this.observer=new d.EventEmitter,this.observer.on(n.Events.FRAG_DECRYPTED,f),this.observer.on(n.Events.ERROR,f);var m={mp4:c.isTypeSupported("video/mp4"),mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(h.enableWorker&&"undefined"!=typeof Worker){var b;o.logger.log("demuxing in webworker");try{b=this.worker=r("./repo/src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),b.addEventListener("message",this.onwmsg),b.onerror=function(t){e.trigger(n.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(t.message+"  ("+t.filename+":"+t.lineno+")")})},b.postMessage({cmd:"init",typeSupported:m,vendor:p,id:t,config:JSON.stringify(h)})}catch(e){o.logger.warn("Error in worker:",e),o.logger.error("Error while initializing DemuxerWorker, fallback to inline"),b&&self.URL.revokeObjectURL(b.objectURL),this.transmuxer=new a.default(this.observer,m,h,p,t),this.worker=null}}else this.transmuxer=new a.default(this.observer,m,h,p,t)}var t=e.prototype;return t.destroy=function(){var e=this.worker;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.worker=null;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var i=this.observer;i&&i.removeAllListeners(),this.observer=null},t.push=function(e,t,i,r,n,s,l,d,c,u){var h,f,m=this;c.transmuxing.start=self.performance.now();var p=this.transmuxer,b=this.worker,y=s?s.start:n.start,g=n.decryptdata,v=this.frag,Z=!(v&&n.cc===v.cc),T=!(v&&c.level===v.level),L=v?c.sn-v.sn:-1,S=this.part?c.part-this.part.index:1,x=!T&&(1===L||0===L&&1===S),k=self.performance.now();(T||L||0===n.stats.parsing.start)&&(n.stats.parsing.start=k),!s||!S&&x||(s.stats.parsing.start=k);var I=!(v&&(null===(h=n.initSegment)||void 0===h?void 0:h.url)===(null===(f=v.initSegment)||void 0===f?void 0:f.url)),X=new a.TransmuxState(Z,x,d,T,y,I);if(!x||Z||I){o.logger.log("[transmuxer-interface, "+n.type+"]: Starting new transmux session for sn: "+c.sn+" p: "+c.part+" level: "+c.level+" id: "+c.id+"\n        discontinuity: "+Z+"\n        trackSwitch: "+T+"\n        contiguous: "+x+"\n        accurateTimeOffset: "+d+"\n        timeOffset: "+y+"\n        initSegmentChange: "+I);var R=new a.TransmuxConfig(i,r,t,l,u);this.configureTransmuxer(R)}if(this.frag=n,this.part=s,b)b.postMessage({cmd:"demux",data:e,decryptdata:g,chunkMeta:c,state:X},e instanceof ArrayBuffer?[e]:[]);else if(p){var w=p.push(e,g,c,X);Object(a.isPromise)(w)?w.then((function(e){m.handleTransmuxComplete(e)})):this.handleTransmuxComplete(w)}},t.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var i=this.transmuxer,r=this.worker;if(r)r.postMessage({cmd:"flush",chunkMeta:e});else if(i){var n=i.flush(e);Object(a.isPromise)(n)?n.then((function(i){t.handleFlushResult(i,e)})):this.handleFlushResult(n,e)}},t.handleFlushResult=function(e,t){var i=this;e.forEach((function(e){i.handleTransmuxComplete(e)})),this.onFlush(t)},t.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},t.configureTransmuxer=function(e){var t=this.worker,i=this.transmuxer;t?t.postMessage({cmd:"configure",config:e}):i&&i.configure(e)},t.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}()},"./repo/src/demux/transmuxer-worker.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return s}));var r=i("./repo/src/demux/transmuxer.ts"),n=i("./repo/src/events.ts"),a=i("./repo/src/utils/logger.ts"),o=i("./node_modules/eventemitter3/index.js");function s(e){var t=new o.EventEmitter,i=function(t,i){e.postMessage({event:t,data:i})};t.on(n.Events.FRAG_DECRYPTED,i),t.on(n.Events.ERROR,i),e.addEventListener("message",(function(n){var o=n.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.transmuxer=new r.default(t,o.typeSupported,s,o.vendor,o.id),Object(a.enableLogs)(s.debug),i("init",null);break;case"configure":e.transmuxer.configure(o.config);break;case"demux":var d=e.transmuxer.push(o.data,o.decryptdata,o.chunkMeta,o.state);Object(r.isPromise)(d)?d.then((function(t){l(e,t)})):l(e,d);break;case"flush":var u=o.chunkMeta,h=e.transmuxer.flush(u);Object(r.isPromise)(h)?h.then((function(t){c(e,t,u)})):c(e,h,u)}}))}function l(e,t){if((i=t.remuxResult).audio||i.video||i.text||i.id3||i.initSegment){var i,r=[],n=t.remuxResult,a=n.audio,o=n.video;a&&d(r,a),o&&d(r,o),e.postMessage({event:"transmuxComplete",data:t},r)}}function d(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function c(e,t,i){t.forEach((function(t){l(e,t)})),e.postMessage({event:"flush",data:i})}},"./repo/src/demux/transmuxer.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return v})),i.d(t,"isPromise",(function(){return T})),i.d(t,"TransmuxConfig",(function(){return L})),i.d(t,"TransmuxState",(function(){return S}));var r,n=i("./repo/src/events.ts"),a=i("./repo/src/errors.ts"),o=i("../crypt/dist/jsvmp.js"),s=i.n(o),l=i("./repo/src/demux/aacdemuxer.ts"),d=i("./repo/src/demux/mp4demuxer.ts"),c=i("./repo/src/demux/tsdemuxer.ts"),u=i("./repo/src/demux/mp3demuxer.ts"),h=i("./repo/src/remux/mp4-remuxer.ts"),f=i("./repo/src/remux/passthrough-remuxer.ts"),m=i("./repo/src/demux/chunk-cache.ts"),p=i("./repo/src/utils/mp4-tools.ts"),b=i("./repo/src/utils/logger.ts");try{r=self.performance.now.bind(self.performance)}catch(e){b.logger.debug("Unable to use Performance API on this environment"),r=self.Date.now}var y=[{demux:c.default,remux:h.default},{demux:d.default,remux:f.default},{demux:l.default,remux:h.default},{demux:u.default,remux:h.default}],g=1024;y.forEach((function(e){var t=e.demux;g=Math.max(g,t.minProbeByteLength)}));var v=function(){function e(e,t,i,r,n){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new m.default,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r,this.id=n}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,i,n){var a=this,o=i.transmuxing;o.executeStart=r();var s=new Uint8Array(e),l=this.cache,d=this.config,c=this.currentTransmuxState,u=this.transmuxConfig;n&&(this.currentTransmuxState=n);var h=function(e,t){var i=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(i=t),i}(s,t);if(h&&"AES-128"===h.method){var f=this.getDecrypter();if(!d.enableSoftwareAES)return this.decryptionPromise=f.webCryptoDecrypt(s,h.key.buffer,h.iv.buffer).then((function(e){var t=a.push(e,null,i);return a.decryptionPromise=null,t})),this.decryptionPromise;var m=f.softwareDecrypt(s,h.key.buffer,h.iv.buffer);if(!m)return o.executeEnd=r(),Z(i);s=new Uint8Array(m)}var b=n||c,y=b.contiguous,g=b.discontinuity,v=b.trackSwitch,T=b.accurateTimeOffset,L=b.timeOffset,S=b.initSegmentChange,x=u.audioCodec,k=u.videoCodec,I=u.defaultInitPts,X=u.duration,R=u.initSegmentData;if((g||v||S)&&this.resetInitSegment(R,x,k,X),(g||S)&&this.resetInitialTimestamp(I),y||this.resetContiguity(),this.needsProbing(s,g,v)){if(l.dataLength){var w=l.flush();s=Object(p.appendUint8Array)(w,s)}this.configureTransmuxer(s,u)}var G=this.transmux(s,h,L,T,i),W=this.currentTransmuxState;return W.contiguous=!0,W.discontinuity=!1,W.trackSwitch=!1,o.executeEnd=r(),G},t.flush=function(e){var t=this,i=e.transmuxing;i.executeStart=r();var o=this.decrypter,s=this.cache,l=this.currentTransmuxState,d=this.decryptionPromise;if(d)return d.then((function(){return t.flush(e)}));var c=[],u=l.timeOffset;if(o){var h=o.flush();h&&c.push(this.push(h,null,e))}var f=s.dataLength;s.reset();var m=this.demuxer,p=this.remuxer;if(!m||!p)return f>=g&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),i.executeEnd=r(),[Z(e)];var b=m.flush(u);return T(b)?b.then((function(i){return t.flushRemux(c,i,e),c})):(this.flushRemux(c,b,e),c)},t.flushRemux=function(e,t,i){var n=t.audioTrack,a=t.videoTrack,o=t.id3Track,s=t.textTrack,l=this.currentTransmuxState,d=l.accurateTimeOffset,c=l.timeOffset;b.logger.log("[transmuxer.ts]: Flushed fragment "+i.sn+(i.part>-1?" p: "+i.part:"")+" of level "+i.level);var u=this.remuxer.remux(n,a,o,s,c,d,!0,this.id);e.push({remuxResult:u,chunkMeta:i}),i.transmuxing.executeEnd=r()},t.resetInitialTimestamp=function(e){var t=this.demuxer,i=this.remuxer;t&&i&&(t.resetTimeStamp(e),i.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,i,r){var n=this.demuxer,a=this.remuxer;n&&a&&(n.resetInitSegment(e,t,i,r),a.resetInitSegment(e,t,i))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,i,r,n){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,i,r,n):this.transmuxUnencrypted(e,i,r,n)},t.transmuxUnencrypted=function(e,t,i,r){var n=this.demuxer.demux(e,t,!1,!this.config.progressive),a=n.audioTrack,o=n.videoTrack,s=n.id3Track,l=n.textTrack;return{remuxResult:this.remuxer.remux(a,o,s,l,t,i,!1,this.id),chunkMeta:r}},t.transmuxSampleAes=function(e,t,i,r,n){var a=this;return this.demuxer.demuxSampleAes(e,t,i).then((function(e){return{remuxResult:a.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,i,r,!1,a.id),chunkMeta:n}}))},t.configureTransmuxer=function(e,t){for(var i,r=this.config,n=this.observer,a=this.typeSupported,o=this.vendor,s=t.audioCodec,l=t.defaultInitPts,c=t.duration,u=t.initSegmentData,h=t.videoCodec,m=0,p=y.length;m<p;m++)if(y[m].demux.probe(e)){i=y[m];break}i||(b.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),i={demux:d.default,remux:f.default});var g=this.demuxer,v=this.remuxer,Z=i.remux,T=i.demux;v&&v instanceof Z||(this.remuxer=new Z(n,r,a,o)),g&&g instanceof T||(this.demuxer=new T(n,r,a),this.probe=T.probe),this.resetInitSegment(u,s,h,c),this.resetInitialTimestamp(l)},t.needsProbing=function(e,t,i){return!this.demuxer||!this.remuxer||t||i},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new s.a(this.observer,this.config)),e},e}(),Z=function(e){return{remuxResult:{},chunkMeta:e}};function T(e){return"then"in e&&e.then instanceof Function}var L=function(e,t,i,r,n){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=n},S=function(e,t,i,r,n,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=n,this.initSegmentChange=a}},"./repo/src/demux/tsdemuxer.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"discardEPB",(function(){return y}));var r=i("./repo/src/demux/adts.ts"),n=i("./repo/src/demux/mpegaudio.ts"),a=i("./repo/src/demux/exp-golomb.ts"),o=i("./repo/src/demux/sample-aes.ts"),s=i("./repo/src/events.ts"),l=i("./repo/src/utils/mp4-tools.ts"),d=i("./repo/src/utils/logger.ts"),c=i("./repo/src/errors.ts"),u=function(){function e(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=i}e.probe=function(t){var i=e.syncOffset(t);return!(i<0||(i&&d.logger.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e.syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:l.RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,i,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video"),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=r,this._duration=n},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._avcTrack,i=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null},t.demux=function(t,i,r,n){var a;void 0===r&&(r=!1),void 0===n&&(n=!1),r||(this.sampleAes=null);var o=this._avcTrack,u=this._audioTrack,h=this._id3Track,b=this._txtTrack,y=o.pid,g=o.pesData,v=u.pid,Z=h.pid,T=u.pesData,L=h.pesData,S=!1,x=this.pmtParsed,k=this._pmtId,I=t.length;if(this.remainderData&&(I=(t=Object(l.appendUint8Array)(this.remainderData,t)).length,this.remainderData=null),I<188&&!n)return this.remainderData=t,{audioTrack:u,videoTrack:o,id3Track:h,textTrack:b};var X=Math.max(0,e.syncOffset(t));(I-=(I+X)%188)<t.byteLength&&!n&&(this.remainderData=new Uint8Array(t.buffer,I,t.buffer.byteLength-I));for(var R=0,w=X;w<I;w+=188)if(71===t[w]){var G=!!(64&t[w+1]),W=((31&t[w+1])<<8)+t[w+2],E=void 0;if((48&t[w+3])>>4>1){if((E=w+5+t[w+4])===w+188)continue}else E=w+4;switch(W){case y:G&&(g&&(a=p(g))&&this.parseAVCPES(o,b,a,!1),g={data:[],size:0}),g&&(g.data.push(t.subarray(E,w+188)),g.size+=w+188-E);break;case v:G&&(T&&(a=p(T))&&(u.isAAC?this.parseAACPES(u,a):this.parseMPEGPES(u,a)),T={data:[],size:0}),T&&(T.data.push(t.subarray(E,w+188)),T.size+=w+188-E);break;case Z:G&&(L&&(a=p(L))&&this.parseID3PES(h,a),L={data:[],size:0}),L&&(L.data.push(t.subarray(E,w+188)),L.size+=w+188-E);break;case 0:G&&(E+=t[E]+1),k=this._pmtId=f(t,E);break;case k:G&&(E+=t[E]+1);var _=m(t,E,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,r);(y=_.avc)>0&&(o.pid=y),(v=_.audio)>0&&(u.pid=v,u.isAAC=_.isAAC),(Z=_.id3)>0&&(h.pid=Z),S&&!x&&(d.logger.log("reparse from beginning"),S=!1,w=X-188),x=this.pmtParsed=!0;break;case 17:case 8191:break;default:S=!0}}else R++;R>0&&this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+R+" TS packet/s that do not start with 0x47"}),o.pesData=g,u.pesData=T,h.pesData=L;var C={audioTrack:u,videoTrack:o,id3Track:h,textTrack:b};return n&&this.extractRemainingSamples(C),C},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,i=e.audioTrack,r=e.videoTrack,n=e.id3Track,a=e.textTrack,o=r.pesData,s=i.pesData,l=n.pesData;o&&(t=p(o))?(this.parseAVCPES(r,a,t,!0),r.pesData=null):r.pesData=o,s&&(t=p(s))?(i.isAAC?this.parseAACPES(i,t):this.parseMPEGPES(i,t),i.pesData=null):(null!=s&&s.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),i.pesData=s),l&&(t=p(l))?(this.parseID3PES(n,t),n.pesData=null):n.pesData=l},t.demuxSampleAes=function(e,t,i){var r=this.demux(e,i,!0,!this.config.progressive),n=this.sampleAes=new o.default(this.observer,this.config,t);return this.decrypt(r,n)},t.decrypt=function(e,t){return new Promise((function(i){var r=e.audioTrack,n=e.videoTrack;r.samples&&r.isAAC?t.decryptAacSamples(r.samples,0,(function(){n.samples?t.decryptAvcSamples(n.samples,0,0,(function(){i(e)})):i(e)})):n.samples&&t.decryptAvcSamples(n.samples,0,0,(function(){i(e)}))}))},t.destroy=function(){this._duration=0},t.parseAVCPES=function(e,t,i,r){var n,o=this,s=this.parseAVCNALu(e,i.data),d=this.avcSample,c=!1;i.data=null,d&&s.length&&!e.audFound&&(b(d,e),d=this.avcSample=h(!1,i.pts,i.dts,"")),s.forEach((function(r){switch(r.type){case 1:n=!0,d||(d=o.avcSample=h(!0,i.pts,i.dts,"")),d.frame=!0;var s=r.data;if(c&&s.length>4){var u=new a.default(s).readSliceType();2!==u&&4!==u&&7!==u&&9!==u||(d.key=!0)}break;case 5:n=!0,d||(d=o.avcSample=h(!0,i.pts,i.dts,"")),d.key=!0,d.frame=!0;break;case 6:n=!0,Object(l.parseSEIMessageFromNALu)(y(r.data),i.pts,t.samples);break;case 7:if(n=!0,c=!0,!e.sps){var f=new a.default(r.data).readSPS();e.width=f.width,e.height=f.height,e.pixelRatio=f.pixelRatio,e.sps=[r.data],e.duration=o._duration;for(var m=r.data.subarray(1,4),p="avc1.",g=0;g<3;g++){var v=m[g].toString(16);v.length<2&&(v="0"+v),p+=v}e.codec=p}break;case 8:n=!0,e.pps||(e.pps=[r.data]);break;case 9:n=!1,e.audFound=!0,d&&b(d,e),d=o.avcSample=h(!1,i.pts,i.dts,"");break;case 12:n=!1;break;default:n=!1,d&&(d.debug+="unknown NAL "+r.type+" ")}d&&n&&d.units.push(r)})),r&&d&&(b(d,e),this.avcSample=null)},t.getLastNalUnit=function(e){var t,i,r=this.avcSample;if(r&&0!==r.units.length||(r=e[e.length-1]),null!==(t=r)&&void 0!==t&&t.units){var n=r.units;i=n[n.length-1]}return i},t.parseAVCNALu=function(e,t){var i,r,n=t.byteLength,a=e.naluState||0,o=a,s=[],l=0,d=-1,c=0;for(-1===a&&(d=0,c=31&t[0],a=0,l=1);l<n;)if(i=t[l++],a)if(1!==a)if(i)if(1===i){if(d>=0){var u={data:t.subarray(d,l-a-1),type:c};s.push(u)}else{var h=this.getLastNalUnit(e.samples);if(h&&(o&&l<=4-o&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-o)),(r=l-a-1)>0)){var f=new Uint8Array(h.data.byteLength+r);f.set(h.data,0),f.set(t.subarray(0,r),h.data.byteLength),h.data=f,h.state=0}}l<n?(d=l,c=31&t[l],a=0):a=-1}else a=0;else a=3;else a=i?0:2;else a=i?0:1;if(d>=0&&a>=0){var m={data:t.subarray(d,n),type:c,state:a};s.push(m)}if(0===s.length){var p=this.getLastNalUnit(e.samples);if(p){var b=new Uint8Array(p.data.byteLength+t.byteLength);b.set(p.data,0),b.set(t,p.data.byteLength),p.data=b}}return e.naluState=a,s},t.parseAACPES=function(e,t){var i,n,a,o,l,u=0,h=this.aacOverFlow,f=t.data;if(h){this.aacOverFlow=null;var m=h.sample.unit.byteLength,p=Math.min(h.missing,m),b=m-p;h.sample.unit.set(f.subarray(0,p),b),e.samples.push(h.sample),u=h.missing}for(i=u,n=f.length;i<n-1&&!r.isHeader(f,i);i++);if(i===u||(i<n-1?(a="AAC PES did not start with ADTS header,offset:"+i,o=!1):(a="no ADTS header found in AAC PES",o=!0),d.logger.warn("parsing error:"+a),this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:o,reason:a}),!o)){if(r.initTrackConfig(e,this.observer,f,i,this.audioCodec),void 0!==t.pts)l=t.pts;else{if(!h)return void d.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var y=r.getFrameDuration(e.samplerate);l=h.sample.pts+y}for(var g=0;i<n;){if(r.isHeader(f,i)){if(i+5<n){var v=r.appendFrame(e,f,i,l,g);if(v){if(!v.missing){i+=v.length,g++;continue}this.aacOverFlow=v}}break}i++}}},t.parseMPEGPES=function(e,t){var i=t.data,r=i.length,a=0,o=0,s=t.pts;if(void 0!==s)for(;o<r;)if(n.isHeader(i,o)){var l=n.appendFrame(e,i,o,s,a);if(!l)break;o+=l.length,a++}else o++;else d.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseID3PES=function(e,t){void 0!==t.pts?e.samples.push(t):d.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function h(e,t,i,r){return{key:e,frame:!1,pts:t,dts:i,units:[],debug:r,length:0}}function f(e,t){return(31&e[t+10])<<8|e[t+11]}function m(e,t,i,r){var n={audio:-1,avc:-1,id3:-1,isAAC:!0},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var o=(31&e[t+1])<<8|e[t+2];switch(e[t]){case 207:if(!r){d.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===n.audio&&(n.audio=o);break;case 21:-1===n.id3&&(n.id3=o);break;case 219:if(!r){d.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===n.avc&&(n.avc=o);break;case 3:case 4:i?-1===n.audio&&(n.audio=o,n.isAAC=!1):d.logger.log("MPEG audio found, not supported in this browser");break;case 36:d.logger.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return n}function p(e){var t,i,r,n,a,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){var l=new Uint8Array(s[0].length+s[1].length);l.set(s[0]),l.set(s[1],s[0].length),s[0]=l,s.splice(1,1)}if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;var c=t[7];192&c&&(n=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&c?n-(a=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(d.logger.warn(Math.round((n-a)/9e4)+"s delta between PTS and DTS, align them"),n=a):a=n);var u=(r=t[8])+9;if(e.size<=u)return null;e.size-=u;for(var h=new Uint8Array(e.size),f=0,m=s.length;f<m;f++){var p=(t=s[f]).byteLength;if(u){if(u>p){u-=p;continue}t=t.subarray(u),p-=u,u=0}h.set(t,o),o+=p}return i&&(i-=r+3),{data:h,pts:n,dts:a,len:i}}return null}function b(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var i=t.samples,r=i.length;if(!r)return void t.dropped++;var n=i[r-1];e.pts=n.pts,e.dts=n.dts}t.samples.push(e)}e.debug.length&&d.logger.log(e.pts+"/"+e.dts+":"+e.debug)}function y(e){for(var t=e.byteLength,i=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(i.push(r+2),r+=2):r++;if(0===i.length)return e;var n=t-i.length,a=new Uint8Array(n),o=0;for(r=0;r<n;o++,r++)o===i[0]&&(o++,i.shift()),a[r]=e[o];return a}u.minProbeByteLength=188,t.default=u},"./repo/src/empty.js":function(e,t){e.exports=void 0},"./repo/src/errors.ts":function(e,t,i){"use strict";var r,n;i.r(t),i.d(t,"ErrorTypes",(function(){return r})),i.d(t,"ErrorDetails",(function(){return n})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown"}(n||(n={}))},"./repo/src/events.ts":function(e,t,i){"use strict";var r;i.r(t),i.d(t,"Events",(function(){return r})),function(e){e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached"}(r||(r={}))},"./repo/src/hls.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return g}));var r=i("./node_modules/url-toolkit/src/url-toolkit.js"),n=i("./repo/src/loader/playlist-loader.ts"),a=i("./repo/src/loader/key-loader.ts"),o=i("./repo/src/controller/id3-track-controller.ts"),s=i("./repo/src/controller/latency-controller.ts"),l=i("./repo/src/controller/level-controller.ts"),d=i("./repo/src/controller/fragment-tracker.ts"),c=i("./repo/src/controller/stream-controller.ts"),u=i("./repo/src/is-supported.ts"),h=i("./repo/src/utils/logger.ts"),f=i("./repo/src/config.ts"),m=i("./node_modules/eventemitter3/index.js"),p=i("./repo/src/events.ts"),b=i("./repo/src/errors.ts");function y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new m.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var i=this.config=Object(f.mergeConfig)(e.DefaultConfig,t);this.userConfig=t,Object(h.enableLogs)(i.debug),this._autoLevelCapping=-1,i.progressive&&Object(f.enableStreamingMode)(i);var r=i.abrController,u=i.bufferController,p=i.capLevelController,b=i.fpsController,y=this.abrController=new r(this),g=this.bufferController=new u(this),v=this.capLevelController=new p(this),Z=new b(this),T=new n.default(this),L=new a.default(this),S=new o.default(this),x=this.levelController=new l.default(this),k=new d.FragmentTracker(this),I=this.streamController=new c.default(this,k);v.setStreamController(I),Z.setStreamController(I);var X=[x,I];this.networkControllers=X;var R=[T,L,y,g,v,Z,S,k];this.audioTrackController=this.createController(i.audioTrackController,null,X),this.createController(i.audioStreamController,k,X),this.subtitleTrackController=this.createController(i.subtitleTrackController,null,X),this.createController(i.subtitleStreamController,k,X),this.createController(i.timelineController,null,R),this.emeController=this.createController(i.emeController,null,R),this.cmcdController=this.createController(i.cmcdController,null,R),this.latencyController=this.createController(s.default,null,R),this.coreComponents=R}e.isSupported=function(){return Object(u.isSupported)()};var t,i,g,v=e.prototype;return v.createController=function(e,t,i){if(e){var r=t?new e(this,t):new e(this);return i&&i.push(r),r}return null},v.on=function(e,t,i){void 0===i&&(i=this),this._emitter.on(e,t,i)},v.once=function(e,t,i){void 0===i&&(i=this),this._emitter.once(e,t,i)},v.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},v.off=function(e,t,i,r){void 0===i&&(i=this),this._emitter.off(e,t,i,r)},v.listeners=function(e){return this._emitter.listeners(e)},v.emit=function(e,t,i){return this._emitter.emit(e,t,i)},v.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){h.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(p.Events.ERROR,{type:b.ErrorTypes.OTHER_ERROR,details:b.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1},v.listenerCount=function(e){return this._emitter.listenerCount(e)},v.destroy=function(){h.logger.log("destroy"),this.trigger(p.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0},v.attachMedia=function(e){h.logger.log("attachMedia"),this._media=e,this.trigger(p.Events.MEDIA_ATTACHING,{media:e})},v.detachMedia=function(){h.logger.log("detachMedia"),this.trigger(p.Events.MEDIA_DETACHING,void 0),this._media=null},v.loadSource=function(e){this.stopLoad();var t=this.media,i=this.url,n=this.url=r.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});h.logger.log("loadSource:"+n),t&&i&&i!==n&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(p.Events.MANIFEST_LOADING,{url:e})},v.startLoad=function(e){void 0===e&&(e=-1),h.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},v.stopLoad=function(){h.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},v.swapAudioCodec=function(){h.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},v.recoverMediaError=function(){h.logger.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},v.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},t=e,g=[{key:"version",get:function(){}},{key:"Events",get:function(){return p.Events}},{key:"ErrorTypes",get:function(){return b.ErrorTypes}},{key:"ErrorDetails",get:function(){return b.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:f.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}],(i=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){h.logger.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){h.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){h.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){h.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){h.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(h.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e)}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var i=e.length,r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&y(t.prototype,i),g&&y(t,g),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.defaultConfig=void 0},"./repo/src/is-supported.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"isSupported",(function(){return a})),i.d(t,"changeTypeSupported",(function(){return o}));var r=i("./repo/src/utils/mediasource-helper.ts");function n(){return self.SourceBuffer||self.WebKitSourceBuffer}function a(){var e=Object(r.getMediaSource)();if(!e)return!1;var t=n(),i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!a}function o(){var e,t=n();return"function"==typeof(null==t||null===(e=t.prototype)||void 0===e?void 0:e.changeType)}},"./repo/src/loader/fragment-loader.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return u})),i.d(t,"LoadError",(function(){return f}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/errors.ts");function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return o(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)})(e)}function o(e,t,i){return(o=s()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&l(n,i.prototype),n}).apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=Math.pow(2,17),u=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var i=this,r=e.url;if(!r)return Promise.reject(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(r?"part list":"url")));this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(r,l){i.loader&&i.loader.destroy();var d=i.loader=e.loader=o?new o(a):new s(a),u=h(e),m={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:"initSegment"===e.sn?1/0:c};e.stats=d.stats,d.load(u,m,{onSuccess:function(t,n,a,o){i.resetLoader(e,d),r({frag:e,part:null,payload:t.data,networkDetails:o})},onError:function(t,r,a){i.resetLoader(e,d),l(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:t,networkDetails:a}))},onAbort:function(t,r,a){i.resetLoader(e,d),l(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:a}))},onTimeout:function(t,r,a){i.resetLoader(e,d),l(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:a}))},onProgress:function(i,r,n,a){t&&t({frag:e,part:null,payload:n,networkDetails:a})}})}))},t.loadPart=function(e,t,i){var r=this;this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(l,d){r.loader&&r.loader.destroy();var u=r.loader=e.loader=o?new o(a):new s(a),m=h(e,t),p={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:c};t.stats=u.stats,u.load(m,p,{onSuccess:function(n,a,o,s){r.resetLoader(e,u),r.updateStatsFromPart(e,t);var d={frag:e,part:t,payload:n.data,networkDetails:s};i(d),l(d)},onError:function(i,a,o){r.resetLoader(e,u),d(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:i,networkDetails:o}))},onAbort:function(i,a,o){e.stats.aborted=t.stats.aborted,r.resetLoader(e,u),d(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,networkDetails:o}))},onTimeout:function(i,a,o){r.resetLoader(e,u),d(new f({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,networkDetails:o}))}})}))},t.updateStatsFromPart=function(e,t){var i=e.stats,r=t.stats,n=r.total;if(i.loaded+=r.loaded,n){var a=Math.round(e.duration/t.duration),o=Math.min(Math.round(i.loaded/n),a),s=(a-o)*Math.round(i.loaded/o);i.total=i.loaded+s}else i.total=Math.max(i.loaded,i.total);var l=i.loading,d=r.loading;l.start?l.first+=d.first-d.start:(l.start=d.start,l.first=d.first),l.end=d.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function h(e,t){void 0===t&&(t=null);var i=t||e,n={frag:e,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},a=i.byteRangeStartOffset,o=i.byteRangeEndOffset;return Object(r.isFiniteNumber)(a)&&Object(r.isFiniteNumber)(o)&&(n.rangeStart=a,n.rangeEnd=o),n}var f=function(e){var t,i;function r(t){for(var i,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(i=e.call.apply(e,[this].concat(n))||this).data=void 0,i.data=t,i}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,l(t,i),r}(a(Error))},"./repo/src/loader/fragment.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"ElementaryStreamTypes",(function(){return r})),i.d(t,"BaseSegment",(function(){return f})),i.d(t,"Fragment",(function(){return m})),i.d(t,"Part",(function(){return p}));var r,n=i("./repo/src/polyfills/number.ts"),a=i("./node_modules/url-toolkit/src/url-toolkit.js"),o=i("./repo/src/utils/logger.ts"),s=i("./repo/src/loader/level-key.ts"),l=i("./repo/src/loader/load-stats.ts");function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AUDIOVIDEO="audiovideo"}(r||(r={}));var f=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[r.AUDIO]=null,t[r.VIDEO]=null,t[r.AUDIOVIDEO]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var i=e.split("@",2),r=[];1===i.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r},h(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),m=function(e){function t(t,i){var r;return(r=e.call(this,i)||this)._decryptdata=null,r.rawProgramDateTime=null,r.programDateTime=null,r.tagList=[],r.duration=0,r.sn=0,r.levelkey=void 0,r.type=void 0,r.loader=null,r.level=-1,r.cc=0,r.startPTS=void 0,r.endPTS=void 0,r.appendedPTS=void 0,r.startDTS=void 0,r.endDTS=void 0,r.start=0,r.deltaPTS=void 0,r.maxStartPTS=void 0,r.minEndPTS=void 0,r.stats=new l.LoadStats,r.urlId=0,r.data=void 0,r.bitrateTest=!1,r.title=null,r.initSegment=null,r.type=t,r}d(t,e);var i=t.prototype;return i.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},i.setDecryptDataFromLevelKey=function(e,t){var i=e;return"AES-128"===(null==e?void 0:e.method)&&e.uri&&!e.iv&&((i=s.LevelKey.fromURI(e.uri)).method=e.method,i.iv=this.createInitializationVector(t),i.keyFormat="identity"),i},i.setElementaryStreamInfo=function(e,t,i,r,n,a){void 0===a&&(a=!1);var o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,i),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,n)):o[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:n,partial:a}},i.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[r.AUDIO]=null,e[r.VIDEO]=null,e[r.AUDIOVIDEO]=null},h(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(n.isFiniteNumber)(this.programDateTime))return null;var e=Object(n.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;return!(null===(e=this.decryptdata)||void 0===e||!e.keyFormat||!this.decryptdata.uri)}}]),t}(f),p=function(e){function t(t,i,r,n,a){var o;(o=e.call(this,r)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new l.LoadStats,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=i,o.index=n;var s=t.enumeratedString("BYTERANGE");return s&&o.setByteRange(s,a),a&&(o.fragOffset=a.fragOffset+a.duration),o}return d(t,e),h(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(f)},"./repo/src/loader/key-loader.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return o}));var r=i("./repo/src/events.ts"),n=i("./repo/src/errors.ts"),a=i("./repo/src/utils/logger.ts"),o=function(){function e(e){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){this.hls.on(r.Events.KEY_LOADING,this.onKeyLoading,this)},t._unregisterListeners=function(){this.hls.off(r.Events.KEY_LOADING,this.onKeyLoading)},t.destroy=function(){for(var e in this._unregisterListeners(),this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={}},t.onKeyLoading=function(e,t){var i=t.frag,n=i.type,o=this.loaders[n];if(i.decryptdata){var s=i.decryptdata.uri;if(s!==this.decrypturl||null===this.decryptkey){var l=this.hls.config;if(o&&(a.logger.warn("abort previous key loader for type:"+n),o.abort()),!s)return void a.logger.warn("key uri is falsy");var d=l.loader,c=i.loader=this.loaders[n]=new d(l);this.decrypturl=s,this.decryptkey=null;var u={url:s,frag:i,responseType:"arraybuffer"},h={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:l.fragLoadingRetryDelay,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:0},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(u,h,f)}else this.decryptkey&&(i.decryptdata.key=this.decryptkey,this.hls.trigger(r.Events.KEY_LOADED,{frag:i}))}else a.logger.warn("Missing decryption data on fragment in onKeyLoading")},t.loadsuccess=function(e,t,i){var n=i.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=null,delete this.loaders[n.type],this.hls.trigger(r.Events.KEY_LOADED,{frag:n})):a.logger.error("after key load, decryptdata unset")},t.loaderror=function(e,t){var i=t.frag,a=i.loader;a&&a.abort(),delete this.loaders[i.type],this.hls.trigger(r.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},t.loadtimeout=function(e,t){var i=t.frag,a=i.loader;a&&a.abort(),delete this.loaders[i.type],this.hls.trigger(r.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},e}()},"./repo/src/loader/level-details.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"LevelDetails",(function(){return a}));var r=i("./repo/src/polyfills/number.ts");function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=e}var t,i;return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},t=e,(i=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(r.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!==(e=this.fragments)&&void 0!==e&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./repo/src/loader/level-key.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"LevelKey",(function(){return a}));var r=i("./node_modules/url-toolkit/src/url-toolkit.js");function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e,t){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=t?Object(r.buildAbsoluteURL)(e,t,{alwaysNormalize:!0}):e}var t,i;return e.fromURL=function(t,i){return new e(t,i)},e.fromURI=function(t){return new e(t)},t=e,(i=[{key:"uri",get:function(){return this._uri}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./repo/src/loader/load-stats.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"LoadStats",(function(){return r}));var r=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./repo/src/loader/m3u8-parser.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return b}));var r=i("./repo/src/polyfills/number.ts"),n=i("./node_modules/url-toolkit/src/url-toolkit.js"),a=i("./repo/src/loader/fragment.ts"),o=i("./repo/src/loader/level-details.ts"),s=i("./repo/src/loader/level-key.ts"),l=i("./repo/src/utils/attr-list.ts"),d=i("./repo/src/utils/logger.ts"),c=i("./repo/src/utils/codecs.ts"),u=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,h=/#EXT-X-MEDIA:(.*)/g,f=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),m=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),p=/\.(mp4|m4s|m4v|m4a)$/i,b=function(){function e(){}return e.findGroup=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.id===t)return r}},e.convertAVC1ToAVCOTI=function(e){var t=e.split(".");if(t.length>2){var i=t.shift()+".";return(i+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).substr(-4)}return e},e.resolve=function(e,t){return n.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var r,n=[],a={},o=!1;for(u.lastIndex=0;null!=(r=u.exec(t));)if(r[1]){var s=new l.AttrList(r[1]),d={attrs:s,bitrate:s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),name:s.NAME,url:e.resolve(r[2],i)},c=s.decimalResolution("RESOLUTION");c&&(d.width=c.width,d.height=c.height),y((s.CODECS||"").split(/[ ,]+/).filter((function(e){return e})),d),d.videoCodec&&-1!==d.videoCodec.indexOf("avc1")&&(d.videoCodec=e.convertAVC1ToAVCOTI(d.videoCodec)),n.push(d)}else if(r[3]){var h=new l.AttrList(r[3]);h["DATA-ID"]&&(o=!0,a[h["DATA-ID"]]=h)}return{levels:n,sessionData:o?a:null}},e.parseMasterPlaylistMedia=function(t,i,r,n){var a;void 0===n&&(n=[]);var o=[],s=0;for(h.lastIndex=0;null!==(a=h.exec(t));){var d=new l.AttrList(a[1]);if(d.TYPE===r){var c={attrs:d,bitrate:0,id:s++,groupId:d["GROUP-ID"],instreamId:d["INSTREAM-ID"],name:d.NAME||d.LANGUAGE||"",type:r,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:d.LANGUAGE,url:d.URI?e.resolve(d.URI,i):""};if(n.length){var u=e.findGroup(n,c.groupId)||n[0];g(c,u,"audioCodec"),g(c,u,"textCodec")}o.push(c)}}return o},e.parseLevelPlaylist=function(e,t,i,c,u){var h,b,y,g=new o.LevelDetails(t),Z=g.fragments,T=null,L=0,S=0,x=0,k=0,I=null,X=new a.Fragment(c,t),R=-1,w=!1;for(f.lastIndex=0,g.m3u8=e;null!==(h=f.exec(e));){w&&(w=!1,(X=new a.Fragment(c,t)).start=x,X.sn=L,X.cc=k,X.level=i,T&&(X.initSegment=T,X.rawProgramDateTime=T.rawProgramDateTime,T.rawProgramDateTime=null));var G=h[1];if(G){X.duration=parseFloat(G);var W=(" "+h[2]).slice(1);X.title=W||null,X.tagList.push(W?["INF",G,W]:["INF",G])}else if(h[3])Object(r.isFiniteNumber)(X.duration)&&(X.start=x,y&&(X.levelkey=y),X.sn=L,X.level=i,X.cc=k,X.urlId=u,Z.push(X),X.relurl=(" "+h[3]).slice(1),v(X,I),I=X,x+=X.duration,L++,S=0,w=!0);else if(h[4]){var E=(" "+h[4]).slice(1);I?X.setByteRange(E,I):X.setByteRange(E)}else if(h[5])X.rawProgramDateTime=(" "+h[5]).slice(1),X.tagList.push(["PROGRAM-DATE-TIME",X.rawProgramDateTime]),-1===R&&(R=Z.length);else{if(!(h=h[0].match(m))){d.logger.warn("No matches on slow regex match for level playlist!");continue}for(b=1;b<h.length&&void 0===h[b];b++);var _=(" "+h[b]).slice(1),C=(" "+h[b+1]).slice(1),P=h[b+2]?(" "+h[b+2]).slice(1):"";switch(_){case"PLAYLIST-TYPE":g.type=C.toUpperCase();break;case"MEDIA-SEQUENCE":L=g.startSN=parseInt(C);break;case"SKIP":var V=new l.AttrList(C),M=V.decimalInteger("SKIPPED-SEGMENTS");if(Object(r.isFiniteNumber)(M)){g.skippedSegments=M;for(var K=M;K--;)Z.unshift(null);L+=M}var Y=V.enumeratedString("RECENTLY-REMOVED-DATERANGES");Y&&(g.recentlyRemovedDateranges=Y.split("\t"));break;case"TARGETDURATION":g.targetduration=parseFloat(C);break;case"VERSION":g.version=parseInt(C);break;case"EXTM3U":break;case"ENDLIST":g.live=!1;break;case"#":(C||P)&&X.tagList.push(P?[C,P]:[C]);break;case"DIS":k++;case"GAP":X.tagList.push([_]);break;case"BITRATE":X.tagList.push([_,C]);break;case"DISCONTINUITY-SEQ":k=parseInt(C);break;case"KEY":var D,F=new l.AttrList(C),H=F.enumeratedString("METHOD"),N=F.URI,U=F.hexadecimalInteger("IV"),O=F.enumeratedString("KEYFORMATVERSIONS"),A=F.enumeratedString("KEYID"),J=null!=(D=F.enumeratedString("KEYFORMAT"))?D:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(J)>-1){d.logger.warn("Keyformat "+J+" is not supported from the manifest");continue}if("identity"!==J)continue;H&&(y=s.LevelKey.fromURL(t,N),N&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(H)>=0&&(y.method=H,y.keyFormat=J,A&&(y.keyID=A),O&&(y.keyFormatVersions=O),y.iv=U));break;case"START":var j=new l.AttrList(C).decimalFloatingPoint("TIME-OFFSET");Object(r.isFiniteNumber)(j)&&(g.startTimeOffset=j);break;case"MAP":var B=new l.AttrList(C);X.relurl=B.URI,B.BYTERANGE&&X.setByteRange(B.BYTERANGE),X.level=i,X.sn="initSegment",y&&(X.levelkey=y),X.initSegment=null,T=X,w=!0;break;case"SERVER-CONTROL":var z=new l.AttrList(C);g.canBlockReload=z.bool("CAN-BLOCK-RELOAD"),g.canSkipUntil=z.optionalFloat("CAN-SKIP-UNTIL",0),g.canSkipDateRanges=g.canSkipUntil>0&&z.bool("CAN-SKIP-DATERANGES"),g.partHoldBack=z.optionalFloat("PART-HOLD-BACK",0),g.holdBack=z.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var Q=new l.AttrList(C);g.partTarget=Q.decimalFloatingPoint("PART-TARGET");break;case"PART":var q=g.partList;q||(q=g.partList=[]);var $=S>0?q[q.length-1]:void 0,ee=S++,te=new a.Part(new l.AttrList(C),X,t,ee,$);q.push(te),X.duration+=te.duration;break;case"PRELOAD-HINT":var ie=new l.AttrList(C);g.preloadHint=ie;break;case"RENDITION-REPORT":var re=new l.AttrList(C);g.renditionReports=g.renditionReports||[],g.renditionReports.push(re);break;default:d.logger.warn("line parsed but not handled: "+h)}}}I&&!I.relurl?(Z.pop(),x-=I.duration,g.partList&&(g.fragmentHint=I)):g.partList&&(v(X,I),X.cc=k,g.fragmentHint=X);var ne=Z.length,ae=Z[0],oe=Z[ne-1];if((x+=g.skippedSegments*g.targetduration)>0&&ne&&oe){g.averagetargetduration=x/ne;var se=oe.sn;g.endSN="initSegment"!==se?se:0,ae&&(g.startCC=ae.cc,ae.initSegment||g.fragments.every((function(e){return e.relurl&&(t=e.relurl,p.test(null!=(i=null===(r=n.parseURL(t))||void 0===r?void 0:r.path)?i:""));var t,i,r}))&&(d.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(X=new a.Fragment(c,t)).relurl=oe.relurl,X.level=i,X.sn="initSegment",ae.initSegment=X,g.needSidxRanges=!0))}else g.endSN=0,g.startCC=0;return g.fragmentHint&&(x+=g.fragmentHint.duration),g.totalduration=x,g.endCC=k,R>0&&function(e,t){for(var i=e[t],r=t;r--;){var n=e[r];if(!n)return;n.programDateTime=i.programDateTime-1e3*n.duration,i=n}}(Z,R),g},e}();function y(e,t){["video","audio","text"].forEach((function(i){var r=e.filter((function(e){return Object(c.isCodecType)(e,i)}));if(r.length){var n=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=n.length>0?n[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}function g(e,t,i){var r=t[i];r&&(e[i]=r)}function v(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(r.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}},"./repo/src/loader/playlist-loader.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/events.ts"),a=i("./repo/src/errors.ts"),o=i("./repo/src/utils/logger.ts"),s=i("./repo/src/utils/mp4-tools.ts"),l=i("./repo/src/loader/m3u8-parser.ts"),d=i("./repo/src/types/loader.ts"),c=i("./repo/src/utils/attr-list.ts");function u(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i}var h=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.hls=e,this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,r=t.loader,n=new(i||r)(t);return e.loader=n,this.loaders[e.type]=n,n},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var i=t.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:d.PlaylistContextType.MANIFEST,url:i,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var i=t.id,r=t.level,n=t.url,a=t.deliveryDirectives;this.load({id:i,groupId:null,level:r,responseType:"text",type:d.PlaylistContextType.LEVEL,url:n,deliveryDirectives:a})},t.onAudioTrackLoading=function(e,t){var i=t.id,r=t.groupId,n=t.url,a=t.deliveryDirectives;this.load({id:i,groupId:r,level:null,responseType:"text",type:d.PlaylistContextType.AUDIO_TRACK,url:n,deliveryDirectives:a})},t.onSubtitleTrackLoading=function(e,t){var i=t.id,r=t.groupId,n=t.url,a=t.deliveryDirectives;this.load({id:i,groupId:r,level:null,responseType:"text",type:d.PlaylistContextType.SUBTITLE_TRACK,url:n,deliveryDirectives:a})},t.load=function(e){var t,i,r,n,a,s,l=this.hls.config,c=this.getInternalLoader(e);if(c){var u=c.context;if(u&&u.url===e.url)return void o.logger.trace("[playlist-loader]: playlist request ongoing");o.logger.log("[playlist-loader]: aborting previous loader for type: "+e.type),c.abort()}switch(e.type){case d.PlaylistContextType.MANIFEST:i=l.manifestLoadingMaxRetry,r=l.manifestLoadingTimeOut,n=l.manifestLoadingRetryDelay,a=l.manifestLoadingMaxRetryTimeout;break;case d.PlaylistContextType.LEVEL:case d.PlaylistContextType.AUDIO_TRACK:case d.PlaylistContextType.SUBTITLE_TRACK:i=0,r=l.levelLoadingTimeOut;break;default:i=l.levelLoadingMaxRetry,r=l.levelLoadingTimeOut,n=l.levelLoadingRetryDelay,a=l.levelLoadingMaxRetryTimeout}if(c=this.createInternalLoader(e),null!==(t=e.deliveryDirectives)&&void 0!==t&&t.part&&(e.type===d.PlaylistContextType.LEVEL&&null!==e.level?s=this.hls.levels[e.level].details:e.type===d.PlaylistContextType.AUDIO_TRACK&&null!==e.id?s=this.hls.audioTracks[e.id].details:e.type===d.PlaylistContextType.SUBTITLE_TRACK&&null!==e.id&&(s=this.hls.subtitleTracks[e.id].details),s)){var h=s.partTarget,f=s.targetduration;h&&f&&(r=Math.min(1e3*Math.max(3*h,.8*f),r))}var m={timeout:r,maxRetry:i,retryDelay:n,maxRetryDelay:a,highWaterMark:0},p={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(e,m,p)},t.loadsuccess=function(e,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this.handleSidxRequest(e,i),void this.handlePlaylistLoaded(e,t,i,r);this.resetInternalLoader(i.type);var n=e.data;0===n.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(e,t,i,r):this.handleMasterPlaylist(e,t,i,r)):this.handleManifestParsingError(e,i,"no EXTM3U delimiter",r)},t.loaderror=function(e,t,i){void 0===i&&(i=null),this.handleNetworkError(t,i,!1,e)},t.loadtimeout=function(e,t,i){void 0===i&&(i=null),this.handleNetworkError(t,i,!0)},t.handleMasterPlaylist=function(e,t,i,r){var a=this.hls,s=e.data,d=u(e,i),h=l.default.parseMasterPlaylist(s,d),f=h.levels,m=h.sessionData;if(f.length){var p=f.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),b=f.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),y=l.default.parseMasterPlaylistMedia(s,d,"AUDIO",p),g=l.default.parseMasterPlaylistMedia(s,d,"SUBTITLES",b),v=l.default.parseMasterPlaylistMedia(s,d,"CLOSED-CAPTIONS");y.length&&(y.some((function(e){return!e.url}))||!f[0].audioCodec||f[0].attrs.AUDIO||(o.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new c.AttrList({}),bitrate:0,url:""}))),a.trigger(n.Events.MANIFEST_LOADED,{levels:f,audioTracks:y,subtitles:g,captions:v,url:d,stats:t,networkDetails:r,sessionData:m})}else this.handleManifestParsingError(e,i,"no level found in manifest",r)},t.handleTrackOrLevelPlaylist=function(e,t,i,o){var s=this.hls,h=i.id,f=i.level,m=i.type,p=u(e,i),b=Object(r.isFiniteNumber)(h)?h:0,y=Object(r.isFiniteNumber)(f)?f:b,g=function(e){switch(e.type){case d.PlaylistContextType.AUDIO_TRACK:return d.PlaylistLevelType.AUDIO;case d.PlaylistContextType.SUBTITLE_TRACK:return d.PlaylistLevelType.SUBTITLE;default:return d.PlaylistLevelType.MAIN}}(i),v=l.default.parseLevelPlaylist(e.data,p,y,g,b);if(v.fragments.length){if(m===d.PlaylistContextType.MANIFEST){var Z={attrs:new c.AttrList({}),bitrate:0,details:v,name:"",url:p};s.trigger(n.Events.MANIFEST_LOADED,{levels:[Z],audioTracks:[],url:p,stats:t,networkDetails:o,sessionData:null})}if(t.parsing.end=performance.now(),v.needSidxRanges){var T,L=null===(T=v.fragments[0].initSegment)||void 0===T?void 0:T.url;this.load({url:L,isSidxRequest:!0,type:m,level:f,levelDetails:v,id:h,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else i.levelDetails=v,this.handlePlaylistLoaded(e,t,i,o)}else s.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:p,reason:"no fragments found in level",level:"number"==typeof i.level?i.level:void 0})},t.handleSidxRequest=function(e,t){var i=Object(s.parseSegmentIndex)(new Uint8Array(e.data));if(i){var r=i.references,n=t.levelDetails;r.forEach((function(e,t){var r=e.info,a=n.fragments[t];0===a.byteRange.length&&a.setByteRange(String(1+r.end-r.start)+"@"+String(r.start)),a.initSegment&&a.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}))}},t.handleManifestParsingError=function(e,t,i,r){this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===d.PlaylistContextType.MANIFEST,url:e.url,reason:i,response:e,context:t,networkDetails:r})},t.handleNetworkError=function(e,t,i,r){void 0===i&&(i=!1),o.logger.warn("[playlist-loader]: A network "+(i?"timeout":"error")+" occurred while loading "+e.type+" level: "+e.level+" id: "+e.id+' group-id: "'+e.groupId+'"');var s=a.ErrorDetails.UNKNOWN,l=!1,c=this.getInternalLoader(e);switch(e.type){case d.PlaylistContextType.MANIFEST:s=i?a.ErrorDetails.MANIFEST_LOAD_TIMEOUT:a.ErrorDetails.MANIFEST_LOAD_ERROR,l=!0;break;case d.PlaylistContextType.LEVEL:s=i?a.ErrorDetails.LEVEL_LOAD_TIMEOUT:a.ErrorDetails.LEVEL_LOAD_ERROR,l=!1;break;case d.PlaylistContextType.AUDIO_TRACK:s=i?a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case d.PlaylistContextType.SUBTITLE_TRACK:s=i?a.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:a.ErrorDetails.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(e.type);var u={type:a.ErrorTypes.NETWORK_ERROR,details:s,fatal:l,url:e.url,loader:c,context:e,networkDetails:t};r&&(u.response=r),this.hls.trigger(n.Events.ERROR,u)},t.handlePlaylistLoaded=function(e,t,i,r){var a=i.type,o=i.level,s=i.id,l=i.groupId,c=i.loader,u=i.levelDetails,h=i.deliveryDirectives;if(null!=u&&u.targetduration){if(c)switch(u.live&&(c.getCacheAge&&(u.ageHeader=c.getCacheAge()||0),c.getCacheAge&&!isNaN(u.ageHeader)||(u.ageHeader=0)),a){case d.PlaylistContextType.MANIFEST:case d.PlaylistContextType.LEVEL:this.hls.trigger(n.Events.LEVEL_LOADED,{details:u,level:o||0,id:s||0,stats:t,networkDetails:r,deliveryDirectives:h});break;case d.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(n.Events.AUDIO_TRACK_LOADED,{details:u,id:s||0,groupId:l||"",stats:t,networkDetails:r,deliveryDirectives:h});break;case d.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADED,{details:u,id:s||0,groupId:l||"",stats:t,networkDetails:r,deliveryDirectives:h})}}else this.handleManifestParsingError(e,i,"invalid target duration",r)},e}();t.default=h},"./repo/src/polyfills/number.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"isFiniteNumber",(function(){return r})),i.d(t,"MAX_SAFE_INTEGER",(function(){return n}));var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},n=Number.MAX_SAFE_INTEGER||9007199254740991},"./repo/src/remux/aac-helper.ts":function(e,t,i){"use strict";i.r(t);var r=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}();t.default=r},"./repo/src/remux/mp4-generator.ts":function(e,t,i){"use strict";i.r(t);var r=Math.pow(2,32)-1,n=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:r};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t=8,i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];for(var a=r.length,o=a;a--;)t+=r[a].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),a=0,t=8;a<o;a++)s.set(r[a],t),t+=r[a].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var n=Math.floor(i/(r+1)),a=Math.floor(i%(r+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,i))},e.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,i){i*=t;var n=Math.floor(i/(r+1)),a=Math.floor(i%(r+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)},e.sdtp=function(t){var i,r,n=t.samples||[],a=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)r=n[i].flags,a[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i,r,n,a=[],o=[];for(i=0;i<t.sps.length;i++)n=(r=t.sps[i]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(r));for(i=0;i<t.pps.length;i++)n=(r=t.pps[i]).byteLength,o.push(n>>>8&255),o.push(255&n),o=o.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,d=t.height,c=t.pixelRatio[0],u=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var i=t.id,n=t.duration*t.timescale,a=t.width,o=t.height,s=Math.floor(n/(r+1)),l=Math.floor(n%(r+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))},e.traf=function(t,i){var n=e.sdtp(t),a=t.id,o=Math.floor(i/(r+1)),s=Math.floor(i%(r+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var r,n,a,o,s,l,d=t.samples||[],c=d.length,u=12+16*c,h=new Uint8Array(u);for(i+=8+u,h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),r=0;r<c;r++)a=(n=d[r]).duration,o=n.size,s=n.flags,l=n.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*r);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var i=e.moov(t),r=new Uint8Array(e.FTYP.byteLength+i.byteLength);return r.set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}();n.types=void 0,n.HDLR_TYPES=void 0,n.STTS=void 0,n.STSC=void 0,n.STCO=void 0,n.STSZ=void 0,n.VMHD=void 0,n.SMHD=void 0,n.STSD=void 0,n.FTYP=void 0,n.DINF=void 0,t.default=n},"./repo/src/remux/mp4-remuxer.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return p})),i.d(t,"normalizePts",(function(){return b})),i.d(t,"flushTextTrackMetadataCueSamples",(function(){return y})),i.d(t,"flushTextTrackUserdataCueSamples",(function(){return g}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/remux/aac-helper.ts"),a=i("./repo/src/remux/mp4-generator.ts"),o=i("./repo/src/events.ts"),s=i("./repo/src/errors.ts"),l=i("./repo/src/utils/logger.ts"),d=i("./repo/src/types/loader.ts"),c=i("./repo/src/utils/timescale-conversion.ts");function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var h=null,f=null,m=!1,p=function(){function e(e,t,i,r){if(void 0===r&&(r=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===h){var n=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);h=n?parseInt(n[1]):0}if(null===f){var a=navigator.userAgent.match(/Safari\/(\d+)/i);f=a?parseInt(a[1]):0}m=!!h&&h<75||!!f&&f<600}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){l.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){l.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){l.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,i=e.reduce((function(e,i){var r=i.pts-e;return r<-4294967296?(t=!0,b(e,i.pts)):r>0?e:i.pts}),e[0].pts);return t&&l.logger.debug("PTS rollover detected"),i},t.remux=function(e,t,i,r,n,a,o,s){var c,u,h,f,m,p,v=n,Z=n,T=e.pid>-1,L=t.pid>-1,S=t.samples.length,x=e.samples.length>0,k=S>1;if((!T||x)&&(!L||k)||this.ISGenerated||o){this.ISGenerated||(h=this.generateIS(e,t,n));var I=this.isVideoContiguous,X=-1;if(k&&(X=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!I&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,X>0){l.logger.warn("[mp4-remuxer]: Dropped "+X+" out of "+S+" video samples due to a missing keyframe");var R=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(X),t.dropped+=X,Z+=(t.samples[0].pts-R)/(t.timescale||9e4)}else-1===X&&(l.logger.warn("[mp4-remuxer]: No keyframe found out of "+S+" video samples"),p=!1);if(this.ISGenerated){if(x&&k){var w=this.getVideoStartPts(t.samples),G=(b(e.samples[0].pts,w)-w)/t.inputTimeScale;v+=Math.max(0,G),Z+=Math.max(0,-G)}if(x){if(e.samplerate||(l.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,n)),u=this.remuxAudio(e,v,this.isAudioContiguous,a,L||k||s===d.PlaylistLevelType.AUDIO?Z:void 0),k){var W=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(l.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,n)),c=this.remuxVideo(t,Z,I,W)}}else k&&(c=this.remuxVideo(t,Z,I,0));c&&(c.firstKeyFrame=X,c.independent=-1!==X)}}return this.ISGenerated&&(i.samples.length&&(m=y(i,n,this._initPTS,this._initDTS)),r.samples.length&&(f=g(r,n,this._initPTS))),{audio:u,video:c,initSegment:h,independent:p,text:f,id3:m}},t.generateIS=function(e,t,i){var n,o,s,l=e.samples,d=t.samples,c=this.typeSupported,u={},h=!Object(r.isFiniteNumber)(this._initPTS),f="audio/mp4";if(h&&(n=o=1/0),e.config&&l.length&&(e.timescale=e.samplerate,e.isAAC||(c.mpeg?(f="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),u.audio={id:"audio",container:f,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array(0):a.default.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(s=e.inputTimeScale,n=o=l[0].pts-Math.round(s*i))),t.sps&&t.pps&&d.length&&(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:a.default.initSegment([t]),metadata:{width:t.width,height:t.height}},h)){s=t.inputTimeScale;var m=this.getVideoStartPts(d),p=Math.round(s*i);o=Math.min(o,b(d[0].dts,m)-p),n=Math.min(n,m-p)}if(Object.keys(u).length)return this.ISGenerated=!0,h&&(this._initPTS=n,this._initDTS=o),{tracks:u,initPTS:n,timescale:s}},t.remuxVideo=function(e,t,i,r){var n,d,f,p=e.inputTimeScale,y=e.samples,g=[],Z=y.length,T=this._initPTS,L=this.nextAvcDts,S=8,x=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,I=0,X=!1;i&&null!==L||(L=t*p-(y[0].pts-b(y[0].dts,y[0].pts)));for(var R=0;R<Z;R++){var w=y[R];w.pts=b(w.pts-T,L),w.dts=b(w.dts-T,L),w.dts>w.pts&&(I=Math.max(Math.min(I,w.pts-w.dts),-18e3)),w.dts<y[R>0?R-1:R].dts&&(X=!0)}X&&y.sort((function(e,t){var i=e.dts-t.dts,r=e.pts-t.pts;return i||r})),d=y[0].dts,f=y[y.length-1].dts;var G=Math.round((f-d)/(Z-1));if(I<0){if(I<-2*G){l.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(c.toMsFromMpegTsClock)(-G,!0)+" ms");for(var W=I,E=0;E<Z;E++)y[E].dts=W=Math.max(W,y[E].pts-G),y[E].pts=Math.max(W,y[E].pts)}else{l.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(c.toMsFromMpegTsClock)(I,!0)+" ms to overcome this issue");for(var _=0;_<Z;_++)y[_].dts=y[_].dts+I}d=y[0].dts}if(i){var C=d-L,P=C>G;if(P||C<-1){P?l.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(C,!0)+" ms ("+C+"dts) hole between fragments detected, filling it"):l.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(-C,!0)+" ms ("+C+"dts) overlapping between fragments detected"),d=L;var V=y[0].pts-C;y[0].dts=d,y[0].pts=V,l.logger.log("Video: First PTS/DTS adjusted: "+Object(c.toMsFromMpegTsClock)(V,!0)+"/"+Object(c.toMsFromMpegTsClock)(d,!0)+", delta: "+Object(c.toMsFromMpegTsClock)(C,!0)+" ms")}}m&&(d=Math.max(0,d));for(var M=0,K=0,Y=0;Y<Z;Y++){for(var D=y[Y],F=D.units,H=F.length,N=0,U=0;U<H;U++)N+=F[U].data.length;K+=N,M+=H,D.length=N,D.dts=Math.max(D.dts,d),D.pts=Math.max(D.pts,D.dts,0),x=Math.min(D.pts,x),k=Math.max(D.pts,k)}f=y[Z-1].dts;var O,A=K+4*M+8;try{O=new Uint8Array(A)}catch(e){return void this.observer.emit(o.Events.ERROR,o.Events.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:A,reason:"fail allocating video mdat "+A})}var J=new DataView(O.buffer);J.setUint32(0,A),O.set(a.default.types.mdat,4);for(var j=0;j<Z;j++){for(var B=y[j],z=B.units,Q=0,q=0,$=z.length;q<$;q++){var ee=z[q],te=ee.data,ie=ee.data.byteLength;J.setUint32(S,ie),S+=4,O.set(te,S),S+=ie,Q+=4+ie}if(j<Z-1)n=y[j+1].dts-B.dts;else{var re=this.config,ne=B.dts-y[j>0?j-1:j].dts;if(re.stretchShortVideoTrack&&null!==this.nextAudioPts){var ae=Math.floor(re.maxBufferHole*p),oe=(r?x+r*p:this.nextAudioPts)-B.pts;oe>ae?((n=oe-ne)<0&&(n=ne),l.logger.log("[mp4-remuxer]: It is approximately "+oe/90+" ms to the next segment; using duration "+n/90+" ms for the last video frame.")):n=ne}else n=ne}var se=Math.round(B.pts-B.dts);g.push(new v(B.key,n,Q,se))}if(g.length&&h&&h<70){var le=g[0].flags;le.dependsOn=2,le.isNonSync=0}console.assert(void 0!==n,"mp4SampleDuration must be computed"),this.nextAvcDts=L=f+n,this.isVideoContiguous=!0;var de={data1:a.default.moof(e.sequenceNumber++,d,u({},e,{samples:g})),data2:O,startPTS:x/p,endPTS:(k+n)/p,startDTS:d/p,endDTS:L/p,type:"video",hasAudio:!1,hasVideo:!0,nb:g.length,dropped:e.dropped};return e.samples=[],e.dropped=0,console.assert(O.length,"MDAT length must not be zero"),de},t.remuxAudio=function(e,t,i,r,d){var c=e.inputTimeScale,h=c/(e.samplerate?e.samplerate:c),f=e.isAAC?1024:1152,m=f*h,p=this._initPTS,y=!e.isAAC&&this.typeSupported.mpeg,g=[],Z=e.samples,T=y?0:8,L=this.nextAudioPts||-1,S=t*c;if(this.isAudioContiguous=i=i||Z.length&&L>0&&(r&&Math.abs(S-L)<9e3||Math.abs(b(Z[0].pts-p,S)-L)<20*m),Z.forEach((function(e){e.pts=b(e.pts-p,S)})),!i||L<0){if(!(Z=Z.filter((function(e){return e.pts>=0}))).length)return;L=0===d?0:r?Math.max(0,S):Z[0].pts}if(e.isAAC)for(var x=void 0!==d,k=this.config.maxAudioFramesDrift,I=0,X=L;I<Z.length;I++){var R=Z[I],w=R.pts,G=w-X,W=Math.abs(1e3*G/c);if(G<=-k*m&&x)0===I&&(l.logger.warn("Audio frame @ "+(w/c).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*G/c)+" ms."),this.nextAudioPts=L=X=w);else if(G>=k*m&&W<1e4&&x){var E=Math.round(G/m);(X=w-E*m)<0&&(E--,X+=m),0===I&&(this.nextAudioPts=L=X),l.logger.warn("[mp4-remuxer]: Injecting "+E+" audio frame @ "+(X/c).toFixed(3)+"s due to "+Math.round(1e3*G/c)+" ms gap.");for(var _=0;_<E;_++){var C=Math.max(X,0),P=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);P||(l.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),P=R.unit.subarray()),Z.splice(I,0,{unit:P,pts:C}),X+=m,I++}}R.pts=X,X+=m}for(var V,M=null,K=null,Y=0,D=Z.length;D--;)Y+=Z[D].unit.byteLength;for(var F=0,H=Z.length;F<H;F++){var N=Z[F],U=N.unit,O=N.pts;if(null!==K)g[F-1].duration=Math.round((O-K)/h);else{if(i&&e.isAAC&&(O=L),M=O,!(Y>0))return;Y+=T;try{V=new Uint8Array(Y)}catch(e){return void this.observer.emit(o.Events.ERROR,o.Events.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Y,reason:"fail allocating audio mdat "+Y})}y||(new DataView(V.buffer).setUint32(0,Y),V.set(a.default.types.mdat,4))}V.set(U,T);var A=U.byteLength;T+=A,g.push(new v(!0,f,A,0)),K=O}var J=g.length;if(J){var j=g[g.length-1];this.nextAudioPts=L=K+h*j.duration;var B=y?new Uint8Array(0):a.default.moof(e.sequenceNumber++,M/h,u({},e,{samples:g}));e.samples=[];var z=M/c,Q=L/c,q={data1:B,data2:V,startPTS:z,endPTS:Q,startDTS:z,endDTS:Q,type:"audio",hasAudio:!0,hasVideo:!1,nb:J};return this.isAudioContiguous=!0,console.assert(V.length,"MDAT length must not be zero"),q}},t.remuxEmptyAudio=function(e,t,i,r){var a=e.inputTimeScale,o=a/(e.samplerate?e.samplerate:a),s=this.nextAudioPts,d=(null!==s?s:r.startDTS*a)+this._initDTS,c=r.endDTS*a+this._initDTS,u=1024*o,h=Math.ceil((c-d)/u),f=n.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(l.logger.warn("[mp4-remuxer]: remux empty Audio"),f){for(var m=[],p=0;p<h;p++){var b=d+p*u;m.push({unit:f,pts:b,dts:b})}return e.samples=m,this.remuxAudio(e,t,i,!1)}l.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e}();function b(e,t){var i;if(null===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}function y(e,t,i,r){var n=e.samples.length;if(n){for(var a=e.inputTimeScale,o=0;o<n;o++){var s=e.samples[o];s.pts=b(s.pts-i,t*a)/a,s.dts=b(s.dts-r,t*a)/a}var l=e.samples;return e.samples=[],{samples:l}}}function g(e,t,i){var r=e.samples.length;if(r){for(var n=e.inputTimeScale,a=0;a<r;a++){var o=e.samples[a];o.pts=b(o.pts-i,t*n)/n}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}var v=function(e,t,i,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=r,this.flags=new Z(e)},Z=function(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},"./repo/src/remux/passthrough-remuxer.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/remux/mp4-remuxer.ts"),a=i("./repo/src/utils/mp4-tools.ts"),o=i("./repo/src/loader/fragment.ts"),s=i("./repo/src/utils/logger.ts"),l=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndDTS=null},t.resetNextTimestamp=function(){this.lastEndDTS=null},t.resetInitSegment=function(e,t,i){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(e),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,i=this.videoCodec;if(!e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var r=this.initData=Object(a.parseInitSegment)(e);t||(t=c(r.audio,o.ElementaryStreamTypes.AUDIO)),i||(i=c(r.video,o.ElementaryStreamTypes.VIDEO));var n={};r.audio&&r.video?n.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:r.audio?n.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?n.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:s.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=n},t.remux=function(e,t,i,o,l){var c,u=this.initPTS,h=this.lastEndDTS,f={audio:void 0,video:void 0,text:o,id3:i,initSegment:void 0};Object(r.isFiniteNumber)(h)||(h=this.lastEndDTS=l||0);var m=t.samples;if(!m||!m.length)return f;var p={initPTS:void 0,timescale:1},b=this.initData;if(b&&b.length||(this.generateInitSegment(m),b=this.initData),!b||!b.length)return s.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),f;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1),Object(r.isFiniteNumber)(u)||(this.initPTS=p.initPTS=u=d(b,m,h));var y=Object(a.getDuration)(m,b),g=h,v=y+g;Object(a.offsetStartDTS)(b,m,u),y>0?this.lastEndDTS=v:(s.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var Z=!!b.audio,T=!!b.video,L="";Z&&(L+="audio"),T&&(L+="video");var S={data1:m,startPTS:g,startDTS:g,endPTS:v,endDTS:v,type:L,hasAudio:Z,hasVideo:T,nb:1,dropped:0};f.audio="audio"===S.type?S:void 0,f.video="audio"!==S.type?S:void 0,f.initSegment=p;var x=null!=(c=this.initPTS)?c:0;return f.id3=Object(n.flushTextTrackMetadataCueSamples)(i,l,x,x),o.samples.length&&(f.text=Object(n.flushTextTrackUserdataCueSamples)(o,l,x)),f},e}(),d=function(e,t,i){return Object(a.getStartDTS)(e,t)-i};function c(e,t){var i=null==e?void 0:e.codec;return i&&i.length>4?i:"hvc1"===i?"hvc1.1.c.L120.90":"av01"===i?"av01.0.04M.08":"avc1"===i||t===o.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}t.default=l},"./repo/src/task-loop.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return r}));var r=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}()},"./repo/src/types/level.ts":function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n;function a(e,t){var i=e.canSkipUntil,r=e.canSkipDateRanges,a=e.endSN;return i&&(void 0!==t?t-a:0)<i?r?n.v2:n.Yes:n.No}i.r(t),i.d(t,"HlsSkip",(function(){return n})),i.d(t,"getSkipValue",(function(){return a})),i.d(t,"HlsUrlParameters",(function(){return o})),i.d(t,"Level",(function(){return s})),function(e){e.No="",e.Yes="YES",e.v2="v2"}(n||(n={}));var o=function(){function e(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.toString()},e}(),s=function(){function e(e){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this.attrs=e.attrs,this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return e})).join(",").replace(/\.[^.,]+/g,"")}var t,i;return t=e,(i=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(e){var t=e%this.url.length;this._urlId!==t&&(this.details=void 0,this._urlId=t)}}])&&r(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./repo/src/types/loader.ts":function(e,t,i){"use strict";var r,n;i.r(t),i.d(t,"PlaylistContextType",(function(){return r})),i.d(t,"PlaylistLevelType",(function(){return n})),function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(n||(n={}))},"./repo/src/types/transmuxer.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"ChunkMetadata",(function(){return r}));var r=function(e,t,i,r,n,a){void 0===r&&(r=0),void 0===n&&(n=-1),void 0===a&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=n,this.partial=a}},"./repo/src/utils/attr-list.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"AttrList",(function(){return a}));var r=/^(\d+)x(\d+)$/,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function e(t){for(var i in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(2*r,2*r+2),16);return i}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var i=this[e];return i?parseFloat(i):t},t.enumeratedString=function(e){return this[e]},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,i={};for(n.lastIndex=0;null!==(t=n.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),i[t[1]]=r}return i},e}()},"./repo/src/utils/binary-search.ts":function(e,t,i){"use strict";i.r(t),t.default={search:function(e,t){for(var i=0,r=e.length-1,n=null,a=null;i<=r;){var o=t(a=e[n=(i+r)/2|0]);if(o>0)i=n+1;else{if(!(o<0))return a;r=n-1}}return null}}},"./repo/src/utils/buffer-helper.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"BufferHelper",(function(){return a}));var r=i("./repo/src/utils/logger.ts"),n={length:0,start:function(){return 0},end:function(){return 0}},a=function(){function e(){}return e.isBuffered=function(t,i){try{if(t)for(var r=e.getBuffered(t),n=0;n<r.length;n++)if(i>=r.start(n)&&i<=r.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(t,i,r){try{if(t){var n,a=e.getBuffered(t),o=[];for(n=0;n<a.length;n++)o.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(o,i,r)}}catch(e){}return{len:0,start:i,end:i,nextStart:void 0}},e.bufferedInfo=function(e,t,i){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var r=[];if(i)for(var n=0;n<e.length;n++){var a=r.length;if(a){var o=r[a-1].end;e[n].start-o<i?e[n].end>o&&(r[a-1].end=e[n].end):r.push(e[n])}else r.push(e[n])}else r=e;for(var s,l=0,d=t,c=t,u=0;u<r.length;u++){var h=r[u].start,f=r[u].end;if(t+i>=h&&t<f)d=h,l=(c=f)-t;else if(t+i<h){s=h;break}}return{len:l,start:d||0,end:c||0,nextStart:s}},e.getBuffered=function(e){try{return e.buffered}catch(e){return r.logger.log("failed to get media.buffered",e),n}},e}()},"./repo/src/utils/codecs.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"isCodecType",(function(){return n})),i.d(t,"isCodecSupportedInMp4",(function(){return a}));var r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function n(e,t){var i=r[t];return!!i&&!0===i[e.slice(0,4)]}function a(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./repo/src/utils/discontinuities.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"findFirstFragWithCC",(function(){return o})),i.d(t,"shouldAlignOnDiscontinuities",(function(){return s})),i.d(t,"findDiscontinuousReferenceFrag",(function(){return l})),i.d(t,"adjustSlidingStart",(function(){return c})),i.d(t,"alignStream",(function(){return u})),i.d(t,"alignPDT",(function(){return h})),i.d(t,"alignFragmentByPDTDelta",(function(){return f})),i.d(t,"alignMediaPlaylistByPDT",(function(){return m}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/utils/logger.ts"),a=i("./repo/src/controller/level-helper.ts");function o(e,t){for(var i=null,r=0,n=e.length;r<n;r++){var a=e[r];if(a&&a.cc===t){i=a;break}}return i}function s(e,t,i){return!(!t.details||!(i.endCC>i.startCC||e&&e.cc<i.startCC))}function l(e,t){var i=e.fragments,r=t.fragments;if(r.length&&i.length){var a=o(i,r[0].cc);if(a&&(!a||a.startPTS))return a;n.logger.log("No frag in previous level to align on")}else n.logger.log("No fragments to align")}function d(e,t){if(e){var i=e.start+t;e.start=e.startPTS=i,e.endPTS=i+e.duration}}function c(e,t){for(var i=t.fragments,r=0,n=i.length;r<n;r++)d(i[r],e);t.fragmentHint&&d(t.fragmentHint,e),t.alignedSliding=!0}function u(e,t,i){t&&(function(e,t,i){if(s(e,i,t)){var a=l(i.details,t);a&&Object(r.isFiniteNumber)(a.start)&&(n.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),c(a.start,t))}}(e,i,t),!i.alignedSliding&&t.details&&h(i,t.details),i.alignedSliding||!t.details||i.skippedSegments||Object(a.adjustSliding)(t.details,i))}function h(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var i=t.fragments[0].programDateTime,a=e.fragments[0].programDateTime,o=(a-i)/1e3+t.fragments[0].start;o&&Object(r.isFiniteNumber)(o)&&(n.logger.log("Adjusting PTS using programDateTime delta "+(a-i)+"ms, sliding:"+o.toFixed(3)+" "+e.url+" "),c(o,e))}}function f(e,t){var i=e.programDateTime;if(i){var r=(i-t)/1e3;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function m(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var i=t.fragments[0].programDateTime-1e3*t.fragments[0].start;e.fragments.forEach((function(e){f(e,i)})),e.fragmentHint&&f(e.fragmentHint,i),e.alignedSliding=!0}}},"./repo/src/utils/ewma-bandwidth-estimator.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/utils/ewma.ts"),n=function(){function e(e,t,i){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new r.default(e),this.fast_=new r.default(t)}var t=e.prototype;return t.update=function(e,t){var i=this.slow_,n=this.fast_;this.slow_.halfLife!==e&&(this.slow_=new r.default(e,i.getEstimate(),i.getTotalWeight())),this.fast_.halfLife!==t&&(this.fast_=new r.default(t,n.getEstimate(),n.getTotalWeight()))},t.sample=function(e,t){var i=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/i;this.fast_.sample(i,r),this.slow_.sample(i,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();t.default=n},"./repo/src/utils/ewma.ts":function(e,t,i){"use strict";i.r(t);var r=function(){function e(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}var t=e.prototype;return t.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}();t.default=r},"./repo/src/utils/fetch-loader.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"fetchSupported",(function(){return h}));var r=i("./repo/src/polyfills/number.ts"),n=i("./repo/src/loader/load-stats.ts"),a=i("./repo/src/demux/chunk-cache.ts");function o(e){var t="function"==typeof Map?new Map:void 0;return(o=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)})(e)}function s(e,t,i){return(s=l()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&d(n,i.prototype),n}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function h(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var f=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||m,this.controller=new self.AbortController,this.stats=new n.LoadStats}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},t.abortInternal=function(){var e=this.response;e&&e.ok||(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,i){var n=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var o=function(e,t){var i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(u({},e.headers))};return e.rangeEnd&&i.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),i}(e,this.controller.signal),s=i.onProgress,l="arraybuffer"===e.responseType,d=l?"byteLength":"length";this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((function(){n.abortInternal(),i.onTimeout(a,e,n.response)}),t.timeout),self.fetch(this.request).then((function(i){if(n.response=n.loader=i,!i.ok){var o=i.status,d=i.statusText;throw new p(d||"fetch, bad network response",o,i)}return a.loading.first=Math.max(self.performance.now(),a.loading.start),a.total=parseInt(i.headers.get("Content-Length")||"0"),s&&Object(r.isFiniteNumber)(t.highWaterMark)?n.loadProgressively(i,a,e,t.highWaterMark,s):l?i.arrayBuffer():i.text()})).then((function(o){var l=n.response;self.clearTimeout(n.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first),a.loaded=a.total=o[d];var c={url:l.url,data:o};s&&!Object(r.isFiniteNumber)(t.highWaterMark)&&s(a,e,o,l),i.onSuccess(c,a,e,l)})).catch((function(t){if(self.clearTimeout(n.requestTimeout),!a.aborted){var r=t.code||0;i.onError({code:r,text:t.message},e,t.details)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.loadProgressively=function(e,t,i,r,n){void 0===r&&(r=0);var o=new a.default,s=e.body.getReader();return function a(){return s.read().then((function(s){if(s.done)return o.dataLength&&n(t,i,o.flush(),e),Promise.resolve(new ArrayBuffer(0));var l=s.value,d=l.length;return t.loaded+=d,d<r||o.dataLength?(o.push(l),o.dataLength>=r&&n(t,i,o.flush(),e)):n(t,i,l,e),a()})).catch((function(){return Promise.reject()}))}()},e}();function m(e,t){return new self.Request(e.url,t)}var p=function(e){var t,i;function r(t,i,r){var n;return(n=e.call(this,t)||this).code=void 0,n.details=void 0,n.code=i,n.details=r,n}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,d(t,i),r}(o(Error));t.default=f},"./repo/src/utils/logger.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"enableLogs",(function(){return s})),i.d(t,"logger",(function(){return l}));var r=function(){},n={trace:r,debug:r,log:r,warn:r,info:r,error:r},a=n;function o(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):r}function s(e){if(self.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];i.forEach((function(t){a[t]=e[t]?e[t].bind(e):o(t)}))}(e,"debug","log","info","warn","error");try{a.log()}catch(e){a=n}}else a=n}var l=n},"./repo/src/utils/mediakeys-helper.ts":function(e,t,i){"use strict";var r;i.r(t),i.d(t,"KeySystems",(function(){return r})),i.d(t,"requestMediaKeySystemAccess",(function(){return n})),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(r||(r={}));var n="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./repo/src/utils/mediasource-helper.ts":function(e,t,i){"use strict";function r(){return self.MediaSource||self.WebKitMediaSource}i.r(t),i.d(t,"getMediaSource",(function(){return r}))},"./repo/src/utils/mp4-tools.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"RemuxerTrackIdConfig",(function(){return l})),i.d(t,"bin2str",(function(){return d})),i.d(t,"readUint16",(function(){return c})),i.d(t,"readUint32",(function(){return u})),i.d(t,"readSint32",(function(){return h})),i.d(t,"writeUint32",(function(){return f})),i.d(t,"findBox",(function(){return m})),i.d(t,"parseSegmentIndex",(function(){return p})),i.d(t,"parseInitSegment",(function(){return b})),i.d(t,"getStartDTS",(function(){return y})),i.d(t,"getDuration",(function(){return g})),i.d(t,"computeRawDurationFromSamples",(function(){return v})),i.d(t,"offsetStartDTS",(function(){return Z})),i.d(t,"segmentValidRange",(function(){return T})),i.d(t,"appendUint8Array",(function(){return L})),i.d(t,"parseSamples",(function(){return S})),i.d(t,"parseSEIMessageFromNALu",(function(){return k})),i.d(t,"parseEmsg",(function(){return I}));var r=i("./repo/src/utils/typed-array.ts"),n=i("./repo/src/loader/fragment.ts"),a=i("./repo/src/demux/id3.ts"),o=Math.pow(2,32)-1,s=[].push,l={video:1,audio:2,id3:3,text:4};function d(e){return String.fromCharCode.apply(null,e)}function c(e,t){var i=e[t]<<8|e[t+1];return i<0?65536+i:i}function u(e,t){var i=h(e,t);return i<0?4294967296+i:i}function h(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function f(e,t,i){e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i}function m(e,t){var i=[];if(!t.length)return i;for(var r=e.byteLength,n=0;n<r;){var a=u(e,n),o=a>1?n+a:r;if(d(e.subarray(n+4,n+8))===t[0])if(1===t.length)i.push(e.subarray(n+8,o));else{var l=m(e.subarray(n+8,o),t.slice(1));l.length&&s.apply(i,l)}n=o}return i}function p(e){var t=m(e,["moov"])[0],i=t?t.length:null,r=m(e,["sidx"]);if(!r||!r[0])return null;var n=[],a=r[0],o=a[0],s=0===o?8:16,l=u(a,s);s+=4,s+=0===o?8:16,s+=2;var d=a.length+0,h=c(a,s);s+=2;for(var f=0;f<h;f++){var p=s,b=u(a,p);p+=4;var y=2147483647&b;if(1==(2147483648&b)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var g=u(a,p);p+=4,n.push({referenceSize:y,subsegmentDuration:g,info:{duration:g/l,start:d,end:d+y-1}}),d+=y,s=p+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:h,references:n,moovEndOffset:i}}function b(e){for(var t=[],i=m(e,["moov","trak"]),r=0;r<i.length;r++){var a=i[r],o=m(a,["tkhd"])[0];if(o){var s=o[0],l=0===s?12:20,c=u(o,l),h=m(a,["mdia","mdhd"])[0];if(h){var f=u(h,l=0===(s=h[0])?12:20),p=m(a,["mdia","hdlr"])[0];if(p){var b=d(p.subarray(8,12)),y={soun:n.ElementaryStreamTypes.AUDIO,vide:n.ElementaryStreamTypes.VIDEO}[b];if(y){var g=m(a,["mdia","minf","stbl","stsd"])[0],v=void 0;g&&(v=d(g.subarray(12,16))),t[c]={timescale:f,type:y},t[y]={timescale:f,id:c,codec:v}}}}}}return m(e,["moov","mvex","trex"]).forEach((function(e){var i=u(e,4),r=t[i];r&&(r.default={duration:u(e,12),flags:u(e,20)})})),t}function y(e,t){return m(t,["moof","traf"]).reduce((function(t,i){var r=m(i,["tfdt"])[0],n=r[0],a=m(i,["tfhd"]).reduce((function(t,i){var a=u(i,4),o=e[a];if(o){var s=u(r,4);1===n&&(s*=Math.pow(2,32),s+=u(r,8));var l=s/(o.timescale||9e4);if(isFinite(l)&&(null===t||l<t))return l}return t}),null);return null!==a&&isFinite(a)&&(null===t||a<t)?a:t}),null)||0}function g(e,t){for(var i=0,r=0,a=0,o=m(e,["moof","traf"]),s=0;s<o.length;s++){var l=o[s],d=m(l,["tfhd"])[0],c=t[u(d,4)];if(c){var h=c.default,f=u(d,0)|(null==h?void 0:h.flags),b=null==h?void 0:h.duration;8&f&&(b=u(d,2&f?12:8));for(var y=c.timescale||9e4,g=m(l,["trun"]),Z=0;Z<g.length;Z++)!(i=v(g[Z]))&&b&&(i=b*u(g[Z],4)),c.type===n.ElementaryStreamTypes.VIDEO?r+=i/y:c.type===n.ElementaryStreamTypes.AUDIO&&(a+=i/y)}}if(0===r&&0===a){var T=p(e);if(null!=T&&T.references)return T.references.reduce((function(e,t){return e+t.info.duration||0}),0)}return r||a}function v(e){var t=u(e,0),i=8;1&t&&(i+=4),4&t&&(i+=4);for(var r=0,n=u(e,4),a=0;a<n;a++)256&t&&(r+=u(e,i),i+=4),512&t&&(i+=4),1024&t&&(i+=4),2048&t&&(i+=4);return r}function Z(e,t,i){m(t,["moof","traf"]).forEach((function(t){m(t,["tfhd"]).forEach((function(r){var n=u(r,4),a=e[n];if(a){var s=a.timescale||9e4;m(t,["tfdt"]).forEach((function(e){var t=e[0],r=u(e,4);if(0===t)f(e,4,r-i*s);else{r*=Math.pow(2,32),r+=u(e,8),r-=i*s,r=Math.max(r,0);var n=Math.floor(r/(o+1)),a=Math.floor(r%(o+1));f(e,4,n),f(e,8,a)}}))}}))}))}function T(e){var t={valid:null,remainder:null},i=m(e,["moof"]);if(!i)return t;if(i.length<2)return t.remainder=e,t;var n=i[i.length-1];return t.valid=Object(r.sliceUint8)(e,0,n.byteOffset-8),t.remainder=Object(r.sliceUint8)(e,n.byteOffset-8),t}function L(e,t){var i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function S(e,t){var i=[],r=t.samples,a=t.timescale,o=t.id,s=!1;return m(r,["moof"]).map((function(l){var d=l.byteOffset-8;m(l,["traf"]).map((function(l){var c=m(l,["tfdt"]).map((function(e){var t=e[0],i=u(e,4);return 1===t&&(i*=Math.pow(2,32),i+=u(e,8)),i/a}))[0];return void 0!==c&&(e=c),m(l,["tfhd"]).map((function(c){var f=u(c,4),p=16777215&u(c,0),b=0,y=0!=(16&p),g=0,v=0!=(32&p),Z=8;f===o&&(0!=(1&p)&&(Z+=8),0!=(2&p)&&(Z+=4),0!=(8&p)&&(b=u(c,Z),Z+=4),y&&(g=u(c,Z),Z+=4),v&&(Z+=4),"video"===t.type&&(s=function(e){if(!e)return!1;var t=e.indexOf("."),i=t<0?e:e.substring(0,t);return"hvc1"===i||"hev1"===i||"dvh1"===i||"dvhe"===i}(t.codec)),m(l,["trun"]).map((function(o){var l=o[0],c=16777215&u(o,0),f=0!=(1&c),m=0,p=0!=(4&c),y=0!=(256&c),v=0,Z=0!=(512&c),T=0,L=0!=(1024&c),S=0!=(2048&c),I=0,X=u(o,4),R=8;f&&(m=u(o,R),R+=4),p&&(R+=4);for(var w=m+d,G=0;G<X;G++){if(y?(v=u(o,R),R+=4):v=b,Z?(T=u(o,R),R+=4):T=g,L&&(R+=4),S&&(I=0===l?u(o,R):h(o,R),R+=4),t.type===n.ElementaryStreamTypes.VIDEO)for(var W=0;W<T;){var E=u(r,w),_=31&r[w+=4];x(s,_)&&k(r.subarray(w,w+E),e+I/a,i),w+=E,W+=E+4}e+=v/a}})))}))}))})),i}function x(e,t){return e?39===t||40===t:6===t}function k(e,t,i){var r=function(e){for(var t=e.byteLength,i=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(i.push(r+2),r+=2):r++;if(0===i.length)return e;var n=t-i.length,a=new Uint8Array(n),o=0;for(r=0;r<n;o++,r++)o===i[0]&&(o++,i.shift()),a[r]=e[o];return a}(e),n=0;n++;for(var o=0,s=0,l=!1,d=0;n<r.length;){o=0;do{if(n>=r.length)break;o+=d=r[n++]}while(255===d);s=0;do{if(n>=r.length)break;s+=d=r[n++]}while(255===d);var h=r.length-n;if(!l&&4===o&&n<r.length){if(l=!0,181===r[n++]){var f=c(r,n);if(n+=2,49===f){var m=u(r,n);if(n+=4,1195456820===m){var p=r[n++];if(3===p){var b=r[n++],y=64&b,g=y?2+3*(31&b):0,v=new Uint8Array(g);if(y){v[0]=b;for(var Z=1;Z<g;Z++)v[Z]=r[n++]}i.push({type:p,payloadType:o,pts:t,bytes:v})}}}}}else if(5===o&&s<h){if(l=!0,s>16){for(var T=[],L=0;L<16;L++){var S=r[n++].toString(16);T.push(1==S.length?"0"+S:S),3!==L&&5!==L&&7!==L&&9!==L||T.push("-")}for(var x=s-16,k=new Uint8Array(x),I=0;I<x;I++)k[I]=r[n++];i.push({payloadType:o,pts:t,uuid:T.join(""),userData:Object(a.utf8ArrayToStr)(k),userDataBytes:k})}}else if(s<h)n+=s;else if(s>h)break}}function I(e){var t=e[0],i="",r="",n=0,a=0,o=0,s=0,l=0,c=0;if(0===t){for(;"\0"!==d(e.subarray(c,c+1));)i+=d(e.subarray(c,c+1)),c+=1;for(i+=d(e.subarray(c,c+1)),c+=1;"\0"!==d(e.subarray(c,c+1));)r+=d(e.subarray(c,c+1)),c+=1;r+=d(e.subarray(c,c+1)),c+=1,n=u(e,12),a=u(e,16),s=u(e,20),l=u(e,24),c=28}else if(1===t){n=u(e,c+=4);var h=u(e,c+=4),f=u(e,c+=4);for(c+=4,o=Math.pow(2,32)*h+f,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=u(e,c),l=u(e,c+=4),c+=4;"\0"!==d(e.subarray(c,c+1));)i+=d(e.subarray(c,c+1)),c+=1;for(i+=d(e.subarray(c,c+1)),c+=1;"\0"!==d(e.subarray(c,c+1));)r+=d(e.subarray(c,c+1)),c+=1;r+=d(e.subarray(c,c+1)),c+=1}return{schemeIdUri:i,value:r,timeScale:n,presentationTime:o,presentationTimeDelta:a,eventDuration:s,id:l,payload:e.subarray(c,e.byteLength)}}},"./repo/src/utils/texttrack-utils.ts":function(e,t,i){"use strict";i.r(t),i.d(t,"sendAddTrackEvent",(function(){return n})),i.d(t,"addCueToTrack",(function(){return a})),i.d(t,"clearCurrentCues",(function(){return o})),i.d(t,"removeCuesInRange",(function(){return s})),i.d(t,"getCuesInRange",(function(){return l}));var r=i("./repo/src/utils/logger.ts");function n(e,t){var i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function a(e,t){var i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(i){r.logger.debug("[texttrack-utils]: "+i);var n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}"disabled"===i&&(e.mode=i)}function o(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var i=e.cues.length;i--;)e.removeCue(e.cues[i]);"disabled"===t&&(e.mode=t)}function s(e,t,i){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var n=l(e.cues,t,i),a=0;a<n.length;a++)e.removeCue(n[a]);"disabled"===r&&(e.mode=r)}function l(e,t,i){var r=[],n=function(e,t){if(t<e[0].startTime)return 0;var i=e.length-1;if(t>e[i].endTime)return-1;for(var r=0,n=i;r<=n;){var a=Math.floor((n+r)/2);if(t<e[a].startTime)n=a-1;else{if(!(t>e[a].startTime&&r<i))return a;r=a+1}}return e[r].startTime-t<t-e[n].startTime?r:n}(e,t);if(n>-1)for(var a=n,o=e.length;a<o;a++){var s=e[a];if(s.startTime>=t&&s.endTime<=i)r.push(s);else if(s.startTime>i)return r}return r}},"./repo/src/utils/time-ranges.ts":function(e,t,i){"use strict";i.r(t),t.default={toString:function(e){for(var t="",i=e.length,r=0;r<i;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}},"./repo/src/utils/timescale-conversion.ts":function(e,t,i){"use strict";function r(e,t,i,r){void 0===i&&(i=1),void 0===r&&(r=!1);var n=e*t*i;return r?Math.round(n):n}function n(e,t,i,n){return void 0===i&&(i=1),void 0===n&&(n=!1),r(e,t,1/i,n)}function a(e,t){return void 0===t&&(t=!1),r(e,1e3,1/9e4,t)}function o(e,t){return void 0===t&&(t=1),r(e,9e4,1/t)}i.r(t),i.d(t,"toTimescaleFromBase",(function(){return r})),i.d(t,"toTimescaleFromScale",(function(){return n})),i.d(t,"toMsFromMpegTsClock",(function(){return a})),i.d(t,"toMpegTsClockFromTimescale",(function(){return o}))},"./repo/src/utils/typed-array.ts":function(e,t,i){"use strict";function r(e,t,i){return Uint8Array.prototype.slice?e.slice(t,i):new Uint8Array(Array.prototype.slice.call(e,t,i))}i.r(t),i.d(t,"sliceUint8",(function(){return r}))},"./repo/src/utils/xhr-loader.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/utils/logger.ts"),n=i("./repo/src/loader/load-stats.ts"),a=/^age:\s*[\d.]+\s*$/m,o=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e?e.xhrSetup:null,this.stats=new n.LoadStats,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e=this.config,t=this.context;if(e){var i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(i,t.url)}catch(e){i.open("GET",t.url,!0),n(i,t.url)}i.readyState||i.open("GET",t.url,!0);var a=this.context.headers;if(a)for(var o in a)i.setRequestHeader(o,a[o])}catch(e){return void this.callbacks.onError({code:i.status,text:e.message},t,i)}t.rangeEnd&&i.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),i.onreadystatechange=this.readystatechange.bind(this),i.onprogress=this.loadprogress.bind(this),i.responseType=t.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),e.timeout),i.send()}},t.readystatechange=function(){var e=this.context,t=this.loader,i=this.stats;if(e&&t){var n=t.readyState,a=this.config;if(!i.aborted&&n>=2)if(self.clearTimeout(this.requestTimeout),0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start)),4===n){t.onreadystatechange=null,t.onprogress=null;var o=t.status;if(o>=200&&o<300){var s,l;if(i.loading.end=Math.max(self.performance.now(),i.loading.first),l="arraybuffer"===e.responseType?(s=t.response).byteLength:(s=t.responseText).length,i.loaded=i.total=l,!this.callbacks)return;var d=this.callbacks.onProgress;if(d&&d(i,e,s,t),!this.callbacks)return;var c={url:t.responseURL,data:s};this.callbacks.onSuccess(c,i,e,t)}else i.retry>=a.maxRetry||o>=400&&o<499?(r.logger.error(o+" while loading "+e.url),this.callbacks.onError({code:o,text:t.statusText},e,t)):(r.logger.warn(o+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout)}},t.loadtimeout=function(){r.logger.warn("timeout while loading "+this.context.url);var e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&a.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},e}();t.default=o},"./src/hls-wrapper.ts":function(e,t,i){"use strict";i.r(t);var r=i("./repo/src/hls.ts"),n=i("../crypt/dist/jsvmp.js");for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=r.default}}).default},e.exports=r())},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_TIMESTAMP=5e9,t.MIN_EXPIRE_INTERVAL=300},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={getBrowserVersion:function(){var e=navigator.userAgent;if(e.toLowerCase().indexOf("mobile")>-1)return"Unknown";if(e.indexOf("Firefox")>-1)return"Firefox "+e.match(/firefox\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Edge")>-1)return"Edge "+e.match(/edge\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("rv:11")>-1)return"IE 11";if(e.indexOf("Opera")>-1||e.indexOf("OPR")>-1){if(e.indexOf("Opera")>-1)return"Opera "+e.match(/opera\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("OPR")>-1)return"Opera "+e.match(/opr\/[\d.]+/gi)[0].match(/[\d]+/)[0]}else{if(e.indexOf("Chrome")>-1)return"Chrome "+e.match(/chrome\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Safari")>-1)return"Safari "+e.match(/safari\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(!(e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1))return"Unknown";if(e.indexOf("MSIE")>-1)return"IE "+e.match(/msie [\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Trident")>-1){var t=e.match(/trident\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"IE "+(parseInt(t)+4)}}},parseUrl:function(e){var t=e.split("?")[1],i={};return t&&t.split("&").forEach((function(e){e=e.split("="),i[e[0]]=decodeURIComponent(e[1])})),i},isBase64:function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)},isRelativeURL:function(e){return!/^(?:[a-z]+:)?\/\//.test(e)},getAbsoluteURL:function(e){var t=new Image;return t.src=e,t.src},checkMediaSourceSupport:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported},offInDestroy:function(e,t,i,r){e.once(r,(function n(){e.off(t,i),e.off(r,n)}))},on:function(e,t,i,n){n?(e.on(t,i),r.offInDestroy(e,t,i,n)):e.on(t,(function r(n){i(n),e.off(t,r)}))},once:function(e,t,i,n){n?(e.once(t,i),r.offInDestroy(e,t,i,n)):e.once(t,(function r(n){i(n),e.off(t,r)}))}};t.default=r,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeID=null,this.func=null}return r(e,[{key:"repeat",value:function(e,t){var i=this;null===this.func&&(this.func=e),this.func===e&&(this.timeID=setTimeout((function(){e(),i.repeat(e,t)}),t))}},{key:"clear",value:function(){clearTimeout(this.timeID)}}]),e}();t.default=n,e.exports=t.default},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.url,n=t.method,a=void 0===n?"GET":n,o=t.type,s=void 0===o?"arraybuffer":o,l=t.timeout,d=void 0===l?1e4:l,c=t.data,u=void 0===c?{}:c;return r(this,e),new Promise((function(e,t){var r=new window.XMLHttpRequest,n=a.toUpperCase(),o=[];for(var l in s&&(r.responseType=s),d&&(r.timeout=d),u)o.push("k="+u[l]);if(r.onload=function(){200===r.status||206===r.status?e(r):t(r)},r.onerror=function(){t(r)},r.ontimeout=function(){t(r)},r.onabort=function(){t(r)},"GET"===n)r.open(n,""+i),r.send();else{if("post"!==n)throw new Error("xhr "+n+" is not supported");r.open(n,i),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(o.join("&"))}}))},e.exports=t.default}]))},79548:(e,t,i)=>{"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(){a=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function c(e,t,i,n){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),s=new I(n||[]);return r(o,"_invoke",{value:L(e,i,s)}),o}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h={};function f(){}function m(){}function p(){}var b={};d(b,o,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(X([])));g&&g!==t&&i.call(g,o)&&(b=g);var v=p.prototype=f.prototype=Object.create(b);function Z(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(r,a,o,s){var l=u(e[r],e,a);if("throw"!==l.type){var d=l.arg,c=d.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){d.value=e,o(d)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return a=a?a.then(r,r):r()}})}function L(e,t,i){var r="suspendedStart";return function(n,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw a;return{value:void 0,done:!0}}for(i.method=n,i.arg=a;;){var o=i.delegate;if(o){var s=S(o,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var l=u(e,t,i);if("normal"===l.type){if(r=i.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r="completed",i.method="throw",i.arg=l.arg)}}}function S(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),h;var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function X(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=p,r(v,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:m,configurable:!0}),m.displayName=d(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,d(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},Z(T.prototype),d(T.prototype,s,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,r,n,a){void 0===a&&(a=Promise);var o=new T(c(t,i,r,n),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},Z(v),d(v,l,"Generator"),d(v,o,(function(){return this})),d(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=X,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return o.type="throw",o.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:X(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function o(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function s(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function s(e){o(a,r,n,s,l,"next",e)}function l(e){o(a,r,n,s,l,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function c(e,t,i){return t&&d(e.prototype,t),i&&d(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.r(t),i.d(t,{default:()=>R,sniffer:()=>v});var f="living_device_id",m="living_user_id",p=function(e){if(!document.cookie)return null;for(var t=document.cookie.split(";"),i=0,r=t.length;i<r;i++){var n=t[i];if(t[i].indexOf(e)>=0)return n.split("=")[1]||null}},b=function(e){return String(Math.floor(Math.random()*Math.pow(10,e)))},y=function(){var e=p(f);if(e)return e;var t=b(11);return document.cookie="".concat(f,"=").concat(t,";max-age=31536000;path=/"),t},g=function(){var e=p(m);if(e)return e;var t=b(12);return document.cookie="".concat(m,"=").concat(t,";max-age=31536000;path=/"),t},v={get device(){return v.os.isPc?"pc":"mobile"},get browser(){var e=function(){var e=navigator.userAgent.toLowerCase(),t={},i={IE:window.ActiveXObject||"ActiveXObject"in window,Chrome:e.indexOf("chrome")>-1&&e.indexOf("safari")>-1,Firefox:e.indexOf("firefox")>-1,Opera:e.indexOf("opera")>-1,Safari:e.indexOf("safari")>-1&&-1==e.indexOf("chrome"),Edge:e.indexOf("edge")>-1,QQBrowser:/qqbrowser/.test(e),WeChBrowser:/MicroMessenger/i.test(e)};for(var r in i)if(i[r]){var n="";if("IE"===r)n=e.match(/(msie\s|trident.*rv:)([\w.]+)/)[2];else if("Chrome"===r){for(var a in navigator.mimeTypes)"application/360softmgrplugin"===navigator.mimeTypes[a].type&&(r="360");var o=e.match(/chrome\/([\d.]+)/);n=o?o[1]:"-1"}else if("Firefox"===r){var s=e.match(/firefox\/([\d.]+)/);n=s?s[1]:"-1"}else if("Opera"===r){var l=e.match(/opera\/([\d.]+)/);n=l?l[1]:"-1"}else if("Safari"===r){var d=e.match(/version\/([\d.]+)/);n=d?d[1]:"-1"}else if("Edge"===r){var c=e.match(/edge\/([\d.]+)/);n=c?c[1]:"-1"}else if("QQBrowser"===r){var u=e.match(/qqbrowser\/([\d.]+)/);n=u?u[1]:"-1"}t.type=r,t.versions=parseInt(n)}return t}(),t=e.type,i=e.versions;return"".concat(t,"_").concat(i)},get os(){var e=navigator.userAgent;navigator.platform.toLowerCase();var t=/(?:Windows Phone)/.test(e),i=/(?:SymbianOS)/.test(e)||t,r=/(?:Android)/.test(e),n=/(?:Firefox)/.test(e),a=/(?:iPad|PlayBook)/.test(e)||r&&!/(?:Mobile)/.test(e)||n&&/(?:Tablet)/.test(e),o=/(?:iPhone)/.test(e)&&!a;return{isTablet:a,isPhone:o,isAndroid:r,isPc:!(o||r||i||a),isSymbian:i,isWindowsPhone:t,isFireFox:n}},get operation_os(){for(var e=navigator.userAgent,t=[{s:"windows",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1|Windows 8.1|Windows NT 6.3|Windows 8|Windows NT 6.2|Windows 7|Windows NT 6.1)/},{s:"android",r:/Android/},{s:"linux",r:/(Linux|X11)/},{s:"ios",r:/(iPhone|iPad|iPod)/},{s:"mac",r:/Mac OS X/},{s:"mac",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],i=0;i<t.length;i++){var r=t[i];if(r.r.test(e))return r.s}return"unknown"}};function Z(){return(new Date).getTime()}function T(e){var t="unknown";return"string"!=typeof e?t:e.indexOf(".flv")>-1?"flv":e.indexOf(".m3u8")>-1?"m3u8":e.indexOf(".mp4")>-1?"mp4":e.indexOf(".sdp")>-1?"rts":t}function L(e){return"undefined"!=typeof MediaSource?+MediaSource.isTypeSupported("video/mp4; codecs=".concat(e)):0}function S(e){if(e.plugins){if(e.plugins.flvlive)return e.plugins.flvlive;if(e.plugins.hlslive)return e.plugins.hlslive;if(e.plugins.hlsvod)return e.plugins.hlsvod;if(e.plugins.hlslivemobile)return e.plugins.hlslivemobile;if(e.plugins.flvlivemobile)return e.plugins.flvlivemobile;if(e.plugins.rts)return e.plugins.rts}return e.newHls||e.newFlv||e.__core__||e.flv}var x={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},k=function(){function e(t){l(this,e);var i=t.Tea;if(!i)throw new Error("lack Tea option");i.event?this.Tea=i.event.bind(i):this.Tea=i,this.logOptions=t,this._player=t.player}return c(e,[{key:"push",value:function(e){var t=this._player.config.url;this._player.video&&(e.play_current_time=this._player.currentTime),e.cdn_play_url=t&&t.startsWith("//")?window.location.protocol+t:t,e.live_stream_session_id=function(e,t){return new URLSearchParams(e.split("?")[1]).get("_session_id")}(t),e.play_format=T(t),e.timestamp=Z();var i=function(){var e={cpu_core_number:-1,memory_usage:-1,network_downlink:-1};try{e.cpu_core_number=navigator.hardwareConcurrency||-1,e.memory_usage=navigator.deviceMemory||-1,e.network_downlink=navigator.connection&&navigator.connection.downlink,null==e.network_downlink&&(e.network_downlink=-1)}catch(e){}return e}(),r=i.cpu_core_number,n=i.memory_usage,a=i.network_downlink;e.cpu_core_number=r,e.memory_usage=n,e.network_downlink=a,this.send(e)}},{key:"send",value:function(e){e.event_key&&(this.logOptions.onReport&&this.logOptions.onReport(e.event_key,e),this.Tea(e.event_key,n({},e)))}}]),e}(),I=["play","playing","pause","ended","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","ratechange","volumechange","loadeddata"],X=!1,R=function(){function e(t){l(this,e),this.options=t,this.logger=new w(t),this.restart=this.restart.bind(this),this.bindUrlChange(),X=v.browser.includes("Chrome")}return c(e,[{key:"restart",value:function(e){this.destroy("string"!=typeof e&&Boolean(e)),this.logger=new w(this.options),this.bindUrlChange(),this.logger.reportStartPlay(),this.logger.handlePlayerComlete()}},{key:"bindUrlChange",value:function(){this.options&&this.options.player&&!this.options.manual_restart&&this.options.player.on("urlchange",this.restart)}},{key:"setNTP",value:function(e){this.logger.setNTP(e)}},{key:"updateExt",value:function(e){this.options.ext=Object.assign(this.options.ext||{},e),this.logger&&this.logger.updateExt(e)}},{key:"updateOptions",value:function(e){Object.assign(this.options,e),this.logger&&this.logger.updateOptions(e)}},{key:"destroy",value:function(e){this.logger.destroy(e),this.logger=null,this.options&&this.options.player&&!this.options.manual_restart&&this.options.player.off("urlchange",this.restart)}}]),e}(),w=function(){function e(t){if(l(this,e),!t.player)throw new Error("option player is necessary");this.options=Object.assign({},t,function(e){return{device_id:e.device_id||y(),user_id:e.user_id||g(),error_report_stop:!!e.error_report_stop,project_key:e.project_key||"live",product_line:e.product_line||"live",onReport:e.onReport||function(){}}}(t)),this.stallOut=this.options.stallOut||1e4,this._player=this.options.player,this._url=this._player.config.url,this.project_key=t.project_key||"live",this.product_line=t.product_line||"live",this.ntpDelta=this.options.ntp?Date.now()-this.options.ntp:0,this.inWaitingStart=0,this.errorNumber=0,this.tempFirstStallTime=0,this.tempDroppedFrameCount=0,this.tempTotalFrameCount=0,this._logmanager=new k(this.options),this.init(),this.started=!1,this.destroyed=!1,this.completed=!1,this.firstFrameViewed=!1,this.cacheRtcStats={}}var t,i,r,o;return c(e,[{key:"videoSize",get:function(){return this.player?{width:this.player.video.videoWidth,height:this.player.video.videoHeight}:{width:0,height:0}}},{key:"player",get:function(){return this._player}},{key:"logmanager",get:function(){return this._logmanager}},{key:"ntpTime",get:function(){return Date.now()-this.ntpDelta}},{key:"setNTP",value:function(e){this.options&&(this.options.ntp=e,this.ntpDelta=Date.now()-this.options.ntp)}},{key:"init",value:function(){this.bindCtx(),this.initLog(),this.initEvt()}},{key:"bindCtx",value:function(){this.handlePlayerComlete=this.handlePlayerComlete.bind(this),this.handlePlayerPlaying=this.handlePlayerPlaying.bind(this),this.destroyFunc=this.destroyFunc.bind(this),this.handleUserLeave=this.handleUserLeave.bind(this),this.handlePlayerError=this.handlePlayerError.bind(this),this.handlePlayerReady=this.handlePlayerReady.bind(this),this.handlePlayerWaiting=this.handlePlayerWaiting.bind(this),this.handleAVUnsync=this.handleAVUnsync.bind(this),this.handleSEIParsed=this.handleSEIParsed.bind(this),this.handlePlayerPause=this.handlePlayerPause.bind(this),this.handleTTFB=this.handleTTFB.bind(this),this.handleUrlChange=this.handleUrlChange.bind(this),this.handleKeyframe=this.handleKeyframe.bind(this),this.handleSourceOpen=this.handleSourceOpen.bind(this),this.handleBufferAppend=this.handleBufferAppend.bind(this),this.handleDegrade=this.handleDegrade.bind(this),this.handleAbrSwitch=this.handleAbrSwitch.bind(this),this.handleChaseFrame=this.handleChaseFrame.bind(this)}},{key:"initLog",value:function(){var e=this,t=this.options,i=t.player,r=void 0!==i.hlsOps;this.commonParams=n({os:v.operation_os},function(e){var t=e.player;return n({project_key:e.project_key,live_sdk_version:S(t)||t.hlsOps?"2":"-1",player_sdk_version:t.version,logger_version:"0.3.4",report_version:"5",fps:0,product_line:e.product_line,user_id:e.user_id,device_id:e.device_id,logger_id:b(12),app_name:e.app_name,cdn_ip:e.cdn_ip,is_wasm:["mobile-video","live-video"].indexOf(t.config.mediaType)>-1?1:0,review_is_live:t.config.isLive?2:1,aid:e.aid,live_id:e.live_id||"".concat(e.aid,"-").concat(e.user_id,"-").concat(Date.now()),is_preview:e.is_preview?1:0,codec_type:e.codec_type||"h264",width:Math.floor(t.config.width),height:Math.floor(t.config.height),browser:v.browser,ua:navigator.userAgent,href:window.location.href,timestamp:0,logger_init_time:Date.now(),isSupportedH265:L("hev1.1.6.L93.B0,mp4a.40.2"),codec_support:-1,play_current_time:0,cdn_play_url:t.config.url&&t.config.url.startsWith("//")?window.location.protocol+t.config.url:t.config.url,play_format:T(t.config.url)},e.ext)}(t)),this.log=Object.assign({},{start_play:{start_play_time:0,event_key:"start_play"},first_frame:{start:0,first_frame_view:0,event_key:"first_frame",first_sei_delay:0,ntp_sync:0,ntp_delta:0,ttfb:-1,ttdb:-1,ttfb_end:0},first_frame_failed:{code:void 0,msg:"",event_key:"first_frame_failed"},stall_start:{ready_state:-1,stall_start_time:0,event_key:"stall_start"},stalling:{event_key:"stalling"},stall:{reason:0,stall_start:0,stall_end:0,ready_state:0,event_key:"stall"},play_stop:{error_code:0,stop_time:0,drop_percent:0,is_stream_received:0,stall_count:0,stall_time:0,retry_count:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,event_key:"play_stop",dns_parse_time:-1,redirect:-1,ttfb:-1,buffered:[],is_firstframe_received:0,meta:null},playing:{index:0,stall_count:0,stall_time:0,play_time:1e4,retry_count:0,is_last:0,video_buffer_time:0,audio_buffer_time:0,speed_switch_count:0,speed_switch_info:"none",download_speed:0,decode_fps:0,render_fps:-1,drop_count:0,drop_percent:0,sei_source:"",sei_delay:0,ntp_sync:0,ntp_delta:0,event_key:"playing",stop_time:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,abr_switch_count:0},play_error:{code:void 0,info:"",event_key:"play_error"},play_low_decode:{fps:-1,decode_fps:-1,bitrate:-1,url:-1,msg:"",event_key:"play_low_decode"},play_av_unsync:{aDts:-1,vDts:-1,frameLength:-1,currentTime:-1,duration:0,event_key:"play_av_unsync"},play_loadstream:{loadstream_url:"",event_key:"play_loadstream"},play_stream_loaded:{event_key:"play_stream_loaded"},play_metadata_loaded:{metadata_type:"",event_key:"play_metadata_loaded"},play_demux_error:{msg:"",event_key:"play_demux_error"},play_stream_discontinue:{type:"",dts:-1,event_key:"play_stream_discontinue"},pause:{event_key:"pause"},play_url_change:{event_key:"play_url_change"},source_opened:{event_key:"source_opened"},source_updateend:{event_key:"source_updateend"},play_result:{event_key:"play_result",result:0,threshold:15e3,is_threshold:0},degrade:{event_key:"degrade",payload:{}},abr_switch:{event_key:"abr_switch",stall_count:0,switch_index:0},abr_session:{event_key:"abr_session",stall_time:0,end_buffer:0},play_chase_frame:{event_key:"play_chase_frame"},play_audio_gap:{event_key:"play_audio_gap"},play_audio_overlap:{event_key:"play_audio_overlap"}});var a=this;for(var o in this.log){var s=function(t){Object.defineProperty(e.log[o],t,{get:function(){return null==this["_"+t]?a.commonParams[t]:this["_"+t]},set:function(e){this["_"+t]=e},enumerable:!0})};for(var l in this.commonParams)s(l);r&&Object.defineProperty(this.log[o],"m3u8",{get:function(){if(i&&i.__core__){var e=i.__core__.m3u8Text;return e?e.slice(0,25e4):""}return""},enumerable:!0}),Object.defineProperty(this.log[o],"volume",{get:function(){if(i&&i.video)return i.volume||0},enumerable:!0}),Object.defineProperty(this.log[o],"access",{get:function(){return void 0!==navigator.onLine?navigator.onLine?(e=navigator.connection)&&(e.effectiveType||e.type)||v.device:"none":"unknown";var e},enumerable:!0})}}},{key:"updateExt",value:function(e){for(var t in this.log)for(var i in e)this.log[t][i]=e[i]}},{key:"updateOptions",value:function(e){Object.assign(this.commonParams,e)}},{key:"reportStartPlay",value:function(){this.started||(this.started=!0,this.log.start_play.start_play_time=this.log.start_play.timestamp=Z(),this.logmanager.push(this.log.start_play,!0))}},{key:"initWindowListener",value:function(){"pc"===v.device?window.addEventListener("beforeunload",this.destroyFunc):"mobile"===v.device&&(window.addEventListener("beforeunload",this.destroyFunc),window.addEventListener("pagehide",this.destroyFunc))}},{key:"removeWindowListener",value:function(){"pc"===v.device?window.removeEventListener("beforeunload",this.destroyFunc):"mobile"===v.device&&(window.removeEventListener("beforeunload",this.destroyFunc),window.removeEventListener("pagehide",this.destroyFunc))}},{key:"initEvt",value:function(){var e=this,t=this.player;I.forEach((function(t){e["handleVideo".concat(t,"Evt")]=function(){e["handleVideo".concat(t)]&&e["handleVideo".concat(t)]()},e.bindVideoEvt(t,e["handleVideo".concat(t,"Evt")])})),this.initWindowListener(),t.once("error",this.handlePlayerError),t.once("complete",this.handlePlayerComlete),t.once("playing",this.handlePlayerPlaying),t.once("timeupdate",this.handlePlayerPlaying),t.once("destroy",this.destroyFunc),t.on("ready",this.handlePlayerReady),t.on("waiting",this.handlePlayerWaiting),t.on("SEI_PARSED",this.handleSEIParsed),t.on("pause",this.handlePlayerPause),t.on("ttfb",this.handleTTFB),t.on("urlchange",this.handleUrlChange),t.once("isKeyframe",this.handleKeyframe),t.once("sourceopen",this.handleSourceOpen),t.once("bufferappend",this.handleBufferAppend),t.on("degrade",this.handleDegrade),t.on("chaseframe",this.handleChaseFrame);var i=t.plugins.abr;i&&i.on("abr_switch",this.handleAbrSwitch),this.hiJackPlayerStart()}},{key:"handleChaseFrame",value:function(e){this.logmanager.push(Object.assign(this.log.play_chase_frame,e))}},{key:"handleAbrSwitch",value:function(e){this.log.abr_switch.switch_index++,this.log.playing.abr_switch_count++;var t=Date.now()-(this.log.abr_session.timestamp||this.log.first_frame.timestamp);this.log.abr_switch.switch_interval=t,this.logmanager.push(Object.assign(this.log.abr_switch,e));var i=this.getFetchLoader();this.logmanager.push(Object.assign(this.log.abr_session,{bitrate:e.cur_bitrate,ave_download_speed:Math.round(1e3*((i||{}).totalByteSize||-1)/t),start_buffer:this.log.abr_session.after_buffer,end_buffer:e.cur_video_buffer_time,after_buffer:e.after_video_buffer_time,stall_count:this.log.abr_switch.stall_count,stall_time_per_100sec:this.log.abr_session.stall_time/t*100,stall_count_per_100sec:1e3*this.log.abr_switch.stall_count/t*100})),this.log.abr_switch.stall_count=0,this.log.abr_session.stall_time=0}},{key:"handleDegrade",value:function(e){this.log.degrade.payload=e,this.logmanager.push(this.log.degrade,!0)}},{key:"hiJackPlayerStart",value:function(){var e=arguments,t=this;this.player._start=this.player.start;var i=this.player;i.start=function(){try{if(i._start)return i._start.apply(i,Array.prototype.slice.call(e,0))}catch(e){}t.destroyed||t.handlePlayerComlete()}}},{key:"handleTTFB",value:function(e){var t=e||{},i=t.end,r=t.elapsed;this.log.first_frame.ttfb=r||-1,this.log.first_frame.ttfb_end=i||0}},{key:"handleUrlChange",value:function(e){this.logmanager.push(Object.assign(this.log.play_url_change,{url:e,timestamp:Z()}))}},{key:"handleKeyframe",value:function(e){this.log.play_stop.is_firstframe_received=1,this.log.play_stop.firstframe_pts=e}},{key:"handleSourceOpen",value:function(){this.log.source_opened.timestamp=Z(),this.logmanager.push(this.log.source_opened)}},{key:"handleBufferAppend",value:function(){this.log.source_updateend.timestamp=Z(),this.logmanager.push(this.log.source_updateend)}},{key:"handlePlayerPause",value:function(){this.log.pause.timestamp=Z(),this.logmanager.push(this.log.pause,!0)}},{key:"handlePlayerError",value:function(e){this.setCdnIp(),this.errorNumber=1;var t=e.errorType,i=e.code||e.errorCode;Object.assign(this.log.play_error,n({timestamp:Z(),code:i||("parse"===t?31:21),info:e.ex||"",detail:JSON.stringify(e)},this.videoSize)),this.logmanager.push(this.log.play_error,!0),this.destroyed||(0===this.log.first_frame.first_frame_view&&(Object.assign(this.log.first_frame_failed,{code:i||("parse"===t?31:21),msg:e.ex}),void 0!==this.log.first_frame_failed.timestamp&&(this.log.first_frame_failed.timestamp=Z()),this.logmanager.push(this.log.first_frame_failed,!0),this.log.play_result.is_threshold||(this.clearPlayResultTimer(),this.log.play_result.reason=e.ex,this.log.play_result.code=this.log.play_error.code,this.logmanager.push(this.log.play_result,!0))),this.options.error_report_stop?this.handleUserLeave():this.updatePlayStopParams())}},{key:"handlePlayerLoadStream",value:function(e){if("string"==typeof e){var t=this.log.play_loadstream;t.timestamp=Z(),t.loadstream_url=e,this.logmanager.push(t)}}},{key:"handlePlayerLoadedStream",value:function(){var e=this.log.play_stream_loaded;e.timestamp=Z(),this.logmanager.push(e)}},{key:"handleSEIParsed",value:function(e){var t=this.log,i=t.playing,r=t.first_frame;if(100===e.code){var n=function(e){var t,i,r,n,a,o;for(t="",r=e.length,i=0;i<r;)switch((n=e[i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(n);break;case 12:case 13:a=e[i++],t+=String.fromCharCode((31&n)<<6|63&a);break;case 14:a=e[i++],o=e[i++],t+=String.fromCharCode((15&n)<<12|(63&a)<<6|(63&o)<<0)}return t}(e.content);n=function(e){var t=e;return['"app_data"','app_data"','canvas"','"canvas"'].some((function(i){var r=function(e,t){var i;if(!e)return"";var r=new RegExp("^([\\w\\W]*)".concat(t,".*")).exec(e);return null!==(i=null==r?void 0:r[1])&&void 0!==i?i:""}(e,i);if(r&&"{"!==r&&r.length<4){var n='"'!==i[0];return t="{".concat(n?'"':"").concat(e.slice(r.length,e.lastIndexOf("}")+1)),!0}return!1}))||(t=e.slice(e.indexOf("{"),e.lastIndexOf("}")+1)),t}(n);try{var a=JSON.parse(n);i.sei_network_delay=this.ntpTime-a.ts,i.sei_buffer_delay=this.getPlayerBuffer(),i.sei_delay=i.sei_network_delay+i.sei_buffer_delay,i.sei_source=a.source,i.ntp_sync=this.options.ntp?1:0,i.ntp_delta=this.ntp_delta,r.first_sei_delay=i.sei_delay,r.sei_network_delay=i.sei_network_delay,r.sei_buffer_delay=i.sei_buffer_delay,r.ntp_sync=this.options.ntp?1:0,r.ntp_delta=this.ntp_delta}catch(e){}}}},{key:"handleMetaDataLoaded",value:function(e){this.log.play_metadata_loaded.timestamp=Z(),this.log.play_metadata_loaded.metadata_type=e;var t=!1;if(this.core){var i,r=this.core._context||this.core.context;r&&("video"===e?i=(r.getInstance("TRACKS")||{}).videoTrack:"audio"===e&&(i=(r.getInstance("TRACKS")||{}).audioTrack),i&&i.meta&&(t=!0,this.log.play_metadata_loaded.meta=i.meta,this.log.play_metadata_loaded.codec=i.meta.codec,"video"===e&&(this.commonParams.codec_type=i.meta.codec,this.commonParams.codec_support=L(i.meta.codec),this.log.play_metadata_loaded.fps=i.meta.frameRate&&i.meta.frameRate.fps,i.meta.refSampleDuration?this.commonParams.fps=Math.round(1e3/i.meta.refSampleDuration):i.meta.frameRate&&(this.commonParams.fps=i.meta.frameRate.fps))))}t||(this.log.play_metadata_loaded.meta=void 0,this.log.play_metadata_loaded.codec=void 0,"video"===e&&(this.commonParams.codec_type="unknown")),this.logmanager.push(this.log.play_metadata_loaded)}},{key:"handleDemuxError",value:function(e){this.log.play_demux_error.msg=e,this.logmanager.push(this.log.play_demux_error)}},{key:"handleAVUnsync",value:function(e){Object.assign(this.log.play_av_unsync,e||{}),this.log.play_av_unsync.timestamp=Z(),this.logmanager.push(this.log.play_av_unsync,!1)}},{key:"handleDetectLargeGap",value:function(e,t){this.log.play_stream_discontinue.type=e,this.log.play_stream_discontinue.gap=t,this.logmanager.push(this.log.play_stream_discontinue)}},{key:"initContextEvt",value:function(e){var t=this;e._emitter.once("LOADER_RESPONSE_HEADERS",(function(e,i){var r=i.get("X-Server-Ip");t.player&&(void 0!==t.player.hlsOps&&(t.log.play_stop.review_ts_count+=1),r&&(t.commonParams.cdn_ip=r))})),e._emitter.on("REMUX_METADATA",(function(e,i){t.log.play_stop.meta=t.log.play_stop.meta||{},e&&(t.log.play_stop.meta[e]=i)})),e._emitter.on("LOADER_START__TO__TS_LOADER",(function(e){t.handlePlayerLoadStream(e)})),e._emitter.on("LOADER_START",(function(e){t.handlePlayerLoadStream(e)})),e._emitter.on("LOADER_COMPLETE",(function(e){t.handlePlayerLoadedStream(e)})),e._emitter.on("LOADER_RETRY",(function(){t.log.play_stop.retry_count++})),e._emitter.once("DEMUX_ERROR",(function(e,i){i&&(t.log.play_demux_error.msg=i.message,t.handleDemuxError(i.message))})),e._emitter.on("METADATA_PARSED__TO__HLS_LIVE_CONTROLLER",(function(e){t.handleMetaDataLoaded(e)})),e._emitter.on("REMUX_METADATA",(function(e){t.handleMetaDataLoaded(e)})),e._emitter.on("DETECT_LARGE_GAP",(function(e,i){t.handleDetectLargeGap(e,i)})),e._emitter.on("DETECT_AUDIO_GAP",(function(e,i){t.logmanager.push(Object.assign({},t.log.play_audio_gap,{gap:e,silent_frame_count:i}))})),e._emitter.on("DETECT_AUDIO_OVERLAP",(function(e){t.logmanager.push(Object.assign({},t.log.play_audio_overlap,{gap:e}))}))}},{key:"handlePlayerComlete",value:function(){var e=this;if(!this.completed){if(this.completed=!0,this.core=S(this.player),this.core){this.commonParams.live_sdk_version="2";var t=this.core._context||this.core.context;t&&this.initContextEvt(t)}this.commonParams.is_wasm&&(this.player.once("lowdecode",(function(t){Object.assign(e.log.play_low_decode,t||{}),e.log.play_low_decode.decode_fps=t.decodeFps,e.log.play_low_decode.timestamp=Z(),e.logmanager.push(e.log.play_low_decode,!0),e.commonParams.is_wasm=0})),this.player.on("largeavgap",this.handleAVUnsync)),(this.player.config.autoplay||this.player.config.videoInit)&&this.reportStartPlay()}}},{key:"getPlayerBuffer",value:function(){var e=this.player.video.buffered;if(e){var t=Math.max(0,e.length-1);try{var i=Number.parseInt(1e3*(e.end(t)-this.player.video.currentTime));return this.log.playing.audio_buffer_time=this.log.playing.video_buffer_time=i,i}catch(e){return 0}}}},{key:"setCdnIp",value:function(){if(!this.commonParams.cdn_ip&&this.core){var e=this.core._context||this.core.context;if(!e)return;var t=e.getInstance("FETCH_LOADER")||e.getInstance("TS_LOADER");if(!t)return;var i=t.responseHeader;if(!i)return;var r=i.get("X-Server-Ip");r&&(this.commonParams.cdn_ip=r)}}},{key:"getFetchLoader",value:function(){if(this.core){var e=this.core._context||this.core.context;if(!e)return;return e.getInstance("FETCH_LOADER")||e.getInstance("TS_LOADER")}}},{key:"getPlayerDownloadSpeed",value:function(){var e=this.getFetchLoader();if(e)return Number.parseInt(e.currentSpeed)}},{key:"collectDowloadSpeed",value:function(){var e,t=this,i=this.getFetchLoader();i&&(this.preLoadedSize&&i.totalByteSize>=this.preLoadedSize&&(e=Math.round(1e3*(i.totalByteSize-this.preLoadedSize)/(Date.now()-this.preCollectSpeedTime))),this.preLoadedSize=i.totalByteSize,this.preCollectSpeedTime=Date.now(),e&&(this.log.playing.download_speed_array?this.log.playing.download_speed_array.push(e):this.log.playing.download_speed_array=[e]),this.collectDownloadSpeedTimer=setTimeout((function(){t.collectDowloadSpeed()}),this.options.downloadSpeedInterval))}},{key:"getPlayerQuality",value:function(e){var t=this.player.video;if(t.getVideoPlaybackQuality){var i=t.getVideoPlaybackQuality();this.log.playing.drop_count=i.droppedVideoFrames-this.tempDroppedFrameCount,this.log.playing.drop_percent=Number.parseFloat(this.tempTotalFrameCount/i.totalVideoFrames).toFixed(1),this.log.play_stop.drop_percent=Number.parseFloat(i.droppedVideoFrames/i.totalVideoFrames).toFixed(1),e&&!this.commonParams.is_wasm&&(this.log.playing.render_fps=Math.round((i.totalVideoFrames-this.tempTotalFrameCount)/e)),this.tempDroppedFrameCount=i.droppedVideoFrames,this.tempTotalFrameCount=i.totalVideoFrames}}},{key:"getExtraStats",value:(o=s(a().mark((function e(t,i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(!X)return e();try{t.getStats((function(t){t.result().forEach((function(e){var t={};e.names().forEach((function(i){t[i]=e.stat(i)})),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,"ssrc"===e.type?(null!=t.googAccelerateRate&&(i.accelerate_rate=t.googAccelerateRate),"audio"===t.mediaType?(i.audio_jitter_buffer_ms=t.googJitterBufferMs,i.audio_rtt_ms=t.googRtt,i.expand_rate=t.googExpandRate):"video"===t.mediaType&&(i.video_rtt_ms=t.googRtt,i.video_codec_name=t.googCodecName)):"VideoBwe"===e.type&&(i.video_recv_retransmit_bps=t.googRetransmitBitrate)})),e()}))}catch(t){e()}})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"getRtcStats",value:(r=s(a().mark((function e(t){var i,r,n,o,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.player.plugins.rts&&this.player.plugins.rts.pc){e.next=3;break}return e.abrupt("return");case 3:return r={},e.next=6,i.getStats();case 6:return n=e.sent,o=t-this.log.playing.timestamp,n.forEach((function(e){var t=e.type,i=e.mediaType,n=e.bytesReceived,a=e.packetsReceived,l=e.audioLevel,d=e.concealmentEvents,c=e.remoteTimestamp,u=e.timestamp,h=e.framesDropped,f=e.framesPerSecond,m=e.keyFramesDecoded,p=e.totalDecodeTime,b=e.framesDecoded,y=e.firCount,g=e.frameHeight,v=e.frameWidth,Z=e.framesReceived,T=e.jitterBufferDelay,L=e.jitterBufferEmittedCount,S=e.jitter,x=e.nackCount,k=e.packetsLost,I=e.pliCount,X=e.totalSamplesReceived,R=e.concealedSamples;switch(t){case"inbound-rtp":"audio"===i?(r.audio_bytes_received=n,r.audio_packets_lost=k,r.audio_packets_received=a,r.audio_volume=-10*Math.log10(Math.pow(l,2))*255,r.concealment_event=d,r.audio_fraction_lost=k/a,null!=s.cacheRtcStats.totalSamplesReceived&&(r.audio_dec_sample_rate=(X-s.cacheRtcStats.totalSamplesReceived)/o),s.cacheRtcStats.totalSamplesReceived=X,r.concealed_samples=R,r.total_samples_received=X):(r.frames_dropped_by_framebuffer=h,r.frame_buffer_out_interval=f,r.iframes_jitter_buffer_out=m,r.video_bytes_received=n,r.video_dec_elapse=1e3*p,r.video_decoded_delay_ms=r.video_dec_elapse/b,r.video_fir_count=y,r.video_fraction_lost=k/a,r.video_frame_height=g,r.video_frame_width=v,null!=s.cacheRtcStats.framesDecoded&&(r.video_framerate_decoder_output=(b-s.cacheRtcStats.framesDecoded)/o),s.cacheRtcStats.framesDecoded=b,null!=s.cacheRtcStats.framesReceived&&(r.video_framerate_recv=(Z-s.cacheRtcStats.framesReceived)/o),s.cacheRtcStats.framesReceived=Z,r.video_jb_min_delay=T/L*1e3,r.video_jitter=1e3*S,r.video_nack_count=x,r.video_packets_lost=k,r.video_packets_received=a,r.video_pli_count=I);break;case"remote-outbound-rtp":r.e2e_delay_ms=u-c}r.total_delay=r.e2e_delay_ms+r.video_decoded_delay_ms+r.video_jb_min_delay})),e.next=11,this.getExtraStats(i,r);case 11:this.log.playing.rtc_stats=r;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"reportPlaying",value:(i=s(a().mark((function e(t){var i,r,o,s,l,d,c,u,h,f,m,p,b,y,g,v,T;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.commonParams.is_wasm?(this.commonParams.fps=this.player.video.fps,this.log.playing.render_fps=this.player.video.fps,this.log.playing.decode_fps=this.player.video.decodeFps):this.core&&(i=this.core._context||this.core.context)&&(r=i.getInstance("TRACKS")||{},(o=r.videoTrack)&&o.meta&&(o.meta.refSampleDuration?this.commonParams.fps=Math.round(1e3/o.meta.refSampleDuration):o.meta.frameRate&&(this.commonParams.fps=o.meta.frameRate.fps))),this.log.playing.index++,s=this.log.playing.timestamp,this.inWaitingStart&&this.inWaitingStart<Z()&&(l=Math.min(this.options.playingInterval||this.log.playing.play_time,Z()-Math.max(this.inWaitingStart,s))),this.getPlayerBuffer(),this.options.downloadSpeedInterval||(this.log.playing.current_speed=this.getPlayerDownloadSpeed()),d=Z(),e.next=9,this.getRtcStats(d);case 9:c=d-s,u=(l>200?l:0)+this.log.playing.stall_time,h=(l>200?1:0)+this.log.playing.stall_count,this.options.aggregationDowngradeStallTime&&(this.log.playing.aggregation_downgrade_stall=(l>this.options.aggregationDowngradeStallTime?l:0)+(this.log.playing.aggregation_downgrade_stall||0)),Object.assign(this.log.playing,n({timestamp:d,stop_time:d,duration:t?0:c/1e3,stall_time_per_100sec:u/c*100,stall_count_per_100sec:1e3*h/c*100,stall_count:h,stall_time:u,play_current_time:this.player.currentTime},this.videoSize)),this.getPlayerQuality(this.log.playing.duration),this.player.plugins.abr&&this.player.plugins.abr.algo&&(f=this.player.plugins.abr.algo,m=f._openTimeMs,p=f.abr_time_offset_set,b=f.abr_cur_bitrate_set,y=f.abr_pred_bitrate_set,g=f.abr_speed_set,v=f.abr_player_buffer_set,T=f.abr_stall_status_set,Object.assign(this.log.playing,{abr_bitrate_map:this.player.plugins.abr.config.urls,abr_start_timestamp:m,abr_time_offset_set:p,abr_cur_bitrate_set:b,abr_pred_bitrate_set:y,abr_speed_set:g,abr_player_buffer_set:v,abr_stall_status_set:T}),this.player.plugins.abr.algo.resetCollect&&this.player.plugins.abr.algo.resetCollect()),this.logmanager.push(Object.assign({},this.log.playing,{play_time:t?0:c}),!0),this.log.playing.download_speed_array=[],this.log.playing.stall_time=0,this.log.playing.stall_count=0,this.log.playing.abr_switch_count=0,this.log.playing.render_fps=-1,this.options.aggregationDowngradeStallTime&&(this.log.playing.aggregation_downgrade_stall=0);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handlePlayerPlaying",value:(t=s(a().mark((function e(){var t,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.player&&this.player.video.readyState<3)){e.next=2;break}return e.abrupt("return");case 2:return this.player.off("playing",this.handlePlayerPlaying),this.player.off("timeupdate",this.handlePlayerPlaying),this.options.downloadSpeedInterval&&this.collectDowloadSpeed(),e.next=7,this.reportPlaying(!0);case 7:this.clearPlayingInterval(),t=this.options.playingInterval||this.log.playing.play_time,this.intervalId=setInterval(s(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Math.abs(Date.now()-i.log.playing.timestamp-t)<100||Date.now()-i.log.playing.timestamp>=t)){e.next=3;break}return e.next=3,i.reportPlaying();case 3:case"end":return e.stop()}}),e)}))),1e3),this.handleVideoplaying(),this.started||this.reportStartPlay(),this.saveBuffered();case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handlePlayerReady",value:function(){var e=this;this.log.start_play.start_play_time=Z(),this.player.config.autoplay&&this.reportStartPlay(),this.options.playResultThreshold&&(this.log.play_result.threshold=this.options.playResultThreshold),this.clearPlayResultTimer(),this.log.play_result.start=Z(),this.playResultTimer=setTimeout((function(){e.log.play_result.timestamp>=e.log.play_result.start||(e.log.play_result.is_threshold=1,e.logmanager.push(e.log.play_result,!0))}),this.log.play_result.threshold)}},{key:"handlePlayerWaiting",value:function(){if(!this.inWaitingStart&&this.log.first_frame.timestamp){var e=Z();this.log.stall.timestamp=this.inWaitingStart=this.log.stall.stall_start=e,this.log.stall_start.ready_state=this.log.stall.ready_state=this.player.video.readyState,this.log.stall_start.timestamp=e,this.log.stall_start.stall_start_time=e,this.log.stall_start.video_buffer_time=this.player.video.readyState,this.log.stall_start.play_current_time=this.player.currentTime,this.log.stall.play_current_time=this.player.currentTime,this.log.stall_start.buffered=this.getBuffered(),this.log.stall.buffered=this.log.stall_start.buffered,this.log.stall.current_speed=this.getPlayerDownloadSpeed(),this.log.stall.start_diff=e-this.log.first_frame.timestamp,this.log.abr_switch.timestamp&&(this.log.stall.abr_diff=e-this.log.abr_switch.timestamp),Object.assign(this.log.stall_start,this.videoSize)}}},{key:"handleVideoseeking",value:function(){this.player&&this.player.video&&this.inWaitingStart&&this.player.video.duration<1/0&&(this.inWaitingStart=0)}},{key:"handleVideoseeked",value:function(){this.player&&this.player.video&&this.inWaitingStart&&this.player.video.duration<1/0&&(this.inWaitingStart=0,this.log.play_stop.stall_count>0&&this.log.play_stop.stall_count--)}},{key:"handleVideoplay",value:function(){this.reportStartPlay(),this.removeVideoEvt("play",this.handleVideoplay)}},{key:"handleVideotimeupdate",value:function(){Math.abs(this.player.currentTime-this.log.stall_start.play_current_time)>.2&&this.stallEnd(),this.saveBuffered()}},{key:"handleVideocanplay",value:function(){this.setCdnIp(),this.stallEnd(),this.reportFirstframe()}},{key:"handleVideoplaying",value:function(){this.stallEnd(),this.log.play_stop.is_stream_received=1;var e=Z();this.reportStartPlay(),this.log.first_frame.start=e}},{key:"stallEnd",value:function(){var e=Z();if(this.inWaitingStart){var t=e-this.inWaitingStart;t>200&&(this.log.abr_switch.stall_count++,this.log.play_stop.stall_count++,this.log.play_stop.stall_time+=e-this.inWaitingStart,this.log.playing.stall_time+=e-Math.max(this.inWaitingStart,this.log.playing.timestamp),this.log.abr_session.stall_time+=e-this.inWaitingStart,this.log.stall.stall_end=e,this.log.stall.timestamp=Z(),this.log.playing.stall_count++,Object.assign(this.log.stall,n({},this.videoSize)),this.logmanager.push(this.log.stall,!0)),this.options.aggregationDowngradeStallTime&&t>this.options.aggregationDowngradeStallTime&&(this.log.playing.aggregation_downgrade_stall=(this.log.playing.aggregation_downgrade_stall||0)+(e-Math.max(this.inWaitingStart,this.log.playing.timestamp)))}this.inWaitingStart=0}},{key:"handleVideoloadeddata",value:function(){this.reportFirstframe()}},{key:"handleVideoratechange",value:function(){this.log.playing.speed_switch_count++,this.log.playing.speed_switch_info=this.player.video.playbackRate}},{key:"handleVideoended",value:function(){this.clearPlayingInterval(),Object.assign(this.log.playing,n({timestamp:Z(),is_last:1},this.videoSize)),this.logmanager.push(this.log.playing)}},{key:"handleVideoerror",value:function(){var e=this;this.errorNumber=1;var t=this.player.video.error;Object.assign(this.log.play_error,n(n({timestamp:Z()},this.videoSize),t&&{code:t.code,info:t.message})),this.logmanager.push(this.log.play_error,!0),0!==e.log.first_frame.first_frame_view||e.log.first_frame_failed.code||t&&(e.log.first_frame_failed.code=t.code,e.log.first_frame_failed.msg=x[t.code],void 0!==e.log.first_frame_failed.timestamp&&(e.log.first_frame_failed.timestamp=Z()),e.logmanager.push(e.log.first_frame_failed,!0),e.log.play_result.is_threshold||(e.log.play_result.reason=x[t.code],e.log.play_result.code=t.code,e.clearPlayResultTimer(),e.logmanager.push(e.log.play_result,!0))),e.options.error_report_stop?e.handleUserLeave():e.updatePlayStopParams()}},{key:"handleVideopause",value:function(){this.stallEnd(),this.clearPlayingInterval(),this.player.once("playing",this.handlePlayerPlaying),this.player.once("timeupdate",this.handlePlayerPlaying)}},{key:"destroyFunc",value:function(e){var t=this;this.destroyed||((!e||e instanceof Event)&&this.handleUserLeave(),this.destroyed=!0,"pc"===v.device?window.removeEventListener("beforeunload",this.destroyFunc):"mobile"===v.device&&(window.removeEventListener("beforeunload",this.destroyFunc),window.removeEventListener("pagehide",this.destroyFunc)),I.forEach((function(e){t.removeVideoEvt(e,t["handleVideo".concat(e,"Evt")])})),this.player&&(this.player._start&&(this.player.start=this.player._start,delete this.player._start),this.player.off("destroy",this.destroyFunc),this.player.off("complete",this.handlePlayerComlete),this.player.off("playing",this.handlePlayerPlaying),this.player.off("timeupdate",this.handlePlayerPlaying),this.player.off("ready",this.handlePlayerReady),this.player.off("waiting",this.handlePlayerWaiting),this.player.off("largeavgap",this.handleAVUnsync),this.player.off("error",this.handlePlayerError),this.player.off("SEI_PARSED",this.handleSEIParsed),this.player.off("pause",this.handlePlayerPause),this.player.off("ttfb",this.handleTTFB),this.player.off("urlchange",this.handleUrlChange),this.player.off("isKeyframe",this.handleKeyframe),this.player.off("sourceopen",this.handleSourceOpen),this.player.off("bufferappend",this.handleBufferAppend),this.player.off("degrade",this.handleDegrade),this.player.off("chaseframe",this.handleChaseFrame),this.clearPlayingInterval(),this.clearPlayResultTimer(),this._player=null))}},{key:"handleUserLeave",value:function(){!this.destroyed&&this.started&&(this.updatePlayStopParams(),this.reportPlayStop(),this.clearPlayingInterval(),this.removeWindowListener())}},{key:"saveBuffered",value:function(){try{var e=this.getBuffered();e&&e.length&&(this.log.play_stop.buffered=e)}catch(e){}}},{key:"getBuffered",value:function(){try{for(var e=[],t=this.player.video,i=0;i<t.buffered.length;i++)e.push([t.buffered.start(i),t.buffered.end(i)]);return e}catch(e){}}},{key:"reportPlayStop",value:function(){this.log.play_stop.play_current_time=this.player.currentTime||this.log.playing.play_current_time,this.saveBuffered(),this.logmanager.push(this.log.play_stop,!0)}},{key:"reportFirstframe",value:function(){if(!this.firstFrameViewed){this.log.play_metadata_loaded.timestamp||(this.handleMetaDataLoaded("video"),this.handleMetaDataLoaded("audio")),this.firstFrameViewed=!0;var e=Z();Object.assign(this.log.first_frame,n({first_frame_view:e-this.log.start_play.start_play_time||e,timestamp:e},this.videoSize)),this.log.first_frame.ttfb_end&&(this.log.first_frame.ttdb=e-this.log.first_frame.ttfb_end),this.log.first_frame.buffered=this.getPlayerBuffer(),this.log.first_frame.sei_buffer_delay=this.log.first_frame.buffered,this.log.first_frame.sei_network_delay&&(this.log.first_frame.first_sei_delay=this.log.first_frame.sei_buffer_delay+this.log.first_frame.sei_network_delay),this.logmanager.push(this.log.first_frame,!0),this.clearPlayResultTimer(),this.log.play_result.result=1,this.logmanager.push(this.log.play_result,!0),this.log.play_stop.is_stream_received=1}}},{key:"updatePlayStopParams",value:function(){var e=function(e){var t=performance.getEntriesByType("resource").filter((function(t){return t.name===e}));if(t.length){var i=t[0],r=t[t.length-1];return{dns_parse_time:Number.parseInt(i.domainLookupEnd-i.domainLookupStart),redirect:Number.parseInt(i.redirectEnd-i.redirectStart),ttfb:Number.parseInt(r.responseStart-r.requestStart)}}return{dns_parse_time:-1,redirect:-1,ttfb:-1}}(this._url),t=Z();this.playedTime=t-this.log.start_play.start_play_time;var i=this.log.play_stop;Object.assign(i,n({},0===i.stall_count&&{stall_time:0})),this.inWaitingStart&&t-this.inWaitingStart>200&&(i.stall_time+=t-this.inWaitingStart),this.inWaitingStart&&t-this.inWaitingStart>this.stallOut?this.log.play_stop.code=-100015:this.log.play_stop.code=0,this.inWaitingStart=0,Object.assign(i,n({stall_time_per_100sec:i.stall_time/this.playedTime*100,stall_count_per_100sec:1e3*i.stall_count/this.playedTime*100},e)),0===this.log.play_stop.stall_count_per_100sec&&(this.log.play_stop.stall_time_per_100sec=0),this.log.play_stop.stall_time_per_100sec>100||this.log.play_stop.stall_time_per_100sec<0||(this.log.playing.index?(Object.assign(this.log.playing,n({timestamp:Z(),is_last:1},this.videoSize)),this.logmanager.push(this.log.playing,!0)):(this.log.play_stop.error_code=this.log.play_error.code,this.log.play_stop.error_info=this.log.play_error.info),t=Z(),Object.assign(i,n({timestamp:t,stop_time:t,duration:this.playedTime/1e3,play_time:this.playedTime/1e3},this.videoSize)),0===this.errorNumber&&(i.play_time_on_no_frame=i.stop_time-this.log.start_play.start_play_time))}},{key:"clearPlayingInterval",value:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}},{key:"clearPlayResultTimer",value:function(){clearTimeout(this.playResultTimer)}},{key:"destroy",value:function(e){this.destroyFunc(!e)}},{key:"bindVideoEvt",value:function(e,t){this.player&&this.player.video.addEventListener(e,t,!1)}},{key:"removeVideoEvt",value:function(e,t){this.player&&this.player.video&&this.player.video.removeEventListener(e,t,!1)}},{key:"send",value:function(e,t){this.logmanager.send(e,t)}}]),e}()},66758:(e,t,i)=>{"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(){a=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function c(e,t,i,n){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),s=new I(n||[]);return r(o,"_invoke",{value:L(e,i,s)}),o}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h={};function f(){}function m(){}function p(){}var b={};d(b,o,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(X([])));g&&g!==t&&i.call(g,o)&&(b=g);var v=p.prototype=f.prototype=Object.create(b);function Z(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(r,a,o,s){var l=u(e[r],e,a);if("throw"!==l.type){var d=l.arg,c=d.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){d.value=e,o(d)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return a=a?a.then(r,r):r()}})}function L(e,t,i){var r="suspendedStart";return function(n,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw a;return{value:void 0,done:!0}}for(i.method=n,i.arg=a;;){var o=i.delegate;if(o){var s=S(o,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var l=u(e,t,i);if("normal"===l.type){if(r=i.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r="completed",i.method="throw",i.arg=l.arg)}}}function S(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),h;var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function X(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=p,r(v,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:m,configurable:!0}),m.displayName=d(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,d(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},Z(T.prototype),d(T.prototype,s,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,r,n,a){void 0===a&&(a=Promise);var o=new T(c(t,i,r,n),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},Z(v),d(v,l,"Generator"),d(v,o,(function(){return this})),d(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=X,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return o.type="throw",o.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:X(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function l(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function o(e){s(a,r,n,o,l,"next",e)}function l(e){s(a,r,n,o,l,"throw",e)}o(void 0)}))}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function u(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t,i){return(t=S(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return y(this,i)}}function v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function Z(){return Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=v(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},Z.apply(this,arguments)}function T(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?L(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function S(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,{D:()=>Xi,Z:()=>Mt}),i(62180),i(3495),i(29832),i(91170),i(67825),i(34895),i(94609),i(9776),i(82489),i(84240),i(36195),i(6686),i(14643),i(96761),i(58067);var x=i(39776),k=i(97185),I=i(54948),X=i(61166),R=i(41107),w=i(49460);function G(){G=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,i){return e[t]=i}}function d(e,t,i,n){var a=t&&t.prototype instanceof h?t:h,o=Object.create(a.prototype),s=new k(n||[]);return r(o,"_invoke",{value:T(e,i,s)}),o}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var u={};function h(){}function f(){}function m(){}var p={};l(p,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(I([])));y&&y!==t&&i.call(y,a)&&(p=y);var g=m.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function Z(e,t){function n(r,a,o,s){var l=c(e[r],e,a);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(u).then((function(e){d.value=e,o(d)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return a=a?a.then(r,r):r()}})}function T(e,t,i){var r="suspendedStart";return function(n,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw a;return{value:void 0,done:!0}}for(i.method=n,i.arg=a;;){var o=i.delegate;if(o){var s=L(o,i);if(s){if(s===u)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var l=c(e,t,i);if("normal"===l.type){if(r=i.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r="completed",i.method="throw",i.arg=l.arg)}}}function L(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,L(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),u;var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:X}}function X(){return{value:void 0,done:!0}}return f.prototype=m,r(g,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(Z.prototype),l(Z.prototype,o,(function(){return this})),e.AsyncIterator=Z,e.async=function(t,i,r,n,a){void 0===a&&(a=Promise);var o=new Z(d(t,i,r,n),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},v(g),l(g,s,"Generator"),l(g,a,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return o.type="throw",o.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),x(i),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;x(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:I(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),u}},e}function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function _(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function o(e){E(a,r,n,o,s,"next",e)}function s(e){E(a,r,n,o,s,"throw",e)}o(void 0)}))}}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n)),r)}var n}function V(e,t,i){return t&&P(e.prototype,t),i&&P(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}i(61331),i(38955),i(35537),i(47754),i(434),i(64822),i(8415),i(60386),i(80177),i(67353),i(56441),i(53139),i(1933),i(59605),i(27435),i(95377),i(69610),i(98083),i(35827),i(9903),i(51018),i(34659),i(43170),i(3708),i(78900),i(10391),i(34721),i(72153),i(51680),i(15691),i(68333),i(71339),i(25310),i(87252),i(90203),i(65698),i(56297),i(82409),i(78931),i(97811),i(96935),i(5818),i(49683),i(49038),i(46558),i(73056),i(60100),i(17021);var M,K,Y,D,F=(M="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,i=void 0!==(e=e||{})?e:{},r={};for(t in i)i.hasOwnProperty(t)&&(r[t]=i[t]);if(i.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var n="";if(document.currentScript&&(n=document.currentScript.src),M&&(n=M),n=0!==n.indexOf("blob:")?n.substr(0,n.lastIndexOf("/")+1):"","object"!==("undefined"==typeof window?"undefined":W(window))&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");var a,o=i.print||console.log.bind(console),s=i.printErr||console.warn.bind(console);for(t in r)r.hasOwnProperty(t)&&(i[t]=r[t]);function l(e){l.shown||(l.shown={}),l.shown[e]||(l.shown[e]=1,s(e))}r=null,i.arguments&&i.arguments,Object.getOwnPropertyDescriptor(i,"arguments")||Object.defineProperty(i,"arguments",{configurable:!0,get:function(){Y("Module.arguments has been replaced with plain arguments_")}}),i.thisProgram&&i.thisProgram,Object.getOwnPropertyDescriptor(i,"thisProgram")||Object.defineProperty(i,"thisProgram",{configurable:!0,get:function(){Y("Module.thisProgram has been replaced with plain thisProgram")}}),i.quit&&i.quit,Object.getOwnPropertyDescriptor(i,"quit")||Object.defineProperty(i,"quit",{configurable:!0,get:function(){Y("Module.quit has been replaced with plain quit_")}}),f(void 0===i.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),f(void 0===i.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),f(void 0===i.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),f(void 0===i.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),f(void 0===i.read,"Module.read option was removed (modify read_ in JS)"),f(void 0===i.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),f(void 0===i.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),f(void 0===i.setWindowTitle,"Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),Object.getOwnPropertyDescriptor(i,"read")||Object.defineProperty(i,"read",{configurable:!0,get:function(){Y("Module.read has been replaced with plain read_")}}),Object.getOwnPropertyDescriptor(i,"readAsync")||Object.defineProperty(i,"readAsync",{configurable:!0,get:function(){Y("Module.readAsync has been replaced with plain readAsync")}}),Object.getOwnPropertyDescriptor(i,"readBinary")||Object.defineProperty(i,"readBinary",{configurable:!0,get:function(){Y("Module.readBinary has been replaced with plain readBinary")}}),le=function(){Y("cannot use the stack before compiled code is ready to run, and has provided stack access")},i.wasmBinary&&(a=i.wasmBinary),Object.getOwnPropertyDescriptor(i,"wasmBinary")||Object.defineProperty(i,"wasmBinary",{configurable:!0,get:function(){Y("Module.wasmBinary has been replaced with plain wasmBinary")}}),i.noExitRuntime&&i.noExitRuntime,Object.getOwnPropertyDescriptor(i,"noExitRuntime")||Object.defineProperty(i,"noExitRuntime",{configurable:!0,get:function(){Y("Module.noExitRuntime has been replaced with plain noExitRuntime")}});var d,c={Memory:function(e){return{buffer:new ArrayBuffer(65536*e.initial),grow:function(e){var t=this.buffer,i=ce(e);return f(this.buffer!==t),i}}},Table:function(e){var t=new Array(e.initial);return t.grow=function(e){t.length>=1&&Y("Unable to grow wasm table. Use a higher value for RESERVED_FUNCTION_POINTERS or set ALLOW_TABLE_GROWTH."),t.push(null)},t.set=function(e,i){t[e]=i},t.get=function(e){return t[e]},t},Module:function(e){return{}},Instance:function(e,t){var i;return{exports:(i=u,function(e,t,r){var n=t.memory,a=i,o=new e.Int8Array(r);new e.Int16Array(r);var s=new e.Int32Array(r),l=new e.Uint8Array(r);new e.Uint16Array(r);var d=new e.Uint32Array(r);new e.Float32Array(r),new e.Float64Array(r);var c=e.Math.imul;e.Math.fround,e.Math.abs,e.Math.clz32,e.Math.min,e.Math.max,e.Math.floor,e.Math.ceil,e.Math.sqrt,t.abort,e.NaN,e.Infinity;var u=t.emscripten_memcpy_big,h=t.emscripten_resize_heap,f=t.__unlock,m=t.__lock,p=9744;function b(e){var t,i;return t=L(),(e=(i=s[388])+e|0)>>>0<=t<<16>>>0||h(0|e)?(s[388]=e,i):(s[256]=48,-1)}function y(e){var t,i=0,r=0,n=0,a=0,o=0,c=0,u=0,h=0,f=0,m=0,y=0,g=0;p=t=p-16|0;e:{t:{i:{r:{n:{a:{o:{s:{l:{d:{c:{if((e|=0)>>>0<=244){if(3&(i=(o=s[261])>>>(e=(c=e>>>0<11?16:e+11&-8)>>>3))){e=(i=s[1092+(a=(r=e+(1&(-1^i))|0)<<3)>>2])+8|0,(0|(n=s[i+8>>2]))!=(0|(a=a+1084|0))?(s[n+12>>2]=a,s[a+8>>2]=n):(y=1044,g=T(r)&o,s[y>>2]=g),r<<=3,s[i+4>>2]=3|r,s[4+(i=i+r|0)>>2]=1|s[i+4>>2];break e}if(c>>>0<=(h=s[263])>>>0)break c;if(i){r=i=(e=(0-(e=(0-(r=2<<e)|r)&i<<e)&e)-1|0)>>>12&16,r|=i=(e>>>=i)>>>5&8,r|=i=(e>>>=i)>>>2&4,i=s[1092+(n=(r=((r|=i=(e>>>=i)>>>1&2)|(i=(e>>>=i)>>>1&1))+(e>>>i)|0)<<3)>>2],(0|(e=s[i+8>>2]))!=(0|(n=n+1084|0))?(s[e+12>>2]=n,s[n+8>>2]=e):(o=T(r)&o,s[261]=o),e=i+8|0,s[i+4>>2]=3|c,a=(r<<=3)-c|0,s[4+(u=i+c|0)>>2]=1|a,s[i+r>>2]=a,h&&(i=1084+((r=h>>>3)<<3)|0,n=s[266],(r=1<<r)&o?r=s[i+8>>2]:(s[261]=r|o,r=i),s[i+8>>2]=n,s[r+12>>2]=n,s[n+12>>2]=i,s[n+8>>2]=r),s[266]=u,s[263]=a;break e}if(!(m=s[262]))break c;for(r=i=(e=(m&0-m)-1|0)>>>12&16,r|=i=(e>>>=i)>>>5&8,r|=i=(e>>>=i)>>>2&4,i=s[1348+(((r|=i=(e>>>=i)>>>1&2)|(i=(e>>>=i)>>>1&1))+(e>>>i)<<2)>>2],n=(-8&s[i+4>>2])-c|0,r=i;(e=s[r+16>>2])||(e=s[r+20>>2]);)n=(r=(a=(-8&s[e+4>>2])-c|0)>>>0<n>>>0)?a:n,i=r?e:i,r=e;if(f=s[i+24>>2],(0|(a=s[i+12>>2]))!=(0|i)){e=s[i+8>>2],s[e+12>>2]=a,s[a+8>>2]=e;break t}if(!(e=s[(r=i+20|0)>>2])){if(!(e=s[i+16>>2]))break d;r=i+16|0}for(;u=r,a=e,(e=s[(r=e+20|0)>>2])||(r=a+16|0,e=s[a+16>>2]););s[u>>2]=0;break t}if(c=-1,!(e>>>0>4294967231)&&(c=-8&(i=e+11|0),h=s[262])){r=0-c|0,o=0,(i>>>=8)&&(o=31,c>>>0>16777215||(o=28+((e=((o=(i<<=n=i+1048320>>>16&8)<<(e=i+520192>>>16&4))<<(i=o+245760>>>16&2)>>>15)-(i|e|n)|0)<<1|c>>>e+21&1)|0));u:{h:{if(n=s[1348+(o<<2)>>2])for(i=c<<(31==(0|o)?0:25-(o>>>1)|0),e=0;;){if(!((u=(-8&s[n+4>>2])-c|0)>>>0>=r>>>0||(a=n,r=u))){r=0,e=n;break h}if(u=s[n+20>>2],n=s[16+((i>>>29&4)+n|0)>>2],e=u?(0|u)==(0|n)?e:u:e,i<<=0!=(0|n),!n)break}else e=0;if(!(e|a)){if(!(e=(0-(e=2<<o)|e)&h))break c;n=i=(e=(e&0-e)-1|0)>>>12&16,n|=i=(e>>>=i)>>>5&8,n|=i=(e>>>=i)>>>2&4,e=s[1348+(((n|=i=(e>>>=i)>>>1&2)|(i=(e>>>=i)>>>1&1))+(e>>>i)<<2)>>2]}if(!e)break u}for(;r=(i=(n=(-8&s[e+4>>2])-c|0)>>>0<r>>>0)?n:r,a=i?e:a,e=(i=s[e+16>>2])||s[e+20>>2];);}if(!(!a|r>>>0>=s[263]-c>>>0)){if(u=s[a+24>>2],(0|a)!=(0|(i=s[a+12>>2]))){e=s[a+8>>2],s[e+12>>2]=i,s[i+8>>2]=e;break i}if(!(e=s[(n=a+20|0)>>2])){if(!(e=s[a+16>>2]))break l;n=a+16|0}for(;o=n,i=e,(e=s[(n=e+20|0)>>2])||(n=i+16|0,e=s[i+16>>2]););s[o>>2]=0;break i}}}if((i=s[263])>>>0>=c>>>0){e=s[266],(r=i-c|0)>>>0>=16?(s[263]=r,n=e+c|0,s[266]=n,s[n+4>>2]=1|r,s[e+i>>2]=r,s[e+4>>2]=3|c):(s[266]=0,s[263]=0,s[e+4>>2]=3|i,s[4+(i=e+i|0)>>2]=1|s[i+4>>2]),e=e+8|0;break e}if((n=s[264])>>>0>c>>>0){i=n-c|0,s[264]=i,r=(e=s[267])+c|0,s[267]=r,s[r+4>>2]=1|i,s[e+4>>2]=3|c,e=e+8|0;break e}if(e=0,r=a=c+47|0,s[379]?i=s[381]:(s[382]=-1,s[383]=-1,s[380]=4096,s[381]=4096,s[379]=t+12&-16^1431655768,s[384]=0,s[372]=0,i=4096),(r=(o=r+i|0)&(u=0-i|0))>>>0<=c>>>0)break e;if((i=s[371])&&(f=(h=s[369])+r|0)>>>0<=h>>>0|f>>>0>i>>>0)break e;if(4&l[1488])break a;c:{u:{if(i=s[267])for(e=1492;;){if((h=s[e>>2])+s[e+4>>2]>>>0>i>>>0&&h>>>0<=i>>>0)break u;if(!(e=s[e+8>>2]))break}if(-1==(0|(i=b(0))))break o;if(o=r,(n=(e=s[380])+-1|0)&i&&(o=(r-i|0)+(i+n&0-e)|0),o>>>0<=c>>>0|o>>>0>2147483646)break o;if((e=s[371])&&(u=(n=s[369])+o|0)>>>0<=n>>>0|u>>>0>e>>>0)break o;if((0|i)!=(0|(e=b(o))))break c;break n}if((o=u&o-n)>>>0>2147483646)break o;if((0|(i=b(o)))==(s[e>>2]+s[e+4>>2]|0))break s;e=i}if(i=e,!(c+48>>>0<=o>>>0|o>>>0>2147483646|-1==(0|e))){if((e=(e=s[381])+(a-o|0)&0-e)>>>0>2147483646)break n;if(-1!=(0|b(e))){o=e+o|0;break n}b(0-o|0);break o}if(-1!=(0|i))break n;break o}a=0;break t}i=0;break i}if(-1!=(0|i))break n}s[372]=4|s[372]}if(r>>>0>2147483646)break r;if((i=b(r))>>>0>=(e=b(0))>>>0|-1==(0|i)|-1==(0|e))break r;if((o=e-i|0)>>>0<=c+40>>>0)break r}e=s[369]+o|0,s[369]=e,e>>>0>d[370]&&(s[370]=e);n:{a:{o:{if(r=s[267]){for(e=1492;;){if(((n=s[e>>2])+(a=s[e+4>>2])|0)==(0|i))break o;if(!(e=s[e+8>>2]))break}break a}for(i>>>0>=(e=s[265])>>>0&&e||(s[265]=i),e=0,s[374]=o,s[373]=i,s[269]=-1,s[270]=s[379],s[376]=0;n=1084+(r=e<<3)|0,s[r+1092>>2]=n,s[r+1096>>2]=n,32!=(0|(e=e+1|0)););n=(e=o+-40|0)-(r=i+8&7?-8-i&7:0)|0,s[264]=n,r=i+r|0,s[267]=r,s[r+4>>2]=1|n,s[4+(e+i|0)>>2]=40,s[268]=s[383];break n}if(!(8&l[e+12|0]|i>>>0<=r>>>0|n>>>0>r>>>0)){s[e+4>>2]=a+o,i=(e=r+8&7?-8-r&7:0)+r|0,s[267]=i,e=(n=s[264]+o|0)-e|0,s[264]=e,s[i+4>>2]=1|e,s[4+(r+n|0)>>2]=40,s[268]=s[383];break n}}i>>>0<(a=s[265])>>>0&&(s[265]=i,a=0),n=i+o|0,e=1492;a:{o:{s:{l:{d:{c:{for(;;){if((0|n)!=s[e>>2]){if(e=s[e+8>>2])continue;break c}break}if(!(8&l[e+12|0]))break d}for(e=1492;;){if((n=s[e>>2])>>>0<=r>>>0&&(a=n+s[e+4>>2]|0)>>>0>r>>>0)break l;e=s[e+8>>2]}}if(s[e>>2]=i,s[e+4>>2]=s[e+4>>2]+o,s[4+(f=(i+8&7?-8-i&7:0)+i|0)>>2]=3|c,e=((i=n+(n+8&7?-8-n&7:0)|0)-f|0)-c|0,u=c+f|0,(0|i)==(0|r)){s[267]=u,e=s[264]+e|0,s[264]=e,s[u+4>>2]=1|e;break o}if(s[266]==(0|i)){s[266]=u,e=s[263]+e|0,s[263]=e,s[u+4>>2]=1|e,s[e+u>>2]=e;break o}if(1==(3&(r=s[i+4>>2]))){m=-8&r;d:if(r>>>0<=255){if(a=r>>>3,r=s[i+8>>2],(0|(n=s[i+12>>2]))==(0|r)){y=1044,g=s[261]&T(a),s[y>>2]=g;break d}s[r+12>>2]=n,s[n+8>>2]=r}else{if(h=s[i+24>>2],(0|(o=s[i+12>>2]))==(0|i))if((c=s[(n=i+20|0)>>2])||(c=s[(n=i+16|0)>>2])){for(;r=n,o=c,(c=s[(n=c+20|0)>>2])||(n=o+16|0,c=s[o+16>>2]););s[r>>2]=0}else o=0;else r=s[i+8>>2],s[r+12>>2]=o,s[o+8>>2]=r;if(h){r=s[i+28>>2];c:{if(s[(n=1348+(r<<2)|0)>>2]==(0|i)){if(s[n>>2]=o,o)break c;y=1048,g=s[262]&T(r),s[y>>2]=g;break d}if(s[h+(s[h+16>>2]==(0|i)?16:20)>>2]=o,!o)break d}s[o+24>>2]=h,(r=s[i+16>>2])&&(s[o+16>>2]=r,s[r+24>>2]=o),(r=s[i+20>>2])&&(s[o+20>>2]=r,s[r+24>>2]=o)}}i=i+m|0,e=e+m|0}if(s[i+4>>2]=-2&s[i+4>>2],s[u+4>>2]=1|e,s[e+u>>2]=e,e>>>0<=255){e=1084+((i=e>>>3)<<3)|0,(r=s[261])&(i=1<<i)?i=s[e+8>>2]:(s[261]=i|r,i=e),s[e+8>>2]=u,s[i+12>>2]=u,s[u+12>>2]=e,s[u+8>>2]=i;break o}if(i=0,(n=e>>>8)&&(i=31,e>>>0>16777215||(i=28+((i=((c=(n<<=a=n+1048320>>>16&8)<<(i=n+520192>>>16&4))<<(n=c+245760>>>16&2)>>>15)-(n|i|a)|0)<<1|e>>>i+21&1)|0)),s[(r=u)+28>>2]=i,s[u+16>>2]=0,s[u+20>>2]=0,r=1348+(i<<2)|0,(n=s[262])&(a=1<<i)){for(n=e<<(31==(0|i)?0:25-(i>>>1)|0),i=s[r>>2];;){if(r=i,(-8&s[i+4>>2])==(0|e))break s;if(i=n>>>29,n<<=1,!(i=s[16+(a=(4&i)+r|0)>>2]))break}s[a+16>>2]=u}else s[262]=n|a,s[r>>2]=u;s[u+24>>2]=r,s[u+12>>2]=u,s[u+8>>2]=u;break o}for(u=(e=o+-40|0)-(n=i+8&7?-8-i&7:0)|0,s[264]=u,n=i+n|0,s[267]=n,s[n+4>>2]=1|u,s[4+(e+i|0)>>2]=40,s[268]=s[383],s[(n=(e=(a+(a+-39&7?39-a&7:0)|0)-47|0)>>>0<r+16>>>0?r:e)+4>>2]=27,e=s[376],s[n+16>>2]=s[375],s[n+20>>2]=e,e=s[374],s[n+8>>2]=s[373],s[n+12>>2]=e,s[375]=n+8,s[374]=o,s[373]=i,s[376]=0,e=n+24|0;s[e+4>>2]=7,i=e+8|0,e=e+4|0,i>>>0<a>>>0;);if((0|r)==(0|n))break n;if(s[n+4>>2]=-2&s[n+4>>2],a=n-r|0,s[r+4>>2]=1|a,s[n>>2]=a,a>>>0<=255){e=1084+((i=a>>>3)<<3)|0,(n=s[261])&(i=1<<i)?i=s[e+8>>2]:(s[261]=i|n,i=e),s[e+8>>2]=r,s[i+12>>2]=r,s[r+12>>2]=e,s[r+8>>2]=i;break n}if(s[r+16>>2]=0,s[r+20>>2]=0,e=0,(n=a>>>8)&&(e=31,a>>>0>16777215||(e=28+((e=((u=(n<<=o=n+1048320>>>16&8)<<(e=n+520192>>>16&4))<<(n=u+245760>>>16&2)>>>15)-(n|e|o)|0)<<1|a>>>e+21&1)|0)),s[(i=r)+28>>2]=e,i=1348+(e<<2)|0,(n=s[262])&(o=1<<e)){for(e=a<<(31==(0|e)?0:25-(e>>>1)|0),i=s[i>>2];;){if(n=i,(0|a)==(-8&s[i+4>>2]))break a;if(i=e>>>29,e<<=1,!(i=s[16+(o=n+(4&i)|0)>>2]))break}s[o+16>>2]=r,s[r+24>>2]=n}else s[262]=n|o,s[i>>2]=r,s[r+24>>2]=i;s[r+12>>2]=r,s[r+8>>2]=r;break n}e=s[r+8>>2],s[e+12>>2]=u,s[r+8>>2]=u,s[u+24>>2]=0,s[u+12>>2]=r,s[u+8>>2]=e}e=f+8|0;break e}e=s[n+8>>2],s[e+12>>2]=r,s[n+8>>2]=r,s[r+24>>2]=0,s[r+12>>2]=n,s[r+8>>2]=e}if(!((e=s[264])>>>0<=c>>>0)){i=e-c|0,s[264]=i,r=(e=s[267])+c|0,s[267]=r,s[r+4>>2]=1|i,s[e+4>>2]=3|c,e=e+8|0;break e}}s[256]=48,e=0;break e}i:if(u){e=s[a+28>>2];r:{if(s[(n=1348+(e<<2)|0)>>2]==(0|a)){if(s[n>>2]=i,i)break r;h=T(e)&h,s[262]=h;break i}if(s[u+(s[u+16>>2]==(0|a)?16:20)>>2]=i,!i)break i}s[i+24>>2]=u,(e=s[a+16>>2])&&(s[i+16>>2]=e,s[e+24>>2]=i),(e=s[a+20>>2])&&(s[i+20>>2]=e,s[e+24>>2]=i)}i:if(r>>>0<=15)e=r+c|0,s[a+4>>2]=3|e,s[4+(e=e+a|0)>>2]=1|s[e+4>>2];else if(s[a+4>>2]=3|c,s[4+(n=a+c|0)>>2]=1|r,s[r+n>>2]=r,r>>>0<=255)e=1084+((i=r>>>3)<<3)|0,(r=s[261])&(i=1<<i)?i=s[e+8>>2]:(s[261]=i|r,i=e),s[e+8>>2]=n,s[i+12>>2]=n,s[n+12>>2]=e,s[n+8>>2]=i;else{e=0,(c=r>>>8)&&(e=31,r>>>0>16777215||(e=28+((e=((u=(c<<=o=c+1048320>>>16&8)<<(e=c+520192>>>16&4))<<(c=u+245760>>>16&2)>>>15)-(c|e|o)|0)<<1|r>>>e+21&1)|0)),s[(i=n)+28>>2]=e,s[n+16>>2]=0,s[n+20>>2]=0,i=1348+(e<<2)|0;r:{if((c=1<<e)&h){for(e=r<<(31==(0|e)?0:25-(e>>>1)|0),c=s[i>>2];;){if((-8&s[(i=c)+4>>2])==(0|r))break r;if(c=e>>>29,e<<=1,!(c=s[16+(o=(4&c)+i|0)>>2]))break}s[o+16>>2]=n}else s[262]=c|h,s[i>>2]=n;s[n+24>>2]=i,s[n+12>>2]=n,s[n+8>>2]=n;break i}e=s[i+8>>2],s[e+12>>2]=n,s[i+8>>2]=n,s[n+24>>2]=0,s[n+12>>2]=i,s[n+8>>2]=e}e=a+8|0;break e}t:if(f){e=s[i+28>>2];i:{if(s[(r=1348+(e<<2)|0)>>2]==(0|i)){if(s[r>>2]=a,a)break i;y=1048,g=T(e)&m,s[y>>2]=g;break t}if(s[f+(s[f+16>>2]==(0|i)?16:20)>>2]=a,!a)break t}s[a+24>>2]=f,(e=s[i+16>>2])&&(s[a+16>>2]=e,s[e+24>>2]=a),(e=s[i+20>>2])&&(s[a+20>>2]=e,s[e+24>>2]=a)}n>>>0<=15?(e=n+c|0,s[i+4>>2]=3|e,s[4+(e=e+i|0)>>2]=1|s[e+4>>2]):(s[i+4>>2]=3|c,s[4+(c=i+c|0)>>2]=1|n,s[n+c>>2]=n,h&&(e=1084+((r=h>>>3)<<3)|0,a=s[266],(r=1<<r)&o?r=s[e+8>>2]:(s[261]=r|o,r=e),s[e+8>>2]=a,s[r+12>>2]=a,s[a+12>>2]=e,s[a+8>>2]=r),s[266]=c,s[263]=n),e=i+8|0}return p=t+16|0,0|e}function g(e){var t=0,i=0,r=0,n=0,a=0,o=0,l=0,c=0,u=0;e:if(e|=0){a=(r=e+-8|0)+(e=-8&(i=s[e+-4>>2]))|0;t:if(!(1&i)){if(!(3&i))break e;if((r=r-(i=s[r>>2])|0)>>>0<d[265])break e;if(e=e+i|0,s[266]==(0|r)){if(3==(3&(i=s[a+4>>2])))return s[263]=e,s[a+4>>2]=-2&i,s[r+4>>2]=1|e,void(s[e+r>>2]=e)}else{if(i>>>0<=255){if(n=s[r+8>>2],i>>>=3,(0|(t=s[r+12>>2]))==(0|n)){c=1044,u=s[261]&T(i),s[c>>2]=u;break t}s[n+12>>2]=t,s[t+8>>2]=n;break t}if(l=s[r+24>>2],(0|r)==(0|(i=s[r+12>>2])))if((t=s[(n=r+20|0)>>2])||(t=s[(n=r+16|0)>>2])){for(;o=n,(t=s[(n=(i=t)+20|0)>>2])||(n=i+16|0,t=s[i+16>>2]););s[o>>2]=0}else i=0;else t=s[r+8>>2],s[t+12>>2]=i,s[i+8>>2]=t;if(!l)break t;n=s[r+28>>2];i:{if(s[(t=1348+(n<<2)|0)>>2]==(0|r)){if(s[t>>2]=i,i)break i;c=1048,u=s[262]&T(n),s[c>>2]=u;break t}if(s[l+(s[l+16>>2]==(0|r)?16:20)>>2]=i,!i)break t}if(s[i+24>>2]=l,(t=s[r+16>>2])&&(s[i+16>>2]=t,s[t+24>>2]=i),!(t=s[r+20>>2]))break t;s[i+20>>2]=t,s[t+24>>2]=i}}if(!(a>>>0<=r>>>0)&&1&(i=s[a+4>>2])){t:{if(!(2&i)){if(s[267]==(0|a)){if(s[267]=r,e=s[264]+e|0,s[264]=e,s[r+4>>2]=1|e,s[266]!=(0|r))break e;return s[263]=0,void(s[266]=0)}if(s[266]==(0|a))return s[266]=r,e=s[263]+e|0,s[263]=e,s[r+4>>2]=1|e,void(s[e+r>>2]=e);e=(-8&i)+e|0;i:if(i>>>0<=255){if(i>>>=3,(0|(t=s[a+8>>2]))==(0|(n=s[a+12>>2]))){c=1044,u=s[261]&T(i),s[c>>2]=u;break i}s[t+12>>2]=n,s[n+8>>2]=t}else{if(l=s[a+24>>2],(0|a)==(0|(i=s[a+12>>2])))if((t=s[(n=a+20|0)>>2])||(t=s[(n=a+16|0)>>2])){for(;o=n,(t=s[(n=(i=t)+20|0)>>2])||(n=i+16|0,t=s[i+16>>2]););s[o>>2]=0}else i=0;else t=s[a+8>>2],s[t+12>>2]=i,s[i+8>>2]=t;if(l){n=s[a+28>>2];r:{if(s[(t=1348+(n<<2)|0)>>2]==(0|a)){if(s[t>>2]=i,i)break r;c=1048,u=s[262]&T(n),s[c>>2]=u;break i}if(s[l+(s[l+16>>2]==(0|a)?16:20)>>2]=i,!i)break i}s[i+24>>2]=l,(t=s[a+16>>2])&&(s[i+16>>2]=t,s[t+24>>2]=i),(t=s[a+20>>2])&&(s[i+20>>2]=t,s[t+24>>2]=i)}}if(s[r+4>>2]=1|e,s[e+r>>2]=e,s[266]!=(0|r))break t;return void(s[263]=e)}s[a+4>>2]=-2&i,s[r+4>>2]=1|e,s[e+r>>2]=e}if(e>>>0<=255)return i=1084+((e>>>=3)<<3)|0,(t=s[261])&(e=1<<e)?e=s[i+8>>2]:(s[261]=e|t,e=i),s[i+8>>2]=r,s[e+12>>2]=r,s[r+12>>2]=i,void(s[r+8>>2]=e);s[r+16>>2]=0,s[r+20>>2]=0,t=0,(n=e>>>8)&&(t=31,e>>>0>16777215||(t=n,t<<=n=n+1048320>>>16&8,t=28+((t=((t<<=l=t+520192>>>16&4)<<(o=t+245760>>>16&2)>>>15)-(o|n|l)|0)<<1|e>>>t+21&1)|0)),s[(i=r)+28>>2]=t,o=1348+(t<<2)|0;t:if((n=s[262])&(i=1<<t)){n=e<<(31==(0|t)?0:25-(t>>>1)|0),i=s[o>>2];i:{for(;;){if(t=i,(-8&s[i+4>>2])==(0|e))break i;if(i=n>>>29,n<<=1,!(i=s[16+(o=t+(4&i)|0)>>2]))break}s[o+16>>2]=r,s[r+12>>2]=r,s[r+24>>2]=t,s[r+8>>2]=r;break t}e=s[t+8>>2],s[e+12>>2]=r,s[t+8>>2]=r,s[r+24>>2]=0,s[r+12>>2]=t,s[r+8>>2]=e}else s[262]=i|n,s[o>>2]=r,s[r+12>>2]=r,s[r+24>>2]=o,s[r+8>>2]=r;if(e=s[269]+-1|0,s[269]=e,!e){for(r=1500;r=(e=s[r>>2])+8|0,e;);s[269]=-1}}}}function v(e){var t,i=0;return d[e+20>>2]<=d[e+28>>2]||(a[s[e+36>>2]](e,0,0),s[e+20>>2])?((i=s[e+4>>2])>>>0<(t=s[e+8>>2])>>>0&&(i=i-t|0,a[s[e+40>>2]](e,i,i>>31,1)),s[e+28>>2]=0,s[e+16>>2]=0,s[e+20>>2]=0,s[e+4>>2]=0,s[e+8>>2]=0,0):-1}function Z(e){for(var t=0,i=0;i=t,e;)e&=e-1,t=t+1|0;return i}function T(e){var t;return(-1>>>(t=31&e)&-2)<<t|(-1<<(e=0-e&31)&-2)>>>e}function L(){return r.byteLength/65536|0}return{__wasm_call_ctors:function(){},malloc:y,openBox:function(e,t){e|=0,t|=0;var i,r,n,a=0;return p=i=p-16|0,s[i+12>>2]=0,s[i+8>>2]=0,s[i+4>>2]=0,s[i>>2]=0,function(e,t,i,r,n,a){var d,c,u=0,h=0,f=0,m=0;if(u=(l[e+2|0]^l[e+1|0]^l[0|e])<<24>>24,s[a>>2]=u+-48,u=47+(t-u|0)|0,s[r>>2]=u,d=i,c=y(u),s[d>>2]=c,f=y(h=s[a>>2]),s[n>>2]=f,(0|h)>0)for(u=h;;){if(f=(h-u|0)+f|0,h=(t-h|0)+e|0,o[0|f]=l[(t-u|0)+e|0]^l[h+-1|0]^l[h+-2|0],(0|(u=u+-1|0))<1){u=s[r>>2];break}f=s[n>>2],h=s[a>>2]}if((0|u)>0)for(;t=s[i>>2]+m|0,m=m+1|0,o[0|t]=l[m+e|0],(0|m)<s[r>>2];);}(e,t,i+12|0,i+4|0,i+8|0,i),function(e,t){var i=0,r=0,n=0,a=0,s=0,d=0,c=0;if((0|t)>=1)for(n=85,a=250;r=Z(i),s=l[0|(d=e+i|0)],c=r,r=1&i,o[0|d]=c+(21+((s^(r?n:a))<<24>>24)|0),a=r?a:s,n=r?s:n,(0|(i=i+1|0))!=(0|t););}(e=s[i+12>>2],t=s[i+4>>2]),r=function(e){var t;return(255&(t=e+-48|0))>>>0<=9?t<<24>>24:((e+-97&255)>>>0<26?e+-87|0:-1)<<24>>24}(o[0|e]),s[i>>2]=r,n=y(a=t-r|0),o[n+(a=a+-1|0)|0]=0,(0|a)>=1&&function(e,t,i){var r,n=0;if(i>>>0>=8192)u(0|e,0|t,0|i);else{r=e+i|0;e:if(3&(e^t))if(r>>>0<4)i=e;else if((n=r+-4|0)>>>0<e>>>0)i=e;else for(i=e;o[0|i]=l[0|t],o[i+1|0]=l[t+1|0],o[i+2|0]=l[t+2|0],o[i+3|0]=l[t+3|0],t=t+4|0,(i=i+4|0)>>>0<=n>>>0;);else{t:if((0|i)<1)i=e;else if(3&e)for(i=e;;){if(o[0|i]=l[0|t],t=t+1|0,(i=i+1|0)>>>0>=r>>>0)break t;if(!(3&i))break}else i=e;if(!((e=-4&r)>>>0<64||i>>>0>(n=e+-64|0)>>>0))for(;s[i>>2]=s[t>>2],s[i+4>>2]=s[t+4>>2],s[i+8>>2]=s[t+8>>2],s[i+12>>2]=s[t+12>>2],s[i+16>>2]=s[t+16>>2],s[i+20>>2]=s[t+20>>2],s[i+24>>2]=s[t+24>>2],s[i+28>>2]=s[t+28>>2],s[i+32>>2]=s[t+32>>2],s[i+36>>2]=s[t+36>>2],s[i+40>>2]=s[t+40>>2],s[i+44>>2]=s[t+44>>2],s[i+48>>2]=s[t+48>>2],s[i+52>>2]=s[t+52>>2],s[i+56>>2]=s[t+56>>2],s[i+60>>2]=s[t+60>>2],t=t- -64|0,(i=i- -64|0)>>>0<=n>>>0;);if(i>>>0>=e>>>0)break e;for(;s[i>>2]=s[t>>2],t=t+4|0,(i=i+4|0)>>>0<e>>>0;);}if(i>>>0<r>>>0)for(;o[0|i]=l[0|t],t=t+1|0,(0|r)!=(0|(i=i+1|0)););}}(n,e+1|0,t+(-1^r)|0),g(e),g(s[i+8>>2]),p=i+16|0,0|n},free:g,__errno_location:function(){return 1024},fflush:function e(t){var i=0;if(t|=0)return s[t+76>>2],0|v(t);if(s[260]&&(i=e(s[260])),m(1028),t=s[259])for(;d[t+20>>2]>d[t+28>>2]&&(i=v(t)|i),t=s[t+56>>2];);return f(1028),0|i},setThrew:function(e,t){e|=0,t|=0,s[385]||(s[386]=t,s[385]=e)},stackSave:function(){return 0|p},stackAlloc:function(e){return p=e=p-(e|=0)&-16,0|e},stackRestore:function(e){p=e|=0},__growWasmMemory:function(t){return 0|function(t){t|=0;var i=0|L(),a=i+t|0;if(i<a&&a<65536){var u=new ArrayBuffer(c(a,65536)),h=new e.Int8Array(u);h.set(o),o=h,o=new e.Int8Array(u),new e.Int16Array(u),s=new e.Int32Array(u),l=new e.Uint8Array(u),new e.Uint16Array(u),d=new e.Uint32Array(u),new e.Float32Array(u),new e.Float64Array(u),r=u,n.buffer=u}return i}(0|(t|=0))}}}({Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0,Math},J,d.buffer))}},instantiate:function(e,t){return{then:function(i,r){i({instance:new c.Instance(new c.Module(e,t))})}}},RuntimeError:Error};a=[],"object"!==W(c)&&Y("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead.");var u=new c.Table({initial:1,maximum:1,element:"anyfunc"}),h=!1;function f(e,t){e||Y("Assertion failed: "+t)}var m,p,b,y,g,v="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function Z(e,t,i,r){if(!(r>0))return 0;for(var n=i,a=i+r-1,o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),s<=127){if(i>=a)break;t[i++]=s}else if(s<=2047){if(i+1>=a)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=a)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+3>=a)break;s>=2097152&&l("Invalid Unicode code point 0x"+s.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-n}function T(e){for(var t=0,i=0;i<e.length;++i){var r=e.charCodeAt(i);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++i)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}function L(e,t){return e%t>0&&(e+=t-e%t),e}function S(e){m=e,i.HEAP8=p=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=y=new Int32Array(e),i.HEAPU8=b=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=g=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");f(!0,"stack must start aligned"),f(!0,"heap must start aligned");i.TOTAL_STACK&&f(8192===i.TOTAL_STACK,"the stack size can no longer be determined at runtime");var x=i.TOTAL_MEMORY||65536;function k(){f(!0),g[429]=34821223,g[430]=2310721022,y[0]=1668509029}function I(){var e=g[429],t=g[430];34821223==e&&2310721022==t||Y("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+t.toString(16)+" "+e.toString(16)),1668509029!==y[0]&&Y("Runtime error: The application has corrupted its heap memory area (address zero)!")}function X(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?i.dynCall_v(r):i.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}Object.getOwnPropertyDescriptor(i,"TOTAL_MEMORY")||Object.defineProperty(i,"TOTAL_MEMORY",{configurable:!0,get:function(){Y("Module.TOTAL_MEMORY has been replaced with plain INITIAL_TOTAL_MEMORY")}}),f(x>=8192,"TOTAL_MEMORY should be larger than TOTAL_STACK, was "+x+"! (TOTAL_STACK=8192)"),f("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),(d=i.wasmMemory?i.wasmMemory:new c.Memory({initial:x/65536}))&&(m=d.buffer),f((x=m.byteLength)%65536==0),S(m),y[388]=9904,function(){var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian!"}();var R=[],w=[],G=[],E=[],_=!1;f(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),f(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),f(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),f(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var C=0,P=null,V=null,K={};function Y(e){throw i.onAbort&&i.onAbort(e),o(e+=""),s(e),h=!0,e="abort("+e+") at "+(r=function(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}(),i.extraStackTrace&&(r+="\n"+i.extraStackTrace()),t=/\b_Z[\w\d_]+/g,r.replace(t,(function(e){var t,i=(t=e,l("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),t);return e===i?e:i+" ["+e+"]"}))),new c.RuntimeError(e);var t,r}i.preloadedImages={},i.preloadedAudios={};var D={error:function(){Y("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){D.error()},createDataFile:function(){D.error()},createPreloadedFile:function(){D.error()},createLazyFile:function(){D.error()},open:function(){D.error()},mkdev:function(){D.error()},registerDevice:function(){D.error()},analyzePath:function(){D.error()},loadFilesFromDB:function(){D.error()},ErrnoError:function(){D.error()}};i.FS_createDataFile=D.createDataFile,i.FS_createPreloadedFile=D.createPreloadedFile;var F="data:application/octet-stream;base64,";function H(e){return String.prototype.startsWith?e.startsWith(F):0===e.indexOf(F)}var N,U="aw.wasm";function O(){try{if(a)return new Uint8Array(a);var e=function(e){if(H(e))return function(e){try{for(var t=A(e),i=new Uint8Array(t.length),r=0;r<t.length;++r)i[r]=t.charCodeAt(r);return i}catch(e){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(F.length))}(U);if(e)return e;throw"both async and sync fetching of the wasm failed"}catch(e){Y(e)}}H(U)||(N=U,U=i.locateFile?i.locateFile(N,n):n+N),w.push({func:function(){oe()}});var A="function"==typeof atob?atob:function(e){var t,i,r,n,a,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",d=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=s.indexOf(e.charAt(d++))<<2|(n=s.indexOf(e.charAt(d++)))>>4,i=(15&n)<<4|(a=s.indexOf(e.charAt(d++)))>>2,r=(3&a)<<6|(o=s.indexOf(e.charAt(d++))),l+=String.fromCharCode(t),64!==a&&(l+=String.fromCharCode(i)),64!==o&&(l+=String.fromCharCode(r))}while(d<e.length);return l},J={__lock:function(){},__unlock:function(){},emscripten_memcpy_big:function(e,t,i){b.set(b.subarray(t,t+i),e)},emscripten_resize_heap:function(e){var t=p.length;f(e>t);var i=2147418112;if(e>i)return s("Cannot enlarge memory, asked to go up to "+e+" bytes, but the limit is "+i+" bytes!"),!1;for(var r=Math.max(t,16777216);r<e;)(r=r<=536870912?L(2*r,65536):Math.min(L((3*r+2147483648)/4,65536),i))===t&&l("Cannot ask for more memory since we reached the practical limit in browsers (which is just below 2GB), so the request would have failed. Requesting only "+p.length);return function(e){try{return d.grow(e-m.byteLength+65535>>16),S(d.buffer),1}catch(t){console.error("emscripten_realloc_buffer: Attempted to grow heap from "+m.byteLength+" bytes to "+e+" bytes, but got error: "+t)}}(r)?(s("Warning: Enlarging memory arrays, this is not fast! "+[t,r]),!0):(s("Failed to grow the heap from "+t+" bytes to "+r+" bytes, not enough memory!"),!1)},memory:d,table:u},j=function(){var e,t={env:J,wasi_unstable:J};function r(e,t){var r=e.exports;i.asm=r,function(e){if(C--,i.monitorRunDependencies&&i.monitorRunDependencies(C),f(K[e]),delete K[e],0==C&&(null!==P&&(clearInterval(P),P=null),V)){var t=V;V=null,t()}}("wasm-instantiate")}e="wasm-instantiate",C++,i.monitorRunDependencies&&i.monitorRunDependencies(C),f(!K[e]),K[e]=1,null===P&&"undefined"!=typeof setInterval&&(P=setInterval((function(){if(h)return clearInterval(P),void(P=null);var e=!1;for(var t in K)e||(e=!0,s("still waiting on run dependencies:")),s("dependency: "+t);e&&s("(end of list)")}),1e4));var n=i;function o(e){f(i===n,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),n=null,r(e.instance)}function l(e){return(a||"function"!=typeof fetch?new Promise((function(e,t){e(O())})):fetch(U,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+U+"'";return e.arrayBuffer()})).catch((function(){return O()}))).then((function(e){return c.instantiate(e,t)})).then(e,(function(e){s("failed to asynchronously prepare wasm: "+e),Y(e)}))}if(i.instantiateWasm)try{return i.instantiateWasm(t,r)}catch(e){return s("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(a||"function"!=typeof c.instantiateStreaming||H(U)||"function"!=typeof fetch)return l(o);fetch(U,{credentials:"same-origin"}).then((function(e){return c.instantiateStreaming(e,t).then(o,(function(e){s("wasm streaming compile failed: "+e),s("falling back to ArrayBuffer instantiation"),l(o)}))}))}(),{}}(),B=j.__wasm_call_ctors;j.__wasm_call_ctors=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),B.apply(null,arguments)};var z=j.malloc;j.malloc=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),z.apply(null,arguments)};var Q=j.openBox;j.openBox=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Q.apply(null,arguments)};var q=j.free;j.free=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),q.apply(null,arguments)};var $=j.__errno_location;j.__errno_location=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),$.apply(null,arguments)};var ee=j.fflush;j.fflush=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ee.apply(null,arguments)};var te=j.setThrew;j.setThrew=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),te.apply(null,arguments)};var ie=j.stackSave;j.stackSave=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ie.apply(null,arguments)};var re=j.stackAlloc;j.stackAlloc=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),re.apply(null,arguments)};var ne=j.stackRestore;j.stackRestore=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ne.apply(null,arguments)};var ae=j.__growWasmMemory;j.__growWasmMemory=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ae.apply(null,arguments)},i.asm=j;var oe=i.___wasm_call_ctors=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__wasm_call_ctors.apply(null,arguments)},se=i._malloc=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.malloc.apply(null,arguments)};i._openBox=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.openBox.apply(null,arguments)},i._free=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.free.apply(null,arguments)},i.___errno_location=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__errno_location.apply(null,arguments)},i._fflush=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.fflush.apply(null,arguments)},i._setThrew=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.setThrew.apply(null,arguments)};var le=i.stackSave=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackSave.apply(null,arguments)};i.stackAlloc=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackAlloc.apply(null,arguments)},i.stackRestore=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.stackRestore.apply(null,arguments)};var de,ce=i.__growWasmMemory=function(){return f(_,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),f(!0,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),i.asm.__growWasmMemory.apply(null,arguments)};function ue(e){function t(){de||(de=!0,h||(I(),f(!_),_=!0,X(w),I(),X(G),i.onRuntimeInitialized&&i.onRuntimeInitialized(),f(!i._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function(){if(I(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),E.unshift(e);var e;X(E)}()))}C>0||(k(),function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),R.unshift(e);var e;X(R)}(),C>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),t()}),1)):t(),I()))}if(i.asm=j,i.intArrayFromString=function(e,t,i){var r=i>0?i:T(e)+1,n=new Array(r),a=Z(e,n,0,n.length);return t&&(n.length=a),n},Object.getOwnPropertyDescriptor(i,"intArrayToString")||(i.intArrayToString=function(){Y("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"ccall")||(i.ccall=function(){Y("'ccall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"cwrap")||(i.cwrap=function(){Y("'cwrap' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"setValue")||(i.setValue=function(){Y("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getValue")||(i.getValue=function(){Y("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"allocate")||(i.allocate=function(){Y("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getMemory")||(i.getMemory=function(){Y("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"AsciiToString")||(i.AsciiToString=function(){Y("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToAscii")||(i.stringToAscii=function(){Y("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF8ArrayToString")||(i.UTF8ArrayToString=function(){Y("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.UTF8ToString=function(e,t){return e?function(e,t,i){for(var r=t+i,n=t;e[n]&&!(n>=r);)++n;if(n-t>16&&e.subarray&&v)return v.decode(e.subarray(t,n));for(var a="";t<n;){var o=e[t++];if(128&o){var s=63&e[t++];if(192!=(224&o)){var d=63&e[t++];if(224==(240&o)?o=(15&o)<<12|s<<6|d:(240!=(248&o)&&l("Invalid UTF-8 leading byte 0x"+o.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),o=(7&o)<<18|s<<12|d<<6|63&e[t++]),o<65536)a+=String.fromCharCode(o);else{var c=o-65536;a+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else a+=String.fromCharCode((31&o)<<6|s)}else a+=String.fromCharCode(o)}return a}(b,e,t):""},Object.getOwnPropertyDescriptor(i,"stringToUTF8Array")||(i.stringToUTF8Array=function(){Y("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF8")||(i.stringToUTF8=function(){Y("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF8")||(i.lengthBytesUTF8=function(){Y("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF16ToString")||(i.UTF16ToString=function(){Y("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF16")||(i.stringToUTF16=function(){Y("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF16")||(i.lengthBytesUTF16=function(){Y("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"UTF32ToString")||(i.UTF32ToString=function(){Y("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stringToUTF32")||(i.stringToUTF32=function(){Y("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"lengthBytesUTF32")||(i.lengthBytesUTF32=function(){Y("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.allocateUTF8=function(e){var t=T(e)+1,i=se(t);return i&&Z(e,p,i,t),i},Object.getOwnPropertyDescriptor(i,"stackTrace")||(i.stackTrace=function(){Y("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPreRun")||(i.addOnPreRun=function(){Y("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnInit")||(i.addOnInit=function(){Y("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPreMain")||(i.addOnPreMain=function(){Y("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnExit")||(i.addOnExit=function(){Y("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addOnPostRun")||(i.addOnPostRun=function(){Y("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeStringToMemory")||(i.writeStringToMemory=function(){Y("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeArrayToMemory")||(i.writeArrayToMemory=function(){Y("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"writeAsciiToMemory")||(i.writeAsciiToMemory=function(){Y("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addRunDependency")||(i.addRunDependency=function(){Y("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"removeRunDependency")||(i.removeRunDependency=function(){Y("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"ENV")||(i.ENV=function(){Y("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"FS")||(i.FS=function(){Y("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"FS_createFolder")||(i.FS_createFolder=function(){Y("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createPath")||(i.FS_createPath=function(){Y("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createDataFile")||(i.FS_createDataFile=function(){Y("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createPreloadedFile")||(i.FS_createPreloadedFile=function(){Y("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createLazyFile")||(i.FS_createLazyFile=function(){Y("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createLink")||(i.FS_createLink=function(){Y("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_createDevice")||(i.FS_createDevice=function(){Y("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"FS_unlink")||(i.FS_unlink=function(){Y("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(i,"GL")||(i.GL=function(){Y("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"dynamicAlloc")||(i.dynamicAlloc=function(){Y("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"loadDynamicLibrary")||(i.loadDynamicLibrary=function(){Y("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"loadWebAssemblyModule")||(i.loadWebAssemblyModule=function(){Y("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getLEB")||(i.getLEB=function(){Y("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getFunctionTables")||(i.getFunctionTables=function(){Y("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"alignFunctionTables")||(i.alignFunctionTables=function(){Y("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"registerFunctions")||(i.registerFunctions=function(){Y("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"addFunction")||(i.addFunction=function(){Y("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"removeFunction")||(i.removeFunction=function(){Y("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getFuncWrapper")||(i.getFuncWrapper=function(){Y("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"prettyPrint")||(i.prettyPrint=function(){Y("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"makeBigInt")||(i.makeBigInt=function(){Y("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"dynCall")||(i.dynCall=function(){Y("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getCompilerSetting")||(i.getCompilerSetting=function(){Y("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackSave")||(i.stackSave=function(){Y("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackRestore")||(i.stackRestore=function(){Y("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"stackAlloc")||(i.stackAlloc=function(){Y("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"establishStackSpace")||(i.establishStackSpace=function(){Y("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"print")||(i.print=function(){Y("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"printErr")||(i.printErr=function(){Y("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"getTempRet0")||(i.getTempRet0=function(){Y("'getTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"setTempRet0")||(i.setTempRet0=function(){Y("'setTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"callMain")||(i.callMain=function(){Y("'callMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"abort")||(i.abort=function(){Y("'abort' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.Pointer_stringify=function(e,t){Y("this function has been removed - you should use UTF8ToString(ptr, maxBytesToRead) instead!")},Object.getOwnPropertyDescriptor(i,"warnOnce")||(i.warnOnce=function(){Y("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),i.writeStackCookie=k,i.checkStackCookie=I,i.abortStackOverflow=function(e){Y("Stack overflow! Attempted to allocate "+e+" bytes on the stack, but stack has only "+(1712-le()+e)+" bytes available!")},Object.getOwnPropertyDescriptor(i,"intArrayFromBase64")||(i.intArrayFromBase64=function(){Y("'intArrayFromBase64' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"tryParseAsDataURI")||(i.tryParseAsDataURI=function(){Y("'tryParseAsDataURI' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(i,"ALLOC_NORMAL")||Object.defineProperty(i,"ALLOC_NORMAL",{configurable:!0,get:function(){Y("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_STACK")||Object.defineProperty(i,"ALLOC_STACK",{configurable:!0,get:function(){Y("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_DYNAMIC")||Object.defineProperty(i,"ALLOC_DYNAMIC",{configurable:!0,get:function(){Y("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"ALLOC_NONE")||Object.defineProperty(i,"ALLOC_NONE",{configurable:!0,get:function(){Y("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(i,"calledRun")||Object.defineProperty(i,"calledRun",{configurable:!0,get:function(){Y("'calledRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}}),i.then=function(e){if(de)e(i);else{var t=i.onRuntimeInitialized;i.onRuntimeInitialized=function(){t&&t(),e(i)}}return i},V=function e(){de||ue(),de||(V=e)},i.run=ue,i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return ue(),e}),H=(i(68068),i(48612),{str2hex:function(e){if(""===e)return"";for(var t=[],i=0;i<e.length;i++)t.push(e.charCodeAt(i));return t},Base64ToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));if(t){for(var r=[],n=0;n<i.length;n++)r.push(i.charCodeAt(n));return new Uint8Array(r).buffer}for(var a="",o=0;o<i.length;o++)a+=("0"+i.charCodeAt(o).toString(16)).substr(-2);return a},checkUnionInfoExpired:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(0===t.indexOf(e)){var r=parseInt(U(t.slice(e.length))),n=(new Date).getTime()-r;if(n>0&&n<=1e3*i)return!0;console.error("UnionInfo timestamp expire!!!")}else console.error("unionID and UnionInfo not match!!!");return!1},getUnionInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(N((new Date).getTime().toString()))},StringToArrayBuffer:function(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return t},ArrayBufferToString:function(e){var t=[];e=ArrayBuffer.isView(e)?e:new Uint8Array(e);for(var i,r=0;r<e.length;r++)i=e[r],t.push(String.fromCharCode(i));return t.join("")},isBase64:function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)}}),N=("vodTimestampSalt",K=function(e){return e.split("").map((function(e){return e.charCodeAt(0)}))},Y=function(e){return("0"+Number(e).toString(16)).substr(-2)},D=function(e){return K("vodTimestampSalt").reduce((function(e,t){return e^t}),e)},function(e){return e.split("").map(K).map(D).map(Y).join("")}),U=function(e){var t=function(e){return(t="vodTimestampSalt",t.split("").map((function(e){return e.charCodeAt(0)}))).reduce((function(e,t){return e^t}),e);var t};return function(e){return e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})).map(t).map((function(e){return String.fromCharCode(e)})).join("")}}(),O=function(){function e(){var t,i;C(this,e);var r=new Promise((function(e,r){t=e,i=r}));return r.resolve=function(e){t(e),r.state="fulfilled"},r.reject=function(e){i(e),r.state="rejected",r.isBreak="DESTROYED"===e},r.state="pending",r}return V(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}(),A=function(){function e(){C(this,e)}return V(e,[{key:"init",value:function(){var e=new O;return this.module={onRuntimeInitialized:function(){e.resolve()},onAbort:function(t){e.reject(t)}},F(this.module),e}},{key:"openBox",value:function(e){try{var t=window.atob(e),i=H.str2hex(t),r=this.module._malloc(Number(i.length));this.module.HEAP8.set(i,r);var n=this.module._openBox(Number(r),i.length),a=this.module.UTF8ToString(n);return this.module._free(r),a}catch(e){}}},{key:"destroy",value:function(){this.module=null}}]),e}(),J=(i(96428),V((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.url,r=t.method,n=void 0===r?"GET":r,a=t.type,o=void 0===a?"arraybuffer":a,s=t.data,l=void 0===s?{}:s;return C(this,e),new Promise((function(e,t){var r=new window.XMLHttpRequest,a=n.toUpperCase(),s=[];if(Object.keys(l).map((function(e){s.push("k=".concat(l[e]))})),"GET"===a)r.open(a,"".concat(i,"?").concat(s.join("&"))),o&&(r.responseType=o),r.send();else{if("POST"!==a)throw new Error("xhr ".concat(a," is not supported"));r.open(a,i,!0),o&&(r.responseType=o),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(l))}r.onload=function(){200===r.status||206===r.status?e(r):t(r)},r.onerror=function(){t(r)}}))})));function j(e,t,i){var r=new O;return new J({type:"json",method:"POST",url:i,data:{drm_type:"22",license_request:[{vid:e,kids:[].concat(t)}]}}).then((function(i){var n=i.response;if("string"==typeof n&&(n=JSON.parse(n)),n){var a=n.play_licenses[e][t];r.resolve(a)}else r.reject()})).catch((function(){r.reject()})),r}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=new O;if(t){var o=n.openBox(t);if(i){var s={clearKeys:{}};s.clearKeys[i]=o,a.resolve(s)}else a.resolve(o)}else{var l=j(e,i,r);l.id="requestPromise",l.then((function(e){if(n){var t=n.openBox(e),r={clearKeys:{}};r.clearKeys[i]=t,a.resolve(r)}else a.reject({errDes:"awManager not exist, player destroyed"})})).catch((function(e){a.reject(e)}))}return a}function z(e){var t,i=!1;try{i=localStorage&&!!localStorage.getItem("playerlog")}catch(e){}for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];i&&console.log&&(t=console).log.apply(t,["[XGSecretkey]",e].concat(n))}var Q=i(93685);function q(e,t){return $.apply(this,arguments)}function $(){return($=_(G().mark((function e(t,i){var r,n,a,o,s;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.iv,n=i.tagLength,a=i.data,o=null,t=H.StringToArrayBuffer(t),a=H.Base64ToHex(a,!0),e.prev=4,e.next=7,crypto.subtle.importKey("raw",t,"AES-GCM",!0,["encrypt","decrypt"]);case 7:s=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),"importKey: ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0);case 13:return e.prev=13,e.next=16,crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(r),tagLength:n},s,a);case 16:o=e.sent,e.next=30;break;case 19:if(e.prev=19,e.t1=e.catch(13),"OperationError"!==String(e.t1)){e.next=25;break}throw"Wrong Password.";case 25:if("InvalidAccessError"!==String(e.t1)){e.next=29;break}throw"Invalid Key";case 29:throw e.t1;case 30:return e.abrupt("return",new TextDecoder("utf-8").decode(o));case 31:case"end":return e.stop()}}),e,null,[[4,10],[13,19]])})))).apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=_(G().mark((function e(t,i){var r,n,a,o,s,l,d;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.iv,n=i.tagLength,a=i.data,o=btoa(H.ArrayBufferToString(r)),s=Q.Z.codec.base64.toBits(o),l=Q.Z.codec.utf8String.toBits(t),d=new Q.Z.cipher.aes(l),e.abrupt("return",Q.Z.codec.utf8String.fromBits(Q.Z.mode.gcm.decrypt(d,Q.Z.codec.base64.toBits(a),s,[],n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie,re={decrypt:(ie=_(G().mark((function e(t,i){var r,n;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof i&&(i=JSON.parse(i)),!i.enableSoftwareAES&&null!==(r=crypto)&&void 0!==r&&r.subtle){e.next=7;break}return e.next=4,ee(t,i);case 4:n=e.sent,e.next=18;break;case 7:return e.prev=7,e.next=10,q(t,i);case 10:n=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(7),e.next=17,ee(t,i);case 17:n=e.sent;case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,null,[[7,13]])}))),function(e,t){return ie.apply(this,arguments)})},ne=i(6061),ae=i.n(ne),oe=new Uint8Array([91,104,69,75,156,171,238,71,202,4,244,5]).buffer;function se(e,t){return le.apply(this,arguments)}function le(){return(le=_(G().mark((function e(t,i){var r,n;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ae().hash(i),e.next=3,re.decrypt(r,{data:t,iv:oe,tagLength:128});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de=function(){function e(){C(this,e),this.queue=[]}return V(e,[{key:"push",value:function(e){this.queue.push(e)}},{key:"startup",value:function(){return Promise.all(this.queue)}},{key:"destroy",value:function(){this.queue=[]}}]),e}(),ce="volcvui",ue=new Map,he=function(){function e(t){C(this,e),this.awManager=null,this._awPromise=null,this.config=e.defaultConfig,this.updateConfig(t),this.config.isEncrypt=!!(this.config.kid||this.config.drm||this.config.secretKey||this.config.drmKeyToken||this.config.keyValue||this.config.drm),this.initAwManager()}var t;return V(e,[{key:"updateConfig",value:function(e){var t=this;Object.keys(e).map((function(i){void 0!==e[i]&&null!==e[i]&&void 0!==t.config[i]&&(t.config[i]=e[i])}))}},{key:"initAwManager",value:function(){var e=this,t=this.config;if(this.awManager||(this.awManager=new A),this._awPromise=new O,this.config.isEncrypt){this.log("initAwManager start, vid,",t.vid);var i=new de;i.push(this.awManager.init()),i.startup().then((function(){i.destroy(),e.log("initAwManager success end, vid,",t.vid),e._awPromise.resolve()})).catch((function(r){i.destroy(),e.log("initAwManager reject end, vid,",t.vid),e._awPromise.reject(r)}))}else this._awPromise.resolve()}},{key:"getSecretKeyByToken",value:function(e,t,i){var r=this,n=this.config,a=e||n.kid,o=t||n.playDomain;o.indexOf("//")<0&&(o="//"+o);var s=i||n.drmKeyToken,l=H.isBase64(s)?window.atob(s):s,d="".concat(o,"?").concat(l,"&DrmType=").concat(n.useUnionInfoDRM?"webdevice":"22","&PlayAuthIds=").concat(a,"&ssl=true");this.log("getSecretKeyByToken start, vid,",n.vid,d);var c=new O;return new J({type:"json",method:"GET",url:d}).then((function(e){var t,i,a=e.response;if("string"==typeof a&&(a=JSON.parse(a)),a&&null!==(t=a)&&void 0!==t&&t.Result&&(null===(i=a.Result.PlayAuthInfoList)||void 0===i?void 0:i.length)>0){var o=a.Result.PlayAuthInfoList[0].PlayAuthContent;r.log("getSecretKeyByToken end, vid,",n.vid,",res,",JSON.stringify(a)),c.resolve(o)}})).catch((function(e){c.reject(e)})),c}},{key:"getLicense",value:function(){var e=this,t=this.config,i=t.vid,r=t.kid,n=t.getLicenseUrl,a=t.drmKeyToken,o=t.playDomain,s=new O;return this._awPromise.then(_(G().mark((function t(){var l,d,c,u,h,f,m;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l={method:"getLicense",success:!1},e.log("getLicense start, vid,",i,JSON.stringify(e.config)),!(r&&a&&o)){t.next=14;break}return t.prev=3,t.next=6,e.getSecretKeyByToken(r,o,a);case 6:e.config.secretKey=t.sent,t.next=14;break;case 9:t.prev=9,t.t0=t.catch(3),l.success=!1,l.error=t.t0,s.reject(l);case 14:if(d=e.config,c=d.secretKey,u=d.keyValue,!(r||c||u||e.config.drm)){t.next=43;break}if(e.log("getKeyValue start, vid,",i,",secretKey，",c,",kid,",r,",getLicenseUrl,",n),t.prev=17,h=e.config.drm||u,!(c||r&&n)){t.next=23;break}return t.next=22,B(i,c,r,n,e.awManager);case 22:h=t.sent;case 23:return e.log("getKeyValue end, vid,",i,",drm，",h),f=h&&h.clearKeys?h.clearKeys[r]:h,e.log("getUnionKey start, vid,",i,",keyValue，",f),t.next=28,e.getUnionKey(f);case 28:m=t.sent,e.log("unionKey end, vid,",i,",unionKey，",m),h&&h.clearKeys&&(h.clearKeys[r]=m,l.drm=h),l.keyValue=m,e.log("getLicense end",", vid, ",i,l),l.success=!0,s.resolve(l),t.next=43;break;case 37:t.prev=37,t.t1=t.catch(17),l.success=!1,l.error=t.t1,e.log("getLicense end",", vid, ",i,l),s.reject(l);case 43:case"end":return t.stop()}}),t,null,[[3,9],[17,37]])})))),s}},{key:"getUnionKey",value:(t=_(G().mark((function e(t){var i,r,n,a,o,s;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config,n=r.sessionId,a=r.useUnionInfoDRM,o=r.keyTokenExpiredDuration,s=ue.get(n),!t&&(t=this.config.keyValue),!a||!H.checkUnionInfoExpired(s.unionID,s.unionInfo,o)){e.next=13;break}return e.next=7,se(t,s.unionInfo);case 7:i=e.sent,e.next=11;break;case 10:throw'The "transformUnionKey" should be provided in configuration as a function';case 11:e.next=14;break;case 13:i=t;case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.awManager&&(this.awManager.destroy(),this.awManager=null)}},{key:"log",value:function(e){if(this.config.openLog){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];z.apply(void 0,[e].concat(i))}}},{key:"getSecretKey",value:function(){var e=this.config,t=e.vid,i=e.kid,r=e.getLicenseUrl,n=e.drmKeyToken,a=e.playDomain,o=e.secretKey;return r&&i?j(t,i,r):n&&i&&a?this.getSecretKeyByToken(i,a,n):o||(console.error("[DRM]DRM,getSecretKey args is invalid"),null)}},{key:"getKeyValue",value:function(){var e=this.config,t=e.vid,i=e.kid,r=e.getLicenseUrl;return B(t,e.secretKey,i,r,this.awManager)}}],[{key:"pluginName",get:function(){return"XGSecretKey"}},{key:"defaultConfig",get:function(){return{keyValue:null,kid:null,getLicenseUrl:"",secretKey:null,drm:null,vid:"",openLog:!1,useUnionInfoDRM:!1,transformUnionKey:null,drmKeyToken:null,keyTokenExpiredDuration:null,playDomain:null,sessionId:ce}}},{key:"updateUnionInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce,i=H.getUnionInfo(e);return ue.set(t,{unionID:e,unionInfo:i}),i}}]),e}();he.isWebAssemblySupported=function(){try{if("object"===("undefined"==typeof WebAssembly?"undefined":W(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){}return!1},i(24111),i(40923),i(40520),i(20481),i(43188),i(31897),i(15561),i(18780),i(43337),i(51838),i(32652),i(73907),i(20166),i(49979);var fe=i(51962),me=i.n(fe),pe=i(33903),be=i.n(pe),ye=i(95780),ge=i(46001),ve='"3.0.0-alpha.38-7"',Ze={416:-499899,401:-499898,403:-499897,404:-499896,timeout:-499895,"4xx":-499894,"5xx":-499893,networkError:-499892,contentError:-499891,mse:-499971,mseOpen:-499972,mseAppend:-499973,boxsError:-499980,moovError:-499981,notH264:-499982,mdatError:-499983,mdhdError:-499984,metaError:-499985,muxError:-499986,h265Error:-499987,noneURL:-499988,other:-499989,other1:-499990,waitTimeout:-499791,onWaitInBufferRange:-499792},Te={network:1003,format:1005,runtime:1002,other:9999,demux:1006,remux:1007},Le=u((function e(t,i,r){d(this,e);var n=0,a=0;r&&r.range&&r.range.length>1&&(n=r.range[0],a=r.range[1]);var o=function(e){var t=0;switch(e){case 0:t=0;break;case-1:t=Ze.networkError;break;case-2:t=Ze.timeout;break;case-3:t=Ze.contentError;break;default:t=e<500?Ze[e]||e["4xx"]:Ze[e]||e["5xx"]}return t}(i);return{errorCode:o,errorType:t,errorTypeCode:Te[t],errorMessage:(null==r?void 0:r.httpText)||(null==r?void 0:r.message),url:null==r?void 0:r.url,httpCode:i,version:ve,rangeStart:n,rangeEnd:a,ext:r,mediaError:{code:o,message:(null==r?void 0:r.httpText)||(null==r?void 0:r.message)}}})),Se=u((function e(t,i,r){return d(this,e),{errorCode:i,errorType:t,errorTypeCode:Te[t],version:ve,errorMessage:r.msg,ext:r,mediaError:{code:i,message:r.msg}}})),xe={};function ke(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}xe.findBox=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.type!==t){if(e&&e.subBox){var r=e.subBox.filter((function(e){return e.type===t}));r.length?r.forEach((function(e){return i.push(e)})):e.subBox.forEach((function(e){return xe.findBox(e,t,i)}))}}else i.push(e);return(i=[].concat(i)).length>1?i:i[0]},xe.padStart=function(e,t,i){for(var r=String(i),n=t>>0,a=Math.ceil(n/r.length),o=[],s=String(e);a--;)o.push(r);return o.join("").substring(0,n-s.length)+s},xe.toHex=function(){for(var e=[],t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach((function(t){e.push(xe.padStart(Number(t).toString(16),2,0))})),e},xe.sum=function(){for(var e=0,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach((function(t){e+=t})),e},xe.StringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return t},xe.fromHex=function(e){for(var t=new Uint8Array(e.length/2),i=0;i<e.length;i+=2)t[i/2]=window.parseInt(e.substr(i,2),16);return t},xe.fromCharCode=function(e){for(var t="",i=0;i<e.length;i+=16e3){var r=e.subarray(i,i+16e3);t+=String.fromCharCode.apply(null,r)}return t},xe.ArrayBufferToString=function(e){for(var t="",i=new Uint8Array(e),r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},xe.Base64ToHex=function(e){for(var t=window.atob(e.replace(/-/g,"+").replace(/_/g,"/")),i="",r=0;r<t.length;r++)i+=("0"+t.charCodeAt(r).toString(16)).substr(-2);return i},xe.toBase64=function(e,t){var i=xe.fromCharCode(e);t=void 0===t||t;var r=window.btoa(i).replace(/\+/g,"-").replace(/\//g,"_");return t?r:r.replace(/=*$/,"")},xe.toUTF8=function(e){for(var t=encodeURIComponent(e),i=unescape(t),r=new Uint8Array(i.length),n=0;n<i.length;++n)r[n]=i.charCodeAt(n);return r.buffer},xe.bufferToString=function(e){return("0"+Number(e).toString(16)).slice(-2).toUpperCase()},xe.strToBuf=function(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e[i]+e[i+1],16));return new Uint8Array(t)},xe.formatIV=function(e){var t="";if(e.forEach((function(e){t+=xe.bufferToString(e)})),t.length<=32)for(var i=32-t.length,r=0;r<i;r++)t+="0";return t},xe.str2hex=function(e){if(""===e)return"";for(var t=[],i=0;i<e.length;i++)t.push(e.charCodeAt(i));return t},xe.parse=function(e){if(!Array.isArray(e)){for(var t=[],i="",r=0;r<e.length;r++)r%2&&(i=e[r-1]+e[r],t.push(parseInt(i,16)),i="");return t}return e.map((function(e){return parseInt(e,16)}))},xe.generateUniqueKey=function(e){var t=e.vid;e.start,e.end;var i=e.mediaType,r=e.definition;return e.preloadTime,i=i||"video",r=r||"0",t?"".concat(t,"#").concat(i,"#").concat(r,"#mp4"):null},xe.validateFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e instanceof ArrayBuffer){try{if(2===t.length){var i=t[1]-t[0]+1;if(e.byteLength!==i)return}}catch(e){return console.error(e),!1}return!0}return!1},xe.typeOf=function(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]},xe.getBufferSplits=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e5,r=t-e;if(r-i<i/2||!t)return[[e,t]];for(var n=[];e<t;){var a=e+i;(a>t||t-a<i/2)&&(a=t),n.push([e,a]),e=a+1}return n},xe.nowTime=function(){try{return parseInt(performance.now(),10)}catch(e){return(new Date).getTime()}},xe.extUrl=function(e,t){try{var i=e.indexOf("?");return i<0?Object.keys(t).map((function(i,r){e+=0===r?"?".concat(i,"=").concat(t[i]):"&".concat(i,"=").concat(t[i])})):Object.keys(t).map((function(r,n){i===e.length-1?e+="".concat(r,"=").concat(t[r]):e+="&".concat(r,"=").concat(t[r])})),e}catch(t){return e}},xe.deepMerge=function(e,t){return Object.keys(t).forEach((function(i){var r,n=ke(t[i]),a=ke(e[i]);"Array"===n?("Array"!==a&&(e[i]=[]),(r=e[i]).push.apply(r,T(t[i]))):"Object"===n?("Object"!==a&&(e[i]={}),xe.deepMerge(e[i],t[i])):e[i]=t[i]})),e},xe.getFileSize=function(e,t){try{return e&&t?parseInt(t*e/8,10):0}catch(e){return 0}},xe.hashVal=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i},xe.getFileSize=function(e,t){try{return e&&t?parseInt(t*e/8,10):0}catch(e){return 0}},xe.concatData=function(e,t){var i=[],r=0;e&&i.push(e),t&&i.push(t),i.every((function(e){return e&&(r+=e.byteLength),!0}));var n=new Uint8Array(r),a=0;return i.every((function(e){return e&&(n.set(e,a),a+=e.byteLength),!0})),n},xe.getFragRange=function(e,t,i){var r=e<t.length?t[e]:null,n=e<i.length?i[e]:null,a=0,o=0;return e===t.length-1&&(a=-1),e===i.length-1&&(o=-1),[Math.min((null==r?void 0:r.range[0])||1/0,(null==n?void 0:n.range[0])||1/0),Math.max((null==r?void 0:r.range[1])+a||0,(null==n?void 0:n.range[1])+o||0)]};var Ie=i(94827),Xe=function(){try{return"undefined"!=typeof localStorage&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch(e){return!1}}()&&!function(){var e="_localstorage_support_test";try{return window.localStorage.setItem(e,!0),window.localStorage.removeItem(e),!1}catch(e){return!0}}(),Re=we();function we(){if(Xe)try{return!!window.localStorage.getItem("playerlog")}catch(e){return!1}return!1}function Ge(e){for(var t,i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];Re&&console.log&&(t=console).log.apply(t,["[logger]",xe.nowTime(),e].concat(r))}i(35815),i(24260);var We={"x-cache":"x_cache","x-response-sinfo":"server_ip","x-response-cinfo":"x-response-cinfo"};function Ee(e){var t={};return Object.keys(We).forEach((function(i){var r=We[i];e&&e.get&&e.get(i)&&(t[r]=e.get(i))})),t}var _e=[{range:[0,90],size:614400},{range:[90,120],size:1228800},{range:[120,Number.MAX_VALUE],size:2048e3}];function Ce(e,t,i){var r=i>51200?Math.min(i,t):t;if(!e)return r;for(var n=0;n<_e.length;n++)if(e>=_e[n].range[0]&&e<_e[n].range[1]){r=Math.min(Math.max(r,_e[n].size),i>0?i:t);break}return r}i(92872),i(91407);var Pe="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHQodCxlKXt2YXIgcj1PYmplY3Qua2V5cyh0KTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHQpO2UmJihuPW4uZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LGUpLmVudW1lcmFibGV9KSkpLHIucHVzaC5hcHBseShyLG4pfXJldHVybiByfWZ1bmN0aW9uIGUoZSl7Zm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3JdP2FyZ3VtZW50c1tyXTp7fTtyJTI/dChPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe2EoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOnQoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gcih0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIG4odCxlKXtmb3IodmFyIHI9MDtyPGUubGVuZ3RoO3IrKyl7dmFyIG49ZVtyXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LGcobi5rZXkpLG4pfX1mdW5jdGlvbiBpKHQsZSxyKXtyZXR1cm4gZSYmbih0LnByb3RvdHlwZSxlKSxyJiZuKHQsciksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksdH1mdW5jdGlvbiBhKHQsZSxyKXtyZXR1cm4oZT1nKGUpKWluIHQ/T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7dmFsdWU6cixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOnRbZV09cix0fWZ1bmN0aW9uIG8odCxlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSYmbnVsbCE9PWUpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUmJmUucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6dCx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksZSYmdSh0LGUpfWZ1bmN0aW9uIHModCl7cmV0dXJuKHM9T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24odCl7cmV0dXJuIHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCl9KSh0KX1mdW5jdGlvbiB1KHQsZSl7cmV0dXJuKHU9T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5fX3Byb3RvX189ZSx0fSkodCxlKX1mdW5jdGlvbiBjKCl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBSZWZsZWN0fHwhUmVmbGVjdC5jb25zdHJ1Y3QpcmV0dXJuITE7aWYoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSlyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgUHJveHkpcmV0dXJuITA7dHJ5e3JldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbixbXSwoZnVuY3Rpb24oKXt9KSkpLCEwfWNhdGNoKHQpe3JldHVybiExfX1mdW5jdGlvbiBmKHQsZSxyKXtyZXR1cm4oZj1jKCk/UmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpOmZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1bbnVsbF07bi5wdXNoLmFwcGx5KG4sZSk7dmFyIGk9bmV3KEZ1bmN0aW9uLmJpbmQuYXBwbHkodCxuKSk7cmV0dXJuIHImJnUoaSxyLnByb3RvdHlwZSksaX0pLmFwcGx5KG51bGwsYXJndW1lbnRzKX1mdW5jdGlvbiBsKHQsZSl7aWYoZSYmKCJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGUpKXJldHVybiBlO2lmKHZvaWQgMCE9PWUpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWQiKTtyZXR1cm4gZnVuY3Rpb24odCl7aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiB0fSh0KX1mdW5jdGlvbiBoKHQpe3ZhciBlPWMoKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcixuPXModCk7aWYoZSl7dmFyIGk9cyh0aGlzKS5jb25zdHJ1Y3RvcjtyPVJlZmxlY3QuY29uc3RydWN0KG4sYXJndW1lbnRzLGkpfWVsc2Ugcj1uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gbCh0aGlzLHIpfX1mdW5jdGlvbiBkKHQsZSl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSkmJm51bGwhPT0odD1zKHQpKTspO3JldHVybiB0fWZ1bmN0aW9uIHAoKXtyZXR1cm4gcD0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0LmJpbmQoKTpmdW5jdGlvbih0LGUscil7dmFyIG49ZCh0LGUpO2lmKG4pe3ZhciBpPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobixlKTtyZXR1cm4gaS5nZXQ/aS5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoPDM/dDpyKTppLnZhbHVlfX0scC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gdih0KXtyZXR1cm4gZnVuY3Rpb24odCl7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4geSh0KX0odCl8fGZ1bmN0aW9uKHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgU3ltYm9sJiZudWxsIT10W1N5bWJvbC5pdGVyYXRvcl18fG51bGwhPXRbIkBAaXRlcmF0b3IiXSlyZXR1cm4gQXJyYXkuZnJvbSh0KX0odCl8fGZ1bmN0aW9uKHQsZSl7aWYoIXQpcmV0dXJuO2lmKCJzdHJpbmciPT10eXBlb2YgdClyZXR1cm4geSh0LGUpO3ZhciByPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KS5zbGljZSg4LC0xKTsiT2JqZWN0Ij09PXImJnQuY29uc3RydWN0b3ImJihyPXQuY29uc3RydWN0b3IubmFtZSk7aWYoIk1hcCI9PT1yfHwiU2V0Ij09PXIpcmV0dXJuIEFycmF5LmZyb20odCk7aWYoIkFyZ3VtZW50cyI9PT1yfHwvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChyKSlyZXR1cm4geSh0LGUpfSh0KXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiB5KHQsZSl7KG51bGw9PWV8fGU+dC5sZW5ndGgpJiYoZT10Lmxlbmd0aCk7Zm9yKHZhciByPTAsbj1uZXcgQXJyYXkoZSk7cjxlO3IrKyluW3JdPXRbcl07cmV0dXJuIG59ZnVuY3Rpb24gZyh0KXt2YXIgZT1mdW5jdGlvbih0LGUpe2lmKCJvYmplY3QiIT10eXBlb2YgdHx8bnVsbD09PXQpcmV0dXJuIHQ7dmFyIHI9dFtTeW1ib2wudG9QcmltaXRpdmVdO2lmKHZvaWQgMCE9PXIpe3ZhciBuPXIuY2FsbCh0LGV8fCJkZWZhdWx0Iik7aWYoIm9iamVjdCIhPXR5cGVvZiBuKXJldHVybiBuO3Rocm93IG5ldyBUeXBlRXJyb3IoIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuIil9cmV0dXJuKCJzdHJpbmciPT09ZT9TdHJpbmc6TnVtYmVyKSh0KX0odCwic3RyaW5nIik7cmV0dXJuInN5bWJvbCI9PXR5cGVvZiBlP2U6U3RyaW5nKGUpfXZhciBtPSJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsVGhpcz9nbG9iYWxUaGlzOiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmP3NlbGY6e30sYj1mdW5jdGlvbih0KXt0cnl7cmV0dXJuISF0KCl9Y2F0Y2goZSl7cmV0dXJuITB9fSx3PXt9LnRvU3RyaW5nLGs9ZnVuY3Rpb24odCl7cmV0dXJuIHcuY2FsbCh0KS5zbGljZSg4LC0xKX0seD1rLFM9IiIuc3BsaXQsQT1iKChmdW5jdGlvbigpe3JldHVybiFPYmplY3QoInoiKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKX0pKT9mdW5jdGlvbih0KXtyZXR1cm4iU3RyaW5nIj09eCh0KT9TLmNhbGwodCwiIik6T2JqZWN0KHQpfTpPYmplY3QsXz1mdW5jdGlvbih0KXtpZihudWxsPT10KXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIit0KTtyZXR1cm4gdH0sVD1BLEU9XyxPPWZ1bmN0aW9uKHQpe3JldHVybiBUKEUodCkpfSxJPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lk1hdGg9PU1hdGgmJnR9LEM9SSgib2JqZWN0Ij09dHlwZW9mIGdsb2JhbFRoaXMmJmdsb2JhbFRoaXMpfHxJKCJvYmplY3QiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cpfHxJKCJvYmplY3QiPT10eXBlb2Ygc2VsZiYmc2VsZil8fEkoIm9iamVjdCI9PXR5cGVvZiBtJiZtKXx8ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30oKXx8RnVuY3Rpb24oInJldHVybiB0aGlzIikoKSxNPXtleHBvcnRzOnt9fSxSPSFiKChmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sMSx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSlbMV19KSksUD17fSxCPWZ1bmN0aW9uKHQpe3JldHVybiJvYmplY3QiPT10eXBlb2YgdD9udWxsIT09dDoiZnVuY3Rpb24iPT10eXBlb2YgdH0sVT1CLEQ9Qy5kb2N1bWVudCxqPVUoRCkmJlUoRC5jcmVhdGVFbGVtZW50KSx6PWZ1bmN0aW9uKHQpe3JldHVybiBqP0QuY3JlYXRlRWxlbWVudCh0KTp7fX0sTD16LEY9IVImJiFiKChmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoTCgiZGl2IiksImEiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSkpLFY9QixOPWZ1bmN0aW9uKHQpe2lmKCFWKHQpKXRocm93IFR5cGVFcnJvcihTdHJpbmcodCkrIiBpcyBub3QgYW4gb2JqZWN0Iik7cmV0dXJuIHR9LEg9QixLPWZ1bmN0aW9uKHQsZSl7aWYoIUgodCkpcmV0dXJuIHQ7dmFyIHIsbjtpZihlJiYiZnVuY3Rpb24iPT10eXBlb2Yocj10LnRvU3RyaW5nKSYmIUgobj1yLmNhbGwodCkpKXJldHVybiBuO2lmKCJmdW5jdGlvbiI9PXR5cGVvZihyPXQudmFsdWVPZikmJiFIKG49ci5jYWxsKHQpKSlyZXR1cm4gbjtpZighZSYmImZ1bmN0aW9uIj09dHlwZW9mKHI9dC50b1N0cmluZykmJiFIKG49ci5jYWxsKHQpKSlyZXR1cm4gbjt0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpfSxZPVIsJD1GLFc9TixHPUsscT1PYmplY3QuZGVmaW5lUHJvcGVydHk7UC5mPVk/cTpmdW5jdGlvbih0LGUscil7aWYoVyh0KSxlPUcoZSwhMCksVyhyKSwkKXRyeXtyZXR1cm4gcSh0LGUscil9Y2F0Y2gobil7fWlmKCJnZXQiaW4gcnx8InNldCJpbiByKXRocm93IFR5cGVFcnJvcigiQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQiKTtyZXR1cm4idmFsdWUiaW4gciYmKHRbZV09ci52YWx1ZSksdH07dmFyIFg9ZnVuY3Rpb24odCxlKXtyZXR1cm57ZW51bWVyYWJsZTohKDEmdCksY29uZmlndXJhYmxlOiEoMiZ0KSx3cml0YWJsZTohKDQmdCksdmFsdWU6ZX19LFE9UCxKPVgsWj1SP2Z1bmN0aW9uKHQsZSxyKXtyZXR1cm4gUS5mKHQsZSxKKDEscikpfTpmdW5jdGlvbih0LGUscil7cmV0dXJuIHRbZV09cix0fSx0dD1DLGV0PVoscnQ9ZnVuY3Rpb24odCxlKXt0cnl7ZXQodHQsdCxlKX1jYXRjaChyKXt0dFt0XT1lfXJldHVybiBlfSxudD1ydCxpdD0iX19jb3JlLWpzX3NoYXJlZF9fIixhdD1DW2l0XXx8bnQoaXQse30pLG90PWF0OyhNLmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gb3RbdF18fChvdFt0XT12b2lkIDAhPT1lP2U6e30pfSkoInZlcnNpb25zIixbXSkucHVzaCh7dmVyc2lvbjoiMy4xMi4xIixtb2RlOiJnbG9iYWwiLGNvcHlyaWdodDoiwqkgMjAyMSBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KSJ9KTt2YXIgc3QsdXQsY3Q9XyxmdD1mdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0KGN0KHQpKX0sbHQ9ZnQsaHQ9e30uaGFzT3duUHJvcGVydHksZHQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gaHQuY2FsbChsdCh0KSxlKX0scHQ9MCx2dD1NYXRoLnJhbmRvbSgpLHl0PWZ1bmN0aW9uKHQpe3JldHVybiJTeW1ib2woIitTdHJpbmcodm9pZCAwPT09dD8iIjp0KSsiKV8iKygrK3B0K3Z0KS50b1N0cmluZygzNil9LGd0PUMsbXQ9Z3QsYnQ9Qyx3dD1mdW5jdGlvbih0KXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90OnZvaWQgMH0sa3Q9ZnVuY3Rpb24odCxlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwyP3d0KG10W3RdKXx8d3QoYnRbdF0pOm10W3RdJiZtdFt0XVtlXXx8YnRbdF0mJmJ0W3RdW2VdfSx4dD1rdCgibmF2aWdhdG9yIiwidXNlckFnZW50Iil8fCIiLFN0PXh0LEF0PUMucHJvY2VzcyxfdD1BdCYmQXQudmVyc2lvbnMsVHQ9X3QmJl90LnY4O1R0P3V0PShzdD1UdC5zcGxpdCgiLiIpKVswXTw0PzE6c3RbMF0rc3RbMV06U3QmJighKHN0PVN0Lm1hdGNoKC9FZGdlXC8oXGQrKS8pKXx8c3RbMV0+PTc0KSYmKHN0PVN0Lm1hdGNoKC9DaHJvbWVcLyhcZCspLykpJiYodXQ9c3RbMV0pO3ZhciBFdCxPdD11dCYmK3V0LEl0PU90LEN0PWIsTXQ9ISFPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzJiYhQ3QoKGZ1bmN0aW9uKCl7cmV0dXJuIVN0cmluZyhTeW1ib2woKSl8fCFTeW1ib2wuc2hhbSYmSXQmJkl0PDQxfSkpLFJ0PU10JiYhU3ltYm9sLnNoYW0mJiJzeW1ib2wiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yLFB0PUMsQnQ9TS5leHBvcnRzLFV0PWR0LER0PXl0LGp0PU10LHp0PVJ0LEx0PUJ0KCJ3a3MiKSxGdD1QdC5TeW1ib2wsVnQ9enQ/RnQ6RnQmJkZ0LndpdGhvdXRTZXR0ZXJ8fER0LE50PWZ1bmN0aW9uKHQpe3JldHVybiBVdChMdCx0KSYmKGp0fHwic3RyaW5nIj09dHlwZW9mIEx0W3RdKXx8KGp0JiZVdChGdCx0KT9MdFt0XT1GdFt0XTpMdFt0XT1WdCgiU3ltYm9sLiIrdCkpLEx0W3RdfSxIdD1NYXRoLmNlaWwsS3Q9TWF0aC5mbG9vcixZdD1mdW5jdGlvbih0KXtyZXR1cm4gaXNOYU4odD0rdCk/MDoodD4wP0t0Okh0KSh0KX0sJHQ9WXQsV3Q9TWF0aC5taW4sR3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHQ+MD9XdCgkdCh0KSw5MDA3MTk5MjU0NzQwOTkxKTowfSxxdD1ZdCxYdD1NYXRoLm1heCxRdD1NYXRoLm1pbixKdD1mdW5jdGlvbih0LGUpe3ZhciByPXF0KHQpO3JldHVybiByPDA/WHQocitlLDApOlF0KHIsZSl9LFp0PU8sdGU9R3QsZWU9SnQscmU9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscixuKXt2YXIgaSxhPVp0KGUpLG89dGUoYS5sZW5ndGgpLHM9ZWUobixvKTtpZih0JiZyIT1yKXtmb3IoO28+czspaWYoKGk9YVtzKytdKSE9aSlyZXR1cm4hMH1lbHNlIGZvcig7bz5zO3MrKylpZigodHx8cyBpbiBhKSYmYVtzXT09PXIpcmV0dXJuIHR8fHN8fDA7cmV0dXJuIXQmJi0xfX0sbmU9e2luY2x1ZGVzOnJlKCEwKSxpbmRleE9mOnJlKCExKX0saWU9e30sYWU9ZHQsb2U9TyxzZT1uZS5pbmRleE9mLHVlPWllLGNlPWZ1bmN0aW9uKHQsZSl7dmFyIHIsbj1vZSh0KSxpPTAsYT1bXTtmb3IociBpbiBuKSFhZSh1ZSxyKSYmYWUobixyKSYmYS5wdXNoKHIpO2Zvcig7ZS5sZW5ndGg+aTspYWUobixyPWVbaSsrXSkmJih+c2UoYSxyKXx8YS5wdXNoKHIpKTtyZXR1cm4gYX0sZmU9WyJjb25zdHJ1Y3RvciIsImhhc093blByb3BlcnR5IiwiaXNQcm90b3R5cGVPZiIsInByb3BlcnR5SXNFbnVtZXJhYmxlIiwidG9Mb2NhbGVTdHJpbmciLCJ0b1N0cmluZyIsInZhbHVlT2YiXSxsZT1jZSxoZT1mZSxkZT1PYmplY3Qua2V5c3x8ZnVuY3Rpb24odCl7cmV0dXJuIGxlKHQsaGUpfSxwZT1QLHZlPU4seWU9ZGUsZ2U9Uj9PYmplY3QuZGVmaW5lUHJvcGVydGllczpmdW5jdGlvbih0LGUpe3ZlKHQpO2Zvcih2YXIgcixuPXllKGUpLGk9bi5sZW5ndGgsYT0wO2k+YTspcGUuZih0LHI9blthKytdLGVbcl0pO3JldHVybiB0fSxtZT1rdCgiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiKSxiZT1NLmV4cG9ydHMsd2U9eXQsa2U9YmUoImtleXMiKSx4ZT1mdW5jdGlvbih0KXtyZXR1cm4ga2VbdF18fChrZVt0XT13ZSh0KSl9LFNlPU4sQWU9Z2UsX2U9ZmUsVGU9aWUsRWU9bWUsT2U9eixJZT14ZSgiSUVfUFJPVE8iKSxDZT1mdW5jdGlvbigpe30sTWU9ZnVuY3Rpb24odCl7cmV0dXJuIjxzY3JpcHQ+Iit0KyI8LyIrInNjcmlwdD4ifSxSZT1mdW5jdGlvbigpe3RyeXtFdD1kb2N1bWVudC5kb21haW4mJm5ldyBBY3RpdmVYT2JqZWN0KCJodG1sZmlsZSIpfWNhdGNoKG4pe312YXIgdCxlO1JlPUV0P2Z1bmN0aW9uKHQpe3Qud3JpdGUoTWUoIiIpKSx0LmNsb3NlKCk7dmFyIGU9dC5wYXJlbnRXaW5kb3cuT2JqZWN0O3JldHVybiB0PW51bGwsZX0oRXQpOigoZT1PZSgiaWZyYW1lIikpLnN0eWxlLmRpc3BsYXk9Im5vbmUiLEVlLmFwcGVuZENoaWxkKGUpLGUuc3JjPVN0cmluZygiamF2YXNjcmlwdDoiKSwodD1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpLm9wZW4oKSx0LndyaXRlKE1lKCJkb2N1bWVudC5GPU9iamVjdCIpKSx0LmNsb3NlKCksdC5GKTtmb3IodmFyIHI9X2UubGVuZ3RoO3ItLTspZGVsZXRlIFJlLnByb3RvdHlwZVtfZVtyXV07cmV0dXJuIFJlKCl9O1RlW0llXT0hMDt2YXIgUGU9T2JqZWN0LmNyZWF0ZXx8ZnVuY3Rpb24odCxlKXt2YXIgcjtyZXR1cm4gbnVsbCE9PXQ/KENlLnByb3RvdHlwZT1TZSh0KSxyPW5ldyBDZSxDZS5wcm90b3R5cGU9bnVsbCxyW0llXT10KTpyPVJlKCksdm9pZCAwPT09ZT9yOkFlKHIsZSl9LEJlPVBlLFVlPVAsRGU9TnQoInVuc2NvcGFibGVzIiksamU9QXJyYXkucHJvdG90eXBlO251bGw9PWplW0RlXSYmVWUuZihqZSxEZSx7Y29uZmlndXJhYmxlOiEwLHZhbHVlOkJlKG51bGwpfSk7dmFyIHplPWZ1bmN0aW9uKHQpe2plW0RlXVt0XT0hMH0sTGU9e30sRmU9YXQsVmU9RnVuY3Rpb24udG9TdHJpbmc7ImZ1bmN0aW9uIiE9dHlwZW9mIEZlLmluc3BlY3RTb3VyY2UmJihGZS5pbnNwZWN0U291cmNlPWZ1bmN0aW9uKHQpe3JldHVybiBWZS5jYWxsKHQpfSk7dmFyIE5lLEhlLEtlLFllPUZlLmluc3BlY3RTb3VyY2UsJGU9WWUsV2U9Qy5XZWFrTWFwLEdlPSJmdW5jdGlvbiI9PXR5cGVvZiBXZSYmL25hdGl2ZSBjb2RlLy50ZXN0KCRlKFdlKSkscWU9QixYZT1aLFFlPWR0LEplPWF0LFplPXhlLHRyPWllLGVyPSJPYmplY3QgYWxyZWFkeSBpbml0aWFsaXplZCIscnI9Qy5XZWFrTWFwO2lmKEdlfHxKZS5zdGF0ZSl7dmFyIG5yPUplLnN0YXRlfHwoSmUuc3RhdGU9bmV3IHJyKSxpcj1uci5nZXQsYXI9bnIuaGFzLG9yPW5yLnNldDtOZT1mdW5jdGlvbih0LGUpe2lmKGFyLmNhbGwobnIsdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihlcik7cmV0dXJuIGUuZmFjYWRlPXQsb3IuY2FsbChucix0LGUpLGV9LEhlPWZ1bmN0aW9uKHQpe3JldHVybiBpci5jYWxsKG5yLHQpfHx7fX0sS2U9ZnVuY3Rpb24odCl7cmV0dXJuIGFyLmNhbGwobnIsdCl9fWVsc2V7dmFyIHNyPVplKCJzdGF0ZSIpO3RyW3NyXT0hMCxOZT1mdW5jdGlvbih0LGUpe2lmKFFlKHQsc3IpKXRocm93IG5ldyBUeXBlRXJyb3IoZXIpO3JldHVybiBlLmZhY2FkZT10LFhlKHQsc3IsZSksZX0sSGU9ZnVuY3Rpb24odCl7cmV0dXJuIFFlKHQsc3IpP3Rbc3JdOnt9fSxLZT1mdW5jdGlvbih0KXtyZXR1cm4gUWUodCxzcil9fXZhciB1cj17c2V0Ok5lLGdldDpIZSxoYXM6S2UsZW5mb3JjZTpmdW5jdGlvbih0KXtyZXR1cm4gS2UodCk/SGUodCk6TmUodCx7fSl9LGdldHRlckZvcjpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHI7aWYoIXFlKGUpfHwocj1IZShlKSkudHlwZSE9PXQpdGhyb3cgVHlwZUVycm9yKCJJbmNvbXBhdGlibGUgcmVjZWl2ZXIsICIrdCsiIHJlcXVpcmVkIik7cmV0dXJuIHJ9fX0sY3I9e30sZnI9e30sbHI9e30ucHJvcGVydHlJc0VudW1lcmFibGUsaHI9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcixkcj1ociYmIWxyLmNhbGwoezE6Mn0sMSk7ZnIuZj1kcj9mdW5jdGlvbih0KXt2YXIgZT1ocih0aGlzLHQpO3JldHVybiEhZSYmZS5lbnVtZXJhYmxlfTpscjt2YXIgcHI9Uix2cj1mcix5cj1YLGdyPU8sbXI9Syxicj1kdCx3cj1GLGtyPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7Y3IuZj1wcj9rcjpmdW5jdGlvbih0LGUpe2lmKHQ9Z3IodCksZT1tcihlLCEwKSx3cil0cnl7cmV0dXJuIGtyKHQsZSl9Y2F0Y2gocil7fWlmKGJyKHQsZSkpcmV0dXJuIHlyKCF2ci5mLmNhbGwodCxlKSx0W2VdKX07dmFyIHhyPXtleHBvcnRzOnt9fSxTcj1DLEFyPVosX3I9ZHQsVHI9cnQsRXI9WWUsT3I9dXIuZ2V0LElyPXVyLmVuZm9yY2UsQ3I9U3RyaW5nKFN0cmluZykuc3BsaXQoIlN0cmluZyIpOyh4ci5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBpLGE9ISFuJiYhIW4udW5zYWZlLG89ISFuJiYhIW4uZW51bWVyYWJsZSxzPSEhbiYmISFuLm5vVGFyZ2V0R2V0OyJmdW5jdGlvbiI9PXR5cGVvZiByJiYoInN0cmluZyIhPXR5cGVvZiBlfHxfcihyLCJuYW1lIil8fEFyKHIsIm5hbWUiLGUpLChpPUlyKHIpKS5zb3VyY2V8fChpLnNvdXJjZT1Dci5qb2luKCJzdHJpbmciPT10eXBlb2YgZT9lOiIiKSkpLHQhPT1Tcj8oYT8hcyYmdFtlXSYmKG89ITApOmRlbGV0ZSB0W2VdLG8/dFtlXT1yOkFyKHQsZSxyKSk6bz90W2VdPXI6VHIoZSxyKX0pKEZ1bmN0aW9uLnByb3RvdHlwZSwidG9TdHJpbmciLChmdW5jdGlvbigpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzJiZPcih0aGlzKS5zb3VyY2V8fEVyKHRoaXMpfSkpO3ZhciBNcj17fSxScj1jZSxQcj1mZS5jb25jYXQoImxlbmd0aCIsInByb3RvdHlwZSIpO01yLmY9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXN8fGZ1bmN0aW9uKHQpe3JldHVybiBScih0LFByKX07dmFyIEJyPXt9O0JyLmY9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgVXIsRHIsanIsenI9TXIsTHI9QnIsRnI9TixWcj1rdCgiUmVmbGVjdCIsIm93bktleXMiKXx8ZnVuY3Rpb24odCl7dmFyIGU9enIuZihGcih0KSkscj1Mci5mO3JldHVybiByP2UuY29uY2F0KHIodCkpOmV9LE5yPWR0LEhyPVZyLEtyPWNyLFlyPVAsJHI9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9SHIoZSksbj1Zci5mLGk9S3IuZixhPTA7YTxyLmxlbmd0aDthKyspe3ZhciBvPXJbYV07TnIodCxvKXx8bih0LG8saShlLG8pKX19LFdyPWIsR3I9LyN8XC5wcm90b3R5cGVcLi8scXI9ZnVuY3Rpb24odCxlKXt2YXIgcj1RcltYcih0KV07cmV0dXJuIHI9PVpyfHxyIT1KciYmKCJmdW5jdGlvbiI9PXR5cGVvZiBlP1dyKGUpOiEhZSl9LFhyPXFyLm5vcm1hbGl6ZT1mdW5jdGlvbih0KXtyZXR1cm4gU3RyaW5nKHQpLnJlcGxhY2UoR3IsIi4iKS50b0xvd2VyQ2FzZSgpfSxRcj1xci5kYXRhPXt9LEpyPXFyLk5BVElWRT0iTiIsWnI9cXIuUE9MWUZJTEw9IlAiLHRuPXFyLGVuPUMscm49Y3IuZixubj1aLGFuPXhyLmV4cG9ydHMsb249cnQsc249JHIsdW49dG4sY249ZnVuY3Rpb24odCxlKXt2YXIgcixuLGksYSxvLHM9dC50YXJnZXQsdT10Lmdsb2JhbCxjPXQuc3RhdDtpZihyPXU/ZW46Yz9lbltzXXx8b24ocyx7fSk6KGVuW3NdfHx7fSkucHJvdG90eXBlKWZvcihuIGluIGUpe2lmKGE9ZVtuXSxpPXQubm9UYXJnZXRHZXQ/KG89cm4ocixuKSkmJm8udmFsdWU6cltuXSwhdW4odT9uOnMrKGM/Ii4iOiIjIikrbix0LmZvcmNlZCkmJnZvaWQgMCE9PWkpe2lmKHR5cGVvZiBhPT10eXBlb2YgaSljb250aW51ZTtzbihhLGkpfSh0LnNoYW18fGkmJmkuc2hhbSkmJm5uKGEsInNoYW0iLCEwKSxhbihyLG4sYSx0KX19LGZuPSFiKChmdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPW51bGwsT2JqZWN0LmdldFByb3RvdHlwZU9mKG5ldyB0KSE9PXQucHJvdG90eXBlfSkpLGxuPWR0LGhuPWZ0LGRuPWZuLHBuPXhlKCJJRV9QUk9UTyIpLHZuPU9iamVjdC5wcm90b3R5cGUseW49ZG4/T2JqZWN0LmdldFByb3RvdHlwZU9mOmZ1bmN0aW9uKHQpe3JldHVybiB0PWhuKHQpLGxuKHQscG4pP3RbcG5dOiJmdW5jdGlvbiI9PXR5cGVvZiB0LmNvbnN0cnVjdG9yJiZ0IGluc3RhbmNlb2YgdC5jb25zdHJ1Y3Rvcj90LmNvbnN0cnVjdG9yLnByb3RvdHlwZTp0IGluc3RhbmNlb2YgT2JqZWN0P3ZuOm51bGx9LGduPWIsbW49eW4sYm49Wix3bj1kdCxrbj1OdCgiaXRlcmF0b3IiKSx4bj0hMTtbXS5rZXlzJiYoIm5leHQiaW4oanI9W10ua2V5cygpKT8oRHI9bW4obW4oanIpKSkhPT1PYmplY3QucHJvdG90eXBlJiYoVXI9RHIpOnhuPSEwKSwobnVsbD09VXJ8fGduKChmdW5jdGlvbigpe3ZhciB0PXt9O3JldHVybiBVcltrbl0uY2FsbCh0KSE9PXR9KSkpJiYoVXI9e30pLHduKFVyLGtuKXx8Ym4oVXIsa24sKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSk7dmFyIFNuPXtJdGVyYXRvclByb3RvdHlwZTpVcixCVUdHWV9TQUZBUklfSVRFUkFUT1JTOnhufSxBbj1QLmYsX249ZHQsVG49TnQoInRvU3RyaW5nVGFnIiksRW49ZnVuY3Rpb24odCxlLHIpe3QmJiFfbih0PXI/dDp0LnByb3RvdHlwZSxUbikmJkFuKHQsVG4se2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTplfSl9LE9uPVNuLkl0ZXJhdG9yUHJvdG90eXBlLEluPVBlLENuPVgsTW49RW4sUm49TGUsUG49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sQm49QixVbj1OLERuPWZ1bmN0aW9uKHQpe2lmKCFCbih0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBzZXQgIitTdHJpbmcodCkrIiBhcyBhIHByb3RvdHlwZSIpO3JldHVybiB0fSxqbj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fCgiX19wcm90b19fImlue30/ZnVuY3Rpb24oKXt2YXIgdCxlPSExLHI9e307dHJ5eyh0PU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoT2JqZWN0LnByb3RvdHlwZSwiX19wcm90b19fIikuc2V0KS5jYWxsKHIsW10pLGU9ciBpbnN0YW5jZW9mIEFycmF5fWNhdGNoKG4pe31yZXR1cm4gZnVuY3Rpb24ocixuKXtyZXR1cm4gVW4ociksRG4obiksZT90LmNhbGwocixuKTpyLl9fcHJvdG9fXz1uLHJ9fSgpOnZvaWQgMCksem49Y24sTG49ZnVuY3Rpb24odCxlLHIpe3ZhciBuPWUrIiBJdGVyYXRvciI7cmV0dXJuIHQucHJvdG90eXBlPUluKE9uLHtuZXh0OkNuKDEscil9KSxNbih0LG4sITEpLFJuW25dPVBuLHR9LEZuPXluLFZuPWpuLE5uPUVuLEhuPVosS249eHIuZXhwb3J0cyxZbj1MZSwkbj1Tbi5JdGVyYXRvclByb3RvdHlwZSxXbj1Tbi5CVUdHWV9TQUZBUklfSVRFUkFUT1JTLEduPU50KCJpdGVyYXRvciIpLHFuPSJrZXlzIixYbj0idmFsdWVzIixRbj0iZW50cmllcyIsSm49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sWm49ZnVuY3Rpb24odCxlLHIsbixpLGEsbyl7TG4ocixlLG4pO3ZhciBzLHUsYyxmPWZ1bmN0aW9uKHQpe2lmKHQ9PT1pJiZ2KXJldHVybiB2O2lmKCFXbiYmdCBpbiBkKXJldHVybiBkW3RdO3N3aXRjaCh0KXtjYXNlIHFuOmNhc2UgWG46Y2FzZSBRbjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyx0KX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyByKHRoaXMpfX0sbD1lKyIgSXRlcmF0b3IiLGg9ITEsZD10LnByb3RvdHlwZSxwPWRbR25dfHxkWyJAQGl0ZXJhdG9yIl18fGkmJmRbaV0sdj0hV24mJnB8fGYoaSkseT0iQXJyYXkiPT1lJiZkLmVudHJpZXN8fHA7aWYoeSYmKHM9Rm4oeS5jYWxsKG5ldyB0KSksJG4hPT1PYmplY3QucHJvdG90eXBlJiZzLm5leHQmJihGbihzKSE9PSRuJiYoVm4/Vm4ocywkbik6ImZ1bmN0aW9uIiE9dHlwZW9mIHNbR25dJiZIbihzLEduLEpuKSksTm4ocyxsLCEwKSkpLGk9PVhuJiZwJiZwLm5hbWUhPT1YbiYmKGg9ITAsdj1mdW5jdGlvbigpe3JldHVybiBwLmNhbGwodGhpcyl9KSxkW0duXSE9PXYmJkhuKGQsR24sdiksWW5bZV09dixpKWlmKHU9e3ZhbHVlczpmKFhuKSxrZXlzOmE/djpmKHFuKSxlbnRyaWVzOmYoUW4pfSxvKWZvcihjIGluIHUpKFdufHxofHwhKGMgaW4gZCkpJiZLbihkLGMsdVtjXSk7ZWxzZSB6bih7dGFyZ2V0OmUscHJvdG86ITAsZm9yY2VkOldufHxofSx1KTtyZXR1cm4gdX0sdGk9TyxlaT16ZSxyaT1MZSxuaT11cixpaT1abixhaT0iQXJyYXkgSXRlcmF0b3IiLG9pPW5pLnNldCxzaT1uaS5nZXR0ZXJGb3IoYWkpLHVpPWlpKEFycmF5LCJBcnJheSIsKGZ1bmN0aW9uKHQsZSl7b2kodGhpcyx7dHlwZTphaSx0YXJnZXQ6dGkodCksaW5kZXg6MCxraW5kOmV9KX0pLChmdW5jdGlvbigpe3ZhciB0PXNpKHRoaXMpLGU9dC50YXJnZXQscj10LmtpbmQsbj10LmluZGV4Kys7cmV0dXJuIWV8fG4+PWUubGVuZ3RoPyh0LnRhcmdldD12b2lkIDAse3ZhbHVlOnZvaWQgMCxkb25lOiEwfSk6ImtleXMiPT1yP3t2YWx1ZTpuLGRvbmU6ITF9OiJ2YWx1ZXMiPT1yP3t2YWx1ZTplW25dLGRvbmU6ITF9Ont2YWx1ZTpbbixlW25dXSxkb25lOiExfX0pLCJ2YWx1ZXMiKTtyaS5Bcmd1bWVudHM9cmkuQXJyYXksZWkoImtleXMiKSxlaSgidmFsdWVzIiksZWkoImVudHJpZXMiKTt2YXIgY2k9e307Y2lbTnQoInRvU3RyaW5nVGFnIildPSJ6Ijt2YXIgZmk9IltvYmplY3Qgel0iPT09U3RyaW5nKGNpKSxsaT1maSxoaT1rLGRpPU50KCJ0b1N0cmluZ1RhZyIpLHBpPSJBcmd1bWVudHMiPT1oaShmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLHZpPWxpP2hpOmZ1bmN0aW9uKHQpe3ZhciBlLHIsbjtyZXR1cm4gdm9pZCAwPT09dD8iVW5kZWZpbmVkIjpudWxsPT09dD8iTnVsbCI6InN0cmluZyI9PXR5cGVvZihyPWZ1bmN0aW9uKHQsZSl7dHJ5e3JldHVybiB0W2VdfWNhdGNoKHIpe319KGU9T2JqZWN0KHQpLGRpKSk/cjpwaT9oaShlKToiT2JqZWN0Ij09KG49aGkoZSkpJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5jYWxsZWU/IkFyZ3VtZW50cyI6bn0seWk9dmksZ2k9Zmk/e30udG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4iW29iamVjdCAiK3lpKHRoaXMpKyJdIn0sbWk9ZmksYmk9eHIuZXhwb3J0cyx3aT1naTttaXx8YmkoT2JqZWN0LnByb3RvdHlwZSwidG9TdHJpbmciLHdpLHt1bnNhZmU6ITB9KTt2YXIga2k9e2V4cG9ydHM6e319LHhpPU50KCJpdGVyYXRvciIpLFNpPSExO3RyeXt2YXIgQWk9MCxfaT17bmV4dDpmdW5jdGlvbigpe3JldHVybntkb25lOiEhQWkrK319LHJldHVybjpmdW5jdGlvbigpe1NpPSEwfX07X2lbeGldPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LEFycmF5LmZyb20oX2ksKGZ1bmN0aW9uKCl7dGhyb3cgMn0pKX1jYXRjaChqbSl7fXZhciBUaSxFaT1mdW5jdGlvbih0LGUpe2lmKCFlJiYhU2kpcmV0dXJuITE7dmFyIHI9ITE7dHJ5e3ZhciBuPXt9O25beGldPWZ1bmN0aW9uKCl7cmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm57ZG9uZTpyPSEwfX19fSx0KG4pfWNhdGNoKGptKXt9cmV0dXJuIHJ9LE9pPSJ1bmRlZmluZWQiIT10eXBlb2YgQXJyYXlCdWZmZXImJiJ1bmRlZmluZWQiIT10eXBlb2YgRGF0YVZpZXcsSWk9T2ksQ2k9UixNaT1DLFJpPUIsUGk9ZHQsQmk9dmksVWk9WixEaT14ci5leHBvcnRzLGppPVAuZix6aT15bixMaT1qbixGaT1OdCxWaT15dCxOaT1NaS5JbnQ4QXJyYXksSGk9TmkmJk5pLnByb3RvdHlwZSxLaT1NaS5VaW50OENsYW1wZWRBcnJheSxZaT1LaSYmS2kucHJvdG90eXBlLCRpPU5pJiZ6aShOaSksV2k9SGkmJnppKEhpKSxHaT1PYmplY3QucHJvdG90eXBlLHFpPUdpLmlzUHJvdG90eXBlT2YsWGk9RmkoInRvU3RyaW5nVGFnIiksUWk9VmkoIlRZUEVEX0FSUkFZX1RBRyIpLEppPUlpJiYhIUxpJiYiT3BlcmEiIT09QmkoTWkub3BlcmEpLFppPSExLHRhPXtJbnQ4QXJyYXk6MSxVaW50OEFycmF5OjEsVWludDhDbGFtcGVkQXJyYXk6MSxJbnQxNkFycmF5OjIsVWludDE2QXJyYXk6MixJbnQzMkFycmF5OjQsVWludDMyQXJyYXk6NCxGbG9hdDMyQXJyYXk6NCxGbG9hdDY0QXJyYXk6OH0sZWE9e0JpZ0ludDY0QXJyYXk6OCxCaWdVaW50NjRBcnJheTo4fSxyYT1mdW5jdGlvbih0KXtpZighUmkodCkpcmV0dXJuITE7dmFyIGU9QmkodCk7cmV0dXJuIFBpKHRhLGUpfHxQaShlYSxlKX07Zm9yKFRpIGluIHRhKU1pW1RpXXx8KEppPSExKTtpZigoIUppfHwiZnVuY3Rpb24iIT10eXBlb2YgJGl8fCRpPT09RnVuY3Rpb24ucHJvdG90eXBlKSYmKCRpPWZ1bmN0aW9uKCl7dGhyb3cgVHlwZUVycm9yKCJJbmNvcnJlY3QgaW52b2NhdGlvbiIpfSxKaSkpZm9yKFRpIGluIHRhKU1pW1RpXSYmTGkoTWlbVGldLCRpKTtpZigoIUppfHwhV2l8fFdpPT09R2kpJiYoV2k9JGkucHJvdG90eXBlLEppKSlmb3IoVGkgaW4gdGEpTWlbVGldJiZMaShNaVtUaV0ucHJvdG90eXBlLFdpKTtpZihKaSYmemkoWWkpIT09V2kmJkxpKFlpLFdpKSxDaSYmIVBpKFdpLFhpKSlmb3IoVGkgaW4gWmk9ITAsamkoV2ksWGkse2dldDpmdW5jdGlvbigpe3JldHVybiBSaSh0aGlzKT90aGlzW1FpXTp2b2lkIDB9fSksdGEpTWlbVGldJiZVaShNaVtUaV0sUWksVGkpO3ZhciBuYT17TkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUzpKaSxUWVBFRF9BUlJBWV9UQUc6WmkmJlFpLGFUeXBlZEFycmF5OmZ1bmN0aW9uKHQpe2lmKHJhKHQpKXJldHVybiB0O3Rocm93IFR5cGVFcnJvcigiVGFyZ2V0IGlzIG5vdCBhIHR5cGVkIGFycmF5Iil9LGFUeXBlZEFycmF5Q29uc3RydWN0b3I6ZnVuY3Rpb24odCl7aWYoTGkpe2lmKHFpLmNhbGwoJGksdCkpcmV0dXJuIHR9ZWxzZSBmb3IodmFyIGUgaW4gdGEpaWYoUGkodGEsVGkpKXt2YXIgcj1NaVtlXTtpZihyJiYodD09PXJ8fHFpLmNhbGwocix0KSkpcmV0dXJuIHR9dGhyb3cgVHlwZUVycm9yKCJUYXJnZXQgaXMgbm90IGEgdHlwZWQgYXJyYXkgY29uc3RydWN0b3IiKX0sZXhwb3J0VHlwZWRBcnJheU1ldGhvZDpmdW5jdGlvbih0LGUscil7aWYoQ2kpe2lmKHIpZm9yKHZhciBuIGluIHRhKXt2YXIgaT1NaVtuXTtpZihpJiZQaShpLnByb3RvdHlwZSx0KSl0cnl7ZGVsZXRlIGkucHJvdG90eXBlW3RdfWNhdGNoKGptKXt9fVdpW3RdJiYhcnx8RGkoV2ksdCxyP2U6SmkmJkhpW3RdfHxlKX19LGV4cG9ydFR5cGVkQXJyYXlTdGF0aWNNZXRob2Q6ZnVuY3Rpb24odCxlLHIpe3ZhciBuLGk7aWYoQ2kpe2lmKExpKXtpZihyKWZvcihuIGluIHRhKWlmKChpPU1pW25dKSYmUGkoaSx0KSl0cnl7ZGVsZXRlIGlbdF19Y2F0Y2goam0pe31pZigkaVt0XSYmIXIpcmV0dXJuO3RyeXtyZXR1cm4gRGkoJGksdCxyP2U6SmkmJiRpW3RdfHxlKX1jYXRjaChqbSl7fX1mb3IobiBpbiB0YSkhKGk9TWlbbl0pfHxpW3RdJiYhcnx8RGkoaSx0LGUpfX0saXNWaWV3OmZ1bmN0aW9uKHQpe2lmKCFSaSh0KSlyZXR1cm4hMTt2YXIgZT1CaSh0KTtyZXR1cm4iRGF0YVZpZXciPT09ZXx8UGkodGEsZSl8fFBpKGVhLGUpfSxpc1R5cGVkQXJyYXk6cmEsVHlwZWRBcnJheTokaSxUeXBlZEFycmF5UHJvdG90eXBlOldpfSxpYT1DLGFhPWIsb2E9RWksc2E9bmEuTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUyx1YT1pYS5BcnJheUJ1ZmZlcixjYT1pYS5JbnQ4QXJyYXksZmE9IXNhfHwhYWEoKGZ1bmN0aW9uKCl7Y2EoMSl9KSl8fCFhYSgoZnVuY3Rpb24oKXtuZXcgY2EoLTEpfSkpfHwhb2EoKGZ1bmN0aW9uKHQpe25ldyBjYSxuZXcgY2EobnVsbCksbmV3IGNhKDEuNSksbmV3IGNhKHQpfSksITApfHxhYSgoZnVuY3Rpb24oKXtyZXR1cm4gMSE9PW5ldyBjYShuZXcgdWEoMiksMSx2b2lkIDApLmxlbmd0aH0pKSxsYT14ci5leHBvcnRzLGhhPWZ1bmN0aW9uKHQsZSxyKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBUeXBlRXJyb3IoIkluY29ycmVjdCAiKyhyP3IrIiAiOiIiKSsiaW52b2NhdGlvbiIpO3JldHVybiB0fSxkYT1ZdCxwYT1HdCx2YT1mdW5jdGlvbih0KXtpZih2b2lkIDA9PT10KXJldHVybiAwO3ZhciBlPWRhKHQpLHI9cGEoZSk7aWYoZSE9PXIpdGhyb3cgUmFuZ2VFcnJvcigiV3JvbmcgbGVuZ3RoIG9yIGluZGV4Iik7cmV0dXJuIHJ9LHlhPU1hdGguYWJzLGdhPU1hdGgucG93LG1hPU1hdGguZmxvb3IsYmE9TWF0aC5sb2csd2E9TWF0aC5MTjIsa2E9ZnQseGE9SnQsU2E9R3QsQWE9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPWthKHRoaXMpLHI9U2EoZS5sZW5ndGgpLG49YXJndW1lbnRzLmxlbmd0aCxpPXhhKG4+MT9hcmd1bWVudHNbMV06dm9pZCAwLHIpLGE9bj4yP2FyZ3VtZW50c1syXTp2b2lkIDAsbz12b2lkIDA9PT1hP3I6eGEoYSxyKTtvPmk7KWVbaSsrXT10O3JldHVybiBlfSxfYT1DLFRhPVIsRWE9T2ksT2E9WixJYT1mdW5jdGlvbih0LGUscil7Zm9yKHZhciBuIGluIGUpbGEodCxuLGVbbl0scik7cmV0dXJuIHR9LENhPWIsTWE9aGEsUmE9WXQsUGE9R3QsQmE9dmEsVWE9e3BhY2s6ZnVuY3Rpb24odCxlLHIpe3ZhciBuLGksYSxvPW5ldyBBcnJheShyKSxzPTgqci1lLTEsdT0oMTw8cyktMSxjPXU+PjEsZj0yMz09PWU/Z2EoMiwtMjQpLWdhKDIsLTc3KTowLGw9dDwwfHwwPT09dCYmMS90PDA/MTowLGg9MDtmb3IoKHQ9eWEodCkpIT10fHx0PT09MS8wPyhpPXQhPXQ/MTowLG49dSk6KG49bWEoYmEodCkvd2EpLHQqKGE9Z2EoMiwtbikpPDEmJihuLS0sYSo9MiksKHQrPW4rYz49MT9mL2E6ZipnYSgyLDEtYykpKmE+PTImJihuKyssYS89MiksbitjPj11PyhpPTAsbj11KTpuK2M+PTE/KGk9KHQqYS0xKSpnYSgyLGUpLG4rPWMpOihpPXQqZ2EoMixjLTEpKmdhKDIsZSksbj0wKSk7ZT49ODtvW2grK109MjU1JmksaS89MjU2LGUtPTgpO2ZvcihuPW48PGV8aSxzKz1lO3M+MDtvW2grK109MjU1Jm4sbi89MjU2LHMtPTgpO3JldHVybiBvWy0taF18PTEyOCpsLG99LHVucGFjazpmdW5jdGlvbih0LGUpe3ZhciByLG49dC5sZW5ndGgsaT04Km4tZS0xLGE9KDE8PGkpLTEsbz1hPj4xLHM9aS03LHU9bi0xLGM9dFt1LS1dLGY9MTI3JmM7Zm9yKGM+Pj03O3M+MDtmPTI1NipmK3RbdV0sdS0tLHMtPTgpO2ZvcihyPWYmKDE8PC1zKS0xLGY+Pj0tcyxzKz1lO3M+MDtyPTI1NipyK3RbdV0sdS0tLHMtPTgpO2lmKDA9PT1mKWY9MS1vO2Vsc2V7aWYoZj09PWEpcmV0dXJuIHI/TmFOOmM/LTEvMDoxLzA7cis9Z2EoMixlKSxmLT1vfXJldHVybihjPy0xOjEpKnIqZ2EoMixmLWUpfX0sRGE9eW4samE9am4semE9TXIuZixMYT1QLmYsRmE9QWEsVmE9RW4sTmE9dXIuZ2V0LEhhPXVyLnNldCxLYT0iQXJyYXlCdWZmZXIiLFlhPSJEYXRhVmlldyIsJGE9Ildyb25nIGluZGV4IixXYT1fYS5BcnJheUJ1ZmZlcixHYT1XYSxxYT1fYS5EYXRhVmlldyxYYT1xYSYmcWEucHJvdG90eXBlLFFhPU9iamVjdC5wcm90b3R5cGUsSmE9X2EuUmFuZ2VFcnJvcixaYT1VYS5wYWNrLHRvPVVhLnVucGFjayxlbz1mdW5jdGlvbih0KXtyZXR1cm5bMjU1JnRdfSxybz1mdW5jdGlvbih0KXtyZXR1cm5bMjU1JnQsdD4+OCYyNTVdfSxubz1mdW5jdGlvbih0KXtyZXR1cm5bMjU1JnQsdD4+OCYyNTUsdD4+MTYmMjU1LHQ+PjI0JjI1NV19LGlvPWZ1bmN0aW9uKHQpe3JldHVybiB0WzNdPDwyNHx0WzJdPDwxNnx0WzFdPDw4fHRbMF19LGFvPWZ1bmN0aW9uKHQpe3JldHVybiBaYSh0LDIzLDQpfSxvbz1mdW5jdGlvbih0KXtyZXR1cm4gWmEodCw1Miw4KX0sc289ZnVuY3Rpb24odCxlKXtMYSh0LnByb3RvdHlwZSxlLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gTmEodGhpcylbZV19fSl9LHVvPWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBpPUJhKHIpLGE9TmEodCk7aWYoaStlPmEuYnl0ZUxlbmd0aCl0aHJvdyBKYSgkYSk7dmFyIG89TmEoYS5idWZmZXIpLmJ5dGVzLHM9aSthLmJ5dGVPZmZzZXQsdT1vLnNsaWNlKHMscytlKTtyZXR1cm4gbj91OnUucmV2ZXJzZSgpfSxjbz1mdW5jdGlvbih0LGUscixuLGksYSl7dmFyIG89QmEocikscz1OYSh0KTtpZihvK2U+cy5ieXRlTGVuZ3RoKXRocm93IEphKCRhKTtmb3IodmFyIHU9TmEocy5idWZmZXIpLmJ5dGVzLGM9bytzLmJ5dGVPZmZzZXQsZj1uKCtpKSxsPTA7bDxlO2wrKyl1W2MrbF09ZlthP2w6ZS1sLTFdfTtpZihFYSl7aWYoIUNhKChmdW5jdGlvbigpe1dhKDEpfSkpfHwhQ2EoKGZ1bmN0aW9uKCl7bmV3IFdhKC0xKX0pKXx8Q2EoKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBXYSxuZXcgV2EoMS41KSxuZXcgV2EoTmFOKSxXYS5uYW1lIT1LYX0pKSl7Zm9yKHZhciBmbyxsbz0oR2E9ZnVuY3Rpb24odCl7cmV0dXJuIE1hKHRoaXMsR2EpLG5ldyBXYShCYSh0KSl9KS5wcm90b3R5cGU9V2EucHJvdG90eXBlLGhvPXphKFdhKSxwbz0wO2hvLmxlbmd0aD5wbzspKGZvPWhvW3BvKytdKWluIEdhfHxPYShHYSxmbyxXYVtmb10pO2xvLmNvbnN0cnVjdG9yPUdhfWphJiZEYShYYSkhPT1RYSYmamEoWGEsUWEpO3ZhciB2bz1uZXcgcWEobmV3IEdhKDIpKSx5bz1YYS5zZXRJbnQ4O3ZvLnNldEludDgoMCwyMTQ3NDgzNjQ4KSx2by5zZXRJbnQ4KDEsMjE0NzQ4MzY0OSksIXZvLmdldEludDgoMCkmJnZvLmdldEludDgoMSl8fElhKFhhLHtzZXRJbnQ4OmZ1bmN0aW9uKHQsZSl7eW8uY2FsbCh0aGlzLHQsZTw8MjQ+PjI0KX0sc2V0VWludDg6ZnVuY3Rpb24odCxlKXt5by5jYWxsKHRoaXMsdCxlPDwyND4+MjQpfX0se3Vuc2FmZTohMH0pfWVsc2UgR2E9ZnVuY3Rpb24odCl7TWEodGhpcyxHYSxLYSk7dmFyIGU9QmEodCk7SGEodGhpcyx7Ynl0ZXM6RmEuY2FsbChuZXcgQXJyYXkoZSksMCksYnl0ZUxlbmd0aDplfSksVGF8fCh0aGlzLmJ5dGVMZW5ndGg9ZSl9LHFhPWZ1bmN0aW9uKHQsZSxyKXtNYSh0aGlzLHFhLFlhKSxNYSh0LEdhLFlhKTt2YXIgbj1OYSh0KS5ieXRlTGVuZ3RoLGk9UmEoZSk7aWYoaTwwfHxpPm4pdGhyb3cgSmEoIldyb25nIG9mZnNldCIpO2lmKGkrKHI9dm9pZCAwPT09cj9uLWk6UGEocikpPm4pdGhyb3cgSmEoIldyb25nIGxlbmd0aCIpO0hhKHRoaXMse2J1ZmZlcjp0LGJ5dGVMZW5ndGg6cixieXRlT2Zmc2V0Oml9KSxUYXx8KHRoaXMuYnVmZmVyPXQsdGhpcy5ieXRlTGVuZ3RoPXIsdGhpcy5ieXRlT2Zmc2V0PWkpfSxUYSYmKHNvKEdhLCJieXRlTGVuZ3RoIiksc28ocWEsImJ1ZmZlciIpLHNvKHFhLCJieXRlTGVuZ3RoIiksc28ocWEsImJ5dGVPZmZzZXQiKSksSWEocWEucHJvdG90eXBlLHtnZXRJbnQ4OmZ1bmN0aW9uKHQpe3JldHVybiB1byh0aGlzLDEsdClbMF08PDI0Pj4yNH0sZ2V0VWludDg6ZnVuY3Rpb24odCl7cmV0dXJuIHVvKHRoaXMsMSx0KVswXX0sZ2V0SW50MTY6ZnVuY3Rpb24odCl7dmFyIGU9dW8odGhpcywyLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApO3JldHVybihlWzFdPDw4fGVbMF0pPDwxNj4+MTZ9LGdldFVpbnQxNjpmdW5jdGlvbih0KXt2YXIgZT11byh0aGlzLDIsdCxhcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCk7cmV0dXJuIGVbMV08PDh8ZVswXX0sZ2V0SW50MzI6ZnVuY3Rpb24odCl7cmV0dXJuIGlvKHVvKHRoaXMsNCx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKSl9LGdldFVpbnQzMjpmdW5jdGlvbih0KXtyZXR1cm4gaW8odW8odGhpcyw0LHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApKT4+PjB9LGdldEZsb2F0MzI6ZnVuY3Rpb24odCl7cmV0dXJuIHRvKHVvKHRoaXMsNCx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKSwyMyl9LGdldEZsb2F0NjQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRvKHVvKHRoaXMsOCx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKSw1Mil9LHNldEludDg6ZnVuY3Rpb24odCxlKXtjbyh0aGlzLDEsdCxlbyxlKX0sc2V0VWludDg6ZnVuY3Rpb24odCxlKXtjbyh0aGlzLDEsdCxlbyxlKX0sc2V0SW50MTY6ZnVuY3Rpb24odCxlKXtjbyh0aGlzLDIsdCxybyxlLGFyZ3VtZW50cy5sZW5ndGg+Mj9hcmd1bWVudHNbMl06dm9pZCAwKX0sc2V0VWludDE2OmZ1bmN0aW9uKHQsZSl7Y28odGhpcywyLHQscm8sZSxhcmd1bWVudHMubGVuZ3RoPjI/YXJndW1lbnRzWzJdOnZvaWQgMCl9LHNldEludDMyOmZ1bmN0aW9uKHQsZSl7Y28odGhpcyw0LHQsbm8sZSxhcmd1bWVudHMubGVuZ3RoPjI/YXJndW1lbnRzWzJdOnZvaWQgMCl9LHNldFVpbnQzMjpmdW5jdGlvbih0LGUpe2NvKHRoaXMsNCx0LG5vLGUsYXJndW1lbnRzLmxlbmd0aD4yP2FyZ3VtZW50c1syXTp2b2lkIDApfSxzZXRGbG9hdDMyOmZ1bmN0aW9uKHQsZSl7Y28odGhpcyw0LHQsYW8sZSxhcmd1bWVudHMubGVuZ3RoPjI/YXJndW1lbnRzWzJdOnZvaWQgMCl9LHNldEZsb2F0NjQ6ZnVuY3Rpb24odCxlKXtjbyh0aGlzLDgsdCxvbyxlLGFyZ3VtZW50cy5sZW5ndGg+Mj9hcmd1bWVudHNbMl06dm9pZCAwKX19KTtWYShHYSxLYSksVmEocWEsWWEpO3ZhciBnbz17QXJyYXlCdWZmZXI6R2EsRGF0YVZpZXc6cWF9LG1vPVl0LGJvPWZ1bmN0aW9uKHQpe3ZhciBlPW1vKHQpO2lmKGU8MCl0aHJvdyBSYW5nZUVycm9yKCJUaGUgYXJndW1lbnQgY2FuJ3QgYmUgbGVzcyB0aGFuIDAiKTtyZXR1cm4gZX0sd289ZnVuY3Rpb24odCxlKXt2YXIgcj1ibyh0KTtpZihyJWUpdGhyb3cgUmFuZ2VFcnJvcigiV3Jvbmcgb2Zmc2V0Iik7cmV0dXJuIHJ9LGtvPXZpLHhvPUxlLFNvPU50KCJpdGVyYXRvciIpLEFvPWZ1bmN0aW9uKHQpe2lmKG51bGwhPXQpcmV0dXJuIHRbU29dfHx0WyJAQGl0ZXJhdG9yIl18fHhvW2tvKHQpXX0sX289TGUsVG89TnQoIml0ZXJhdG9yIiksRW89QXJyYXkucHJvdG90eXBlLE9vPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDAhPT10JiYoX28uQXJyYXk9PT10fHxFb1tUb109PT10KX0sSW89ZnVuY3Rpb24odCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgVHlwZUVycm9yKFN0cmluZyh0KSsiIGlzIG5vdCBhIGZ1bmN0aW9uIik7cmV0dXJuIHR9LENvPUlvLE1vPWZ1bmN0aW9uKHQsZSxyKXtpZihDbyh0KSx2b2lkIDA9PT1lKXJldHVybiB0O3N3aXRjaChyKXtjYXNlIDA6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuY2FsbChlKX07Y2FzZSAxOnJldHVybiBmdW5jdGlvbihyKXtyZXR1cm4gdC5jYWxsKGUscil9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24ocixuKXtyZXR1cm4gdC5jYWxsKGUscixuKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihyLG4saSl7cmV0dXJuIHQuY2FsbChlLHIsbixpKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX0sUm89ZnQsUG89R3QsQm89QW8sVW89T28sRG89TW8sam89bmEuYVR5cGVkQXJyYXlDb25zdHJ1Y3Rvcix6bz1rLExvPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKHQpe3JldHVybiJBcnJheSI9PXpvKHQpfSxGbz1CLFZvPUxvLE5vPU50KCJzcGVjaWVzIiksSG89ZnVuY3Rpb24odCxlKXt2YXIgcjtyZXR1cm4gVm8odCkmJigiZnVuY3Rpb24iIT10eXBlb2Yocj10LmNvbnN0cnVjdG9yKXx8ciE9PUFycmF5JiYhVm8oci5wcm90b3R5cGUpP0ZvKHIpJiZudWxsPT09KHI9cltOb10pJiYocj12b2lkIDApOnI9dm9pZCAwKSxuZXcodm9pZCAwPT09cj9BcnJheTpyKSgwPT09ZT8wOmUpfSxLbz1NbyxZbz1BLCRvPWZ0LFdvPUd0LEdvPUhvLHFvPVtdLnB1c2gsWG89ZnVuY3Rpb24odCl7dmFyIGU9MT09dCxyPTI9PXQsbj0zPT10LGk9ND09dCxhPTY9PXQsbz03PT10LHM9NT09dHx8YTtyZXR1cm4gZnVuY3Rpb24odSxjLGYsbCl7Zm9yKHZhciBoLGQscD0kbyh1KSx2PVlvKHApLHk9S28oYyxmLDMpLGc9V28odi5sZW5ndGgpLG09MCxiPWx8fEdvLHc9ZT9iKHUsZyk6cnx8bz9iKHUsMCk6dm9pZCAwO2c+bTttKyspaWYoKHN8fG0gaW4gdikmJihkPXkoaD12W21dLG0scCksdCkpaWYoZSl3W21dPWQ7ZWxzZSBpZihkKXN3aXRjaCh0KXtjYXNlIDM6cmV0dXJuITA7Y2FzZSA1OnJldHVybiBoO2Nhc2UgNjpyZXR1cm4gbTtjYXNlIDI6cW8uY2FsbCh3LGgpfWVsc2Ugc3dpdGNoKHQpe2Nhc2UgNDpyZXR1cm4hMTtjYXNlIDc6cW8uY2FsbCh3LGgpfXJldHVybiBhPy0xOm58fGk/aTp3fX0sUW89e2ZvckVhY2g6WG8oMCksbWFwOlhvKDEpLGZpbHRlcjpYbygyKSxzb21lOlhvKDMpLGV2ZXJ5OlhvKDQpLGZpbmQ6WG8oNSksZmluZEluZGV4OlhvKDYpLGZpbHRlck91dDpYbyg3KX0sSm89a3QsWm89UCx0cz1SLGVzPU50KCJzcGVjaWVzIikscnM9ZnVuY3Rpb24odCl7dmFyIGU9Sm8odCkscj1aby5mO3RzJiZlJiYhZVtlc10mJnIoZSxlcyx7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzfX0pfSxucz1CLGlzPWpuLGFzPWZ1bmN0aW9uKHQsZSxyKXt2YXIgbixpO3JldHVybiBpcyYmImZ1bmN0aW9uIj09dHlwZW9mKG49ZS5jb25zdHJ1Y3RvcikmJm4hPT1yJiZucyhpPW4ucHJvdG90eXBlKSYmaSE9PXIucHJvdG90eXBlJiZpcyh0LGkpLHR9LG9zPWNuLHNzPUMsdXM9Uixjcz1mYSxmcz1uYSxscz1nbyxocz1oYSxkcz1YLHBzPVosdnM9R3QseXM9dmEsZ3M9d28sbXM9Syxicz1kdCx3cz12aSxrcz1CLHhzPVBlLFNzPWpuLEFzPU1yLmYsX3M9ZnVuY3Rpb24odCl7dmFyIGUscixuLGksYSxvLHM9Um8odCksdT1hcmd1bWVudHMubGVuZ3RoLGM9dT4xP2FyZ3VtZW50c1sxXTp2b2lkIDAsZj12b2lkIDAhPT1jLGw9Qm8ocyk7aWYobnVsbCE9bCYmIVVvKGwpKWZvcihvPShhPWwuY2FsbChzKSkubmV4dCxzPVtdOyEoaT1vLmNhbGwoYSkpLmRvbmU7KXMucHVzaChpLnZhbHVlKTtmb3IoZiYmdT4yJiYoYz1EbyhjLGFyZ3VtZW50c1syXSwyKSkscj1QbyhzLmxlbmd0aCksbj1uZXcoam8odGhpcykpKHIpLGU9MDtyPmU7ZSsrKW5bZV09Zj9jKHNbZV0sZSk6c1tlXTtyZXR1cm4gbn0sVHM9UW8uZm9yRWFjaCxFcz1ycyxPcz1QLElzPWNyLENzPWFzLE1zPXVyLmdldCxScz11ci5zZXQsUHM9T3MuZixCcz1Jcy5mLFVzPU1hdGgucm91bmQsRHM9c3MuUmFuZ2VFcnJvcixqcz1scy5BcnJheUJ1ZmZlcix6cz1scy5EYXRhVmlldyxMcz1mcy5OQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTLEZzPWZzLlRZUEVEX0FSUkFZX1RBRyxWcz1mcy5UeXBlZEFycmF5LE5zPWZzLlR5cGVkQXJyYXlQcm90b3R5cGUsSHM9ZnMuYVR5cGVkQXJyYXlDb25zdHJ1Y3RvcixLcz1mcy5pc1R5cGVkQXJyYXksWXM9IkJZVEVTX1BFUl9FTEVNRU5UIiwkcz0iV3JvbmcgbGVuZ3RoIixXcz1mdW5jdGlvbih0LGUpe2Zvcih2YXIgcj0wLG49ZS5sZW5ndGgsaT1uZXcoSHModCkpKG4pO24+cjspaVtyXT1lW3IrK107cmV0dXJuIGl9LEdzPWZ1bmN0aW9uKHQsZSl7UHModCxlLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gTXModGhpcylbZV19fSl9LHFzPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0IGluc3RhbmNlb2YganN8fCJBcnJheUJ1ZmZlciI9PShlPXdzKHQpKXx8IlNoYXJlZEFycmF5QnVmZmVyIj09ZX0sWHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gS3ModCkmJiJzeW1ib2wiIT10eXBlb2YgZSYmZSBpbiB0JiZTdHJpbmcoK2UpPT1TdHJpbmcoZSl9LFFzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIFhzKHQsZT1tcyhlLCEwKSk/ZHMoMix0W2VdKTpCcyh0LGUpfSxKcz1mdW5jdGlvbih0LGUscil7cmV0dXJuIShYcyh0LGU9bXMoZSwhMCkpJiZrcyhyKSYmYnMociwidmFsdWUiKSl8fGJzKHIsImdldCIpfHxicyhyLCJzZXQiKXx8ci5jb25maWd1cmFibGV8fGJzKHIsIndyaXRhYmxlIikmJiFyLndyaXRhYmxlfHxicyhyLCJlbnVtZXJhYmxlIikmJiFyLmVudW1lcmFibGU/UHModCxlLHIpOih0W2VdPXIudmFsdWUsdCl9O3VzPyhMc3x8KElzLmY9UXMsT3MuZj1KcyxHcyhOcywiYnVmZmVyIiksR3MoTnMsImJ5dGVPZmZzZXQiKSxHcyhOcywiYnl0ZUxlbmd0aCIpLEdzKE5zLCJsZW5ndGgiKSksb3Moe3RhcmdldDoiT2JqZWN0IixzdGF0OiEwLGZvcmNlZDohTHN9LHtnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6UXMsZGVmaW5lUHJvcGVydHk6SnN9KSxraS5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyKXt2YXIgbj10Lm1hdGNoKC9cZCskLylbMF0vOCxpPXQrKHI/IkNsYW1wZWQiOiIiKSsiQXJyYXkiLGE9ImdldCIrdCxvPSJzZXQiK3Qscz1zc1tpXSx1PXMsYz11JiZ1LnByb3RvdHlwZSxmPXt9LGw9ZnVuY3Rpb24odCxlKXtQcyh0LGUse2dldDpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0LGUpe3ZhciByPU1zKHQpO3JldHVybiByLnZpZXdbYV0oZSpuK3IuYnl0ZU9mZnNldCwhMCl9KHRoaXMsZSl9LHNldDpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24odCxlLGkpe3ZhciBhPU1zKHQpO3ImJihpPShpPVVzKGkpKTwwPzA6aT4yNTU/MjU1OjI1NSZpKSxhLnZpZXdbb10oZSpuK2EuYnl0ZU9mZnNldCxpLCEwKX0odGhpcyxlLHQpfSxlbnVtZXJhYmxlOiEwfSl9O0xzP2NzJiYodT1lKChmdW5jdGlvbih0LGUscixhKXtyZXR1cm4gaHModCx1LGkpLENzKGtzKGUpP3FzKGUpP3ZvaWQgMCE9PWE/bmV3IHMoZSxncyhyLG4pLGEpOnZvaWQgMCE9PXI/bmV3IHMoZSxncyhyLG4pKTpuZXcgcyhlKTpLcyhlKT9Xcyh1LGUpOl9zLmNhbGwodSxlKTpuZXcgcyh5cyhlKSksdCx1KX0pKSxTcyYmU3ModSxWcyksVHMoQXMocyksKGZ1bmN0aW9uKHQpe3QgaW4gdXx8cHModSx0LHNbdF0pfSkpLHUucHJvdG90eXBlPWMpOih1PWUoKGZ1bmN0aW9uKHQsZSxyLGEpe2hzKHQsdSxpKTt2YXIgbyxzLGMsZj0wLGg9MDtpZihrcyhlKSl7aWYoIXFzKGUpKXJldHVybiBLcyhlKT9Xcyh1LGUpOl9zLmNhbGwodSxlKTtvPWUsaD1ncyhyLG4pO3ZhciBkPWUuYnl0ZUxlbmd0aDtpZih2b2lkIDA9PT1hKXtpZihkJW4pdGhyb3cgRHMoJHMpO2lmKChzPWQtaCk8MCl0aHJvdyBEcygkcyl9ZWxzZSBpZigocz12cyhhKSpuKStoPmQpdGhyb3cgRHMoJHMpO2M9cy9ufWVsc2UgYz15cyhlKSxvPW5ldyBqcyhzPWMqbik7Zm9yKFJzKHQse2J1ZmZlcjpvLGJ5dGVPZmZzZXQ6aCxieXRlTGVuZ3RoOnMsbGVuZ3RoOmMsdmlldzpuZXcgenMobyl9KTtmPGM7KWwodCxmKyspfSkpLFNzJiZTcyh1LFZzKSxjPXUucHJvdG90eXBlPXhzKE5zKSksYy5jb25zdHJ1Y3RvciE9PXUmJnBzKGMsImNvbnN0cnVjdG9yIix1KSxGcyYmcHMoYyxGcyxpKSxmW2ldPXUsb3Moe2dsb2JhbDohMCxmb3JjZWQ6dSE9cyxzaGFtOiFMc30sZiksWXMgaW4gdXx8cHModSxZcyxuKSxZcyBpbiBjfHxwcyhjLFlzLG4pLEVzKGkpfSk6a2kuZXhwb3J0cz1mdW5jdGlvbigpe30sKDAsa2kuZXhwb3J0cykoIlVpbnQ4IiwoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscixuKXtyZXR1cm4gdCh0aGlzLGUscixuKX19KSk7dmFyIFpzPWZ0LHR1PUp0LGV1PUd0LHJ1PU1hdGgubWluLG51PVtdLmNvcHlXaXRoaW58fGZ1bmN0aW9uKHQsZSl7dmFyIHI9WnModGhpcyksbj1ldShyLmxlbmd0aCksaT10dSh0LG4pLGE9dHUoZSxuKSxvPWFyZ3VtZW50cy5sZW5ndGg+Mj9hcmd1bWVudHNbMl06dm9pZCAwLHM9cnUoKHZvaWQgMD09PW8/bjp0dShvLG4pKS1hLG4taSksdT0xO2ZvcihhPGkmJmk8YStzJiYodT0tMSxhKz1zLTEsaSs9cy0xKTtzLS0gPjA7KWEgaW4gcj9yW2ldPXJbYV06ZGVsZXRlIHJbaV0saSs9dSxhKz11O3JldHVybiByfSxpdT1udSxhdT1uYS5hVHlwZWRBcnJheTsoMCxuYS5leHBvcnRUeXBlZEFycmF5TWV0aG9kKSgiY29weVdpdGhpbiIsKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGl1LmNhbGwoYXUodGhpcyksdCxlLGFyZ3VtZW50cy5sZW5ndGg+Mj9hcmd1bWVudHNbMl06dm9pZCAwKX0pKTt2YXIgb3U9UW8uZXZlcnksc3U9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImV2ZXJ5IiwoZnVuY3Rpb24odCl7cmV0dXJuIG91KHN1KHRoaXMpLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciB1dT1BYSxjdT1uYS5hVHlwZWRBcnJheTsoMCxuYS5leHBvcnRUeXBlZEFycmF5TWV0aG9kKSgiZmlsbCIsKGZ1bmN0aW9uKHQpe3JldHVybiB1dS5hcHBseShjdSh0aGlzKSxhcmd1bWVudHMpfSkpO3ZhciBmdT1OLGx1PUlvLGh1PU50KCJzcGVjaWVzIiksZHU9ZnVuY3Rpb24odCxlKXt2YXIgcixuPWZ1KHQpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT1ufHxudWxsPT0ocj1mdShuKVtodV0pP2U6bHUocil9LHB1PW5hLmFUeXBlZEFycmF5Q29uc3RydWN0b3IsdnU9ZHUseXU9UW8uZmlsdGVyLGd1PWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXZ1KHQsdC5jb25zdHJ1Y3Rvciksbj0wLGk9ZS5sZW5ndGgsYT1uZXcocHUocikpKGkpO2k+bjspYVtuXT1lW24rK107cmV0dXJuIGF9LG11PW5hLmFUeXBlZEFycmF5OygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJmaWx0ZXIiLChmdW5jdGlvbih0KXt2YXIgZT15dShtdSh0aGlzKSx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKTtyZXR1cm4gZ3UodGhpcyxlKX0pKTt2YXIgYnU9UW8uZmluZCx3dT1uYS5hVHlwZWRBcnJheTsoMCxuYS5leHBvcnRUeXBlZEFycmF5TWV0aG9kKSgiZmluZCIsKGZ1bmN0aW9uKHQpe3JldHVybiBidSh3dSh0aGlzKSx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX0pKTt2YXIga3U9UW8uZmluZEluZGV4LHh1PW5hLmFUeXBlZEFycmF5OygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJmaW5kSW5kZXgiLChmdW5jdGlvbih0KXtyZXR1cm4ga3UoeHUodGhpcyksdCxhcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCl9KSk7dmFyIFN1PVFvLmZvckVhY2gsQXU9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImZvckVhY2giLChmdW5jdGlvbih0KXtTdShBdSh0aGlzKSx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX0pKTt2YXIgX3U9bmUuaW5jbHVkZXMsVHU9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImluY2x1ZGVzIiwoZnVuY3Rpb24odCl7cmV0dXJuIF91KFR1KHRoaXMpLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciBFdT1uZS5pbmRleE9mLE91PW5hLmFUeXBlZEFycmF5OygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJpbmRleE9mIiwoZnVuY3Rpb24odCl7cmV0dXJuIEV1KE91KHRoaXMpLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciBJdT1DLEN1PW5hLE11PXVpLFJ1PU50KCJpdGVyYXRvciIpLFB1PUl1LlVpbnQ4QXJyYXksQnU9TXUudmFsdWVzLFV1PU11LmtleXMsRHU9TXUuZW50cmllcyxqdT1DdS5hVHlwZWRBcnJheSx6dT1DdS5leHBvcnRUeXBlZEFycmF5TWV0aG9kLEx1PVB1JiZQdS5wcm90b3R5cGVbUnVdLEZ1PSEhTHUmJigidmFsdWVzIj09THUubmFtZXx8bnVsbD09THUubmFtZSksVnU9ZnVuY3Rpb24oKXtyZXR1cm4gQnUuY2FsbChqdSh0aGlzKSl9O3p1KCJlbnRyaWVzIiwoZnVuY3Rpb24oKXtyZXR1cm4gRHUuY2FsbChqdSh0aGlzKSl9KSksenUoImtleXMiLChmdW5jdGlvbigpe3JldHVybiBVdS5jYWxsKGp1KHRoaXMpKX0pKSx6dSgidmFsdWVzIixWdSwhRnUpLHp1KFJ1LFZ1LCFGdSk7dmFyIE51PW5hLmFUeXBlZEFycmF5LEh1PVtdLmpvaW47KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImpvaW4iLChmdW5jdGlvbih0KXtyZXR1cm4gSHUuYXBwbHkoTnUodGhpcyksYXJndW1lbnRzKX0pKTt2YXIgS3U9YixZdT1mdW5jdGlvbih0LGUpe3ZhciByPVtdW3RdO3JldHVybiEhciYmS3UoKGZ1bmN0aW9uKCl7ci5jYWxsKG51bGwsZXx8ZnVuY3Rpb24oKXt0aHJvdyAxfSwxKX0pKX0sJHU9TyxXdT1ZdCxHdT1HdCxxdT1ZdSxYdT1NYXRoLm1pbixRdT1bXS5sYXN0SW5kZXhPZixKdT0hIVF1JiYxL1sxXS5sYXN0SW5kZXhPZigxLC0wKTwwLFp1PXF1KCJsYXN0SW5kZXhPZiIpLHRjPUp1fHwhWnU/ZnVuY3Rpb24odCl7aWYoSnUpcmV0dXJuIFF1LmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8MDt2YXIgZT0kdSh0aGlzKSxyPUd1KGUubGVuZ3RoKSxuPXItMTtmb3IoYXJndW1lbnRzLmxlbmd0aD4xJiYobj1YdShuLFd1KGFyZ3VtZW50c1sxXSkpKSxuPDAmJihuPXIrbik7bj49MDtuLS0paWYobiBpbiBlJiZlW25dPT09dClyZXR1cm4gbnx8MDtyZXR1cm4tMX06UXUsZWM9dGMscmM9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImxhc3RJbmRleE9mIiwoZnVuY3Rpb24odCl7cmV0dXJuIGVjLmFwcGx5KHJjKHRoaXMpLGFyZ3VtZW50cyl9KSk7dmFyIG5jPVFvLm1hcCxpYz1kdSxhYz1uYS5hVHlwZWRBcnJheSxvYz1uYS5hVHlwZWRBcnJheUNvbnN0cnVjdG9yOygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJtYXAiLChmdW5jdGlvbih0KXtyZXR1cm4gbmMoYWModGhpcyksdCxhcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCwoZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3KG9jKGljKHQsdC5jb25zdHJ1Y3RvcikpKShlKX0pKX0pKTt2YXIgc2M9SW8sdWM9ZnQsY2M9QSxmYz1HdCxsYz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyLG4saSl7c2Mocik7dmFyIGE9dWMoZSksbz1jYyhhKSxzPWZjKGEubGVuZ3RoKSx1PXQ/cy0xOjAsYz10Py0xOjE7aWYobjwyKWZvcig7Oyl7aWYodSBpbiBvKXtpPW9bdV0sdSs9YzticmVha31pZih1Kz1jLHQ/dTwwOnM8PXUpdGhyb3cgVHlwZUVycm9yKCJSZWR1Y2Ugb2YgZW1wdHkgYXJyYXkgd2l0aCBubyBpbml0aWFsIHZhbHVlIil9Zm9yKDt0P3U+PTA6cz51O3UrPWMpdSBpbiBvJiYoaT1yKGksb1t1XSx1LGEpKTtyZXR1cm4gaX19LGhjPXtsZWZ0OmxjKCExKSxyaWdodDpsYyghMCl9LGRjPWhjLmxlZnQscGM9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoInJlZHVjZSIsKGZ1bmN0aW9uKHQpe3JldHVybiBkYyhwYyh0aGlzKSx0LGFyZ3VtZW50cy5sZW5ndGgsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciB2Yz1oYy5yaWdodCx5Yz1uYS5hVHlwZWRBcnJheTsoMCxuYS5leHBvcnRUeXBlZEFycmF5TWV0aG9kKSgicmVkdWNlUmlnaHQiLChmdW5jdGlvbih0KXtyZXR1cm4gdmMoeWModGhpcyksdCxhcmd1bWVudHMubGVuZ3RoLGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX0pKTt2YXIgZ2M9bmEuYVR5cGVkQXJyYXksbWM9bmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCxiYz1NYXRoLmZsb29yO21jKCJyZXZlcnNlIiwoZnVuY3Rpb24oKXtmb3IodmFyIHQsZT10aGlzLHI9Z2MoZSkubGVuZ3RoLG49YmMoci8yKSxpPTA7aTxuOyl0PWVbaV0sZVtpKytdPWVbLS1yXSxlW3JdPXQ7cmV0dXJuIGV9KSk7dmFyIHdjPUd0LGtjPXdvLHhjPWZ0LFNjPW5hLmFUeXBlZEFycmF5OygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJzZXQiLChmdW5jdGlvbih0KXtTYyh0aGlzKTt2YXIgZT1rYyhhcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCwxKSxyPXRoaXMubGVuZ3RoLG49eGModCksaT13YyhuLmxlbmd0aCksYT0wO2lmKGkrZT5yKXRocm93IFJhbmdlRXJyb3IoIldyb25nIGxlbmd0aCIpO2Zvcig7YTxpOyl0aGlzW2UrYV09blthKytdfSksYigoZnVuY3Rpb24oKXtuZXcgSW50OEFycmF5KDEpLnNldCh7fSl9KSkpO3ZhciBBYz1kdSxfYz1uYS5hVHlwZWRBcnJheSxUYz1uYS5hVHlwZWRBcnJheUNvbnN0cnVjdG9yLEVjPVtdLnNsaWNlOygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJzbGljZSIsKGZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPUVjLmNhbGwoX2ModGhpcyksdCxlKSxuPUFjKHRoaXMsdGhpcy5jb25zdHJ1Y3RvciksaT0wLGE9ci5sZW5ndGgsbz1uZXcoVGMobikpKGEpO2E+aTspb1tpXT1yW2krK107cmV0dXJuIG99KSxiKChmdW5jdGlvbigpe25ldyBJbnQ4QXJyYXkoMSkuc2xpY2UoKX0pKSk7dmFyIE9jPVFvLnNvbWUsSWM9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoInNvbWUiLChmdW5jdGlvbih0KXtyZXR1cm4gT2MoSWModGhpcyksdCxhcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCl9KSk7dmFyIENjPW5hLmFUeXBlZEFycmF5LE1jPVtdLnNvcnQ7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoInNvcnQiLChmdW5jdGlvbih0KXtyZXR1cm4gTWMuY2FsbChDYyh0aGlzKSx0KX0pKTt2YXIgUmM9R3QsUGM9SnQsQmM9ZHUsVWM9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoInN1YmFycmF5IiwoZnVuY3Rpb24odCxlKXt2YXIgcj1VYyh0aGlzKSxuPXIubGVuZ3RoLGk9UGModCxuKTtyZXR1cm4gbmV3KEJjKHIsci5jb25zdHJ1Y3RvcikpKHIuYnVmZmVyLHIuYnl0ZU9mZnNldCtpKnIuQllURVNfUEVSX0VMRU1FTlQsUmMoKHZvaWQgMD09PWU/bjpQYyhlLG4pKS1pKSl9KSk7dmFyIERjPW5hLGpjPWIsemM9Qy5JbnQ4QXJyYXksTGM9RGMuYVR5cGVkQXJyYXksRmM9RGMuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCxWYz1bXS50b0xvY2FsZVN0cmluZyxOYz1bXS5zbGljZSxIYz0hIXpjJiZqYygoZnVuY3Rpb24oKXtWYy5jYWxsKG5ldyB6YygxKSl9KSk7RmMoInRvTG9jYWxlU3RyaW5nIiwoZnVuY3Rpb24oKXtyZXR1cm4gVmMuYXBwbHkoSGM/TmMuY2FsbChMYyh0aGlzKSk6TGModGhpcyksYXJndW1lbnRzKX0pLGpjKChmdW5jdGlvbigpe3JldHVyblsxLDJdLnRvTG9jYWxlU3RyaW5nKCkhPW5ldyB6YyhbMSwyXSkudG9Mb2NhbGVTdHJpbmcoKX0pKXx8IWpjKChmdW5jdGlvbigpe3pjLnByb3RvdHlwZS50b0xvY2FsZVN0cmluZy5jYWxsKFsxLDJdKX0pKSk7dmFyIEtjPW5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QsWWM9YiwkYz1DLlVpbnQ4QXJyYXksV2M9JGMmJiRjLnByb3RvdHlwZXx8e30sR2M9W10udG9TdHJpbmcscWM9W10uam9pbjtZYygoZnVuY3Rpb24oKXtHYy5jYWxsKHt9KX0pKSYmKEdjPWZ1bmN0aW9uKCl7cmV0dXJuIHFjLmNhbGwodGhpcyl9KTt2YXIgWGM9V2MudG9TdHJpbmchPUdjO0tjKCJ0b1N0cmluZyIsR2MsWGMpO3ZhciBRYz1LLEpjPVAsWmM9WCx0Zj1mdW5jdGlvbih0LGUscil7dmFyIG49UWMoZSk7biBpbiB0P0pjLmYodCxuLFpjKDAscikpOnRbbl09cn0sZWY9YixyZj1PdCxuZj1OdCgic3BlY2llcyIpLGFmPWZ1bmN0aW9uKHQpe3JldHVybiByZj49NTF8fCFlZigoZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4oZS5jb25zdHJ1Y3Rvcj17fSlbbmZdPWZ1bmN0aW9uKCl7cmV0dXJue2ZvbzoxfX0sMSE9PWVbdF0oQm9vbGVhbikuZm9vfSkpfSxvZj1jbixzZj1iLHVmPUxvLGNmPUIsZmY9ZnQsbGY9R3QsaGY9dGYsZGY9SG8scGY9YWYsdmY9T3QseWY9TnQoImlzQ29uY2F0U3ByZWFkYWJsZSIpLGdmPTkwMDcxOTkyNTQ3NDA5OTEsbWY9Ik1heGltdW0gYWxsb3dlZCBpbmRleCBleGNlZWRlZCIsYmY9dmY+PTUxfHwhc2YoKGZ1bmN0aW9uKCl7dmFyIHQ9W107cmV0dXJuIHRbeWZdPSExLHQuY29uY2F0KClbMF0hPT10fSkpLHdmPXBmKCJjb25jYXQiKSxrZj1mdW5jdGlvbih0KXtpZighY2YodCkpcmV0dXJuITE7dmFyIGU9dFt5Zl07cmV0dXJuIHZvaWQgMCE9PWU/ISFlOnVmKHQpfTtvZih7dGFyZ2V0OiJBcnJheSIscHJvdG86ITAsZm9yY2VkOiFiZnx8IXdmfSx7Y29uY2F0OmZ1bmN0aW9uKHQpe3ZhciBlLHIsbixpLGEsbz1mZih0aGlzKSxzPWRmKG8sMCksdT0wO2ZvcihlPS0xLG49YXJndW1lbnRzLmxlbmd0aDtlPG47ZSsrKWlmKGtmKGE9LTE9PT1lP286YXJndW1lbnRzW2VdKSl7aWYodSsoaT1sZihhLmxlbmd0aCkpPmdmKXRocm93IFR5cGVFcnJvcihtZik7Zm9yKHI9MDtyPGk7cisrLHUrKylyIGluIGEmJmhmKHMsdSxhW3JdKX1lbHNle2lmKHU+PWdmKXRocm93IFR5cGVFcnJvcihtZik7aGYocyx1KyssYSl9cmV0dXJuIHMubGVuZ3RoPXUsc319KTt2YXIgeGY9e0NTU1J1bGVMaXN0OjAsQ1NTU3R5bGVEZWNsYXJhdGlvbjowLENTU1ZhbHVlTGlzdDowLENsaWVudFJlY3RMaXN0OjAsRE9NUmVjdExpc3Q6MCxET01TdHJpbmdMaXN0OjAsRE9NVG9rZW5MaXN0OjEsRGF0YVRyYW5zZmVySXRlbUxpc3Q6MCxGaWxlTGlzdDowLEhUTUxBbGxDb2xsZWN0aW9uOjAsSFRNTENvbGxlY3Rpb246MCxIVE1MRm9ybUVsZW1lbnQ6MCxIVE1MU2VsZWN0RWxlbWVudDowLE1lZGlhTGlzdDowLE1pbWVUeXBlQXJyYXk6MCxOYW1lZE5vZGVNYXA6MCxOb2RlTGlzdDoxLFBhaW50UmVxdWVzdExpc3Q6MCxQbHVnaW46MCxQbHVnaW5BcnJheTowLFNWR0xlbmd0aExpc3Q6MCxTVkdOdW1iZXJMaXN0OjAsU1ZHUGF0aFNlZ0xpc3Q6MCxTVkdQb2ludExpc3Q6MCxTVkdTdHJpbmdMaXN0OjAsU1ZHVHJhbnNmb3JtTGlzdDowLFNvdXJjZUJ1ZmZlckxpc3Q6MCxTdHlsZVNoZWV0TGlzdDowLFRleHRUcmFja0N1ZUxpc3Q6MCxUZXh0VHJhY2tMaXN0OjAsVG91Y2hMaXN0OjB9LFNmPVFvLmZvckVhY2gsQWY9WXUoImZvckVhY2giKT9bXS5mb3JFYWNoOmZ1bmN0aW9uKHQpe3JldHVybiBTZih0aGlzLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSxfZj1DLFRmPXhmLEVmPUFmLE9mPVo7Zm9yKHZhciBJZiBpbiBUZil7dmFyIENmPV9mW0lmXSxNZj1DZiYmQ2YucHJvdG90eXBlO2lmKE1mJiZNZi5mb3JFYWNoIT09RWYpdHJ5e09mKE1mLCJmb3JFYWNoIixFZil9Y2F0Y2goam0pe01mLmZvckVhY2g9RWZ9fXZhciBSZj1Rby5tYXA7Y24oe3RhcmdldDoiQXJyYXkiLHByb3RvOiEwLGZvcmNlZDohYWYoIm1hcCIpfSx7bWFwOmZ1bmN0aW9uKHQpe3JldHVybiBSZih0aGlzLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfX0pO3ZhciBQZj1uZS5pbmNsdWRlcyxCZj16ZTtjbih7dGFyZ2V0OiJBcnJheSIscHJvdG86ITB9LHtpbmNsdWRlczpmdW5jdGlvbih0KXtyZXR1cm4gUGYodGhpcyx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX19KSxCZigiaW5jbHVkZXMiKTt2YXIgVWY9QixEZj1rLGpmPU50KCJtYXRjaCIpLHpmPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBVZih0KSYmKHZvaWQgMCE9PShlPXRbamZdKT8hIWU6IlJlZ0V4cCI9PURmKHQpKX0sTGY9TnQoIm1hdGNoIiksRmY9ZnVuY3Rpb24odCl7aWYoemYodCkpdGhyb3cgVHlwZUVycm9yKCJUaGUgbWV0aG9kIGRvZXNuJ3QgYWNjZXB0IHJlZ3VsYXIgZXhwcmVzc2lvbnMiKTtyZXR1cm4gdH0sVmY9Xztjbih7dGFyZ2V0OiJTdHJpbmciLHByb3RvOiEwLGZvcmNlZDohZnVuY3Rpb24odCl7dmFyIGU9Ly4vO3RyeXsiLy4vIlt0XShlKX1jYXRjaChyKXt0cnl7cmV0dXJuIGVbTGZdPSExLCIvLi8iW3RdKGUpfWNhdGNoKG4pe319cmV0dXJuITF9KCJpbmNsdWRlcyIpfSx7aW5jbHVkZXM6ZnVuY3Rpb24odCl7cmV0dXJuISF+U3RyaW5nKFZmKHRoaXMpKS5pbmRleE9mKEZmKHQpLGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX19KTt2YXIgTmY9UW8uZmlsdGVyO2NuKHt0YXJnZXQ6IkFycmF5Iixwcm90bzohMCxmb3JjZWQ6IWFmKCJmaWx0ZXIiKX0se2ZpbHRlcjpmdW5jdGlvbih0KXtyZXR1cm4gTmYodGhpcyx0LGFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06dm9pZCAwKX19KTt2YXIgSGY9ZnQsS2Y9eW4sWWY9Zm47Y24oe3RhcmdldDoiT2JqZWN0IixzdGF0OiEwLGZvcmNlZDpiKChmdW5jdGlvbigpe0tmKDEpfSkpLHNoYW06IVlmfSx7Z2V0UHJvdG90eXBlT2Y6ZnVuY3Rpb24odCl7cmV0dXJuIEtmKEhmKHQpKX19KTt2YXIgJGY9SW8sV2Y9QixHZj1bXS5zbGljZSxxZj17fSxYZj1mdW5jdGlvbih0LGUscil7aWYoIShlIGluIHFmKSl7Zm9yKHZhciBuPVtdLGk9MDtpPGU7aSsrKW5baV09ImFbIitpKyJdIjtxZltlXT1GdW5jdGlvbigiQyxhIiwicmV0dXJuIG5ldyBDKCIrbi5qb2luKCIsIikrIikiKX1yZXR1cm4gcWZbZV0odCxyKX0sUWY9RnVuY3Rpb24uYmluZHx8ZnVuY3Rpb24odCl7dmFyIGU9JGYodGhpcykscj1HZi5jYWxsKGFyZ3VtZW50cywxKSxuPWZ1bmN0aW9uKCl7dmFyIGk9ci5jb25jYXQoR2YuY2FsbChhcmd1bWVudHMpKTtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIG4/WGYoZSxpLmxlbmd0aCxpKTplLmFwcGx5KHQsaSl9O3JldHVybiBXZihlLnByb3RvdHlwZSkmJihuLnByb3RvdHlwZT1lLnByb3RvdHlwZSksbn0sSmY9Y24sWmY9SW8sdGw9TixlbD1CLHJsPVBlLG5sPVFmLGlsPWIsYWw9a3QoIlJlZmxlY3QiLCJjb25zdHJ1Y3QiKSxvbD1pbCgoZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiEoYWwoKGZ1bmN0aW9uKCl7fSksW10sdClpbnN0YW5jZW9mIHQpfSkpLHNsPSFpbCgoZnVuY3Rpb24oKXthbCgoZnVuY3Rpb24oKXt9KSl9KSksdWw9b2x8fHNsO0pmKHt0YXJnZXQ6IlJlZmxlY3QiLHN0YXQ6ITAsZm9yY2VkOnVsLHNoYW06dWx9LHtjb25zdHJ1Y3Q6ZnVuY3Rpb24odCxlKXtaZih0KSx0bChlKTt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPDM/dDpaZihhcmd1bWVudHNbMl0pO2lmKHNsJiYhb2wpcmV0dXJuIGFsKHQsZSxyKTtpZih0PT1yKXtzd2l0Y2goZS5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbmV3IHQ7Y2FzZSAxOnJldHVybiBuZXcgdChlWzBdKTtjYXNlIDI6cmV0dXJuIG5ldyB0KGVbMF0sZVsxXSk7Y2FzZSAzOnJldHVybiBuZXcgdChlWzBdLGVbMV0sZVsyXSk7Y2FzZSA0OnJldHVybiBuZXcgdChlWzBdLGVbMV0sZVsyXSxlWzNdKX12YXIgbj1bbnVsbF07cmV0dXJuIG4ucHVzaC5hcHBseShuLGUpLG5ldyhubC5hcHBseSh0LG4pKX12YXIgaT1yLnByb3RvdHlwZSxhPXJsKGVsKGkpP2k6T2JqZWN0LnByb3RvdHlwZSksbz1GdW5jdGlvbi5hcHBseS5jYWxsKHQsYSxlKTtyZXR1cm4gZWwobyk/bzphfX0pO3ZhciBjbD17fSxmbD1PLGxsPU1yLmYsaGw9e30udG9TdHJpbmcsZGw9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJndpbmRvdyYmT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM/T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KTpbXTtjbC5mPWZ1bmN0aW9uKHQpe3JldHVybiBkbCYmIltvYmplY3QgV2luZG93XSI9PWhsLmNhbGwodCk/ZnVuY3Rpb24odCl7dHJ5e3JldHVybiBsbCh0KX1jYXRjaChqbSl7cmV0dXJuIGRsLnNsaWNlKCl9fSh0KTpsbChmbCh0KSl9O3ZhciBwbD17fSx2bD1OdDtwbC5mPXZsO3ZhciB5bD1ndCxnbD1kdCxtbD1wbCxibD1QLmYsd2w9ZnVuY3Rpb24odCl7dmFyIGU9eWwuU3ltYm9sfHwoeWwuU3ltYm9sPXt9KTtnbChlLHQpfHxibChlLHQse3ZhbHVlOm1sLmYodCl9KX0sa2w9Y24seGw9QyxTbD1rdCxBbD1SLF9sPU10LFRsPVJ0LEVsPWIsT2w9ZHQsSWw9TG8sQ2w9QixNbD1OLFJsPWZ0LFBsPU8sQmw9SyxVbD1YLERsPVBlLGpsPWRlLHpsPU1yLExsPWNsLEZsPUJyLFZsPWNyLE5sPVAsSGw9ZnIsS2w9WixZbD14ci5leHBvcnRzLCRsPU0uZXhwb3J0cyxXbD1pZSxHbD15dCxxbD1OdCxYbD1wbCxRbD13bCxKbD1FbixabD11cix0aD1Rby5mb3JFYWNoLGVoPXhlKCJoaWRkZW4iKSxyaD0iU3ltYm9sIixuaD1xbCgidG9QcmltaXRpdmUiKSxpaD1abC5zZXQsYWg9WmwuZ2V0dGVyRm9yKHJoKSxvaD1PYmplY3QucHJvdG90eXBlLHNoPXhsLlN5bWJvbCx1aD1TbCgiSlNPTiIsInN0cmluZ2lmeSIpLGNoPVZsLmYsZmg9TmwuZixsaD1MbC5mLGhoPUhsLmYsZGg9JGwoInN5bWJvbHMiKSxwaD0kbCgib3Atc3ltYm9scyIpLHZoPSRsKCJzdHJpbmctdG8tc3ltYm9sLXJlZ2lzdHJ5IikseWg9JGwoInN5bWJvbC10by1zdHJpbmctcmVnaXN0cnkiKSxnaD0kbCgid2tzIiksbWg9eGwuUU9iamVjdCxiaD0hbWh8fCFtaC5wcm90b3R5cGV8fCFtaC5wcm90b3R5cGUuZmluZENoaWxkLHdoPUFsJiZFbCgoZnVuY3Rpb24oKXtyZXR1cm4gNyE9RGwoZmgoe30sImEiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZmgodGhpcywiYSIse3ZhbHVlOjd9KS5hfX0pKS5hfSkpP2Z1bmN0aW9uKHQsZSxyKXt2YXIgbj1jaChvaCxlKTtuJiZkZWxldGUgb2hbZV0sZmgodCxlLHIpLG4mJnQhPT1vaCYmZmgob2gsZSxuKX06Zmgsa2g9ZnVuY3Rpb24odCxlKXt2YXIgcj1kaFt0XT1EbChzaC5wcm90b3R5cGUpO3JldHVybiBpaChyLHt0eXBlOnJoLHRhZzp0LGRlc2NyaXB0aW9uOmV9KSxBbHx8KHIuZGVzY3JpcHRpb249ZSkscn0seGg9VGw/ZnVuY3Rpb24odCl7cmV0dXJuInN5bWJvbCI9PXR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0KHQpaW5zdGFuY2VvZiBzaH0sU2g9ZnVuY3Rpb24odCxlLHIpe3Q9PT1vaCYmU2gocGgsZSxyKSxNbCh0KTt2YXIgbj1CbChlLCEwKTtyZXR1cm4gTWwociksT2woZGgsbik/KHIuZW51bWVyYWJsZT8oT2wodCxlaCkmJnRbZWhdW25dJiYodFtlaF1bbl09ITEpLHI9RGwocix7ZW51bWVyYWJsZTpVbCgwLCExKX0pKTooT2wodCxlaCl8fGZoKHQsZWgsVWwoMSx7fSkpLHRbZWhdW25dPSEwKSx3aCh0LG4scikpOmZoKHQsbixyKX0sQWg9ZnVuY3Rpb24odCxlKXtNbCh0KTt2YXIgcj1QbChlKSxuPWpsKHIpLmNvbmNhdChPaChyKSk7cmV0dXJuIHRoKG4sKGZ1bmN0aW9uKGUpe0FsJiYhX2guY2FsbChyLGUpfHxTaCh0LGUscltlXSl9KSksdH0sX2g9ZnVuY3Rpb24odCl7dmFyIGU9QmwodCwhMCkscj1oaC5jYWxsKHRoaXMsZSk7cmV0dXJuISh0aGlzPT09b2gmJk9sKGRoLGUpJiYhT2wocGgsZSkpJiYoIShyfHwhT2wodGhpcyxlKXx8IU9sKGRoLGUpfHxPbCh0aGlzLGVoKSYmdGhpc1tlaF1bZV0pfHxyKX0sVGg9ZnVuY3Rpb24odCxlKXt2YXIgcj1QbCh0KSxuPUJsKGUsITApO2lmKHIhPT1vaHx8IU9sKGRoLG4pfHxPbChwaCxuKSl7dmFyIGk9Y2gocixuKTtyZXR1cm4haXx8IU9sKGRoLG4pfHxPbChyLGVoKSYmcltlaF1bbl18fChpLmVudW1lcmFibGU9ITApLGl9fSxFaD1mdW5jdGlvbih0KXt2YXIgZT1saChQbCh0KSkscj1bXTtyZXR1cm4gdGgoZSwoZnVuY3Rpb24odCl7T2woZGgsdCl8fE9sKFdsLHQpfHxyLnB1c2godCl9KSkscn0sT2g9ZnVuY3Rpb24odCl7dmFyIGU9dD09PW9oLHI9bGgoZT9waDpQbCh0KSksbj1bXTtyZXR1cm4gdGgociwoZnVuY3Rpb24odCl7IU9sKGRoLHQpfHxlJiYhT2wob2gsdCl8fG4ucHVzaChkaFt0XSl9KSksbn07KF9sfHwoc2g9ZnVuY3Rpb24oKXtpZih0aGlzIGluc3RhbmNlb2Ygc2gpdGhyb3cgVHlwZUVycm9yKCJTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IiKTt2YXIgdD1hcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/U3RyaW5nKGFyZ3VtZW50c1swXSk6dm9pZCAwLGU9R2wodCkscj1mdW5jdGlvbih0KXt0aGlzPT09b2gmJnIuY2FsbChwaCx0KSxPbCh0aGlzLGVoKSYmT2wodGhpc1tlaF0sZSkmJih0aGlzW2VoXVtlXT0hMSksd2godGhpcyxlLFVsKDEsdCkpfTtyZXR1cm4gQWwmJmJoJiZ3aChvaCxlLHtjb25maWd1cmFibGU6ITAsc2V0OnJ9KSxraChlLHQpfSxZbChzaC5wcm90b3R5cGUsInRvU3RyaW5nIiwoZnVuY3Rpb24oKXtyZXR1cm4gYWgodGhpcykudGFnfSkpLFlsKHNoLCJ3aXRob3V0U2V0dGVyIiwoZnVuY3Rpb24odCl7cmV0dXJuIGtoKEdsKHQpLHQpfSkpLEhsLmY9X2gsTmwuZj1TaCxWbC5mPVRoLHpsLmY9TGwuZj1FaCxGbC5mPU9oLFhsLmY9ZnVuY3Rpb24odCl7cmV0dXJuIGtoKHFsKHQpLHQpfSxBbCYmKGZoKHNoLnByb3RvdHlwZSwiZGVzY3JpcHRpb24iLHtjb25maWd1cmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGFoKHRoaXMpLmRlc2NyaXB0aW9ufX0pLFlsKG9oLCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsX2gse3Vuc2FmZTohMH0pKSksa2woe2dsb2JhbDohMCx3cmFwOiEwLGZvcmNlZDohX2wsc2hhbTohX2x9LHtTeW1ib2w6c2h9KSx0aChqbChnaCksKGZ1bmN0aW9uKHQpe1FsKHQpfSkpLGtsKHt0YXJnZXQ6cmgsc3RhdDohMCxmb3JjZWQ6IV9sfSx7Zm9yOmZ1bmN0aW9uKHQpe3ZhciBlPVN0cmluZyh0KTtpZihPbCh2aCxlKSlyZXR1cm4gdmhbZV07dmFyIHI9c2goZSk7cmV0dXJuIHZoW2VdPXIseWhbcl09ZSxyfSxrZXlGb3I6ZnVuY3Rpb24odCl7aWYoIXhoKHQpKXRocm93IFR5cGVFcnJvcih0KyIgaXMgbm90IGEgc3ltYm9sIik7aWYoT2woeWgsdCkpcmV0dXJuIHloW3RdfSx1c2VTZXR0ZXI6ZnVuY3Rpb24oKXtiaD0hMH0sdXNlU2ltcGxlOmZ1bmN0aW9uKCl7Ymg9ITF9fSksa2woe3RhcmdldDoiT2JqZWN0IixzdGF0OiEwLGZvcmNlZDohX2wsc2hhbTohQWx9LHtjcmVhdGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdm9pZCAwPT09ZT9EbCh0KTpBaChEbCh0KSxlKX0sZGVmaW5lUHJvcGVydHk6U2gsZGVmaW5lUHJvcGVydGllczpBaCxnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6VGh9KSxrbCh7dGFyZ2V0OiJPYmplY3QiLHN0YXQ6ITAsZm9yY2VkOiFfbH0se2dldE93blByb3BlcnR5TmFtZXM6RWgsZ2V0T3duUHJvcGVydHlTeW1ib2xzOk9ofSksa2woe3RhcmdldDoiT2JqZWN0IixzdGF0OiEwLGZvcmNlZDpFbCgoZnVuY3Rpb24oKXtGbC5mKDEpfSkpfSx7Z2V0T3duUHJvcGVydHlTeW1ib2xzOmZ1bmN0aW9uKHQpe3JldHVybiBGbC5mKFJsKHQpKX19KSx1aCkmJmtsKHt0YXJnZXQ6IkpTT04iLHN0YXQ6ITAsZm9yY2VkOiFfbHx8RWwoKGZ1bmN0aW9uKCl7dmFyIHQ9c2goKTtyZXR1cm4iW251bGxdIiE9dWgoW3RdKXx8Int9IiE9dWgoe2E6dH0pfHwie30iIT11aChPYmplY3QodCkpfSkpfSx7c3RyaW5naWZ5OmZ1bmN0aW9uKHQsZSxyKXtmb3IodmFyIG4saT1bdF0sYT0xO2FyZ3VtZW50cy5sZW5ndGg+YTspaS5wdXNoKGFyZ3VtZW50c1thKytdKTtpZihuPWUsKENsKGUpfHx2b2lkIDAhPT10KSYmIXhoKHQpKXJldHVybiBJbChlKXx8KGU9ZnVuY3Rpb24odCxlKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgbiYmKGU9bi5jYWxsKHRoaXMsdCxlKSksIXhoKGUpKXJldHVybiBlfSksaVsxXT1lLHVoLmFwcGx5KG51bGwsaSl9fSk7c2gucHJvdG90eXBlW25oXXx8S2woc2gucHJvdG90eXBlLG5oLHNoLnByb3RvdHlwZS52YWx1ZU9mKSxKbChzaCxyaCksV2xbZWhdPSEwO3ZhciBJaD1jbixDaD1SLE1oPUMsUmg9ZHQsUGg9QixCaD1QLmYsVWg9JHIsRGg9TWguU3ltYm9sO2lmKENoJiYiZnVuY3Rpb24iPT10eXBlb2YgRGgmJighKCJkZXNjcmlwdGlvbiJpbiBEaC5wcm90b3R5cGUpfHx2b2lkIDAhPT1EaCgpLmRlc2NyaXB0aW9uKSl7dmFyIGpoPXt9LHpoPWZ1bmN0aW9uKCl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aDwxfHx2b2lkIDA9PT1hcmd1bWVudHNbMF0/dm9pZCAwOlN0cmluZyhhcmd1bWVudHNbMF0pLGU9dGhpcyBpbnN0YW5jZW9mIHpoP25ldyBEaCh0KTp2b2lkIDA9PT10P0RoKCk6RGgodCk7cmV0dXJuIiI9PT10JiYoamhbZV09ITApLGV9O1VoKHpoLERoKTt2YXIgTGg9emgucHJvdG90eXBlPURoLnByb3RvdHlwZTtMaC5jb25zdHJ1Y3Rvcj16aDt2YXIgRmg9TGgudG9TdHJpbmcsVmg9IlN5bWJvbCh0ZXN0KSI9PVN0cmluZyhEaCgidGVzdCIpKSxOaD0vXlN5bWJvbFwoKC4qKVwpW14pXSskLztCaChMaCwiZGVzY3JpcHRpb24iLHtjb25maWd1cmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7dmFyIHQ9UGgodGhpcyk/dGhpcy52YWx1ZU9mKCk6dGhpcyxlPUZoLmNhbGwodCk7aWYoUmgoamgsdCkpcmV0dXJuIiI7dmFyIHI9Vmg/ZS5zbGljZSg3LC0xKTplLnJlcGxhY2UoTmgsIiQxIik7cmV0dXJuIiI9PT1yP3ZvaWQgMDpyfX0pLEloKHtnbG9iYWw6ITAsZm9yY2VkOiEwfSx7U3ltYm9sOnpofSl9d2woIml0ZXJhdG9yIik7dmFyIEhoPVl0LEtoPV8sWWg9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscil7dmFyIG4saSxhPVN0cmluZyhLaChlKSksbz1IaChyKSxzPWEubGVuZ3RoO3JldHVybiBvPDB8fG8+PXM/dD8iIjp2b2lkIDA6KG49YS5jaGFyQ29kZUF0KG8pKTw1NTI5Nnx8bj41NjMxOXx8bysxPT09c3x8KGk9YS5jaGFyQ29kZUF0KG8rMSkpPDU2MzIwfHxpPjU3MzQzP3Q/YS5jaGFyQXQobyk6bjp0P2Euc2xpY2UobyxvKzIpOmktNTYzMjArKG4tNTUyOTY8PDEwKSs2NTUzNn19LCRoPXtjb2RlQXQ6WWgoITEpLGNoYXJBdDpZaCghMCl9LFdoPSRoLmNoYXJBdCxHaD11cixxaD1abixYaD0iU3RyaW5nIEl0ZXJhdG9yIixRaD1HaC5zZXQsSmg9R2guZ2V0dGVyRm9yKFhoKTtxaChTdHJpbmcsIlN0cmluZyIsKGZ1bmN0aW9uKHQpe1FoKHRoaXMse3R5cGU6WGgsc3RyaW5nOlN0cmluZyh0KSxpbmRleDowfSl9KSwoZnVuY3Rpb24oKXt2YXIgdCxlPUpoKHRoaXMpLHI9ZS5zdHJpbmcsbj1lLmluZGV4O3JldHVybiBuPj1yLmxlbmd0aD97dmFsdWU6dm9pZCAwLGRvbmU6ITB9Oih0PVdoKHIsbiksZS5pbmRleCs9dC5sZW5ndGgse3ZhbHVlOnQsZG9uZTohMX0pfSkpO3ZhciBaaD1DLHRkPXhmLGVkPXVpLHJkPVosbmQ9TnQsaWQ9bmQoIml0ZXJhdG9yIiksYWQ9bmQoInRvU3RyaW5nVGFnIiksb2Q9ZWQudmFsdWVzO2Zvcih2YXIgc2QgaW4gdGQpe3ZhciB1ZD1aaFtzZF0sY2Q9dWQmJnVkLnByb3RvdHlwZTtpZihjZCl7aWYoY2RbaWRdIT09b2QpdHJ5e3JkKGNkLGlkLG9kKX1jYXRjaChqbSl7Y2RbaWRdPW9kfWlmKGNkW2FkXXx8cmQoY2QsYWQsc2QpLHRkW3NkXSlmb3IodmFyIGZkIGluIGVkKWlmKGNkW2ZkXSE9PWVkW2ZkXSl0cnl7cmQoY2QsZmQsZWRbZmRdKX1jYXRjaChqbSl7Y2RbZmRdPWVkW2ZkXX19fXZhciBsZD1OLGhkPU4sZGQ9ZnVuY3Rpb24odCl7dmFyIGU9dC5yZXR1cm47aWYodm9pZCAwIT09ZSlyZXR1cm4gbGQoZS5jYWxsKHQpKS52YWx1ZX0scGQ9TW8sdmQ9ZnQseWQ9ZnVuY3Rpb24odCxlLHIsbil7dHJ5e3JldHVybiBuP2UoaGQocilbMF0sclsxXSk6ZShyKX1jYXRjaChqbSl7dGhyb3cgZGQodCksam19fSxnZD1PbyxtZD1HdCxiZD10Zix3ZD1BbyxrZD1mdW5jdGlvbih0KXt2YXIgZSxyLG4saSxhLG8scz12ZCh0KSx1PSJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzP3RoaXM6QXJyYXksYz1hcmd1bWVudHMubGVuZ3RoLGY9Yz4xP2FyZ3VtZW50c1sxXTp2b2lkIDAsbD12b2lkIDAhPT1mLGg9d2QocyksZD0wO2lmKGwmJihmPXBkKGYsYz4yP2FyZ3VtZW50c1syXTp2b2lkIDAsMikpLG51bGw9PWh8fHU9PUFycmF5JiZnZChoKSlmb3Iocj1uZXcgdShlPW1kKHMubGVuZ3RoKSk7ZT5kO2QrKylvPWw/ZihzW2RdLGQpOnNbZF0sYmQocixkLG8pO2Vsc2UgZm9yKGE9KGk9aC5jYWxsKHMpKS5uZXh0LHI9bmV3IHU7IShuPWEuY2FsbChpKSkuZG9uZTtkKyspbz1sP3lkKGksZixbbi52YWx1ZSxkXSwhMCk6bi52YWx1ZSxiZChyLGQsbyk7cmV0dXJuIHIubGVuZ3RoPWQscn07Y24oe3RhcmdldDoiQXJyYXkiLHN0YXQ6ITAsZm9yY2VkOiFFaSgoZnVuY3Rpb24odCl7QXJyYXkuZnJvbSh0KX0pKX0se2Zyb206a2R9KTt2YXIgeGQ9Y24sU2Q9QixBZD1MbyxfZD1KdCxUZD1HdCxFZD1PLE9kPXRmLElkPU50LENkPWFmKCJzbGljZSIpLE1kPUlkKCJzcGVjaWVzIiksUmQ9W10uc2xpY2UsUGQ9TWF0aC5tYXg7eGQoe3RhcmdldDoiQXJyYXkiLHByb3RvOiEwLGZvcmNlZDohQ2R9LHtzbGljZTpmdW5jdGlvbih0LGUpe3ZhciByLG4saSxhPUVkKHRoaXMpLG89VGQoYS5sZW5ndGgpLHM9X2QodCxvKSx1PV9kKHZvaWQgMD09PWU/bzplLG8pO2lmKEFkKGEpJiYoImZ1bmN0aW9uIiE9dHlwZW9mKHI9YS5jb25zdHJ1Y3Rvcil8fHIhPT1BcnJheSYmIUFkKHIucHJvdG90eXBlKT9TZChyKSYmbnVsbD09PShyPXJbTWRdKSYmKHI9dm9pZCAwKTpyPXZvaWQgMCxyPT09QXJyYXl8fHZvaWQgMD09PXIpKXJldHVybiBSZC5jYWxsKGEscyx1KTtmb3Iobj1uZXcodm9pZCAwPT09cj9BcnJheTpyKShQZCh1LXMsMCkpLGk9MDtzPHU7cysrLGkrKylzIGluIGEmJk9kKG4saSxhW3NdKTtyZXR1cm4gbi5sZW5ndGg9aSxufX0pO3ZhciBCZD1SLFVkPVAuZixEZD1GdW5jdGlvbi5wcm90b3R5cGUsamQ9RGQudG9TdHJpbmcsemQ9L15ccypmdW5jdGlvbiAoW14gKF0qKS8sTGQ9Im5hbWUiO0JkJiYhKExkIGluIERkKSYmVWQoRGQsTGQse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIGpkLmNhbGwodGhpcykubWF0Y2goemQpWzFdfWNhdGNoKGptKXtyZXR1cm4iIn19fSk7dmFyIEZkPU4sVmQ9ZnVuY3Rpb24oKXt2YXIgdD1GZCh0aGlzKSxlPSIiO3JldHVybiB0Lmdsb2JhbCYmKGUrPSJnIiksdC5pZ25vcmVDYXNlJiYoZSs9ImkiKSx0Lm11bHRpbGluZSYmKGUrPSJtIiksdC5kb3RBbGwmJihlKz0icyIpLHQudW5pY29kZSYmKGUrPSJ1IiksdC5zdGlja3kmJihlKz0ieSIpLGV9LE5kPXt9LEhkPWI7ZnVuY3Rpb24gS2QodCxlKXtyZXR1cm4gUmVnRXhwKHQsZSl9TmQuVU5TVVBQT1JURURfWT1IZCgoZnVuY3Rpb24oKXt2YXIgdD1LZCgiYSIsInkiKTtyZXR1cm4gdC5sYXN0SW5kZXg9MixudWxsIT10LmV4ZWMoImFiY2QiKX0pKSxOZC5CUk9LRU5fQ0FSRVQ9SGQoKGZ1bmN0aW9uKCl7dmFyIHQ9S2QoIl5yIiwiZ3kiKTtyZXR1cm4gdC5sYXN0SW5kZXg9MixudWxsIT10LmV4ZWMoInN0ciIpfSkpO3ZhciBZZCwkZCxXZD1WZCxHZD1OZCxxZD1NLmV4cG9ydHMsWGQ9UmVnRXhwLnByb3RvdHlwZS5leGVjLFFkPXFkKCJuYXRpdmUtc3RyaW5nLXJlcGxhY2UiLFN0cmluZy5wcm90b3R5cGUucmVwbGFjZSksSmQ9WGQsWmQ9KFlkPS9hLywkZD0vYiovZyxYZC5jYWxsKFlkLCJhIiksWGQuY2FsbCgkZCwiYSIpLDAhPT1ZZC5sYXN0SW5kZXh8fDAhPT0kZC5sYXN0SW5kZXgpLHRwPUdkLlVOU1VQUE9SVEVEX1l8fEdkLkJST0tFTl9DQVJFVCxlcD12b2lkIDAhPT0vKCk/Py8uZXhlYygiIilbMV07KFpkfHxlcHx8dHApJiYoSmQ9ZnVuY3Rpb24odCl7dmFyIGUscixuLGksYT10aGlzLG89dHAmJmEuc3RpY2t5LHM9V2QuY2FsbChhKSx1PWEuc291cmNlLGM9MCxmPXQ7cmV0dXJuIG8mJigtMT09PShzPXMucmVwbGFjZSgieSIsIiIpKS5pbmRleE9mKCJnIikmJihzKz0iZyIpLGY9U3RyaW5nKHQpLnNsaWNlKGEubGFzdEluZGV4KSxhLmxhc3RJbmRleD4wJiYoIWEubXVsdGlsaW5lfHxhLm11bHRpbGluZSYmIlxuIiE9PXRbYS5sYXN0SW5kZXgtMV0pJiYodT0iKD86ICIrdSsiKSIsZj0iICIrZixjKyspLHI9bmV3IFJlZ0V4cCgiXig/OiIrdSsiKSIscykpLGVwJiYocj1uZXcgUmVnRXhwKCJeIit1KyIkKD8hXFxzKSIscykpLFpkJiYoZT1hLmxhc3RJbmRleCksbj1YZC5jYWxsKG8/cjphLGYpLG8/bj8obi5pbnB1dD1uLmlucHV0LnNsaWNlKGMpLG5bMF09blswXS5zbGljZShjKSxuLmluZGV4PWEubGFzdEluZGV4LGEubGFzdEluZGV4Kz1uWzBdLmxlbmd0aCk6YS5sYXN0SW5kZXg9MDpaZCYmbiYmKGEubGFzdEluZGV4PWEuZ2xvYmFsP24uaW5kZXgrblswXS5sZW5ndGg6ZSksZXAmJm4mJm4ubGVuZ3RoPjEmJlFkLmNhbGwoblswXSxyLChmdW5jdGlvbigpe2ZvcihpPTE7aTxhcmd1bWVudHMubGVuZ3RoLTI7aSsrKXZvaWQgMD09PWFyZ3VtZW50c1tpXSYmKG5baV09dm9pZCAwKX0pKSxufSk7dmFyIHJwPUpkO2Z1bmN0aW9uIG5wKHQsZSl7aWYoISh0IGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9ZnVuY3Rpb24gaXAodCxlKXtmb3IodmFyIHI9MDtyPGUubGVuZ3RoO3IrKyl7dmFyIG49ZVtyXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LG4ua2V5LG4pfX1mdW5jdGlvbiBhcCh0LGUscil7cmV0dXJuIGUmJmlwKHQucHJvdG90eXBlLGUpLHImJmlwKHQsciksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksdH1mdW5jdGlvbiBvcCh0LGUscil7cmV0dXJuIGUgaW4gdD9PYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHt2YWx1ZTpyLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6dFtlXT1yLHR9ZnVuY3Rpb24gc3AodCxlKXtyZXR1cm4gZnVuY3Rpb24odCl7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gdH0odCl8fGZ1bmN0aW9uKHQsZSl7dmFyIHI9bnVsbD09dD9udWxsOiJ1bmRlZmluZWQiIT10eXBlb2YgU3ltYm9sJiZ0W1N5bWJvbC5pdGVyYXRvcl18fHRbIkBAaXRlcmF0b3IiXTtpZihudWxsPT1yKXJldHVybjt2YXIgbixpLGE9W10sbz0hMCxzPSExO3RyeXtmb3Iocj1yLmNhbGwodCk7IShvPShuPXIubmV4dCgpKS5kb25lKSYmKGEucHVzaChuLnZhbHVlKSwhZXx8YS5sZW5ndGghPT1lKTtvPSEwKTt9Y2F0Y2godSl7cz0hMCxpPXV9ZmluYWxseXt0cnl7b3x8bnVsbD09ci5yZXR1cm58fHIucmV0dXJuKCl9ZmluYWxseXtpZihzKXRocm93IGl9fXJldHVybiBhfSh0LGUpfHxjcCh0LGUpfHxmdW5jdGlvbigpe3Rocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIil9KCl9ZnVuY3Rpb24gdXAodCl7cmV0dXJuIGZ1bmN0aW9uKHQpe2lmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuIGZwKHQpfSh0KXx8ZnVuY3Rpb24odCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJm51bGwhPXRbU3ltYm9sLml0ZXJhdG9yXXx8bnVsbCE9dFsiQEBpdGVyYXRvciJdKXJldHVybiBBcnJheS5mcm9tKHQpfSh0KXx8Y3AodCl8fGZ1bmN0aW9uKCl7dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIil9KCl9ZnVuY3Rpb24gY3AodCxlKXtpZih0KXtpZigic3RyaW5nIj09dHlwZW9mIHQpcmV0dXJuIGZwKHQsZSk7dmFyIHI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpLnNsaWNlKDgsLTEpO3JldHVybiJPYmplY3QiPT09ciYmdC5jb25zdHJ1Y3RvciYmKHI9dC5jb25zdHJ1Y3Rvci5uYW1lKSwiTWFwIj09PXJ8fCJTZXQiPT09cj9BcnJheS5mcm9tKHQpOiJBcmd1bWVudHMiPT09cnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qocik/ZnAodCxlKTp2b2lkIDB9fWZ1bmN0aW9uIGZwKHQsZSl7KG51bGw9PWV8fGU+dC5sZW5ndGgpJiYoZT10Lmxlbmd0aCk7Zm9yKHZhciByPTAsbj1uZXcgQXJyYXkoZSk7cjxlO3IrKyluW3JdPXRbcl07cmV0dXJuIG59Y24oe3RhcmdldDoiUmVnRXhwIixwcm90bzohMCxmb3JjZWQ6Ly4vLmV4ZWMhPT1ycH0se2V4ZWM6cnB9KTt2YXIgbHA9InZpZGVvIixocD0iYXVkaW8iLGRwPSJtZXRhZGF0YSIscHA9ImF2YyIsdnA9ImhldmMiLHlwPSJhYWMiLGdwPSJnNzExMGEiLG1wPSJnNzExMG0iLGJwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe25wKHRoaXMsdCksb3AodGhpcywiaWQiLDEpLG9wKHRoaXMsInR5cGUiLGxwKSxvcCh0aGlzLCJjb2RlY1R5cGUiLHBwKSxvcCh0aGlzLCJwaWQiLC0xKSxvcCh0aGlzLCJodmNDIix2b2lkIDApLG9wKHRoaXMsImNvZGVjIiwiIiksb3AodGhpcywidGltZXNjYWxlIiwwKSxvcCh0aGlzLCJmb3JtYXRUaW1lc2NhbGUiLDApLG9wKHRoaXMsInNlcXVlbmNlTnVtYmVyIiwwKSxvcCh0aGlzLCJiYXNlTWVkaWFEZWNvZGVUaW1lIiwwKSxvcCh0aGlzLCJiYXNlRHRzIiwwKSxvcCh0aGlzLCJkdXJhdGlvbiIsMCksb3AodGhpcywid2FybmluZ3MiLFtdKSxvcCh0aGlzLCJzYW1wbGVzIixbXSksb3AodGhpcywicHBzIixbXSksb3AodGhpcywic3BzIixbXSksb3AodGhpcywidnBzIixbXSksb3AodGhpcywiZnBzTnVtIiwwKSxvcCh0aGlzLCJmcHNEZW4iLDApLG9wKHRoaXMsInNhclJhdGlvIixbXSksb3AodGhpcywid2lkdGgiLDApLG9wKHRoaXMsImhlaWdodCIsMCksb3AodGhpcywibmFsVW5pdFNpemUiLDQpLG9wKHRoaXMsInByZXNlbnQiLCExKSxvcCh0aGlzLCJpc1ZpZGVvRW5jcnlwdGlvbiIsITEpLG9wKHRoaXMsImlzQXVkaW9FbmNyeXB0aW9uIiwhMSksb3AodGhpcywiaXNWaWRlbyIsITApLG9wKHRoaXMsImtpZCIsbnVsbCksb3AodGhpcywicHNzaCIsbnVsbCksb3AodGhpcywiZXh0Iix2b2lkIDApfXJldHVybiBhcCh0LFt7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNlcXVlbmNlTnVtYmVyPXRoaXMud2lkdGg9dGhpcy5oZWlnaHQ9dGhpcy5mcHNEZW49dGhpcy5mcHNOdW09dGhpcy5kdXJhdGlvbj10aGlzLmJhc2VNZWRpYURlY29kZVRpbWU9dGhpcy50aW1lc2NhbGU9MCx0aGlzLmNvZGVjPSIiLHRoaXMucHJlc2VudD0hMSx0aGlzLnBpZD0tMSx0aGlzLnBwcz1bXSx0aGlzLnNwcz1bXSx0aGlzLnZwcz1bXSx0aGlzLnNhclJhdGlvPVtdLHRoaXMuc2FtcGxlcz1bXSx0aGlzLndhcm5pbmdzPVtdLHRoaXMuaHZjQz1udWxsfX0se2tleToiZXhpc3QiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISEodGhpcy5wcHMubGVuZ3RoJiZ0aGlzLnNwcy5sZW5ndGgmJnRoaXMuY29kZWMpfX0se2tleToiaGFzU2FtcGxlIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5zYW1wbGVzLmxlbmd0aH19LHtrZXk6ImlzRW5jcnlwdGlvbiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNWaWRlb0VuY3J5cHRpb259fV0pLHR9KCksd3A9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7bnAodGhpcyx0KSxvcCh0aGlzLCJpZCIsMiksb3AodGhpcywidHlwZSIsaHApLG9wKHRoaXMsImNvZGVjVHlwZSIseXApLG9wKHRoaXMsInBpZCIsLTEpLG9wKHRoaXMsImNvZGVjIiwiIiksb3AodGhpcywic2VxdWVuY2VOdW1iZXIiLDApLG9wKHRoaXMsInNhbXBsZUR1cmF0aW9uIiwwKSxvcCh0aGlzLCJ0aW1lc2NhbGUiLDApLG9wKHRoaXMsImZvcm1hdFRpbWVzY2FsZSIsMCksb3AodGhpcywiYmFzZU1lZGlhRGVjb2RlVGltZSIsMCksb3AodGhpcywiZHVyYXRpb24iLDApLG9wKHRoaXMsIndhcm5pbmdzIixbXSksb3AodGhpcywic2FtcGxlcyIsW10pLG9wKHRoaXMsImJhc2VEdHMiLDApLG9wKHRoaXMsInNhbXBsZVNpemUiLDE2KSxvcCh0aGlzLCJzYW1wbGVSYXRlIiwwKSxvcCh0aGlzLCJjaGFubmVsQ291bnQiLDApLG9wKHRoaXMsIm9iamVjdFR5cGUiLDApLG9wKHRoaXMsInNhbXBsZVJhdGVJbmRleCIsMCksb3AodGhpcywiY29uZmlnIixbXSksb3AodGhpcywicHJlc2VudCIsITEpLG9wKHRoaXMsImlzVmlkZW9FbmNyeXB0aW9uIiwhMSksb3AodGhpcywiaXNBdWRpb0VuY3J5cHRpb24iLCExKSxvcCh0aGlzLCJraWQiLG51bGwpLG9wKHRoaXMsImV4dCIsdm9pZCAwKX1yZXR1cm4gYXAodCxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5zZXF1ZW5jZU51bWJlcj0wLHRoaXMudGltZXNjYWxlPTAsdGhpcy5zYW1wbGVEdXJhdGlvbj0wLHRoaXMuc2FtcGxlUmF0ZT0wLHRoaXMuY2hhbm5lbENvdW50PTAsdGhpcy5iYXNlTWVkaWFEZWNvZGVUaW1lPTAsdGhpcy5wcmVzZW50PSExLHRoaXMucGlkPS0xLHRoaXMuY29kZWM9IiIsdGhpcy5zYW1wbGVzPVtdLHRoaXMuY29uZmlnPVtdLHRoaXMud2FybmluZ3M9W119fSx7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hISh0aGlzLnNhbXBsZVJhdGUmJnRoaXMuY2hhbm5lbENvdW50JiZ0aGlzLmNvZGVjJiZ0aGlzLmNvZGVjVHlwZT09PXlwKX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuc2FtcGxlcy5sZW5ndGh9fSx7a2V5OiJpc0VuY3J5cHRpb24iLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQXVkaW9FbmNyeXB0aW9ufX1dKSx0fSgpLGtwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHIsbil7bnAodGhpcyx0KSxvcCh0aGlzLCJmbGFnIix7fSksb3AodGhpcywia2V5ZnJhbWUiLCExKSxvcCh0aGlzLCJnb3BJZCIsMCksb3AodGhpcywiZHVyYXRpb24iLDApLG9wKHRoaXMsInNpemUiLDApLG9wKHRoaXMsInVuaXRzIixbXSksb3AodGhpcywiY2hyb21hRm9ybWF0Iiw0MjApLHRoaXMub3JpZ2luUHRzPXRoaXMucHRzPWUsdGhpcy5vcmlnaW5EdHM9dGhpcy5kdHM9cixuJiYodGhpcy51bml0cz1uKX1yZXR1cm4gYXAodCxbe2tleToiY3RzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMtdGhpcy5kdHN9fSx7a2V5OiJzZXRUb0tleWZyYW1lIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMua2V5ZnJhbWU9ITAsdGhpcy5mbGFnLmRlcGVuZHNPbj0yLHRoaXMuZmxhZy5pc05vblN5bmNTYW1wbGU9MH19XSksdH0oKSx4cD1hcCgoZnVuY3Rpb24gdChlLHIsbixpKXtucCh0aGlzLHQpLG9wKHRoaXMsImR1cmF0aW9uIiwxMDI0KSxvcCh0aGlzLCJmbGFnIix7ZGVwZW5kc09uOjIsaXNOb25TeW5jU2FtcGxlOjB9KSxvcCh0aGlzLCJrZXlmcmFtZSIsITApLHRoaXMub3JpZ2luUHRzPXRoaXMucHRzPXRoaXMuZHRzPWUsdGhpcy5kYXRhPXIsdGhpcy5zaXplPXIuYnl0ZUxlbmd0aCx0aGlzLnNhbXBsZU9mZnNldD1pLG4mJih0aGlzLmR1cmF0aW9uPW4pfSkpLFNwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe25wKHRoaXMsdCksb3AodGhpcywiaWQiLDMpLG9wKHRoaXMsInR5cGUiLGRwKSxvcCh0aGlzLCJ0aW1lc2NhbGUiLDApLG9wKHRoaXMsImZsdlNjcmlwdFNhbXBsZXMiLFtdKSxvcCh0aGlzLCJzZWlTYW1wbGVzIixbXSl9cmV0dXJuIGFwKHQsW3trZXk6ImV4aXN0Iix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEoIXRoaXMuZmx2U2NyaXB0U2FtcGxlcy5sZW5ndGgmJiF0aGlzLnNlaVNhbXBsZXMubGVuZ3RofHwhdGhpcy50aW1lc2NhbGUpfX0se2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy50aW1lc2NhbGU9MCx0aGlzLmZsdlNjcmlwdFNhbXBsZXM9W10sdGhpcy5zZWlTYW1wbGVzPVtdfX0se2tleToiaGFzU2FtcGxlIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEoIXRoaXMuZmx2U2NyaXB0U2FtcGxlcy5sZW5ndGgmJiF0aGlzLnNlaVNhbXBsZXMubGVuZ3RoKX19XSksdH0oKSxBcD1fLF9wPSJbXHRcblx2XGZcciDCoOGagOKAgOKAgeKAguKAg+KAhOKAheKAhuKAh+KAiOKAieKAiuKAr+KBn+OAgFx1MjAyOFx1MjAyOVx1ZmVmZl0iLFRwPVJlZ0V4cCgiXiIrX3ArX3ArIioiKSxFcD1SZWdFeHAoX3ArX3ArIiokIiksT3A9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciByPVN0cmluZyhBcChlKSk7cmV0dXJuIDEmdCYmKHI9ci5yZXBsYWNlKFRwLCIiKSksMiZ0JiYocj1yLnJlcGxhY2UoRXAsIiIpKSxyfX0sSXA9e3N0YXJ0Ok9wKDEpLGVuZDpPcCgyKSx0cmltOk9wKDMpfSxDcD1SLE1wPUMsUnA9dG4sUHA9eHIuZXhwb3J0cyxCcD1kdCxVcD1rLERwPWFzLGpwPUssenA9YixMcD1QZSxGcD1Nci5mLFZwPWNyLmYsTnA9UC5mLEhwPUlwLnRyaW0sS3A9Ik51bWJlciIsWXA9TXAuTnVtYmVyLCRwPVlwLnByb3RvdHlwZSxXcD1VcChMcCgkcCkpPT1LcCxHcD1mdW5jdGlvbih0KXt2YXIgZSxyLG4saSxhLG8scyx1LGM9anAodCwhMSk7aWYoInN0cmluZyI9PXR5cGVvZiBjJiZjLmxlbmd0aD4yKWlmKDQzPT09KGU9KGM9SHAoYykpLmNoYXJDb2RlQXQoMCkpfHw0NT09PWUpe2lmKDg4PT09KHI9Yy5jaGFyQ29kZUF0KDIpKXx8MTIwPT09cilyZXR1cm4gTmFOfWVsc2UgaWYoNDg9PT1lKXtzd2l0Y2goYy5jaGFyQ29kZUF0KDEpKXtjYXNlIDY2OmNhc2UgOTg6bj0yLGk9NDk7YnJlYWs7Y2FzZSA3OTpjYXNlIDExMTpuPTgsaT01NTticmVhaztkZWZhdWx0OnJldHVybitjfWZvcihvPShhPWMuc2xpY2UoMikpLmxlbmd0aCxzPTA7czxvO3MrKylpZigodT1hLmNoYXJDb2RlQXQocykpPDQ4fHx1PmkpcmV0dXJuIE5hTjtyZXR1cm4gcGFyc2VJbnQoYSxuKX1yZXR1cm4rY307aWYoUnAoS3AsIVlwKCIgMG8xIil8fCFZcCgiMGIxIil8fFlwKCIrMHgxIikpKXtmb3IodmFyIHFwLFhwPWZ1bmN0aW9uKHQpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg8MT8wOnQscj10aGlzO3JldHVybiByIGluc3RhbmNlb2YgWHAmJihXcD96cCgoZnVuY3Rpb24oKXskcC52YWx1ZU9mLmNhbGwocil9KSk6VXAocikhPUtwKT9EcChuZXcgWXAoR3AoZSkpLHIsWHApOkdwKGUpfSxRcD1DcD9GcChZcCk6Ik1BWF9WQUxVRSxNSU5fVkFMVUUsTmFOLE5FR0FUSVZFX0lORklOSVRZLFBPU0lUSVZFX0lORklOSVRZLEVQU0lMT04saXNGaW5pdGUsaXNJbnRlZ2VyLGlzTmFOLGlzU2FmZUludGVnZXIsTUFYX1NBRkVfSU5URUdFUixNSU5fU0FGRV9JTlRFR0VSLHBhcnNlRmxvYXQscGFyc2VJbnQsaXNJbnRlZ2VyLGZyb21TdHJpbmcscmFuZ2UiLnNwbGl0KCIsIiksSnA9MDtRcC5sZW5ndGg+SnA7SnArKylCcChZcCxxcD1RcFtKcF0pJiYhQnAoWHAscXApJiZOcChYcCxxcCxWcChZcCxxcCkpO1hwLnByb3RvdHlwZT0kcCwkcC5jb25zdHJ1Y3Rvcj1YcCxQcChNcCxLcCxYcCl9dmFyIFpwPWNuLHR2PUp0LGV2PVl0LHJ2PUd0LG52PWZ0LGl2PUhvLGF2PXRmLG92PWFmKCJzcGxpY2UiKSxzdj1NYXRoLm1heCx1dj1NYXRoLm1pbixjdj05MDA3MTk5MjU0NzQwOTkxLGZ2PSJNYXhpbXVtIGFsbG93ZWQgbGVuZ3RoIGV4Y2VlZGVkIjtacCh7dGFyZ2V0OiJBcnJheSIscHJvdG86ITAsZm9yY2VkOiFvdn0se3NwbGljZTpmdW5jdGlvbih0LGUpe3ZhciByLG4saSxhLG8scyx1PW52KHRoaXMpLGM9cnYodS5sZW5ndGgpLGY9dHYodCxjKSxsPWFyZ3VtZW50cy5sZW5ndGg7aWYoMD09PWw/cj1uPTA6MT09PWw/KHI9MCxuPWMtZik6KHI9bC0yLG49dXYoc3YoZXYoZSksMCksYy1mKSksYytyLW4+Y3YpdGhyb3cgVHlwZUVycm9yKGZ2KTtmb3IoaT1pdih1LG4pLGE9MDthPG47YSsrKShvPWYrYSlpbiB1JiZhdihpLGEsdVtvXSk7aWYoaS5sZW5ndGg9bixyPG4pe2ZvcihhPWY7YTxjLW47YSsrKXM9YStyLChvPWErbilpbiB1P3Vbc109dVtvXTpkZWxldGUgdVtzXTtmb3IoYT1jO2E+Yy1uK3I7YS0tKWRlbGV0ZSB1W2EtMV19ZWxzZSBpZihyPm4pZm9yKGE9Yy1uO2E+ZjthLS0pcz1hK3ItMSwobz1hK24tMSlpbiB1P3Vbc109dVtvXTpkZWxldGUgdVtzXTtmb3IoYT0wO2E8cjthKyspdVthK2ZdPWFyZ3VtZW50c1thKzJdO3JldHVybiB1Lmxlbmd0aD1jLW4rcixpfX0pO3ZhciBsdj1HdCxodj1ZdCxkdj1uYS5hVHlwZWRBcnJheTsoMCxuYS5leHBvcnRUeXBlZEFycmF5TWV0aG9kKSgiYXQiLChmdW5jdGlvbih0KXt2YXIgZT1kdih0aGlzKSxyPWx2KGUubGVuZ3RoKSxuPWh2KHQpLGk9bj49MD9uOnIrbjtyZXR1cm4gaTwwfHxpPj1yP3ZvaWQgMDplW2ldfSkpO3ZhciBwdj1Nbyx2dj1BLHl2PWZ0LGd2PUd0LG12PWZ1bmN0aW9uKHQpe3ZhciBlPTY9PXQ7cmV0dXJuIGZ1bmN0aW9uKHIsbixpKXtmb3IodmFyIGEsbz15dihyKSxzPXZ2KG8pLHU9cHYobixpLDMpLGM9Z3Yocy5sZW5ndGgpO2MtLSA+MDspaWYodShhPXNbY10sYyxvKSlzd2l0Y2godCl7Y2FzZSA1OnJldHVybiBhO2Nhc2UgNjpyZXR1cm4gY31yZXR1cm4gZT8tMTp2b2lkIDB9fSxidj17ZmluZExhc3Q6bXYoNSksZmluZExhc3RJbmRleDptdig2KX0sd3Y9YnYuZmluZExhc3Qsa3Y9bmEuYVR5cGVkQXJyYXk7KDAsbmEuZXhwb3J0VHlwZWRBcnJheU1ldGhvZCkoImZpbmRMYXN0IiwoZnVuY3Rpb24odCl7cmV0dXJuIHd2KGt2KHRoaXMpLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciB4dj1idi5maW5kTGFzdEluZGV4LFN2PW5hLmFUeXBlZEFycmF5OygwLG5hLmV4cG9ydFR5cGVkQXJyYXlNZXRob2QpKCJmaW5kTGFzdEluZGV4IiwoZnVuY3Rpb24odCl7cmV0dXJuIHh2KFN2KHRoaXMpLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfSkpO3ZhciBBdj14ci5leHBvcnRzLF92PU4sVHY9YixFdj1WZCxPdj0idG9TdHJpbmciLEl2PVJlZ0V4cC5wcm90b3R5cGUsQ3Y9SXYudG9TdHJpbmcsTXY9VHYoKGZ1bmN0aW9uKCl7cmV0dXJuIi9hL2IiIT1Ddi5jYWxsKHtzb3VyY2U6ImEiLGZsYWdzOiJiIn0pfSkpLFJ2PUN2Lm5hbWUhPU92OyhNdnx8UnYpJiZBdihSZWdFeHAucHJvdG90eXBlLE92LChmdW5jdGlvbigpe3ZhciB0PV92KHRoaXMpLGU9U3RyaW5nKHQuc291cmNlKSxyPXQuZmxhZ3M7cmV0dXJuIi8iK2UrIi8iK1N0cmluZyh2b2lkIDA9PT1yJiZ0IGluc3RhbmNlb2YgUmVnRXhwJiYhKCJmbGFncyJpbiBJdik/RXYuY2FsbCh0KTpyKX0pLHt1bnNhZmU6ITB9KTt2YXIgUHY9Y24sQnY9TyxVdj1bXS5qb2luLER2PUEhPU9iamVjdCxqdj1ZdSgiam9pbiIsIiwiKTtQdih7dGFyZ2V0OiJBcnJheSIscHJvdG86ITAsZm9yY2VkOkR2fHwhanZ9LHtqb2luOmZ1bmN0aW9uKHQpe3JldHVybiBVdi5jYWxsKEJ2KHRoaXMpLHZvaWQgMD09PXQ/IiwiOnQpfX0pO3ZhciB6dixMdixGdj1jbixWdj1CLE52PSh6dj0hMSwoTHY9L1thY10vKS5leGVjPWZ1bmN0aW9uKCl7cmV0dXJuIHp2PSEwLC8uLy5leGVjLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sITA9PT1Mdi50ZXN0KCJhYmMiKSYmenYpLEh2PS8uLy50ZXN0O0Z2KHt0YXJnZXQ6IlJlZ0V4cCIscHJvdG86ITAsZm9yY2VkOiFOdn0se3Rlc3Q6ZnVuY3Rpb24odCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHRoaXMuZXhlYylyZXR1cm4gSHYuY2FsbCh0aGlzLHQpO3ZhciBlPXRoaXMuZXhlYyh0KTtpZihudWxsIT09ZSYmIVZ2KGUpKXRocm93IG5ldyBFcnJvcigiUmVnRXhwIGV4ZWMgbWV0aG9kIHJldHVybmVkIHNvbWV0aGluZyBvdGhlciB0aGFuIGFuIE9iamVjdCBvciBudWxsIik7cmV0dXJuISFlfX0pO3ZhciBLdj0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyxZdj1LdiYmbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvY2FsZUxvd2VyQ2FzZSgpO0t2JiYvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvLnRlc3QoWXYpO3ZhciAkdj1LdiYmWXYuaW5jbHVkZXMoImZpcmVmb3giKSxXdj1LdiYmWXYuaW5jbHVkZXMoImFuZHJvaWQiKSxHdj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtucCh0aGlzLHQpfXJldHVybiBhcCh0LG51bGwsW3trZXk6ImdldFJhdGVJbmRleEJ5UmF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuRlJFUS5pbmRleE9mKGUpfX0se2tleToicGFyc2VBRFRTIix2YWx1ZTpmdW5jdGlvbihlLHIpe2Zvcih2YXIgbj1lLmxlbmd0aCxpPTA7aSsyPG4mJigyNTUhPT1lW2ldfHwyNDAhPSgyNDYmZVtpKzFdKSk7KWkrKztpZighKGk+PW4pKXt2YXIgYT1pLG89W10scz0oNjAmZVtpKzJdKT4+PjIsdT10LkZSRVFbc107aWYoIXUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHNhbXBsaW5nIGluZGV4OiAiLmNvbmNhdChzKSk7Zm9yKHZhciBjLGYsbD0xKygoMTkyJmVbaSsyXSk+Pj42KSxoPSgxJmVbaSsyXSk8PDJ8KDE5MiZlW2krM10pPj4+NixkPXQuX2dldENvbmZpZyhzLGgsbCkscD1kLmNvbmZpZyx2PWQuY29kZWMseT0wLGc9dC5nZXRGcmFtZUR1cmF0aW9uKHUpO2krNzxuOylpZigyNTU9PT1lW2ldJiYyNDA9PSgyNDYmZVtpKzFdKSl7aWYobi1pPChmPSgzJmVbaSszXSk8PDExfGVbaSs0XTw8M3woMjI0JmVbaSs1XSk+PjUpKWJyZWFrO2M9MiooMSZ+ZVtpKzFdKSxvLnB1c2goe3B0czpyK3kqZyxkYXRhOmUuc3ViYXJyYXkoaSs3K2MsaStmKX0pLHkrKyxpKz1mfWVsc2UgaSsrO3JldHVybntza2lwOmEscmVtYWluaW5nOmk+PW4/dm9pZCAwOmUuc3ViYXJyYXkoaSksZnJhbWVzOm8sc2FtcGxpbmdGcmVxdWVuY3lJbmRleDpzLHNhbXBsZVJhdGU6dSxvYmplY3RUeXBlOmwsY2hhbm5lbENvdW50OmgsY29kZWM6dixjb25maWc6cCxvcmlnaW5Db2RlYzoibXA0YS40MC4iLmNvbmNhdChsKX19fX0se2tleToicGFyc2VBdWRpb1NwZWNpZmljQ29uZmlnIix2YWx1ZTpmdW5jdGlvbihlKXtpZihlLmxlbmd0aCl7dmFyIHI9ZVswXT4+PjMsbj0oNyZlWzBdKTw8MXxlWzFdPj4+NyxpPSgxMjAmZVsxXSk+Pj4zLGE9dC5GUkVRW25dO2lmKGEpe3ZhciBvPXQuX2dldENvbmZpZyhuLGkscik7cmV0dXJue3NhbXBsaW5nRnJlcXVlbmN5SW5kZXg6bixzYW1wbGVSYXRlOmEsb2JqZWN0VHlwZTpyLGNoYW5uZWxDb3VudDppLGNvbmZpZzpvLmNvbmZpZyxjb2RlYzpvLmNvZGVjLG9yaWdpbkNvZGVjOiJtcDRhLjQwLiIuY29uY2F0KHIpfX19fX0se2tleToiZ2V0RnJhbWVEdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjllNDtyZXR1cm4gMTAyNCplL3R9fSx7a2V5OiJfZ2V0Q29uZmlnIix2YWx1ZTpmdW5jdGlvbih0LGUscil7dmFyIG4saSxhPVtdO3JldHVybiAkdj90Pj02PyhuPTUsaT10LTMpOihuPTIsaT10KTpXdj8obj0yLGk9dCk6KG49Mj09PXJ8fDU9PT1yP3I6NSxpPXQsdD49Nj9pPXQtMzoxPT09ZSYmKG49MixpPXQpKSxhWzBdPW48PDMsYVswXXw9KDE0JnQpPj4xLGFbMV09KDEmdCk8PDcsYVsxXXw9ZTw8Myw1PT09biYmKGFbMV18PSgxNCZpKT4+MSxhWzJdPSgxJmkpPDw3LGFbMl18PTgsYVszXT0wKSx7Y29uZmlnOmEsY29kZWM6Im1wNGEuNDAuIi5jb25jYXQobil9fX0se2tleToiZ2V0U2lsZW50RnJhbWUiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7aWYoIm1wNGEuNDAuMiI9PT10KXtpZigxPT09ZSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDM1LDEyOF0pO2lmKDI9PT1lKXJldHVybiBuZXcgVWludDhBcnJheShbMzMsMCw3MywxNDQsMiwyNSwwLDM1LDEyOF0pO2lmKDM9PT1lKXJldHVybiBuZXcgVWludDhBcnJheShbMCwyMDAsMCwxMjgsMzIsMTMyLDEsMzgsNjQsOCwxMDAsMCwxNDJdKTtpZig0PT09ZSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDMyLDEzMiwxLDM4LDY0LDgsMTAwLDAsMTI4LDQ0LDEyOCw4LDIsNTZdKTtpZig1PT09ZSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDMyLDEzMiwxLDM4LDY0LDgsMTAwLDAsMTMwLDQ4LDQsMTUzLDAsMzMsMTQ0LDIsNTZdKTtpZig2PT09ZSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDMyLDEzMiwxLDM4LDY0LDgsMTAwLDAsMTMwLDQ4LDQsMTUzLDAsMzMsMTQ0LDIsMCwxNzgsMCwzMiw4LDIyNF0pfWVsc2V7aWYoMT09PWUpcmV0dXJuIG5ldyBVaW50OEFycmF5KFsxLDY0LDM0LDEyOCwxNjMsNzgsMjMwLDEyOCwxODYsOCwwLDAsMCwyOCw2LDI0MSwxOTMsMTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTRdKTtpZigyPT09ZSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzEsNjQsMzQsMTI4LDE2Myw5NCwyMzAsMTI4LDE4Niw4LDAsMCwwLDAsMTQ5LDAsNiwyNDEsMTYxLDEwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDk0XSk7aWYoMz09PWUpcmV0dXJuIG5ldyBVaW50OEFycmF5KFsxLDY0LDM0LDEyOCwxNjMsOTQsMjMwLDEyOCwxODYsOCwwLDAsMCwwLDE0OSwwLDYsMjQxLDE2MSwxMCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5NF0pfX19XSksdH0oKTtmdW5jdGlvbiBxdigpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLGU9bmV3IEFycmF5KHQpLHI9MDtyPHQ7cisrKWVbcl09YXJndW1lbnRzW3JdO2U9ZS5maWx0ZXIoQm9vbGVhbik7dmFyIG49bmV3IFVpbnQ4QXJyYXkoZS5yZWR1Y2UoKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZS5ieXRlTGVuZ3RofSksMCkpLGk9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbih0KXtuLnNldCh0LGkpLGkrPXQuYnl0ZUxlbmd0aH0pKSxufW9wKEd2LCJGUkVRIixbOTZlMyw4ODIwMCw2NGUzLDQ4ZTMsNDQxMDAsMzJlMywyNGUzLDIyMDUwLDE2ZTMsMTJlMywxMTAyNSw4ZTMsNzM1MF0pO3ZhciBYdj1NYXRoLnBvdygyLDMyKTtmdW5jdGlvbiBRdih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4odFtlXTw8OCkrKHRbZSsxXXx8MCl9ZnVuY3Rpb24gSnYodCl7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjA7cmV0dXJuKHRbZV08PDI0Pj4+MCkrKHRbZSsxXTw8MTYpKyh0W2UrMl08PDgpKyh0W2UrM118fDApfWZ1bmN0aW9uIFp2KHQpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTowO3JldHVybiBKdih0LGUpKlh2K0p2KHQsZSs0KX1mdW5jdGlvbiB0eSh0KXt2YXIgZT0iIjtpZih0LmZvckVhY2goKGZ1bmN0aW9uKHQpe2UrPWZ1bmN0aW9uKHQpe3JldHVybigiMCIrTnVtYmVyKHQpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpLnRvVXBwZXJDYXNlKCl9KHQpfSkpLGUubGVuZ3RoPD0zMilmb3IodmFyIHI9MzItZS5sZW5ndGgsbj0wO248cjtuKyspZSs9IjAiO3JldHVybiBlfWZ1bmN0aW9uIGV5KHQpe2lmKCFBcnJheS5pc0FycmF5KHQpKXtmb3IodmFyIGU9W10scj0iIixuPTA7bjx0Lmxlbmd0aDtuKyspbiUyJiYocj10W24tMV0rdFtuXSxlLnB1c2gocGFyc2VJbnQociwxNikpLHI9IiIpO3JldHVybiBlfXJldHVybiB0Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlSW50KHQsMTYpfSkpfXZhciByeT1mdCxueT1kZTtjbih7dGFyZ2V0OiJPYmplY3QiLHN0YXQ6ITAsZm9yY2VkOmIoKGZ1bmN0aW9uKCl7bnkoMSl9KSl9LHtrZXlzOmZ1bmN0aW9uKHQpe3JldHVybiBueShyeSh0KSl9fSk7dmFyIGl5PVIsYXk9UCxveT1WZCxzeT1OZC5VTlNVUFBPUlRFRF9ZO2l5JiYoImciIT0vLi9nLmZsYWdzfHxzeSkmJmF5LmYoUmVnRXhwLnByb3RvdHlwZSwiZmxhZ3MiLHtjb25maWd1cmFibGU6ITAsZ2V0Om95fSk7dmFyIHV5PVl0LGN5PV8sZnk9R3QsbHk9ZnVuY3Rpb24odCl7dmFyIGU9U3RyaW5nKGN5KHRoaXMpKSxyPSIiLG49dXkodCk7aWYobjwwfHxuPT0xLzApdGhyb3cgUmFuZ2VFcnJvcigiV3JvbmcgbnVtYmVyIG9mIHJlcGV0aXRpb25zIik7Zm9yKDtuPjA7KG4+Pj49MSkmJihlKz1lKSkxJm4mJihyKz1lKTtyZXR1cm4gcn0saHk9XyxkeT1NYXRoLmNlaWwscHk9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscixuKXt2YXIgaSxhLG89U3RyaW5nKGh5KGUpKSxzPW8ubGVuZ3RoLHU9dm9pZCAwPT09bj8iICI6U3RyaW5nKG4pLGM9Znkocik7cmV0dXJuIGM8PXN8fCIiPT11P286KGk9Yy1zLChhPWx5LmNhbGwodSxkeShpL3UubGVuZ3RoKSkpLmxlbmd0aD5pJiYoYT1hLnNsaWNlKDAsaSkpLHQ/bythOmErbyl9fSx2eT17c3RhcnQ6cHkoITEpLGVuZDpweSghMCl9LHl5PS9WZXJzaW9uXC8xMCg/OlwuXGQrKXsxLDJ9KD86IFtcdy4vXSspPyg/OiBNb2JpbGVcL1x3Kyk/IFNhZmFyaVwvLy50ZXN0KHh0KSxneT12eS5zdGFydDtjbih7dGFyZ2V0OiJTdHJpbmciLHByb3RvOiEwLGZvcmNlZDp5eX0se3BhZFN0YXJ0OmZ1bmN0aW9uKHQpe3JldHVybiBneSh0aGlzLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfX0pO3ZhciBteT1jbixieT1Rby5maW5kLHd5PXplLGt5PSJmaW5kIix4eT0hMDtreSBpbltdJiZBcnJheSgxKS5maW5kKChmdW5jdGlvbigpe3h5PSExfSkpLG15KHt0YXJnZXQ6IkFycmF5Iixwcm90bzohMCxmb3JjZWQ6eHl9LHtmaW5kOmZ1bmN0aW9uKHQpe3JldHVybiBieSh0aGlzLHQsYXJndW1lbnRzLmxlbmd0aD4xP2FyZ3VtZW50c1sxXTp2b2lkIDApfX0pLHd5KGt5KTt2YXIgU3k9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7bnAodGhpcyx0KX1yZXR1cm4gYXAodCxudWxsLFt7a2V5OiJmaW5kQm94Iix2YWx1ZTpmdW5jdGlvbihlLHIpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTowLGk9W107aWYoIWUpcmV0dXJuIGk7Zm9yKHZhciBhPTAsbz0iIixzPTA7ZS5sZW5ndGg+Nzspe2lmKGE9SnYoZSksbz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsZS5zdWJhcnJheSg0LDgpKSxzPTgsMT09PWE/KGE9WnYoZSw4KSxzKz04KTphfHwoYT1lLmxlbmd0aCksIXJbMF18fG89PT1yWzBdKXt2YXIgdT1lLnN1YmFycmF5KDAsYSk7aWYoIShyLmxlbmd0aDwyKSlyZXR1cm4gdC5maW5kQm94KHUuc3ViYXJyYXkocyksci5zbGljZSgxKSxuK3MpO2kucHVzaCh7c3RhcnQ6bixzaXplOmEsaGVhZGVyU2l6ZTpzLHR5cGU6byxkYXRhOnV9KX1uKz1hLGU9ZS5zdWJhcnJheShhKX1yZXR1cm4gaX19LHtrZXk6InRmaGQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3QudHJhY2tJZD1KdihlKTt2YXIgcj00LG49MSZ0LmZsYWdzLGk9MiZ0LmZsYWdzLGE9OCZ0LmZsYWdzLG89MTYmdC5mbGFncyxzPTMyJnQuZmxhZ3M7biYmKHIrPTQsdC5iYXNlRGF0YU9mZnNldD1KdihlLHIpLHIrPTQpLGkmJih0LnNhbXBsZURlc2NyaXB0aW9uSW5kZXg9SnYoZSxyKSxyKz00KSxhJiYodC5kZWZhdWx0U2FtcGxlRHVyYXRpb249SnYoZSxyKSxyKz00KSxvJiYodC5kZWZhdWx0U2FtcGxlU2l6ZT1KdihlLHIpLHIrPTQpLHMmJih0LmRlZmF1bHRTYW1wbGVGbGFncz1KdihlLHIpKX0pKX19LHtrZXk6InNpZHgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3ZhciByPTA7dC5yZWZlcmVuY2VfSUQ9SnYoZSxyKSxyKz00LHQudGltZXNjYWxlPUp2KGUscikscis9NCwwPT09dC52ZXJzaW9uPyh0LmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPUp2KGUscikscis9NCx0LmZpcnN0X29mZnNldD1KdihlLHIpLHIrPTQpOih0LmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPVp2KGUscikscis9OCx0LmZpcnN0X29mZnNldD1adihlLHIpLHIrPTgpLHIrPTIsdC5yZWZlcmVuY2VzPVtdO3ZhciBuPVF2KGUscik7cis9Mjtmb3IodmFyIGk9MDtpPG47aSsrKXt2YXIgYT17fTt0LnJlZmVyZW5jZXMucHVzaChhKTt2YXIgbz1KdihlLHIpO3IrPTQsYS5yZWZlcmVuY2VfdHlwZT1vPj4zMSYxLGEucmVmZXJlbmNlZF9zaXplPTIxNDc0ODM2NDcmbyxhLnN1YnNlZ21lbnRfZHVyYXRpb249SnYoZSxyKSxvPUp2KGUscis9NCkscis9NCxhLnN0YXJ0c193aXRoX1NBUD1vPj4zMSYxLGEuU0FQX3R5cGU9bz4+MjgmNyxhLlNBUF9kZWx0YV90aW1lPTI2ODQzNTQ1NSZvfX0pKX19LHtrZXk6Im1vb3YiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBFeShlLCExLChmdW5jdGlvbihlLHIsbil7ZS5tdmhkPXQubXZoZCh0LmZpbmRCb3gocixbIm12aGQiXSxuKVswXSksZS50cmFrPXQuZmluZEJveChyLFsidHJhayJdLG4pLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQudHJhayhlKX0pKSxlLnBzc2g9dC5wc3NoKHQuZmluZEJveChyLFsicHNzaCJdLG4pWzBdKX0pKX19LHtrZXk6Im12aGQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3ZhciByPTA7MT09PXQudmVyc2lvbj8odC50aW1lc2NhbGU9SnYoZSwxNiksdC5kdXJhdGlvbj1adihlLDIwKSxyKz0yOCk6KHQudGltZXNjYWxlPUp2KGUsOCksdC5kdXJhdGlvbj1KdihlLDEyKSxyKz0xNiksdC5uZXh0VHJhY2tJZD1KdihlLHIrNzYpfSkpfX0se2tleToidHJhayIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEV5KGUsITEsKGZ1bmN0aW9uKGUscixuKXtlLnRraGQ9dC50a2hkKHQuZmluZEJveChyLFsidGtoZCJdLG4pWzBdKSxlLm1kaWE9dC5tZGlhKHQuZmluZEJveChyLFsibWRpYSJdLG4pWzBdKX0pKX19LHtrZXk6InRraGQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3ZhciByPTA7MT09PXQudmVyc2lvbj8odC50cmFja0lkPUp2KGUsMTYpLHQuZHVyYXRpb249WnYoZSwyNCkscis9MzIpOih0LnRyYWNrSWQ9SnYoZSw4KSx0LmR1cmF0aW9uPUp2KGUsMTYpLHIrPTIwKSx0LndpZHRoPUp2KGUscis1MiksdC5oZWlnaHQ9SnYoZSxyKzU2KX0pKX19LHtrZXk6Im1kaWEiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBFeShlLCExLChmdW5jdGlvbihlLHIsbil7ZS5tZGhkPXQubWRoZCh0LmZpbmRCb3gocixbIm1kaGQiXSxuKVswXSksZS5oZGxyPXQuaGRscih0LmZpbmRCb3gocixbImhkbHIiXSxuKVswXSksZS5taW5mPXQubWluZih0LmZpbmRCb3gocixbIm1pbmYiXSxuKVswXSl9KSl9fSx7a2V5OiJtZGhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXt2YXIgcj0wOzE9PT10LnZlcnNpb24/KHQudGltZXNjYWxlPUp2KGUsMTYpLHQuZHVyYXRpb249WnYoZSwyMCkscis9MjgpOih0LnRpbWVzY2FsZT1KdihlLDgpLHQuZHVyYXRpb249SnYoZSwxMikscis9MTYpO3ZhciBuPVF2KGUscik7dC5sYW5ndWFnZT1TdHJpbmcuZnJvbUNoYXJDb2RlKDk2KyhuPj4xMCYzMSksOTYrKG4+PjUmMzEpLDk2KygzMSZuKSl9KSl9fSx7a2V5OiJoZGxyIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXswPT09dC52ZXJzaW9uJiYodC5oYW5kbGVyVHlwZT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsZS5zdWJhcnJheSg0LDgpKSl9KSl9fSx7a2V5OiJtaW5mIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gRXkoZSwhMSwoZnVuY3Rpb24oZSxyLG4pe2Uudm1oZD10LnZtaGQodC5maW5kQm94KHIsWyJ2bWhkIl0sbilbMF0pLGUuc21oZD10LnNtaGQodC5maW5kQm94KHIsWyJzbWhkIl0sbilbMF0pLGUuc3RibD10LnN0YmwodC5maW5kQm94KHIsWyJzdGJsIl0sbilbMF0pfSkpfX0se2tleToidm1oZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEV5KHQsITAsKGZ1bmN0aW9uKHQsZSl7dC5ncmFwaGljc21vZGU9UXYoZSksdC5vcGNvbG9yPVtRdihlLDIpLFF2KGUsNCksUXYoZSw2KV19KSl9fSx7a2V5OiJzbWhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXt0LmJhbGFuY2U9UXYoZSl9KSl9fSx7a2V5OiJzdGJsIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gRXkoZSwhMSwoZnVuY3Rpb24oZSxyLG4pe3ZhciBpLGEsbztlLnN0c2Q9dC5zdHNkKHQuZmluZEJveChyLFsic3RzZCJdLG4pWzBdKSxlLnN0dHM9dC5zdHRzKHQuZmluZEJveChyLFsic3R0cyJdLG4pWzBdKSxlLmN0dHM9dC5jdHRzKHQuZmluZEJveChyLFsiY3R0cyJdLG4pWzBdKSxlLnN0c2M9dC5zdHNjKHQuZmluZEJveChyLFsic3RzYyJdLG4pWzBdKSxlLnN0c3o9dC5zdHN6KHQuZmluZEJveChyLFsic3RzeiJdLG4pWzBdKSxlLnN0Y289dC5zdGNvKHQuZmluZEJveChyLFsic3RjbyJdLG4pWzBdKSxlLnN0Y298fChlLmNvNjQ9dC5jbzY0KHQuZmluZEJveChyLFsiY282NCJdLG4pWzBdKSxlLnN0Y289ZS5jbzY0KTt2YXIgcz1udWxsPT09KGk9ZS5zdHNkLmVudHJpZXNbMF0pfHx2b2lkIDA9PT1pfHxudWxsPT09KGE9aS5zaW5mKXx8dm9pZCAwPT09YXx8bnVsbD09PShvPWEuc2NoaSl8fHZvaWQgMD09PW8/dm9pZCAwOm8udGVuYy5kZWZhdWx0X0lWX3NpemU7ZS5zdHNzPXQuc3Rzcyh0LmZpbmRCb3gocixbInN0c3MiXSxuKVswXSksZS5zZW5jPXQuc2VuYyh0LmZpbmRCb3gocixbInNlbmMiXSxuKVswXSxzKX0pKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo4O3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LHIpe3ZhciBuPTAsaT1KdihyLG4pO24rPTQsdC5zYW1wbGVzPVtdO2Zvcih2YXIgYT0wO2E8aTthKyspe2Zvcih2YXIgbz17SW5pdGlhbGl6YXRpb25WZWN0b3I6W119LHM9MDtzPGU7cysrKW8uSW5pdGlhbGl6YXRpb25WZWN0b3Jbc109cltuK3NdO2lmKG4rPWUsMiZ0LmZsYWdzKXtvLnN1YnNhbXBsZXM9W107dmFyIHU9UXYocixuKTtuKz0yO2Zvcih2YXIgYz0wO2M8dTtjKyspe3ZhciBmPXt9O2YuQnl0ZXNPZkNsZWFyRGF0YT1RdihyLG4pLG4rPTIsZi5CeXRlc09mUHJvdGVjdGVkRGF0YT1KdihyLG4pLG4rPTQsby5zdWJzYW1wbGVzLnB1c2goZil9fXQuc2FtcGxlcy5wdXNoKG8pfX0pKX19LHtrZXk6InBzc2giLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj1bXSxuPVtdLGk9MCxhPTA7YTwxNjthKyspbi5wdXNoKEl5KGVbaSthXSkpO2lmKGkrPTE2LHQudmVyc2lvbj4wKXt2YXIgbz1KdihlLGkpO2krPTQ7Zm9yKHZhciBzPTA7czwoIiIrbykubGVuZ3RoO3MrKylmb3IodmFyIHU9MDt1PDE2O3UrKyl7dmFyIGM9ZVtpXTtpKz0xLHIucHVzaChJeShjKSl9fXZhciBmPUp2KGUsaSk7dC5kYXRhX3NpemU9ZixpKz00LHQua2lkPXIsdC5zeXN0ZW1faWQ9bix0LmJ1ZmZlcj1lfSkpfX0se2tleToic3RzZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEV5KGUsITAsKGZ1bmN0aW9uKGUscixuKXtlLmVudHJ5Q291bnQ9SnYociksZS5lbnRyaWVzPXQuZmluZEJveChyLnN1YmFycmF5KDQpLFtdLG4rNCkubWFwKChmdW5jdGlvbihlKXtzd2l0Y2goZS50eXBlKXtjYXNlImF2YzEiOmNhc2UiYXZjMiI6Y2FzZSJhdmMzIjpjYXNlImF2YzQiOnJldHVybiB0LmF2YzEoZSk7Y2FzZSJodmMxIjpjYXNlImhldjEiOnJldHVybiB0Lmh2YzEoZSk7Y2FzZSJtcDRhIjpyZXR1cm4gdC5tcDRhKGUpO2Nhc2UiYWxhdyI6Y2FzZSJ1bGF3IjpyZXR1cm4gdC5hbGF3KGUpO2Nhc2UiZW5jYSI6cmV0dXJuIEV5KGUsITEsKGZ1bmN0aW9uKGUscixuKXtlLmNoYW5uZWxDb3VudD1RdihyLDE2KSxlLnNhbXBsZXNpemU9UXYociwxOCksZS5zYW1wbGVSYXRlPUp2KHIsMjQpLzY1NTM2LHI9ci5zdWJhcnJheSgyOCksZS5zaW5mPXQuc2luZih0LmZpbmRCb3gocixbInNpbmYiXSxuKVswXSksZS5lc2RzPXQuZXNkcyh0LmZpbmRCb3gocixbImVzZHMiXSxuKVswXSl9KSk7Y2FzZSJlbmN2IjpyZXR1cm4gRXkoZSwhMSwoZnVuY3Rpb24oZSxyLG4pe2Uud2lkdGg9UXYociwyNCksZS5oZWlnaHQ9UXYociwyNiksZS5ob3JpenJlc29sdXRpb249SnYociwyOCksZS52ZXJ0cmVzb2x1dGlvbj1KdihyLDMyKSxyPXIuc3ViYXJyYXkoNzgpLGUuc2luZj10LnNpbmYodC5maW5kQm94KHIsWyJzaW5mIl0sbilbMF0pLGUuYXZjQz10LmF2Y0ModC5maW5kQm94KHIsWyJhdmNDIl0sbilbMF0pLGUuaHZjQz10Lmh2Y0ModC5maW5kQm94KHIsWyJodmNDIl0sbilbMF0pLGUucGFzcD10LnBhc3AodC5maW5kQm94KHIsWyJwYXNwIl0sbilbMF0pfSkpfX0pKS5maWx0ZXIoQm9vbGVhbil9KSl9fSx7a2V5OiJ0ZW5jIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMSwoZnVuY3Rpb24odCxlKXt2YXIgcj02O3QuZGVmYXVsdF9Jc0VuY3J5cHRlZD1lW3JdLHIrPTEsdC5kZWZhdWx0X0lWX3NpemU9ZVtyXSxyKz0xLHQuZGVmYXVsdF9LSUQ9W107Zm9yKHZhciBuPTA7bjwxNjtuKyspdC5kZWZhdWx0X0tJRC5wdXNoKEl5KGVbcl0pKSxyKz0xfSkpfX0se2tleToic2NoaSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEV5KGUsITEsKGZ1bmN0aW9uKGUscixuKXtlLnRlbmM9dC50ZW5jKHQuZmluZEJveChyLFsidGVuYyJdLG4pWzBdKX0pKX19LHtrZXk6InNpbmYiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBFeShlLCExLChmdW5jdGlvbihlLHIsbil7ZS5zY2hpPXQuc2NoaSh0LmZpbmRCb3gocixbInNjaGkiXSxuKVswXSksZS5mcm1hPXQuZnJtYSh0LmZpbmRCb3gocixbImZybWEiXSxuKVswXSl9KSl9fSx7a2V5OiJmcm1hIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMSwoZnVuY3Rpb24odCxlKXt0LmRhdGFfZm9ybWF0PSIiO2Zvcih2YXIgcj0wO3I8NDtyKyspdC5kYXRhX2Zvcm1hdCs9U3RyaW5nLmZyb21DaGFyQ29kZShlW3JdKX0pKX19LHtrZXk6ImF2YzEiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBFeShlLCExLChmdW5jdGlvbihlLHIsbil7dmFyIGk9X3koZSxyKSxhPXIuc3ViYXJyYXkoaSk7bis9aSxlLmF2Y0M9dC5hdmNDKHQuZmluZEJveChhLFsiYXZjQyJdLG4pWzBdKSxlLnBhc3A9dC5wYXNwKHQuZmluZEJveChhLFsicGFzcCJdLG4pWzBdKX0pKX19LHtrZXk6ImF2Y0MiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCExLChmdW5jdGlvbih0LGUpe3QuY29uZmlndXJhdGlvblZlcnNpb249ZVswXSx0LkFWQ1Byb2ZpbGVJbmRpY2F0aW9uPWVbMV0sdC5wcm9maWxlQ29tcGF0aWJpbGl0eT1lWzJdLHQuQVZDTGV2ZWxJbmRpY2F0aW9uPWVbM10sdC5jb2RlYz1mdW5jdGlvbih0KXtmb3IodmFyIGUscj0iYXZjMS4iLG49MDtuPDM7bisrKShlPXRbbl0udG9TdHJpbmcoMTYpKS5sZW5ndGg8MiYmKGU9IjAiLmNvbmNhdChlKSkscis9ZTtyZXR1cm4gcn0oW2VbMV0sZVsyXSxlWzNdXSksdC5sZW5ndGhTaXplTWludXNPbmU9MyZlWzRdLHQuc3BzTGVuZ3RoPTMxJmVbNV0sdC5zcHM9W107Zm9yKHZhciByPTYsbj0wO248dC5zcHNMZW5ndGg7bisrKXt2YXIgaT1RdihlLHIpO3IrPTIsdC5zcHMucHVzaChlLnN1YmFycmF5KHIscitpKSkscis9aX10LnBwc0xlbmd0aD1lW3JdLHIrPTEsdC5wcHM9W107Zm9yKHZhciBhPTA7YTx0LnBwc0xlbmd0aDthKyspe3ZhciBvPVF2KGUscik7cis9Mix0LnBwcy5wdXNoKGUuc3ViYXJyYXkocixyKz1vKSkscis9b319KSl9fSx7a2V5OiJodmMxIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gRXkoZSwhMSwoZnVuY3Rpb24oZSxyLG4pe3ZhciBpPV95KGUsciksYT1yLnN1YmFycmF5KGkpO24rPWksZS5odmNDPXQuaHZjQyh0LmZpbmRCb3goYSxbImh2Y0MiXSxuKVswXSksZS5wYXNwPXQucGFzcCh0LmZpbmRCb3goYSxbInBhc3AiXSxuKVswXSl9KSl9fSx7a2V5OiJodmNDIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMSwoZnVuY3Rpb24oZSxyKXtlLmRhdGE9dC5kYXRhLGUuY29kZWM9ImhldjEuMS42Lkw5My5CMCIsZS5jb25maWd1cmF0aW9uVmVyc2lvbj1yWzBdO3ZhciBuPXJbMV07ZS5nZW5lcmFsUHJvZmlsZVNwYWNlPW4+PjYsZS5nZW5lcmFsVGllckZsYWc9KDMyJm4pPj41LGUuZ2VuZXJhbFByb2ZpbGVJZGM9MzEmbixlLmdlbmVyYWxQcm9maWxlQ29tcGF0aWJpbGl0eT1KdihyLDIpLGUuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncz1yLnN1YmFycmF5KDYsMTIpLGUuZ2VuZXJhbExldmVsSWRjPXJbMTJdLGUuYXZnRnJhbWVSYXRlPVF2KHIsMTkpLGUubnVtT2ZBcnJheXM9clsyMl0sZS52cHM9W10sZS5zcHM9W10sZS5wcHM9W107Zm9yKHZhciBpPTIzLGE9MCxvPTAscz0wLHU9MDt1PGUubnVtT2ZBcnJheXM7dSsrKXthPTYzJnJbaV0sbz1RdihyLGkrMSksaSs9Mztmb3IodmFyIGMsZj1bXSxsPTA7bDxvO2wrKylzPVF2KHIsaSksaSs9MixmLnB1c2goci5zdWJhcnJheShpLGkrcykpLGkrPXM7aWYoMzI9PT1hKShjPWUudnBzKS5wdXNoLmFwcGx5KGMsZik7ZWxzZSBpZigzMz09PWEpe3ZhciBoOyhoPWUuc3BzKS5wdXNoLmFwcGx5KGgsZil9ZWxzZSBpZigzND09PWEpe3ZhciBkOyhkPWUucHBzKS5wdXNoLmFwcGx5KGQsZil9fX0pKX19LHtrZXk6InBhc3AiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCExLChmdW5jdGlvbih0LGUpe3QuaFNwYWNpbmc9SnYoZSksdC52U3BhY2luZz1KdihlLDQpfSkpfX0se2tleToibXA0YSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEV5KGUsITEsKGZ1bmN0aW9uKGUscixuKXt2YXIgaT1UeShlLHIpO2UuZXNkcz10LmVzZHModC5maW5kQm94KHIuc3ViYXJyYXkoaSksWyJlc2RzIl0sbitpKVswXSl9KSl9fSx7a2V5OiJlc2RzIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXt0LmNvZGVjPSJtcDRhLiI7Zm9yKHZhciByPTAsbj0wLGk9MCxhPTA7ZS5sZW5ndGg7KXtmb3IoYT1lW3I9MF0sbj1lW3IrMV0scis9MjsxMjgmbjspaT0oMTI3Jm4pPDw3LG49ZVtyXSxyKz0xO2lmKGkrPTEyNyZuLDM9PT1hKWU9ZS5zdWJhcnJheShyKzMpO2Vsc2V7aWYoNCE9PWEpe2lmKDU9PT1hKXt2YXIgbz10LmNvbmZpZz1lLnN1YmFycmF5KHIscitpKSxzPSgyNDgmb1swXSk+PjM7cmV0dXJuIDMxPT09cyYmby5sZW5ndGg+PTImJihzPTMyKygoNyZvWzBdKTw8MykrKCgyMjQmb1sxXSk+PjUpKSx0Lm9iamVjdFR5cGU9cyx0LmNvZGVjKz1zLnRvU3RyaW5nKDE2KSx2b2lkKCIuIj09PXQuY29kZWNbdC5jb2RlYy5sZW5ndGgtMV0mJih0LmNvZGVjPXQuY29kZWMuc3Vic3RyaW5nKDAsdC5jb2RlYy5sZW5ndGgtMSkpKX1yZXR1cm4gdm9pZCgiLiI9PT10LmNvZGVjW3QuY29kZWMubGVuZ3RoLTFdJiYodC5jb2RlYz10LmNvZGVjLnN1YnN0cmluZygwLHQuY29kZWMubGVuZ3RoLTEpKSl9dC5jb2RlYys9KGVbcl0udG9TdHJpbmcoMTYpKyIuIikucGFkU3RhcnQoMywiMCIpLGU9ZS5zdWJhcnJheShyKzEzKX19fSkpfX0se2tleToiYWxhdyIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEV5KHQsITEsKGZ1bmN0aW9uKHQsZSl7VHkodCxlKX0pKX19LHtrZXk6InN0dHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj1KdihlKSxuPVtdLGk9NCxhPTA7YTxyO2ErKyluLnB1c2goe2NvdW50Okp2KGUsaSksZGVsdGE6SnYoZSxpKzQpfSksaSs9ODt0LmVudHJ5Q291bnQ9cix0LmVudHJpZXM9bn0pKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3ZhciByPUp2KGUpLG49W10saT00O2lmKDE9PT10LnZlcnNpb24pZm9yKHZhciBhPTA7YTxyO2ErKyluLnB1c2goe2NvdW50Okp2KGUsaSksb2Zmc2V0Okp2KGUsaSs0KX0pLGkrPTg7ZWxzZSBmb3IodmFyIG89MDtvPHI7bysrKW4ucHVzaCh7Y291bnQ6SnYoZSxpKSxvZmZzZXQ6LSgxK35KdihlLGkrNCkpfSksaSs9ODt0LmVudHJ5Q291bnQ9cix0LmVudHJpZXM9bn0pKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj1KdihlKSxuPVtdLGk9NCxhPTA7YTxyO2ErKyluLnB1c2goe2ZpcnN0Q2h1bms6SnYoZSxpKSxzYW1wbGVzUGVyQ2h1bms6SnYoZSxpKzQpLHNhbXBsZURlc2NyaXB0aW9uSW5kZXg6SnYoZSxpKzgpfSksaSs9MTI7dC5lbnRyeUNvdW50PXIsdC5lbnRyaWVzPW59KSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXt2YXIgcj1KdihlKSxuPUp2KGUsNCksaT1bXTtpZighcilmb3IodmFyIGE9OCxvPTA7bzxuO28rKylpLnB1c2goSnYoZSxhKSksYSs9NDt0LnNhbXBsZVNpemU9cix0LnNhbXBsZUNvdW50PW4sdC5lbnRyeVNpemVzPWl9KSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9SnYoZSksbj1bXSxpPTQsYT0wO2E8cjthKyspbi5wdXNoKEp2KGUsaSkpLGkrPTQ7dC5lbnRyeUNvdW50PXIsdC5lbnRyaWVzPW59KSl9fSx7a2V5OiJjbzY0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9SnYoZSksbj1bXSxpPTQsYT0wO2E8cjthKyspbi5wdXNoKFp2KGUsaSkpLGkrPTg7dC5lbnRyeUNvdW50PXIsdC5lbnRyaWVzPW59KSl9fSx7a2V5OiJzdHNzIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9SnYoZSksbj1bXSxpPTQsYT0wO2E8cjthKyspbi5wdXNoKEp2KGUsaSkpLGkrPTQ7dC5lbnRyeUNvdW50PXIsdC5lbnRyaWVzPW59KSl9fSx7a2V5OiJtb29mIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gRXkoZSwhMSwoZnVuY3Rpb24oZSxyLG4pe2UubWZoZD10Lm1maGQodC5maW5kQm94KHIsWyJtZmhkIl0sbilbMF0pLGUudHJhZj10LmZpbmRCb3gocixbInRyYWYiXSxuKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiB0LnRyYWYoZSl9KSl9KSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXt0LnNlcXVlbmNlTnVtYmVyPUp2KGUpfSkpfX0se2tleToidHJhZiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEV5KGUsITEsKGZ1bmN0aW9uKGUscixuKXtlLnRmaGQ9dC50ZmhkKHQuZmluZEJveChyLFsidGZoZCJdLG4pWzBdKSxlLnRmZHQ9dC50ZmR0KHQuZmluZEJveChyLFsidGZkdCJdLG4pWzBdKSxlLnRydW49dC50cnVuKHQuZmluZEJveChyLFsidHJ1biJdLG4pWzBdKX0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBFeSh0LCEwLChmdW5jdGlvbih0LGUpe3ZhciByPXQudmVyc2lvbixuPXQuZmxhZ3MsaT1lLmxlbmd0aCxhPXQuc2FtcGxlQ291bnQ9SnYoZSksbz00O2lmKGk+byYmMSZuJiYodC5kYXRhT2Zmc2V0PS0oMSt+SnYoZSxvKSksbys9NCksaT5vJiY0Jm4mJih0LmZpcnN0U2FtcGxlRmxhZ3M9SnYoZSxvKSxvKz00KSx0LnNhbXBsZXM9W10saT5vKWZvcih2YXIgcyx1PTA7dTxhO3UrKylzPXt9LDI1NiZuJiYocy5kdXJhdGlvbj1KdihlLG8pLG8rPTQpLDUxMiZuJiYocy5zaXplPUp2KGUsbyksbys9NCksMTAyNCZuJiYocy5mbGFncz1KdihlLG8pLG8rPTQpLDIwNDgmbiYmKHMuY3RzPXI/LSgxK35KdihlLG8rNCkpOkp2KGUsbyksbys9NCksdC5zYW1wbGVzLnB1c2gocyl9KSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gRXkodCwhMCwoZnVuY3Rpb24odCxlKXsxPT09dC52ZXJzaW9uP3QuYmFzZU1lZGlhRGVjb2RlVGltZT1adihlKTp0LmJhc2VNZWRpYURlY29kZVRpbWU9SnYoZSl9KSl9fSx7a2V5OiJwcm9iZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuISF0LmZpbmRCb3goZSxbImZ0eXAiXSl9fSx7a2V5OiJwYXJzZVNhbXBsZUZsYWdzIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm57aXNMZWFkaW5nOigxMiZ0WzBdKT4+PjIsZGVwZW5kc09uOjMmdFswXSxpc0RlcGVuZGVkT246KDE5MiZ0WzFdKT4+PjYsaGFzUmVkdW5kYW5jeTooNDgmdFsxXSk+Pj40LHBhZGRpbmdWYWx1ZTooMTQmdFsxXSk+Pj4xLGlzTm9uU3luY1NhbXBsZToxJnRbMV0sZGVncmFkYXRpb25Qcmlvcml0eTp0WzJdPDw4fHRbM119fX0se2tleToibW9vdlRvVHJhY2siLHZhbHVlOmZ1bmN0aW9uKHQsZSxyKXt2YXIgbixpLGE9dC50cmFrO2lmKGEmJmEubGVuZ3RoKXt2YXIgbz1hLmZpbmQoKGZ1bmN0aW9uKHQpe3ZhciBlLHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0oZT10Lm1kaWEpfHx2b2lkIDA9PT1lfHxudWxsPT09KHI9ZS5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSkscz1hLmZpbmQoKGZ1bmN0aW9uKHQpe3ZhciBlLHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0oZT10Lm1kaWEpfHx2b2lkIDA9PT1lfHxudWxsPT09KHI9ZS5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYobyYmZSl7dmFyIHUsYyxmLGwsaCxkLHAsdj1lLHk9bnVsbD09PSh1PW8udGtoZCl8fHZvaWQgMD09PXU/dm9pZCAwOnUudHJhY2tJZDtudWxsIT15JiYodi5pZD1vLnRraGQudHJhY2tJZCksdi50a2hkRHVyYXRpb249by50a2hkLmR1cmF0aW9uLHYubXZoZER1cnRpb249dC5tdmhkLmR1cmF0aW9uLHYubXZoZFRpbWVjYWxlPXQubXZoZC50aW1lc2NhbGUsdi50aW1lc2NhbGU9di5mb3JtYXRUaW1lc2NhbGU9by5tZGlhLm1kaGQudGltZXNjYWxlLHYuZHVyYXRpb249by5tZGlhLm1kaGQuZHVyYXRpb258fHYubXZoZER1cnRpb24vdi5tdmhkVGltZWNhbGUqdi50aW1lc2NhbGU7dmFyIGcsbSxiLHcsayx4LFMsQSxfPW8ubWRpYS5taW5mLnN0Ymwuc3RzZC5lbnRyaWVzWzBdO2lmKHYud2lkdGg9Xy53aWR0aCx2LmhlaWdodD1fLmhlaWdodCxfLnBhc3AmJih2LnNhclJhdGlvPVtfLnBhc3AuaFNwYWNpbmcsXy5wYXNwLnZTcGFjaW5nXSksXy5odmNDKXYuY29kZWNUeXBlPXZwLHYuY29kZWM9Xy5odmNDLmNvZGVjLHYudnBzPV8uaHZjQy52cHMsdi5zcHM9Xy5odmNDLnNwcyx2LnBwcz1fLmh2Y0MucHBzLHYuaHZjQz1fLmh2Y0MuZGF0YTtlbHNle2lmKCFfLmF2Y0MpdGhyb3cgbmV3IEVycm9yKCJ1bmtub3duIHZpZGVvIHN0c2QgZW50cnkiKTt2LmNvZGVjPV8uYXZjQy5jb2RlYyx2LnNwcz1fLmF2Y0Muc3BzLHYucHBzPV8uYXZjQy5wcHN9aWYodi5wcmVzZW50PSEwLHYuZXh0PXt9LHYuZXh0LnN0c3M9bnVsbD09PShjPW8ubWRpYSl8fHZvaWQgMD09PWN8fG51bGw9PT0oZj1jLm1pbmYpfHx2b2lkIDA9PT1mfHxudWxsPT09KGw9Zi5zdGJsKXx8dm9pZCAwPT09bD92b2lkIDA6bC5zdHNzLHYuZXh0LmN0dHM9bnVsbD09PShoPW8ubWRpYSl8fHZvaWQgMD09PWh8fG51bGw9PT0oZD1oLm1pbmYpfHx2b2lkIDA9PT1kfHxudWxsPT09KHA9ZC5zdGJsKXx8dm9pZCAwPT09cD92b2lkIDA6cC5jdHRzLF8mJiJlbmN2Ij09PV8udHlwZSl2LmlzVmlkZW9FbmNyeXB0aW9uPSEwLF8uZGVmYXVsdF9LSUQ9bnVsbD09PShnPV8uc2luZil8fHZvaWQgMD09PWd8fG51bGw9PT0obT1nLnNjaGkpfHx2b2lkIDA9PT1tP3ZvaWQgMDptLnRlbmMuZGVmYXVsdF9LSUQsXy5kZWZhdWx0X0lzRW5jcnlwdGVkPW51bGw9PT0oYj1fLnNpbmYpfHx2b2lkIDA9PT1ifHxudWxsPT09KHc9Yi5zY2hpKXx8dm9pZCAwPT09dz92b2lkIDA6dy50ZW5jLmRlZmF1bHRfSXNFbmNyeXB0ZWQsXy5kZWZhdWx0X0lWX3NpemU9bnVsbD09PShrPV8uc2luZil8fHZvaWQgMD09PWt8fG51bGw9PT0oeD1rLnNjaGkpfHx2b2lkIDA9PT14P3ZvaWQgMDp4LnRlbmMuZGVmYXVsdF9JVl9zaXplLHYudmlkZW9TZW5jPW8ubWRpYS5taW5mLnN0Ymwuc2VuYyYmby5tZGlhLm1pbmYuc3RibC5zZW5jLnNhbXBsZXMsXy5kYXRhX2Zvcm1hdD1udWxsPT09KFM9Xy5zaW5mKXx8dm9pZCAwPT09U3x8bnVsbD09PShBPVMuZnJtYSl8fHZvaWQgMD09PUE/dm9pZCAwOkEuZGF0YV9mb3JtYXQsdi51c2VFTUU9dC51c2VFTUUsdi5raWRWYWx1ZT10LmtpZFZhbHVlLHYucHNzaD10LnBzc2gsdi5lbmN2PV99aWYocyYmcil7dmFyIFQsRSxPLEksQyxNLFIsUCxCLFU9cixEPW51bGw9PT0oVD1zLnRraGQpfHx2b2lkIDA9PT1UP3ZvaWQgMDpULnRyYWNrSWQ7bnVsbCE9RCYmKFUuaWQ9cy50a2hkLnRyYWNrSWQpLFUudGtoZER1cmF0aW9uPXMudGtoZC5kdXJhdGlvbixVLm12aGREdXJ0aW9uPXQubXZoZC5kdXJhdGlvbixVLm12aGRUaW1lY2FsZT10Lm12aGQudGltZXNjYWxlLFUudGltZXNjYWxlPVUuZm9ybWF0VGltZXNjYWxlPXMubWRpYS5tZGhkLnRpbWVzY2FsZSxVLmR1cmF0aW9uPXMubWRpYS5tZGhkLmR1cmF0aW9ufHxVLm12aGREdXJ0aW9uL1UubXZoZFRpbWVjYWxlKlUudGltZXNjYWxlO3ZhciBqLHosTCxGLFYsTixILEssWT1zLm1kaWEubWluZi5zdGJsLnN0c2QuZW50cmllc1swXTtzd2l0Y2goVS5zYW1wbGVTaXplPVkuc2FtcGxlU2l6ZSxVLnNhbXBsZVJhdGU9WS5zYW1wbGVSYXRlLFUuY2hhbm5lbENvdW50PVkuY2hhbm5lbENvdW50LFUucHJlc2VudD0hMCxZLnR5cGUpe2Nhc2UiYWxhdyI6VS5jb2RlY1R5cGU9VS5jb2RlYz1ncCxVLnNhbXBsZVJhdGU9OGUzO2JyZWFrO2Nhc2UidWxhdyI6VS5jb2RlY1R5cGU9VS5jb2RlYz1tcCxVLnNhbXBsZVJhdGU9OGUzO2JyZWFrO2RlZmF1bHQ6VS5zYW1wbGVEdXJhdGlvbj1Hdi5nZXRGcmFtZUR1cmF0aW9uKFUuc2FtcGxlUmF0ZSxVLnRpbWVzY2FsZSksVS5zYW1wbGVSYXRlSW5kZXg9R3YuZ2V0UmF0ZUluZGV4QnlSYXRlKFUuc2FtcGxlUmF0ZSksVS5vYmplY3RUeXBlPShudWxsPT09KG49WS5lc2RzKXx8dm9pZCAwPT09bj92b2lkIDA6bi5vYmplY3RUeXBlKXx8MixZLmVzZHMmJihVLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpKSxVLmNvZGVjPShudWxsPT09KGk9WS5lc2RzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5jb2RlYyl8fCJtcDRhLjQwLjIifWlmKFUuc2FtcGxlRHVyYXRpb249R3YuZ2V0RnJhbWVEdXJhdGlvbihVLnNhbXBsZVJhdGUsVS50aW1lc2NhbGUpLFUub2JqZWN0VHlwZT0obnVsbD09PShFPVkuZXNkcyl8fHZvaWQgMD09PUU/dm9pZCAwOkUub2JqZWN0VHlwZSl8fDIsWS5lc2RzJiYoWS5lc2RzLmNvbmZpZz9VLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpOmNvbnNvbGUud2FybigiZXNkcyBjb25maWcgaXMgbnVsbCIpKSxVLmNvZGVjPShudWxsPT09KE89WS5lc2RzKXx8dm9pZCAwPT09Tz92b2lkIDA6Ty5jb2RlYyl8fCJtcDRhLjQwLjIiLFUuc2FtcGxlUmF0ZUluZGV4PUd2LmdldFJhdGVJbmRleEJ5UmF0ZShVLnNhbXBsZVJhdGUpLFUuZXh0PXt9LFUuZXh0LnN0c3M9bnVsbD09PShJPXMubWRpYSl8fHZvaWQgMD09PUl8fG51bGw9PT0oQz1JLm1pbmYpfHx2b2lkIDA9PT1DfHxudWxsPT09KE09Qy5zdGJsKXx8dm9pZCAwPT09TT92b2lkIDA6TS5zdHNzLFUuZXh0LmN0dHM9bnVsbD09PShSPXMubWRpYSl8fHZvaWQgMD09PVJ8fG51bGw9PT0oUD1SLm1pbmYpfHx2b2lkIDA9PT1QfHxudWxsPT09KEI9UC5zdGJsKXx8dm9pZCAwPT09Qj92b2lkIDA6Qi5jdHRzLFUucHJlc2VudD0hMCxZJiYiZW5jYSI9PT1ZLnR5cGUpVS5pc0F1ZGlvRW5jcnlwdGlvbj0hMCxZLmRhdGFfZm9ybWF0PW51bGw9PT0oaj1ZLnNpbmYpfHx2b2lkIDA9PT1qfHxudWxsPT09KHo9ai5mcm1hKXx8dm9pZCAwPT09ej92b2lkIDA6ei5kYXRhX2Zvcm1hdCxZLmRlZmF1bHRfS0lEPW51bGw9PT0oTD1ZLnNpbmYpfHx2b2lkIDA9PT1MfHxudWxsPT09KEY9TC5zY2hpKXx8dm9pZCAwPT09Rj92b2lkIDA6Ri50ZW5jLmRlZmF1bHRfS0lELFkuZGVmYXVsdF9Jc0VuY3J5cHRlZD1udWxsPT09KFY9WS5zaW5mKXx8dm9pZCAwPT09Vnx8bnVsbD09PShOPVYuc2NoaSl8fHZvaWQgMD09PU4/dm9pZCAwOk4udGVuYy5kZWZhdWx0X0lzRW5jcnlwdGVkLFkuZGVmYXVsdF9JVl9zaXplPW51bGw9PT0oSD1ZLnNpbmYpfHx2b2lkIDA9PT1IfHxudWxsPT09KEs9SC5zY2hpKXx8dm9pZCAwPT09Sz92b2lkIDA6Sy50ZW5jLmRlZmF1bHRfSVZfc2l6ZSxVLmF1ZGlvU2VuYz1zLm1kaWEubWluZi5zdGJsLnNlbmMmJnMubWRpYS5taW5mLnN0Ymwuc2VuYy5zYW1wbGVzLFUudXNlRU1FPXQudXNlRU1FLFUua2lkVmFsdWU9dC5raWRWYWx1ZSxVLmVuY2E9WX1pZihyJiYoci5pc1ZpZGVvRW5jcnlwdGlvbj0hIWUmJmUuaXNWaWRlb0VuY3J5cHRpb24pLGUmJihlLmlzQXVkaW9FbmNyeXB0aW9uPSEhciYmci5pc0F1ZGlvRW5jcnlwdGlvbiksbnVsbCE9ZSYmZS5lbmN2fHxudWxsIT1yJiZyLmVuY2Epe3ZhciAkLFcsRz1udWxsPT1lfHxudWxsPT09KCQ9ZS5lbmN2KXx8dm9pZCAwPT09JD92b2lkIDA6JC5kZWZhdWx0X0tJRCxxPW51bGw9PXJ8fG51bGw9PT0oVz1yLmVuY2EpfHx2b2lkIDA9PT1XP3ZvaWQgMDpXLmRlZmF1bHRfS0lELFg9R3x8cT8oR3x8cSkuam9pbigiIik6bnVsbDtlJiYoZS5raWQ9WCksciYmKHIua2lkPVgpfXJldHVybiBlJiYoZS5mbGFncz0zODQxKSxyJiYoci5mbGFncz0xNzkzKSx7dmlkZW9UcmFjazplLGF1ZGlvVHJhY2s6cn19fX0se2tleToiZXZhbHVhdGVEZWZhdWx0RHVyYXRpb24iLHZhbHVlOmZ1bmN0aW9uKHQsZSxyKXt2YXIgbixpPW51bGw9PWV8fG51bGw9PT0obj1lLnNhbXBsZXMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmxlbmd0aDtyZXR1cm4gaT8xMDI0KmkvZS50aW1lc2NhbGUqdC50aW1lc2NhbGUvcjoxMDI0fX0se2tleToibW9vZlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24oZSxyLG4pe3ZhciBpPXt9O3JldHVybiBlLm1maGQmJihyJiYoci5zZXF1ZW5jZU51bWJlcj1lLm1maGQuc2VxdWVuY2VOdW1iZXIpLG4mJihuLnNlcXVlbmNlTnVtYmVyPWUubWZoZC5zZXF1ZW5jZU51bWJlcikpLGUudHJhZi5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgYT1lLnRmaGQsbz1lLnRmZHQscz1lLnRydW47aWYoYSYmcyl7byYmKHImJnIuaWQ9PT1hLnRyYWNrSWQmJihyLmJhc2VNZWRpYURlY29kZVRpbWU9by5iYXNlTWVkaWFEZWNvZGVUaW1lKSxuJiZuLmlkPT09YS50cmFja0lkJiYobi5iYXNlTWVkaWFEZWNvZGVUaW1lPW8uYmFzZU1lZGlhRGVjb2RlVGltZSkpO3ZhciB1PWEuZGVmYXVsdFNhbXBsZVNpemV8fDAsYz1hLmRlZmF1bHRTYW1wbGVEdXJhdGlvbnx8dC5ldmFsdWF0ZURlZmF1bHREdXJhdGlvbihyLG4scy5zYW1wbGVzLmxlbmd0aHx8cy5zYW1wbGVDb3VudCksZj1zLmRhdGFPZmZzZXR8fDAsbD0wLGg9LTE7aWYoIXMuc2FtcGxlcy5sZW5ndGgmJnMuc2FtcGxlQ291bnQpe2lbYS50cmFja0lkXT1bXTtmb3IodmFyIGQ9MDtkPHMuc2FtcGxlQ291bnQ7ZCsrKWlbYS50cmFja0lkXS5wdXNoKHtvZmZzZXQ6ZixkdHM6bCxkdXJhdGlvbjpjLHNpemU6dX0pLGwrPWMsZis9dX1lbHNlIGlbYS50cmFja0lkXT1zLnNhbXBsZXMubWFwKChmdW5jdGlvbih0LGUpe3JldHVybih0PXtvZmZzZXQ6ZixkdHM6bCxwdHM6bCsodC5jdHN8fDApLGR1cmF0aW9uOnQuZHVyYXRpb258fGMsc2l6ZTp0LnNpemV8fHUsZ29wSWQ6aCxrZXlmcmFtZTowPT09ZXx8bnVsbCE9PXQuZmxhZ3MmJnZvaWQgMCE9PXQuZmxhZ3MmJig2NTUzNiZ0LmZsYWdzKT4+PjAhPTY1NTM2fSkua2V5ZnJhbWUmJihoKyssdC5nb3BJZD1oKSxsKz10LmR1cmF0aW9uLGYrPXQuc2l6ZSx0fSkpfX0pKSxpfX0se2tleToibW9vdlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dC50cmFrO2lmKGUmJmUubGVuZ3RoKXt2YXIgcj1lLmZpbmQoKGZ1bmN0aW9uKHQpe3ZhciBlLHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0oZT10Lm1kaWEpfHx2b2lkIDA9PT1lfHxudWxsPT09KHI9ZS5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSksbj1lLmZpbmQoKGZ1bmN0aW9uKHQpe3ZhciBlLHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0oZT10Lm1kaWEpfHx2b2lkIDA9PT1lfHxudWxsPT09KHI9ZS5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYocnx8bil7dmFyIGksYTtpZihyKXt2YXIgbyxzLHU9bnVsbD09PShvPXIubWRpYSl8fHZvaWQgMD09PW98fG51bGw9PT0ocz1vLm1pbmYpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLnN0Ymw7aWYoIXUpcmV0dXJuO3ZhciBjPXUuc3R0cyxmPXUuc3RzYyxsPXUuc3RzeixoPXUuc3RjbyxkPXUuc3RzcyxwPXUuY3R0cztpZighKGMmJmYmJmwmJmgmJmQpKXJldHVybjtpPUF5KGMsZixsLGgscCxkKX1pZihuKXt2YXIgdix5LGcsbT1udWxsPT09KHY9bi5tZGlhKXx8dm9pZCAwPT09dnx8bnVsbD09PSh5PXYubWluZil8fHZvaWQgMD09PXk/dm9pZCAwOnkuc3RibDtpZighbSlyZXR1cm47dmFyIGI9bnVsbD09PShnPW4ubWRpYS5tZGhkKXx8dm9pZCAwPT09Zz92b2lkIDA6Zy50aW1lc2NhbGUsdz1tLnN0dHMsaz1tLnN0c2MseD1tLnN0c3osUz1tLnN0Y287aWYoIShiJiZ3JiZrJiZ4JiZTKSlyZXR1cm47YT1BeSh3LGsseCxTKX1yZXR1cm57dmlkZW9TYW1wbGVzOmksYXVkaW9TYW1wbGVzOmF9fX19fV0pLHR9KCk7ZnVuY3Rpb24gQXkodCxlLHIsbixpLGEpe3ZhciBvLHMsdSxjPVtdLGY9bnVsbD09aT92b2lkIDA6aS5lbnRyaWVzLGw9ZS5lbnRyaWVzLGg9bi5lbnRyaWVzLGQ9ci5lbnRyeVNpemVzLHA9bnVsbD09YT92b2lkIDA6YS5lbnRyaWVzO3AmJihvPXt9LHAuZm9yRWFjaCgoZnVuY3Rpb24odCl7b1t0LTFdPSEwfSkpKSxmJiYocz1bXSxmLmZvckVhY2goKGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmNvdW50LHI9dC5vZmZzZXQsbj0wO248ZTtuKyspcy5wdXNoKHIpfSkpKTt2YXIgdj0tMSx5PTAsZz0wLG09MCxiPTAsdz0wLGs9bFswXS5zYW1wbGVzUGVyQ2h1bmsseD1sWzFdP2xbMV0uZmlyc3RDaHVuay0xOjEvMDtyZXR1cm4gdC5lbnRyaWVzLmZvckVhY2goKGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmNvdW50LG49dC5kZWx0YSxpPTA7aTxlO2krKyl1PXtkdHM6eSxkdXJhdGlvbjpuLHNpemU6ZFtnXXx8ci5zYW1wbGVTaXplLG9mZnNldDpoW21dK3csaW5kZXg6Z30scCYmKHUua2V5ZnJhbWU9b1tnXSx1LmtleWZyYW1lJiZ2KyssdS5nb3BJZD12KSxzJiZnPHMubGVuZ3RoJiYodS5wdHM9dS5kdHMrc1tnXSksYy5wdXNoKHUpLHkrPW4sKytnPGs/dys9dS5zaXplOihtKyssdz0wLG0+PXgmJihiKysseD1sW2IrMV0/bFtiKzFdLmZpcnN0Q2h1bmstMToxLzApLGsrPWxbYl0uc2FtcGxlc1BlckNodW5rKX0pKSxjfWZ1bmN0aW9uIF95KHQsZSl7cmV0dXJuIHQuZGF0YVJlZmVyZW5jZUluZGV4PVF2KGUsNiksdC53aWR0aD1RdihlLDI0KSx0LmhlaWdodD1RdihlLDI2KSx0Lmhvcml6cmVzb2x1dGlvbj1KdihlLDI4KSx0LnZlcnRyZXNvbHV0aW9uPUp2KGUsMzIpLHQuZnJhbWVDb3VudD1RdihlLDQwKSx0LmRlcHRoPVF2KGUsNzQpLDc4fWZ1bmN0aW9uIFR5KHQsZSl7cmV0dXJuIHQuZGF0YVJlZmVyZW5jZUluZGV4PVF2KGUsNiksdC5jaGFubmVsQ291bnQ9UXYoZSwxNiksdC5zYW1wbGVTaXplPVF2KGUsMTgpLHQuc2FtcGxlUmF0ZT1KdihlLDI0KS82NTUzNiwyOH1mdW5jdGlvbiBFeSh0LGUscil7aWYodCl7aWYodC5zaXplIT09dC5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImJveCAiLmNvbmNhdCh0LnR5cGUsIiBzaXplICE9PSBkYXRhLmxlbmd0aCIpKTt2YXIgbj17c3RhcnQ6dC5zdGFydCxzaXplOnQuc2l6ZSxoZWFkZXJTaXplOnQuaGVhZGVyU2l6ZSx0eXBlOnQudHlwZX07cmV0dXJuIGUmJihuLnZlcnNpb249dC5kYXRhW3QuaGVhZGVyU2l6ZV0sbi5mbGFncz1mdW5jdGlvbih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4odFtlXTw8MTYpKyh0W2UrMV08PDgpKyh0W2UrMl18fDApfSh0LmRhdGEsdC5oZWFkZXJTaXplKzEpLG4uaGVhZGVyU2l6ZSs9NCkscihuLHQuZGF0YS5zdWJhcnJheShuLmhlYWRlclNpemUpLG4uc3RhcnQrbi5oZWFkZXJTaXplKSxufX12YXIgT3k9ZnVuY3Rpb24odCxlLHIpe2Zvcih2YXIgbj1TdHJpbmcociksaT1lPj4wLGE9TWF0aC5jZWlsKGkvbi5sZW5ndGgpLG89W10scz1TdHJpbmcodCk7YS0tOylvLnB1c2gobik7cmV0dXJuIG8uam9pbigiIikuc3Vic3RyaW5nKDAsaS1zLmxlbmd0aCkrc30sSXk9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sZT1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KGUpLG49MDtuPGU7bisrKXJbbl09YXJndW1lbnRzW25dO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QucHVzaChPeShOdW1iZXIoZSkudG9TdHJpbmcoMTYpLDIsMCkpfSkpLHRbMF19LEN5PXJzLE15PSJBcnJheUJ1ZmZlciIsUnk9Z28uQXJyYXlCdWZmZXI7ZnVuY3Rpb24gUHkodCl7Zm9yKHZhciBlPTAscj1hcmd1bWVudHMubGVuZ3RoLG49bmV3IEFycmF5KHI+MT9yLTE6MCksaT0xO2k8cjtpKyspbltpLTFdPWFyZ3VtZW50c1tpXTtuLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UrPXQubGVuZ3RofSkpO3ZhciBhPW5ldyB0KGUpLG89MDtyZXR1cm4gbi5mb3JFYWNoKChmdW5jdGlvbih0KXthLnNldCh0LG8pLG8rPXQubGVuZ3RofSkpLGF9Y24oe2dsb2JhbDohMCxmb3JjZWQ6Qy5BcnJheUJ1ZmZlciE9PVJ5fSx7QXJyYXlCdWZmZXI6Unl9KSxDeShNeSk7dmFyIEJ5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe25wKHRoaXMsdCksdGhpcy5idWZmZXI9bmV3IFVpbnQ4QXJyYXkoMCl9cmV0dXJuIGFwKHQsW3trZXk6IndyaXRlIix2YWx1ZTpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLGU9YXJndW1lbnRzLmxlbmd0aCxyPW5ldyBBcnJheShlKSxuPTA7bjxlO24rKylyW25dPWFyZ3VtZW50c1tuXTtyLmZvckVhY2goKGZ1bmN0aW9uKGUpe2U/dC5idWZmZXI9UHkoVWludDhBcnJheSx0LmJ1ZmZlcixlKTp3aW5kb3cuY29uc29sZS53YXJuKGUpfSkpfX1dLFt7a2V5OiJ3cml0ZVVpbnQxNiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFt0Pj44JjI1NSwyNTUmdF0pfX0se2tleToid3JpdGVVaW50MzIiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgVWludDhBcnJheShbdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSl9fV0pLHR9KCksVXk9TWF0aC5wb3coMiwzMiktMSxEeT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtucCh0aGlzLHQpfXJldHVybiBhcCh0LG51bGwsW3trZXk6ImJveCIsdmFsdWU6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgscj1uZXcgQXJyYXkoZT4xP2UtMTowKSxuPTE7bjxlO24rKylyW24tMV09YXJndW1lbnRzW25dO3ZhciBpPTgrKHI9ci5maWx0ZXIoQm9vbGVhbikpLnJlZHVjZSgoZnVuY3Rpb24odCxlKXtyZXR1cm4gdCtlLmJ5dGVMZW5ndGh9KSwwKSxhPW5ldyBVaW50OEFycmF5KGkpO2FbMF09aT4+MjQmMjU1LGFbMV09aT4+MTYmMjU1LGFbMl09aT4+OCYyNTUsYVszXT0yNTUmaSxhLnNldCh0LDQpO3ZhciBvPTg7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24odCl7YS5zZXQodCxvKSxvKz10LmJ5dGVMZW5ndGh9KSksYX19LHtrZXk6ImZ0eXAiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmZpbmQoKGZ1bmN0aW9uKHQpe3JldHVybiB0LnR5cGU9PT1scCYmdC5jb2RlY1R5cGU9PT12cH0pKT90LkZUWVBIRVYxOnQuRlRZUEFWQzF9fSx7a2V5OiJpbml0U2VnbWVudCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHF2KHQuZnR5cChlKSx0Lm1vb3YoZSkpfX0se2tleToicHNzaCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDBdLmNvbmNhdChbMTYsMTE5LDIzOSwyMzYsMTkyLDE3OCw3NywyLDE3MiwyMjcsNjAsMzAsODIsMjI2LDI1MSw3NV0sWzAsMCwwLDFdLGV5KGUua2lkKSxbMCwwLDAsMF0pKTtyZXR1cm4gdC5ib3godC50eXBlcy5wc3NoLHIpfX0se2tleToibW9vdiIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoZVswXS51c2VFTUUmJihlWzBdLmVuY3Z8fGVbMF0uZW5jYSkpe2VbMF0ucHNzaHx8KGVbMF0ucHNzaD17a2lkOmVbMF0ua2lkfSk7dmFyIHI9dGhpcy5wc3NoKGVbMF0ucHNzaCk7cmV0dXJuIHQuYm94LmFwcGx5KHQsW3QudHlwZXMubW9vdix0Lm12aGQoZVswXS5tdmhkRHVydGlvbnx8ZVswXS5kdXJhdGlvbixlWzBdLm12aGRUaW1lY2FsZXx8ZVswXS50aW1lc2NhbGUpLHQubXZleChlKV0uY29uY2F0KHVwKGUubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gdC50cmFrKGUpfSkpKSxbcl0pKX1yZXR1cm4gdC5ib3guYXBwbHkodCxbdC50eXBlcy5tb292LHQubXZoZChlWzBdLm12aGREdXJ0aW9ufHxlWzBdLmR1cmF0aW9uLGVbMF0ubXZoZFRpbWVjYWxlfHxlWzBdLnRpbWVzY2FsZSldLmNvbmNhdCh1cChlLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQudHJhayhlKX0pKSksW3QubXZleChlKV0pKX19LHtrZXk6Im12aGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo5ZTQsbj10LmJveCh0LnR5cGVzLm12aGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHI+PjI0JjI1NSxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsZT4+MjQmMjU1LGU+PjE2JjI1NSxlPj44JjI1NSwyNTUmZSwwLDEsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw2NCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNTUsMjU1LDI1NSwyNTVdKSk7cmV0dXJuIG59fSx7a2V5OiJ0cmFrIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy50cmFrLHQudGtoZChlLmlkLGUudGtoZER1cmF0aW9ufHwwLGUud2lkdGgsZS5oZWlnaHQpLHQubWRpYShlKSl9fSx7a2V5OiJ0a2hkIix2YWx1ZTpmdW5jdGlvbihlLHIpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTowLGk9YXJndW1lbnRzLmxlbmd0aD4zJiZ2b2lkIDAhPT1hcmd1bWVudHNbM10/YXJndW1lbnRzWzNdOjAsYT10LmJveCh0LnR5cGVzLnRraGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDcsMCwwLDAsMCwwLDAsMCwwLGU+PjI0JjI1NSxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmUsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDY0LDAsMCwwLG4+PjgmMjU1LDI1NSZuLDAsMCxpPj44JjI1NSwyNTUmaSwwLDBdKSk7cmV0dXJuIGF9fSx7a2V5OiJtZGlhIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy5tZGlhLHQubWRoZChlLmR1cmF0aW9uLGUudGltZXNjYWxlKSx0LmhkbHIoZS50eXBlKSx0Lm1pbmYoZSkpfX0se2tleToibWRoZCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjllNCxuPXQuYm94KHQudHlwZXMubWRoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcixlPj4yNCYyNTUsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlLDg1LDE5NiwwLDBdKSk7cmV0dXJuIG59fSx7a2V5OiJoZGxyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy5oZGxyLHQuSERMUl9UWVBFU1tlXSl9fSx7a2V5OiJtaW5mIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy5taW5mLGUudHlwZT09PWxwP3QuVk1IRDp0LlNNSEQsdC5ESU5GLHQuc3RibChlKSl9fSx7a2V5OiJzdGJsIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1bXTtyZXR1cm4gZSYmZS5leHQmJmUuZXh0LnN0c3MmJnIucHVzaCh0LnN0c3MoZS5leHQuc3Rzcy5lbnRyaWVzKSksdC5ib3godC50eXBlcy5zdGJsLHQuc3RzZChlKSx0LlNUVFMsclswXSx0LlNUU0MsdC5TVFNaLHQuU1RDTyl9fSx7a2V5OiJzdHNkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcjtyZXR1cm4gcj0iYXVkaW8iPT09ZS50eXBlP2UudXNlRU1FJiZlLmVuY2E/dC5lbmNhKGUpOnQubXA0YShlKTplLnVzZUVNRSYmZS5lbmN2P3QuZW5jdihlKTp0LmF2YzFoZXYxKGUpLHQuYm94KHQudHlwZXMuc3RzZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxXSkscil9fSx7a2V5OiJlbmNhIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1lLmVuY2EuY2hhbm5lbENvdW50LG49ZS5lbmNhLnNhbXBsZVJhdGUsaT1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLHIsMCwxNiwwLDAsMCwwLG4+PjgmMjU1LDI1NSZuLDAsMF0pLGE9dC5lc2RzKGUuY29uZmlnKSxvPXQuc2luZihlLmVuY2EpO3JldHVybiB0LmJveCh0LnR5cGVzLmVuY2EsaSxhLG8pfX0se2tleToiZW5jdiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHIsbixpPWUuc3BzLmxlbmd0aD4wP2Uuc3BzWzBdOltdLGE9ZS5wcHMubGVuZ3RoPjA/ZS5wcHNbMF06W10sbz1lLndpZHRoLHM9ZS5oZWlnaHQsdT1lLnNhclJhdGlvWzBdLGM9ZS5zYXJSYXRpb1sxXSxmPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxvPj44JjI1NSwyNTUmbyxzPj44JjI1NSwyNTUmcywwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwxOCwxMDAsOTcsMTA1LDEwOCwxMjEsMTA5LDExMSwxMTYsMTA1LDExMSwxMTAsNDcsMTA0LDEwOCwxMTUsNDYsMTA2LDExNSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjQsMTcsMTddKSxsPW5ldyBVaW50OEFycmF5KChyPShuPVsxLGlbMV0saVsyXSxpWzNdLDI1NSwyMjUsaS5sZW5ndGg+Pj44JjI1NSwyNTUmaS5sZW5ndGhdKS5jb25jYXQuYXBwbHkobix1cChpKSkuY29uY2F0KFsxLGEubGVuZ3RoPj4+OCYyNTUsMjU1JmEubGVuZ3RoXSkpLmNvbmNhdC5hcHBseShyLHVwKGEpKSksaD1uZXcgVWludDhBcnJheShbMCwwLDg4LDU3LDAsMTUsMjAwLDE5MiwwLDQsODYsNzJdKSxkPXQuc2luZihlLmVuY3YpLHA9bmV3IFVpbnQ4QXJyYXkoW3U+PjI0LHU+PjE2JjI1NSx1Pj44JjI1NSwyNTUmdSxjPj4yNCxjPj4xNiYyNTUsYz4+OCYyNTUsMjU1JmNdKTtyZXR1cm4gdC5ib3godC50eXBlcy5lbmN2LGYsdC5ib3godC50eXBlcy5hdmNDLGwpLHQuYm94KHQudHlwZXMuYnRydCxoKSxkLHQuYm94KHQudHlwZXMucGFzcCxwKSl9fSx7a2V5OiJzY2hpIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1uZXcgVWludDhBcnJheShbXSksbj10LnRlbmMoZSk7cmV0dXJuIHQuYm94KHQudHlwZXMuc2NoaSxyLG4pfX0se2tleToidGVuYyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDI1NSZlLmRlZmF1bHRfSXNFbmNyeXB0ZWQsMjU1JmUuZGVmYXVsdF9JVl9zaXplXS5jb25jYXQoZXkoZS5kZWZhdWx0X0tJRCkpKTtyZXR1cm4gdC5ib3godC50eXBlcy50ZW5jLHIpfX0se2tleToic2luZiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoW10pLG49bmV3IFVpbnQ4QXJyYXkoW2UuZGF0YV9mb3JtYXQuY2hhckNvZGVBdCgwKSxlLmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMSksZS5kYXRhX2Zvcm1hdC5jaGFyQ29kZUF0KDIpLGUuZGF0YV9mb3JtYXQuY2hhckNvZGVBdCgzKV0pLGk9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsOTksMTAxLDExMCw5OSwwLDEsMCwwXSksYT10LnNjaGkoZSk7cmV0dXJuIHQuYm94KHQudHlwZXMuc2luZixyLHQuYm94KHQudHlwZXMuZnJtYSxuKSx0LmJveCh0LnR5cGVzLnNjaG0saSksYSl9fSx7a2V5OiJhdmMxaGV2MSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9ZS5jb2RlY1R5cGU9PT12cCxuPXI/dC50eXBlcy5odmMxOnQudHlwZXMuYXZjMSxpPXI/dC5odmNDKGUpOnQuYXZjQyhlKSxhPVtuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsZS53aWR0aD4+OCYyNTUsMjU1JmUud2lkdGgsZS5oZWlnaHQ+PjgmMjU1LDI1NSZlLmhlaWdodCwwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNCwxNywxN10pLGldO3JldHVybiByP2EucHVzaCh0LmJveCh0LnR5cGVzLmZpZWwsbmV3IFVpbnQ4QXJyYXkoWzEsMF0pKSk6ZS5zYXJSYXRpbyYmZS5zYXJSYXRpby5sZW5ndGg+MSYmYS5wdXNoKHQucGFzcChlLnNhclJhdGlvKSksdC5ib3guYXBwbHkodCxbbl0uY29uY2F0KGEpKX19LHtrZXk6ImF2Y0MiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByLG4saSxhPVtdLG89W107cmV0dXJuIGUuc3BzLmZvckVhY2goKGZ1bmN0aW9uKHQpe2k9dC5ieXRlTGVuZ3RoLGEucHVzaChpPj4+OCYyNTUpLGEucHVzaCgyNTUmaSksYS5wdXNoLmFwcGx5KGEsdXAodCkpfSkpLGUucHBzLmZvckVhY2goKGZ1bmN0aW9uKHQpe2k9dC5ieXRlTGVuZ3RoLG8ucHVzaChpPj4+OCYyNTUpLG8ucHVzaCgyNTUmaSksby5wdXNoLmFwcGx5KG8sdXAodCkpfSkpLHQuYm94KHQudHlwZXMuYXZjQyxuZXcgVWludDhBcnJheSgocj0obj1bMSxhWzNdLGFbNF0sYVs1XSwyNTUsMjI0fGUuc3BzLmxlbmd0aF0pLmNvbmNhdC5hcHBseShuLGEpLmNvbmNhdChbZS5wcHMubGVuZ3RoXSkpLmNvbmNhdC5hcHBseShyLG8pKSl9fSx7a2V5OiJodmNDIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1lLmh2Y0M7aWYociBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHxyIGluc3RhbmNlb2YgVWludDhBcnJheSlyZXR1cm4gcjt2YXIgbixpPWUudnBzLGE9ZS5zcHMsbz1lLnBwcztpZihyKXt2YXIgcz1yLmdlbmVyYWxQcm9maWxlQ29tcGF0aWJpbGl0eUZsYWdzLHU9ci5nZW5lcmFsQ29uc3RyYWludEluZGljYXRvckZsYWdzLGM9KGkubGVuZ3RoJiYxKSsoYS5sZW5ndGgmJjEpKyhvLmxlbmd0aCYmMSk7bj1bMSxyLmdlbmVyYWxQcm9maWxlU3BhY2U8PDZ8ci5nZW5lcmFsVGllckZsYWc8PDV8ci5nZW5lcmFsUHJvZmlsZUlkYyxzPj4+MjQscz4+PjE2LHM+Pj44LHMsdVswXSx1WzFdLHVbMl0sdVszXSx1WzRdLHVbNV0sci5nZW5lcmFsTGV2ZWxJZGMsMjQwLDAsMjUyLDI1MnxyLmNocm9tYUZvcm1hdElkYywyNDh8ci5iaXREZXB0aEx1bWFNaW51czgsMjQ4fHIuYml0RGVwdGhDaHJvbWFNaW51czgsMCwwLHIubnVtVGVtcG9yYWxMYXllcnM8PDN8ci50ZW1wb3JhbElkTmVzdGVkPDwyfDMsY107dmFyIGY9ZnVuY3Rpb24odCl7dmFyIGU7bi5wdXNoKHQubGVuZ3RoPj44LHQubGVuZ3RoKSwoZT1uKS5wdXNoLmFwcGx5KGUsdXAodCkpfTtpLmxlbmd0aCYmKG4ucHVzaCgxNjAsMCxpLmxlbmd0aCksaS5mb3JFYWNoKGYpKSxhLmxlbmd0aCYmKG4ucHVzaCgxNjEsMCxhLmxlbmd0aCksYS5mb3JFYWNoKGYpKSxvLmxlbmd0aCYmKG4ucHVzaCgxNjIsMCxvLmxlbmd0aCksby5mb3JFYWNoKGYpKX1lbHNlIG49WzEsMSw5NiwwLDAsMCwxNDQsMCwwLDAsMCwwLDkzLDI0MCwwLDI1MiwyNTMsMjQ4LDI0OCwwLDAsMTUsMywxNjAsMCwxLDAsMjQsNjQsMSwxMiwxLDI1NSwyNTUsMSw5NiwwLDAsMywwLDE0NCwwLDAsMywwLDAsMywwLDkzLDE1MywxNTIsOSwxNjEsMCwxLDAsNDUsNjYsMSwxLDEsOTYsMCwwLDMsMCwxNDQsMCwwLDMsMCwwLDMsMCw5MywxNjAsMiwxMjgsMTI4LDQ1LDIyLDg5LDE1MywxNjQsMTQ3LDQzLDE1NCwxMjgsMTI4LDEyOCwxMzAsMCwwLDMsMCwyLDAsMCwzLDAsNTAsMTYsMTYyLDAsMSwwLDcsNjgsMSwxOTMsMTE0LDE4MCw5OCw2NF07cmV0dXJuIHQuYm94KHQudHlwZXMuaHZjQyxuZXcgVWludDhBcnJheShuKSl9fSx7a2V5OiJwYXNwIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1zcChlLDIpLG49clswXSxpPXJbMV07cmV0dXJuIHQuYm94KHQudHlwZXMucGFzcCxuZXcgVWludDhBcnJheShbbj4+MjQsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuLGk+PjI0LGk+PjE2JjI1NSxpPj44JjI1NSwyNTUmaV0pKX19LHtrZXk6Im1wNGEiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmJveCh0LnR5cGVzLm1wNGEsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCxlLmNoYW5uZWxDb3VudCwwLDE2LDAsMCwwLDAsZS5zYW1wbGVSYXRlPj44JjI1NSwyNTUmZS5zYW1wbGVSYXRlLDAsMF0pLGUuY29uZmlnLmxlbmd0aD90LmVzZHMoZS5jb25maWcpOnZvaWQgMCl9fSx7a2V5OiJlc2RzIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1lLmxlbmd0aDtyZXR1cm4gdC5ib3godC50eXBlcy5lc2RzLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDMsMjMrciwwLDAsMCw0LDE1K3IsNjQsMjEsMCw2LDAsMCwwLDIxOCwxOTIsMCwwLDIxOCwxOTIsNV0uY29uY2F0KFtyXSkuY29uY2F0KGUpLmNvbmNhdChbNiwxLDJdKSkpfX0se2tleToibXZleCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94LmFwcGx5KHQsW3QudHlwZXMubXZleF0uY29uY2F0KHVwKGUubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gdC50cmV4KGUuaWQpfSkpKSkpfX0se2tleToidHJleCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94KHQudHlwZXMudHJleCxuZXcgVWludDhBcnJheShbMCwwLDAsMCxlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmUsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMV0pKX19LHtrZXk6InRyZXgxIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy50cmV4LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLGU+PjI0LGU+PjE2JjI1NSxlPj44JjI1NSwyNTUmZSwwLDAsMCwxLDAsMCwyLDAsMCwwLDAsMCwwLDEsMCwwXSkpfX0se2tleToidHJleDIiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmJveCh0LnR5cGVzLnRyZXgsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlLDAsMCwwLDEsMCwwLDQsMCwwLDAsMCwwLDIsMCwwLDBdKSl9fSx7a2V5OiJtb29mIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3guYXBwbHkodCxbdC50eXBlcy5tb29mLHQubWZoZChlWzBdLnNhbXBsZXM/ZVswXS5zYW1wbGVzWzBdLmdvcElkOjApXS5jb25jYXQodXAoZS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiB0LnRyYWYoZSl9KSkpKSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy5tZmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLGU+PjI0LGU+PjE2JjI1NSxlPj44JjI1NSwyNTUmZV0pKX19LHtrZXk6InRyYWYiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPXQudGZoZChlLmlkKSxuPXQudGZkdChlLGUuYmFzZU1lZGlhRGVjb2RlVGltZSksaT0wO2lmKGUuaXNWaWRlbyYmZS52aWRlb1NlbmMmJmUudmlkZW9TZW5jLmZvckVhY2goKGZ1bmN0aW9uKHQpe2krPTgsdC5zdWJzYW1wbGVzJiZ0LnN1YnNhbXBsZXMubGVuZ3RoJiYoaSs9MixpKz02KnQuc3Vic2FtcGxlcy5sZW5ndGgpfSkpLGUudmlkZW9TZW5jTGVuZ3RoPWksZS51c2VFTUUmJihlLmlzVmlkZW9FbmNyeXB0aW9ufHxlLmlzQXVkaW9FbmNyeXB0aW9uKSl7aWYoZS5pc1ZpZGVvRW5jcnlwdGlvbil7aWYoZS5pc1ZpZGVvKXt2YXIgYT10LnNhaXooZSksbz10LnNhaW8oZSkscz10LnRydW4xKGUpLHU9dC5zZW5jKGUpO3JldHVybiB0LmJveCh0LnR5cGVzLnRyYWYscixuLGEsbyxzLHUpfWlmKGUuaXNBdWRpb0VuY3J5cHRpb24pe3ZhciBjPXQuc2JncCgpLGY9dC5zYWl6KGUpLGw9dC5zYWlvKGUpLGg9dC5zZW5jKGUpLGQ9dC50cnVuMShlKTtyZXR1cm4gdC5ib3godC50eXBlcy50cmFmLHIsbixjLGYsbCxoLGQpfXZhciBwPXQuc2JncCgpLHY9dC50cnVuMShlKTtyZXR1cm4gdC5ib3godC50eXBlcy50cmFmLHIsbixwLHYpfWlmKGUuaXNWaWRlbyl7dmFyIHk9dC50cnVuMShlKTtyZXR1cm4gdC5ib3godC50eXBlcy50cmFmLHIsbix5KX12YXIgZz10LnNiZ3AoKSxtPXQuc2FpeihlKSxiPXQuc2FpbyhlKSx3PXQuc2VuYyhlKSxrPXQudHJ1bjEoZSk7cmV0dXJuIHQuYm94KHQudHlwZXMudHJhZixyLG4sZyxtLGIsdyxrKX12YXIgeD10LnNkdHAoZSk7cmV0dXJuIHQuYm94KHQudHlwZXMudHJhZixyLG4seCx0LnRydW4oZS5zYW1wbGVzLHguYnl0ZUxlbmd0aCs3NikpfX0se2tleToic2R0cCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9bmV3IEJ5O3JldHVybiBlLnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24odCl7ci53cml0ZShuZXcgVWludDhBcnJheShlLmlzVmlkZW8/W3Qua2V5ZnJhbWU/MzI6MTZdOlsxNl0pKX0pKSx0LmJveCh0LnR5cGVzLnNkdHAsdGhpcy5leHRlbnNpb24oMCwwKSxyLmJ1ZmZlcil9fSx7a2V5OiJ0cnVuMSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9bmV3IEJ5LG49Qnkud3JpdGVVaW50MzIoZS5zYW1wbGVzLmxlbmd0aCksaT1udWxsO2lmKGUuaXNWaWRlbyl7dmFyIGE9ZS52aWRlb1NlbmNMZW5ndGg7aT1CeS53cml0ZVVpbnQzMigxNiplLnNhbXBsZXMubGVuZ3RoK2ErMTQ5KSwhZS5pc1ZpZGVvRW5jcnlwdGlvbiYmZS5pc0F1ZGlvRW5jcnlwdGlvbiYmKGk9Qnkud3JpdGVVaW50MzIoMTYqZS5zYW1wbGVzLmxlbmd0aCs5MikpfWVsc2V7dmFyIG89MTIqZS5zYW1wbGVzLmxlbmd0aCsxMjQ7ZS5pc0F1ZGlvRW5jcnlwdGlvbiYmKG89MTIqZS5zYW1wbGVzLmxlbmd0aCs4KmUuYXVkaW9TZW5jLmxlbmd0aCsxNzcpLGk9Qnkud3JpdGVVaW50MzIobyl9cmV0dXJuIGUuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0KXtyLndyaXRlKEJ5LndyaXRlVWludDMyKHQuZHVyYXRpb24pKSxyLndyaXRlKEJ5LndyaXRlVWludDMyKHQuc2l6ZSkpLHIud3JpdGUoQnkud3JpdGVVaW50MzIodC5rZXlmcmFtZT8zMzU1NDQzMjo2NTUzNikpLGUuaXNWaWRlbyYmci53cml0ZShCeS53cml0ZVVpbnQzMih0LmN0cz90LmN0czowKSl9KSksdC5ib3godC50eXBlcy50cnVuLHRoaXMuZXh0ZW5zaW9uKDAsZS5mbGFncyksbixpLHIuYnVmZmVyKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPW5ldyBCeSxuPWUuc2FtcGxlcy5sZW5ndGgsaT1lLmlzVmlkZW8/MTY6OCxhPWUuaXNWaWRlbz8yOjAsbz1bXSxzPTA7cmV0dXJuIGUuaXNWaWRlbz8obz1lLnZpZGVvU2VuYyxzPWUudmlkZW9TZW5jTGVuZ3RoKTpvPWUuYXVkaW9TZW5jLHM9c3x8aSpuLHIud3JpdGUoQnkud3JpdGVVaW50MzIoMTYrcyksdC50eXBlcy5zZW5jLHRoaXMuZXh0ZW5zaW9uKDAsYSkpLHIud3JpdGUoQnkud3JpdGVVaW50MzIobikpLG8uZm9yRWFjaCgoZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0LkluaXRpYWxpemF0aW9uVmVjdG9yLmxlbmd0aDtlKyspci53cml0ZShuZXcgVWludDhBcnJheShbdC5Jbml0aWFsaXphdGlvblZlY3RvcltlXV0pKTt0LnN1YnNhbXBsZXMmJnQuc3Vic2FtcGxlcy5sZW5ndGgmJihyLndyaXRlKEJ5LndyaXRlVWludDE2KHQuc3Vic2FtcGxlcy5sZW5ndGgpKSx0LnN1YnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24odCl7ci53cml0ZShCeS53cml0ZVVpbnQxNih0LkJ5dGVzT2ZDbGVhckRhdGEpKSxyLndyaXRlKEJ5LndyaXRlVWludDMyKHQuQnl0ZXNPZlByb3RlY3RlZERhdGEpKX0pKSl9KSksci5idWZmZXJ9fSx7a2V5OiJzYWlvIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj0xMiplLnNhbXBsZXMubGVuZ3RoKzE0MTshZS5pc1ZpZGVvJiZlLmlzQXVkaW9FbmNyeXB0aW9uJiYocj0xNDkpO3ZhciBuPW5ldyBVaW50OEFycmF5KFsxLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIHQuYm94KHQudHlwZXMuc2FpbyxuKX19LHtrZXk6InNhaXoiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPWUuc2FtcGxlcy5sZW5ndGgsbj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwxNixyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIHQuYm94KHQudHlwZXMuc2FpeixuKX19LHtrZXk6InNiZ3AiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9bmV3IFVpbnQ4QXJyYXkoWzExNCwxMTEsMTA4LDEwOCwwLDAsMCwxLDAsMCwxLDI1LDAsMCwwLDFdKTtyZXR1cm4gdC5ib3godC50eXBlcy5zYmdwLHRoaXMuZXh0ZW5zaW9uKDAsMCksZSl9fSx7a2V5OiJleHRlbnNpb24iLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFt0LGU+PjE2JjI1NSxlPj44JjI1NSwyNTUmZV0pfX0se2tleToidGZoZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94KHQudHlwZXMudGZoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCxlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdKSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbihlLHIpe3ZhciBuPU1hdGguZmxvb3Ioci8oVXkrMSkpLGk9TWF0aC5mbG9vcihyJShVeSsxKSk7cmV0dXJuIGUudXNlRU1FJiYoZS5pc1ZpZGVvRW5jcnlwdGlvbnx8ZS5pc0F1ZGlvRW5jcnlwdGlvbik/dC5ib3godC50eXBlcy50ZmR0LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLGk+PjI0LGk+PjE2JjI1NSxpPj44JjI1NSwyNTUmaV0pKTp0LmJveCh0LnR5cGVzLnRmZHQsbmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDAsbj4+MjQsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuLGk+PjI0LGk+PjE2JjI1NSxpPj44JjI1NSwyNTUmaV0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKGUscil7dmFyIG49ZS5sZW5ndGgsaT0xMisxNipuO3IrPTgraTt2YXIgYT1uZXcgVWludDhBcnJheShpKTthLnNldChbMCwwLDE1LDEsbj4+PjI0JjI1NSxuPj4+MTYmMjU1LG4+Pj44JjI1NSwyNTUmbixyPj4+MjQmMjU1LHI+Pj4xNiYyNTUscj4+PjgmMjU1LDI1NSZyXSwwKTtmb3IodmFyIG89MDtvPG47bysrKXt2YXIgcz1lW29dLHU9cy5kdXJhdGlvbixjPXMuc2l6ZSxmPXMuZmxhZyxsPXZvaWQgMD09PWY/e306ZixoPXMuY3RzLGQ9dm9pZCAwPT09aD8wOmg7YS5zZXQoW3U+Pj4yNCYyNTUsdT4+PjE2JjI1NSx1Pj4+OCYyNTUsMjU1JnUsYz4+PjI0JjI1NSxjPj4+MTYmMjU1LGM+Pj44JjI1NSwyNTUmYyxsLmlzTGVhZGluZzw8MnwobnVsbD09PWwuZGVwZW5kc09ufHx2b2lkIDA9PT1sLmRlcGVuZHNPbj8xOmwuZGVwZW5kc09uKSxsLmlzRGVwZW5kZWRPbjw8NnxsLmhhc1JlZHVuZGFuY3k8PDR8bC5wYWRkaW5nVmFsdWU8PDF8KG51bGw9PT1sLmlzTm9uU3luY1NhbXBsZXx8dm9pZCAwPT09bC5pc05vblN5bmNTYW1wbGU/MTpsLmlzTm9uU3luY1NhbXBsZSksNjE0NDAmbC5kZWdyYWRhdGlvblByaW9yaXR5LDE1JmwuZGVncmFkYXRpb25Qcmlvcml0eSxkPj4+MjQmMjU1LGQ+Pj4xNiYyNTUsZD4+PjgmMjU1LDI1NSZkXSwxMisxNipvKX1yZXR1cm4gdC5ib3godC50eXBlcy50cnVuLGEpfX0se2tleToibW9vdk1QNCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94LmFwcGx5KHQsW3QudHlwZXMubW9vdix0Lm12aGQoZVswXS5kdXJhdGlvbixlWzBdLnRpbWVzY2FsZSldLmNvbmNhdCh1cChlLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQudHJhY2tNUDQoZSl9KSkpKSl9fSx7a2V5OiJ0cmFja01QNCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94KHQudHlwZXMudHJhayx0LnRraGQoZS5pZCxlLmR1cmF0aW9uLGUud2lkdGgsZS5oZWlnaHQpLHQubWRpYU1QNChlKSl9fSx7a2V5OiJtZGlhTVA0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5ib3godC50eXBlcy5tZGlhLHQubWRoZChlLmR1cmF0aW9uLGUudGltZXNjYWxlKSx0LmhkbHIoZS50eXBlKSx0Lm1pbmZNUDQoZSkpfX0se2tleToibWluZk1QNCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYm94KHQudHlwZXMubWluZixlLnR5cGU9PT1scD90LlZNSEQ6dC5TTUhELHQuRElORix0LnN0YmxNUDQoZSkpfX0se2tleToic3RibE1QNCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9ZS5leHQsbj1bdC5zdHNkKGUpLHQuc3R0cyhyLnN0dHMpLHQuc3RzYyhyLnN0c2MpLHQuc3RzeihyLnN0c3opLHQuc3RjbyhyLnN0Y28pXTtyZXR1cm4gci5zdHNzLmxlbmd0aCYmbi5wdXNoKHQuc3RzcyhyLnN0c3MpKSxyLmN0dHMubGVuZ3RoJiZuLnB1c2godC5jdHRzKHIuY3R0cykpLHQuYm94LmFwcGx5KHQsW3QudHlwZXMuc3RibF0uY29uY2F0KG4pKX19LHtrZXk6InN0dHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPWUubGVuZ3RoLG49bmV3IFVpbnQ4QXJyYXkoOCpyKSxpPTA7cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24odCl7dmFyIGU9dC52YWx1ZSxyPXQuY291bnQ7bi5zZXQoW3I+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcixlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLGkpLGkrPTh9KSksdC5ib3godC50eXBlcy5zdHRzLHF2KG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLG4pKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPWUubGVuZ3RoLG49bmV3IFVpbnQ4QXJyYXkoMTIqciksaT0wO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBlPXQuZmlyc3RDaHVuayxyPXQuc2FtcGxlc1BlckNodW5rLGE9dC5zYW1wbGVEZXNjSW5kZXg7bi5zZXQoW2U+PjI0LGU+PjE2JjI1NSxlPj44JjI1NSwyNTUmZSxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsYT4+MjQsYT4+MTYmMjU1LGE+PjgmMjU1LDI1NSZhXSxpKSxpKz0xMn0pKSx0LmJveCh0LnR5cGVzLnN0c2MscXYobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksbikpfX0se2tleToic3RzeiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9ZS5sZW5ndGgsbj1uZXcgVWludDhBcnJheSg0KnIpLGk9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbih0KXtuLnNldChbdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSxpKSxpKz00fSkpLHQuYm94KHQudHlwZXMuc3RzeixxdihuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLG4pKX19LHtrZXk6InN0Y28iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciByPWUubGVuZ3RoLG49bmV3IFVpbnQ4QXJyYXkoNCpyKSxpPTA7cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24odCl7bi5zZXQoW3Q+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0saSksaSs9NH0pKSx0LmJveCh0LnR5cGVzLnN0Y28scXYobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksbikpfX0se2tleToic3RzcyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHI9ZS5sZW5ndGgsbj1uZXcgVWludDhBcnJheSg0KnIpLGk9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbih0KXtuLnNldChbdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSxpKSxpKz00fSkpLHQuYm94KHQudHlwZXMuc3RzcyxxdihuZXcgVWludDhBcnJheShbMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxuKSl9fSx7a2V5OiJjdHRzIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1lLmxlbmd0aCxuPW5ldyBVaW50OEFycmF5KDgqciksaT0wO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBlPXQudmFsdWUscj10LmNvdW50O24uc2V0KFtyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlXSxpKSxpKz04fSkpLHQuYm94KHQudHlwZXMuY3R0cyxxdihuZXcgVWludDhBcnJheShbMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxuKSl9fSx7a2V5OiJzdHlwIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0LmJveCh0LnR5cGVzLnN0eXAsbmV3IFVpbnQ4QXJyYXkoWzEwOSwxMTUsMTAwLDEwNCwwLDAsMCwwLDEwOSwxMTUsMTAwLDEwNCwxMDksMTE1LDEwNSwxMjBdKSl9fSx7a2V5OiJzaWR4Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcj1lLnRpbWVzY2FsZSxuPWUuc2FtcGxlc1swXS5kdXJhdGlvbixpPW4qZS5zYW1wbGVzLmxlbmd0aCxhPWUuc2FtcGxlc1swXS5zYW1wbGVPZmZzZXQqbixvPTg7ZS5zYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHQpe28rPXQuc2l6ZX0pKTt2YXIgcz0wO2lmKGUuaXNWaWRlbyl7dmFyIHUsYz0wO2UudmlkZW9TZW5jJiYodT1lLnZpZGVvU2VuYyksZS5pc1ZpZGVvJiZ1LmZvckVhY2goKGZ1bmN0aW9uKHQpe2MrPTgsdC5zdWJzYW1wbGVzJiZ0LnN1YnNhbXBsZXMubGVuZ3RoJiYoYys9MixjKz02KnQuc3Vic2FtcGxlcy5sZW5ndGgpfSkpLGUudmlkZW9TZW5jTGVuZ3RoPWMscz1vKzE0MSsxNiplLnNhbXBsZXMubGVuZ3RoK2MsZS51c2VFTUUmJmUuaXNBdWRpb0VuY3J5cHRpb24mJiFlLmlzVmlkZW9FbmNyeXB0aW9uJiYocz1vKzE2KmUuc2FtcGxlcy5sZW5ndGgrODQpfWVsc2Ugcz1vKzExNisxMiplLnNhbXBsZXMubGVuZ3RoLGUudXNlRU1FJiZlLmlzQXVkaW9FbmNyeXB0aW9uJiYocz1vKzE2OSsxMiplLnNhbXBsZXMubGVuZ3RoKzgqZS5hdWRpb1NlbmMubGVuZ3RoKTt2YXIgZj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwyNTUmZS5pZCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyLGE+PjI0JjI1NSxhPj4xNiYyNTUsYT4+OCYyNTUsMjU1JmEsMCwwLDAsMCwwLDAsMCwxLDAscz4+MTYmMjU1LHM+PjgmMjU1LDI1NSZzLGk+PjI0JjI1NSxpPj4xNiYyNTUsaT4+OCYyNTUsMjU1JmksMTQ0LDAsMCwwXSk7cmV0dXJuIHQuYm94KHQudHlwZXMuc2lkeCxmKX19LHtrZXk6Im1kYXQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmJveCh0LnR5cGVzLm1kYXQsZSl9fV0pLHR9KCk7b3AoRHksInR5cGVzIixbImF2YzEiLCJhdmNDIiwiaHZjMSIsImh2Y0MiLCJkaW5mIiwiZHJlZiIsImVzZHMiLCJmdHlwIiwiaGRsciIsIm1kYXQiLCJtZGhkIiwibWRpYSIsIm1maGQiLCJtaW5mIiwibW9vZiIsIm1vb3YiLCJtcDRhIiwibXZleCIsIm12aGQiLCJwYXNwIiwic3RibCIsInN0Y28iLCJzdHNjIiwic3RzZCIsInN0c3oiLCJzdHRzIiwidGZkdCIsInRmaGQiLCJ0cmFmIiwidHJhayIsInRyZXgiLCJ0a2hkIiwidm1oZCIsInNtaGQiLCJjdHRzIiwic3RzcyIsInN0eXAiLCJwc3NoIiwic2lkeCIsInNiZ3AiLCJzYWl6Iiwic2FpbyIsInNlbmMiLCJ0cnVuIiwiZW5jdiIsImVuY2EiLCJzaW5mIiwiYnRydCIsImZybWEiLCJ0ZW5jIiwic2NobSIsInNjaGkiLCJtZWhkIiwiZmllbCIsInNkdHAiXS5yZWR1Y2UoKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRbZV09W2UuY2hhckNvZGVBdCgwKSxlLmNoYXJDb2RlQXQoMSksZS5jaGFyQ29kZUF0KDIpLGUuY2hhckNvZGVBdCgzKV0sdH0pLE9iamVjdC5jcmVhdGUobnVsbCkpKSxvcChEeSwiSERMUl9UWVBFUyIse3ZpZGVvOm5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMTE4LDEwNSwxMDAsMTAxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDg2LDEwNSwxMDAsMTAxLDExMSw3Miw5NywxMTAsMTAwLDEwOCwxMDEsMTE0LDBdKSxhdWRpbzpuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDExNSwxMTEsMTE3LDExMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw4MywxMTEsMTE3LDExMCwxMDAsNzIsOTcsMTEwLDEwMCwxMDgsMTAxLDExNCwwXSl9KSxvcChEeSwiRlRZUEFWQzEiLER5LmJveChEeS50eXBlcy5mdHlwLG5ldyBVaW50OEFycmF5KFsxMDUsMTE1LDExMSwxMDksMCwwLDAsMSwxMDUsMTE1LDExMSwxMDksOTcsMTE4LDk5LDQ5XSkpKSxvcChEeSwiRlRZUEhFVjEiLER5LmJveChEeS50eXBlcy5mdHlwLG5ldyBVaW50OEFycmF5KFsxMDUsMTE1LDExMSwxMDksMCwwLDAsMSwxMDUsMTE1LDExMSwxMDksMTA0LDEwMSwxMTgsNDldKSkpLG9wKER5LCJESU5GIixEeS5ib3goRHkudHlwZXMuZGluZixEeS5ib3goRHkudHlwZXMuZHJlZixuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDEyLDExNywxMTQsMTA4LDMyLDAsMCwwLDFdKSkpKSxvcChEeSwiVk1IRCIsRHkuYm94KER5LnR5cGVzLnZtaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwXSkpKSxvcChEeSwiU01IRCIsRHkuYm94KER5LnR5cGVzLnNtaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMF0pKSksb3AoRHksIlN0YmxUYWJsZSIsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMF0pKSxvcChEeSwiU1RUUyIsRHkuYm94KER5LnR5cGVzLnN0dHMsRHkuU3RibFRhYmxlKSksb3AoRHksIlNUU0MiLER5LmJveChEeS50eXBlcy5zdHNjLER5LlN0YmxUYWJsZSkpLG9wKER5LCJTVFNaIixEeS5ib3goRHkudHlwZXMuc3RzeixuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDBdKSkpLG9wKER5LCJTVENPIixEeS5ib3goRHkudHlwZXMuc3RjbyxEeS5TdGJsVGFibGUpKTt2YXIgank9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUscil7bnAodGhpcyx0KSx0aGlzLm5hbWU9ZXx8IiIsdGhpcy5fcHJlZml4PSJbIi5jb25jYXQodGhpcy5uYW1lLCJdIiksdC5kaXNhYmxlZD1yfXJldHVybiBhcCh0LFt7a2V5OiJkZWJ1ZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtpZighdC5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsbj1uZXcgQXJyYXkociksaT0wO2k8cjtpKyspbltpXT1hcmd1bWVudHNbaV07KGU9Y29uc29sZSkuZGVidWcuYXBwbHkoZSxbdGhpcy5fcHJlZml4XS5jb25jYXQobikpfX19LHtrZXk6ImxvZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtpZighdC5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsbj1uZXcgQXJyYXkociksaT0wO2k8cjtpKyspbltpXT1hcmd1bWVudHNbaV07KGU9Y29uc29sZSkubG9nLmFwcGx5KGUsW3RoaXMuX3ByZWZpeF0uY29uY2F0KG4pKX19fSx7a2V5OiJ3YXJuIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO2lmKCF0LmRpc2FibGVkKXtmb3IodmFyIHI9YXJndW1lbnRzLmxlbmd0aCxuPW5ldyBBcnJheShyKSxpPTA7aTxyO2krKyluW2ldPWFyZ3VtZW50c1tpXTsoZT1jb25zb2xlKS53YXJuLmFwcGx5KGUsW3RoaXMuX3ByZWZpeF0uY29uY2F0KG4pKX19fSx7a2V5OiJlcnJvciIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtpZighdC5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsbj1uZXcgQXJyYXkociksaT0wO2k8cjtpKyspbltpXT1hcmd1bWVudHNbaV07KGU9Y29uc29sZSkuZXJyb3IuYXBwbHkoZSxbdGhpcy5fcHJlZml4XS5jb25jYXQobikpfX19LHtrZXk6InRhYmxlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO3QuZGlzYWJsZWR8fChjb25zb2xlLmdyb3VwKHRoaXMuX3ByZWZpeCksKGU9Y29uc29sZSkudGFibGUuYXBwbHkoZSxhcmd1bWVudHMpLGNvbnNvbGUuZ3JvdXBFbmQoKSl9fV0sW3trZXk6ImVuYWJsZSIsdmFsdWU6ZnVuY3Rpb24oKXt0LmRpc2FibGVkPSExfX0se2tleToiZGlzYWJsZSIsdmFsdWU6ZnVuY3Rpb24oKXt0LmRpc2FibGVkPSEwfX1dKSx0fSgpO29wKGp5LCJkaXNhYmxlZCIsITApO3ZhciB6eT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSxyLG4pe25wKHRoaXMsdCksdGhpcy52aWRlb1RyYWNrPWUsdGhpcy5hdWRpb1RyYWNrPXI7dmFyIGk9L0Nocm9tZVwvKFteLl0rKS8uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KTt0aGlzLmZvcmNlRmlyc3RJRFI9aSYmTnVtYmVyKGlbMV0pPDUwLHRoaXMubG9nPW5ldyBqeSgiRk1QNFJlbXV4ZXIiLCFufHwhbi5vcGVuTG9nfHwhbi5vcGVuTG9nKX1yZXR1cm4gYXAodCxbe2tleToicmVtdXgiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQsZSxyLG4saSxhPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdJiZhcmd1bWVudHNbMF0sbz1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30scz10aGlzLnZpZGVvVHJhY2ssdT10aGlzLmF1ZGlvVHJhY2ssYz1zLmV4aXN0KCksZj11LmV4aXN0KCksbD1bXTtyZXR1cm4gYSYmKG8mJm8uaW5pdE1lcmdlPyhjJiZsLnB1c2godGhpcy52aWRlb1RyYWNrKSxmJiZsLnB1c2godGhpcy5hdWRpb1RyYWNrKSxyPUR5LmluaXRTZWdtZW50KGwpKTooYyYmKHQ9RHkuaW5pdFNlZ21lbnQoW3RoaXMudmlkZW9UcmFja10pKSxmJiYoZT1EeS5pbml0U2VnbWVudChbdGhpcy5hdWRpb1RyYWNrXSkpKSksYyYmcy5oYXNTYW1wbGUoKSYmKG49dGhpcy5fcmVtdXhWaWRlbygpKSxmJiZ1Lmhhc1NhbXBsZSgpJiYoaT10aGlzLl9yZW11eEF1ZGlvKCkpLHMuc2FtcGxlcz1bXSx1LnNhbXBsZXM9W10se2luaXRTZWdtZW50OnIsdmlkZW9Jbml0U2VnbWVudDp0LGF1ZGlvSW5pdFNlZ21lbnQ6ZSx2aWRlb1NlZ21lbnQ6bixhdWRpb1NlZ21lbnQ6aX19fSx7a2V5OiJfcmVtdXhWaWRlbyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnZpZGVvVHJhY2s7dGhpcy5mb3JjZUZpcnN0SURSJiYodC5zYW1wbGVzWzBdLmZsYWc9e2RlcGVuZHNPbjoyLGlzTm9uU3luY1NhbXBsZTowfSk7dmFyIGU9dC5zYW1wbGVzLHI9MDtlLmZvckVhY2goKGZ1bmN0aW9uKHQpe3IrPXQudW5pdHMucmVkdWNlKChmdW5jdGlvbih0LGUpe3JldHVybiB0K2UuYnl0ZUxlbmd0aH0pLDApLHIrPTQqdC51bml0cy5sZW5ndGh9KSk7Zm9yKHZhciBuLGk9bmV3IFVpbnQ4QXJyYXkociksYT1uZXcgRGF0YVZpZXcoaS5idWZmZXIpLG89ZnVuY3Rpb24odCxyLG8scyl7cz1lW3RdO3ZhciB1PTA7cy51bml0cy5mb3JFYWNoKChmdW5jdGlvbih0KXthLnNldFVpbnQzMihvLHQuYnl0ZUxlbmd0aCksbys9NCxpLnNldCh0LG8pLG8rPXQuYnl0ZUxlbmd0aCx1Kz00K3QuYnl0ZUxlbmd0aH0pKSxzLnNpemU9dSxjPW8sbj1zfSxzPTAsdT1lLmxlbmd0aCxjPTA7czx1O3MrKylvKHMsMCxjLG4pO3ZhciBmPUR5Lm1kYXQoaSk7cmV0dXJuIHF2KER5Lm1vb2YoW3RdKSxmKX19LHtrZXk6Il9yZW11eEF1ZGlvIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuYXVkaW9UcmFjayxlPW5ldyBVaW50OEFycmF5KHQuc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZS5zaXplfSksMCkpO3Quc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKHQscil7cmV0dXJuIGUuc2V0KHIuZGF0YSx0KSx0K3Iuc2l6ZX0pLDApO3ZhciByPUR5Lm1kYXQoZSk7cmV0dXJuIHF2KER5Lm1vb2YoW3RdKSxyKX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudmlkZW9UcmFjay5yZXNldCgpLHRoaXMuYXVkaW9UcmFjay5yZXNldCgpfX1dKSx0fSgpLEx5PVIsRnk9YixWeT1kZSxOeT1CcixIeT1mcixLeT1mdCxZeT1BLCR5PU9iamVjdC5hc3NpZ24sV3k9T2JqZWN0LmRlZmluZVByb3BlcnR5LEd5PSEkeXx8RnkoKGZ1bmN0aW9uKCl7aWYoTHkmJjEhPT0keSh7YjoxfSwkeShXeSh7fSwiYSIse2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7V3kodGhpcywiYiIse3ZhbHVlOjMsZW51bWVyYWJsZTohMX0pfX0pLHtiOjJ9KSkuYilyZXR1cm4hMDt2YXIgdD17fSxlPXt9LHI9U3ltYm9sKCksbj0iYWJjZGVmZ2hpamtsbW5vcHFyc3QiO3JldHVybiB0W3JdPTcsbi5zcGxpdCgiIikuZm9yRWFjaCgoZnVuY3Rpb24odCl7ZVt0XT10fSkpLDchPSR5KHt9LHQpW3JdfHxWeSgkeSh7fSxlKSkuam9pbigiIikhPW59KSk/ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9S3kodCksbj1hcmd1bWVudHMubGVuZ3RoLGk9MSxhPU55LmYsbz1IeS5mO24+aTspZm9yKHZhciBzLHU9WXkoYXJndW1lbnRzW2krK10pLGM9YT9WeSh1KS5jb25jYXQoYSh1KSk6VnkodSksZj1jLmxlbmd0aCxsPTA7Zj5sOylzPWNbbCsrXSxMeSYmIW8uY2FsbCh1LHMpfHwocltzXT11W3NdKTtyZXR1cm4gcn06JHkscXk9R3k7Y24oe3RhcmdldDoiT2JqZWN0IixzdGF0OiEwLGZvcmNlZDpPYmplY3QuYXNzaWduIT09cXl9LHthc3NpZ246cXl9KSwoMCxraS5leHBvcnRzKSgiSW50OCIsKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQodGhpcyxlLHIsbil9fSkpLCgwLGtpLmV4cG9ydHMpKCJVaW50OCIsKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQodGhpcyxlLHIsbil9fSksITApLCgwLGtpLmV4cG9ydHMpKCJJbnQxNiIsKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQodGhpcyxlLHIsbil9fSkpLCgwLGtpLmV4cG9ydHMpKCJVaW50MTYiLChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3JldHVybiB0KHRoaXMsZSxyLG4pfX0pKSwoMCxraS5leHBvcnRzKSgiSW50MzIiLChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3JldHVybiB0KHRoaXMsZSxyLG4pfX0pKSwoMCxraS5leHBvcnRzKSgiVWludDMyIiwoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscixuKXtyZXR1cm4gdCh0aGlzLGUscixuKX19KSksKDAsa2kuZXhwb3J0cykoIkZsb2F0MzIiLChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3JldHVybiB0KHRoaXMsZSxyLG4pfX0pKSwoMCxraS5leHBvcnRzKSgiRmxvYXQ2NCIsKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIsbil7cmV0dXJuIHQodGhpcyxlLHIsbil9fSkpO2Zvcih2YXIgWHk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7cih0aGlzLHQpfXJldHVybiBpKHQsW3trZXk6Im1peEluIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLHQpfX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIE9iamVjdC5hc3NpZ24odCx0aGlzKSx0fX1dLFt7a2V5OiJjcmVhdGUiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsZT1uZXcgQXJyYXkodCkscj0wO3I8dDtyKyspZVtyXT1hcmd1bWVudHNbcl07cmV0dXJuIGYodGhpcyxlKX19XSksdH0oKSxReT1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKCl7dmFyIHQsaT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10sYT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06NCppLmxlbmd0aDtyKHRoaXMsbiksdD1lLmNhbGwodGhpcyk7dmFyIG89aTtpZihvIGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJihvPW5ldyBVaW50OEFycmF5KG8pKSwobyBpbnN0YW5jZW9mIEludDhBcnJheXx8byBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHxvIGluc3RhbmNlb2YgSW50MTZBcnJheXx8byBpbnN0YW5jZW9mIFVpbnQxNkFycmF5fHxvIGluc3RhbmNlb2YgSW50MzJBcnJheXx8byBpbnN0YW5jZW9mIFVpbnQzMkFycmF5fHxvIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHxvIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSYmKG89bmV3IFVpbnQ4QXJyYXkoby5idWZmZXIsby5ieXRlT2Zmc2V0LG8uYnl0ZUxlbmd0aCkpLG8gaW5zdGFuY2VvZiBVaW50OEFycmF5KXtmb3IodmFyIHM9by5ieXRlTGVuZ3RoLHU9W10sYz0wO2M8cztjKz0xKXVbYz4+PjJdfD1vW2NdPDwyNC1jJTQqODt0LndvcmRzPXUsdC5zaWdCeXRlcz1zfWVsc2UgdC53b3Jkcz1pLHQuc2lnQnl0ZXM9YTtyZXR1cm4gdH1yZXR1cm4gaShuLFt7a2V5OiJ0b1N0cmluZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06Snk7cmV0dXJuIHQuc3RyaW5naWZ5KHRoaXMpfX0se2tleToiY29uY2F0Iix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLndvcmRzLHI9dC53b3JkcyxuPXRoaXMuc2lnQnl0ZXMsaT10LnNpZ0J5dGVzO2lmKHRoaXMuY2xhbXAoKSxuJTQpZm9yKHZhciBhPTA7YTxpO2ErPTEpe3ZhciBvPXJbYT4+PjJdPj4+MjQtYSU0KjgmMjU1O2VbbithPj4+Ml18PW88PDI0LShuK2EpJTQqOH1lbHNlIGZvcih2YXIgcz0wO3M8aTtzKz00KWVbbitzPj4+Ml09cltzPj4+Ml07cmV0dXJuIHRoaXMuc2lnQnl0ZXMrPWksdGhpc319LHtrZXk6ImNsYW1wIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMud29yZHMsZT10aGlzLnNpZ0J5dGVzO3RbZT4+PjJdJj00Mjk0OTY3Mjk1PDwzMi1lJTQqOCx0Lmxlbmd0aD1NYXRoLmNlaWwoZS80KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXAocyhuLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiB0LndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksdH19XSxbe2tleToicmFuZG9tIix2YWx1ZTpmdW5jdGlvbih0KXtmb3IodmFyIGUscj1bXSxpPWZ1bmN0aW9uKHQpe3ZhciBlPXQscj05ODc2NTQzMjEsbj00Mjk0OTY3Mjk1O3JldHVybiBmdW5jdGlvbigpe3ZhciB0PSgocj0zNjk2OSooNjU1MzUmcikrKHI+PjE2KSZuKTw8MTYpKyhlPTE4ZTMqKDY1NTM1JmUpKyhlPj4xNikmbikmbjtyZXR1cm4gdC89NDI5NDk2NzI5NiwodCs9LjUpKihNYXRoLnJhbmRvbSgpPi41PzE6LTEpfX0sYT0wO2E8dDthKz00KXt2YXIgbz1pKDQyOTQ5NjcyOTYqKGV8fE1hdGgucmFuZG9tKCkpKTtlPTk4NzY1NDA3MSpvKCksci5wdXNoKDQyOTQ5NjcyOTYqbygpfDApfXJldHVybiBuZXcgbihyLHQpfX1dKSxufShYeSksSnk9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsbj1bXSxpPTA7aTxyO2krPTEpe3ZhciBhPWVbaT4+PjJdPj4+MjQtaSU0KjgmMjU1O24ucHVzaCgoYT4+PjQpLnRvU3RyaW5nKDE2KSksbi5wdXNoKCgxNSZhKS50b1N0cmluZygxNikpfXJldHVybiBuLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5sZW5ndGgscj1bXSxuPTA7bjxlO24rPTIpcltuPj4+M118PXBhcnNlSW50KHQuc3Vic3RyKG4sMiksMTYpPDwyNC1uJTgqNDtyZXR1cm4gbmV3IFF5KHIsZS8yKX19LFp5PWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10Lmxlbmd0aCxyPVtdLG49MDtuPGU7bis9MSlyW24+Pj4yXXw9KDI1NSZ0LmNoYXJDb2RlQXQobikpPDwyNC1uJTQqODtyZXR1cm4gbmV3IFF5KHIsZSl9LHRnPWZ1bmN0aW9uKHQpe3JldHVybiBaeSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodCkpKX0sZWc9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbigpe3ZhciB0O3JldHVybiByKHRoaXMsbiksKHQ9ZS5jYWxsKHRoaXMpKS5fbWluQnVmZmVyU2l6ZT0wLHR9cmV0dXJuIGkobixbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgUXksdGhpcy5fbkRhdGFCeXRlcz0wfX0se2tleToiX2FwcGVuZCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dDsic3RyaW5nIj09dHlwZW9mIGUmJihlPXRnKGUpKSx0aGlzLl9kYXRhLmNvbmNhdChlKSx0aGlzLl9uRGF0YUJ5dGVzKz1lLnNpZ0J5dGVzfX0se2tleToiX3Byb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlLHI9dGhpcy5fZGF0YSxuPXRoaXMuYmxvY2tTaXplLGk9ci53b3JkcyxhPXIuc2lnQnl0ZXMsbz1hLyg0Km4pLHM9KG89dD9NYXRoLmNlaWwobyk6TWF0aC5tYXgoKDB8byktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKSkqbix1PU1hdGgubWluKDQqcyxhKTtpZihzKXtmb3IodmFyIGM9MDtjPHM7Yys9bil0aGlzLl9kb1Byb2Nlc3NCbG9jayhpLGMpO2U9aS5zcGxpY2UoMCxzKSxyLnNpZ0J5dGVzLT11fXJldHVybiBuZXcgUXkoZSx1KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXAocyhuLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiB0Ll9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKSx0fX1dKSxufShYeSkscmc9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbih0KXt2YXIgaTtyZXR1cm4gcih0aGlzLG4pLChpPWUuY2FsbCh0aGlzKSkuYmxvY2tTaXplPTE2LGkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IFh5LHQpLGkucmVzZXQoKSxpfXJldHVybiBpKG4sW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AocyhuLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InVwZGF0ZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2FwcGVuZCh0KSx0aGlzLl9wcm9jZXNzKCksdGhpc319LHtrZXk6ImZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy5fYXBwZW5kKHQpLHRoaXMuX2RvRmluYWxpemUoKX19XSxbe2tleToiX2NyZWF0ZUhlbHBlciIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUscil7cmV0dXJuIG5ldyB0KHIpLmZpbmFsaXplKGUpfX19LHtrZXk6Il9jcmVhdGVIbWFjSGVscGVyIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyKXtyZXR1cm4gbmV3IG5nKHQscikuZmluYWxpemUoZSl9fX1dKSxufShlZyksbmc9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbih0LGkpe3ZhciBhO3IodGhpcyxuKSxhPWUuY2FsbCh0aGlzKTt2YXIgbz1uZXcgdDthLl9oYXNoZXI9bzt2YXIgcz1pOyJzdHJpbmciPT10eXBlb2YgcyYmKHM9dGcocykpO3ZhciB1PW8uYmxvY2tTaXplLGM9NCp1O3Muc2lnQnl0ZXM+YyYmKHM9by5maW5hbGl6ZShpKSkscy5jbGFtcCgpO3ZhciBmPXMuY2xvbmUoKTthLl9vS2V5PWY7dmFyIGw9cy5jbG9uZSgpO2EuX2lLZXk9bDtmb3IodmFyIGg9Zi53b3JkcyxkPWwud29yZHMscD0wO3A8dTtwKz0xKWhbcF1ePTE1NDk1NTY4MjgsZFtwXV49OTA5NTIyNDg2O3JldHVybiBmLnNpZ0J5dGVzPWMsbC5zaWdCeXRlcz1jLGEucmVzZXQoKSxhfXJldHVybiBpKG4sW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2hhc2hlcjt0LnJlc2V0KCksdC51cGRhdGUodGhpcy5faUtleSl9fSx7a2V5OiJ1cGRhdGUiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9oYXNoZXIudXBkYXRlKHQpLHRoaXN9fSx7a2V5OiJmaW5hbGl6ZSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5faGFzaGVyLHI9ZS5maW5hbGl6ZSh0KTtyZXR1cm4gZS5yZXNldCgpLGUuZmluYWxpemUodGhpcy5fb0tleS5jbG9uZSgpLmNvbmNhdChyKSl9fV0pLG59KFh5KSxpZz17c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe3ZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLG49dGhpcy5fbWFwO3QuY2xhbXAoKTtmb3IodmFyIGk9W10sYT0wO2E8cjthKz0zKWZvcih2YXIgbz0oZVthPj4+Ml0+Pj4yNC1hJTQqOCYyNTUpPDwxNnwoZVthKzE+Pj4yXT4+PjI0LShhKzEpJTQqOCYyNTUpPDw4fGVbYSsyPj4+Ml0+Pj4yNC0oYSsyKSU0KjgmMjU1LHM9MDtzPDQmJmErLjc1KnM8cjtzKz0xKWkucHVzaChuLmNoYXJBdChvPj4+NiooMy1zKSY2MykpO3ZhciB1PW4uY2hhckF0KDY0KTtpZih1KWZvcig7aS5sZW5ndGglNDspaS5wdXNoKHUpO3JldHVybiBpLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0KXt2YXIgZT10Lmxlbmd0aCxyPXRoaXMuX21hcCxuPXRoaXMuX3JldmVyc2VNYXA7aWYoIW4pe3RoaXMuX3JldmVyc2VNYXA9W10sbj10aGlzLl9yZXZlcnNlTWFwO2Zvcih2YXIgaT0wO2k8ci5sZW5ndGg7aSs9MSluW3IuY2hhckNvZGVBdChpKV09aX12YXIgYT1yLmNoYXJBdCg2NCk7aWYoYSl7dmFyIG89dC5pbmRleE9mKGEpOy0xIT09byYmKGU9byl9cmV0dXJuIGZ1bmN0aW9uKHQsZSxyKXtmb3IodmFyIG49W10saT0wLGE9MDthPGU7YSs9MSlpZihhJTQpe3ZhciBvPXJbdC5jaGFyQ29kZUF0KGEtMSldPDxhJTQqMnxyW3QuY2hhckNvZGVBdChhKV0+Pj42LWElNCoyO25baT4+PjJdfD1vPDwyNC1pJTQqOCxpKz0xfXJldHVybiBReS5jcmVhdGUobixpKX0odCxlLG4pfSxfbWFwOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSJ9LGFnPVtdLG9nPTA7b2c8NjQ7b2crPTEpYWdbb2ddPTQyOTQ5NjcyOTYqTWF0aC5hYnMoTWF0aC5zaW4ob2crMSkpfDA7dmFyIHNnPWZ1bmN0aW9uKHQsZSxyLG4saSxhLG8pe3ZhciBzPXQrKGUmcnx+ZSZuKStpK287cmV0dXJuKHM8PGF8cz4+PjMyLWEpK2V9LHVnPWZ1bmN0aW9uKHQsZSxyLG4saSxhLG8pe3ZhciBzPXQrKGUmbnxyJn5uKStpK287cmV0dXJuKHM8PGF8cz4+PjMyLWEpK2V9LGNnPWZ1bmN0aW9uKHQsZSxyLG4saSxhLG8pe3ZhciBzPXQrKGVecl5uKStpK287cmV0dXJuKHM8PGF8cz4+PjMyLWEpK2V9LGZnPWZ1bmN0aW9uKHQsZSxyLG4saSxhLG8pe3ZhciBzPXQrKHJeKGV8fm4pKStpK287cmV0dXJuKHM8PGF8cz4+PjMyLWEpK2V9LGxnPWZ1bmN0aW9uKHQpe28obix0KTt2YXIgZT1oKG4pO2Z1bmN0aW9uIG4oKXtyZXR1cm4gcih0aGlzLG4pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBpKG4sW3trZXk6Il9kb1Jlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IFF5KFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX19LHtrZXk6Il9kb1Byb2Nlc3NCbG9jayIsdmFsdWU6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9dCxuPTA7bjwxNjtuKz0xKXt2YXIgaT1lK24sYT10W2ldO3JbaV09MTY3MTE5MzUmKGE8PDh8YT4+PjI0KXw0Mjc4MjU1MzYwJihhPDwyNHxhPj4+OCl9dmFyIG89dGhpcy5faGFzaC53b3JkcyxzPXJbZSswXSx1PXJbZSsxXSxjPXJbZSsyXSxmPXJbZSszXSxsPXJbZSs0XSxoPXJbZSs1XSxkPXJbZSs2XSxwPXJbZSs3XSx2PXJbZSs4XSx5PXJbZSs5XSxnPXJbZSsxMF0sbT1yW2UrMTFdLGI9cltlKzEyXSx3PXJbZSsxM10saz1yW2UrMTRdLHg9cltlKzE1XSxTPW9bMF0sQT1vWzFdLF89b1syXSxUPW9bM107Uz1zZyhTLEEsXyxULHMsNyxhZ1swXSksVD1zZyhULFMsQSxfLHUsMTIsYWdbMV0pLF89c2coXyxULFMsQSxjLDE3LGFnWzJdKSxBPXNnKEEsXyxULFMsZiwyMixhZ1szXSksUz1zZyhTLEEsXyxULGwsNyxhZ1s0XSksVD1zZyhULFMsQSxfLGgsMTIsYWdbNV0pLF89c2coXyxULFMsQSxkLDE3LGFnWzZdKSxBPXNnKEEsXyxULFMscCwyMixhZ1s3XSksUz1zZyhTLEEsXyxULHYsNyxhZ1s4XSksVD1zZyhULFMsQSxfLHksMTIsYWdbOV0pLF89c2coXyxULFMsQSxnLDE3LGFnWzEwXSksQT1zZyhBLF8sVCxTLG0sMjIsYWdbMTFdKSxTPXNnKFMsQSxfLFQsYiw3LGFnWzEyXSksVD1zZyhULFMsQSxfLHcsMTIsYWdbMTNdKSxfPXNnKF8sVCxTLEEsaywxNyxhZ1sxNF0pLEE9c2coQSxfLFQsUyx4LDIyLGFnWzE1XSksUz11ZyhTLEEsXyxULHUsNSxhZ1sxNl0pLFQ9dWcoVCxTLEEsXyxkLDksYWdbMTddKSxfPXVnKF8sVCxTLEEsbSwxNCxhZ1sxOF0pLEE9dWcoQSxfLFQsUyxzLDIwLGFnWzE5XSksUz11ZyhTLEEsXyxULGgsNSxhZ1syMF0pLFQ9dWcoVCxTLEEsXyxnLDksYWdbMjFdKSxfPXVnKF8sVCxTLEEseCwxNCxhZ1syMl0pLEE9dWcoQSxfLFQsUyxsLDIwLGFnWzIzXSksUz11ZyhTLEEsXyxULHksNSxhZ1syNF0pLFQ9dWcoVCxTLEEsXyxrLDksYWdbMjVdKSxfPXVnKF8sVCxTLEEsZiwxNCxhZ1syNl0pLEE9dWcoQSxfLFQsUyx2LDIwLGFnWzI3XSksUz11ZyhTLEEsXyxULHcsNSxhZ1syOF0pLFQ9dWcoVCxTLEEsXyxjLDksYWdbMjldKSxfPXVnKF8sVCxTLEEscCwxNCxhZ1szMF0pLEE9dWcoQSxfLFQsUyxiLDIwLGFnWzMxXSksUz1jZyhTLEEsXyxULGgsNCxhZ1szMl0pLFQ9Y2coVCxTLEEsXyx2LDExLGFnWzMzXSksXz1jZyhfLFQsUyxBLG0sMTYsYWdbMzRdKSxBPWNnKEEsXyxULFMsaywyMyxhZ1szNV0pLFM9Y2coUyxBLF8sVCx1LDQsYWdbMzZdKSxUPWNnKFQsUyxBLF8sbCwxMSxhZ1szN10pLF89Y2coXyxULFMsQSxwLDE2LGFnWzM4XSksQT1jZyhBLF8sVCxTLGcsMjMsYWdbMzldKSxTPWNnKFMsQSxfLFQsdyw0LGFnWzQwXSksVD1jZyhULFMsQSxfLHMsMTEsYWdbNDFdKSxfPWNnKF8sVCxTLEEsZiwxNixhZ1s0Ml0pLEE9Y2coQSxfLFQsUyxkLDIzLGFnWzQzXSksUz1jZyhTLEEsXyxULHksNCxhZ1s0NF0pLFQ9Y2coVCxTLEEsXyxiLDExLGFnWzQ1XSksXz1jZyhfLFQsUyxBLHgsMTYsYWdbNDZdKSxBPWNnKEEsXyxULFMsYywyMyxhZ1s0N10pLFM9ZmcoUyxBLF8sVCxzLDYsYWdbNDhdKSxUPWZnKFQsUyxBLF8scCwxMCxhZ1s0OV0pLF89ZmcoXyxULFMsQSxrLDE1LGFnWzUwXSksQT1mZyhBLF8sVCxTLGgsMjEsYWdbNTFdKSxTPWZnKFMsQSxfLFQsYiw2LGFnWzUyXSksVD1mZyhULFMsQSxfLGYsMTAsYWdbNTNdKSxfPWZnKF8sVCxTLEEsZywxNSxhZ1s1NF0pLEE9ZmcoQSxfLFQsUyx1LDIxLGFnWzU1XSksUz1mZyhTLEEsXyxULHYsNixhZ1s1Nl0pLFQ9ZmcoVCxTLEEsXyx4LDEwLGFnWzU3XSksXz1mZyhfLFQsUyxBLGQsMTUsYWdbNThdKSxBPWZnKEEsXyxULFMsdywyMSxhZ1s1OV0pLFM9ZmcoUyxBLF8sVCxsLDYsYWdbNjBdKSxUPWZnKFQsUyxBLF8sbSwxMCxhZ1s2MV0pLF89ZmcoXyxULFMsQSxjLDE1LGFnWzYyXSksQT1mZyhBLF8sVCxTLHksMjEsYWdbNjNdKSxvWzBdPW9bMF0rU3wwLG9bMV09b1sxXStBfDAsb1syXT1vWzJdK198MCxvWzNdPW9bM10rVHwwfX0se2tleToiX2RvRmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZGF0YSxlPXQud29yZHMscj04KnRoaXMuX25EYXRhQnl0ZXMsbj04KnQuc2lnQnl0ZXM7ZVtuPj4+NV18PTEyODw8MjQtbiUzMjt2YXIgaT1NYXRoLmZsb29yKHIvNDI5NDk2NzI5NiksYT1yO2VbMTUrKG4rNjQ+Pj45PDw0KV09MTY3MTE5MzUmKGk8PDh8aT4+PjI0KXw0Mjc4MjU1MzYwJihpPDwyNHxpPj4+OCksZVsxNCsobis2ND4+Pjk8PDQpXT0xNjcxMTkzNSYoYTw8OHxhPj4+MjQpfDQyNzgyNTUzNjAmKGE8PDI0fGE+Pj44KSx0LnNpZ0J5dGVzPTQqKGUubGVuZ3RoKzEpLHRoaXMuX3Byb2Nlc3MoKTtmb3IodmFyIG89dGhpcy5faGFzaCxzPW8ud29yZHMsdT0wO3U8NDt1Kz0xKXt2YXIgYz1zW3VdO3NbdV09MTY3MTE5MzUmKGM8PDh8Yz4+PjI0KXw0Mjc4MjU1MzYwJihjPDwyNHxjPj4+OCl9cmV0dXJuIG99fSx7a2V5OiJjbG9uZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1wKHMobi5wcm90b3R5cGUpLCJjbG9uZSIsdGhpcykuY2FsbCh0aGlzKTtyZXR1cm4gdC5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksdH19XSksbn0ocmcpO3JnLl9jcmVhdGVIZWxwZXIobGcpLHJnLl9jcmVhdGVIbWFjSGVscGVyKGxnKTt2YXIgaGc9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbih0KXt2YXIgaTtyZXR1cm4gcih0aGlzLG4pLChpPWUuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IFh5LHtrZXlTaXplOjQsaGFzaGVyOmxnLGl0ZXJhdGlvbnM6MX0sdCksaX1yZXR1cm4gaShuLFt7a2V5OiJjb21wdXRlIix2YWx1ZTpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcixuPXRoaXMuY2ZnLGk9bi5oYXNoZXIuY3JlYXRlKCksYT1ReS5jcmVhdGUoKSxvPWEud29yZHMscz1uLmtleVNpemUsdT1uLml0ZXJhdGlvbnM7by5sZW5ndGg8czspe3ImJmkudXBkYXRlKHIpLHI9aS51cGRhdGUodCkuZmluYWxpemUoZSksaS5yZXNldCgpO2Zvcih2YXIgYz0xO2M8dTtjKz0xKXI9aS5maW5hbGl6ZShyKSxpLnJlc2V0KCk7YS5jb25jYXQocil9cmV0dXJuIGEuc2lnQnl0ZXM9NCpzLGF9fV0pLG59KFh5KSxkZz1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKHQsaSxhKXt2YXIgbztyZXR1cm4gcih0aGlzLG4pLChvPWUuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IFh5LGEpLG8uX3hmb3JtTW9kZT10LG8uX2tleT1pLG8ucmVzZXQoKSxvfXJldHVybiBpKG4sW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AocyhuLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InByb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9hcHBlbmQodCksdGhpcy5fcHJvY2VzcygpfX0se2tleToiZmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLl9hcHBlbmQodCksdGhpcy5fZG9GaW5hbGl6ZSgpfX1dLFt7a2V5OiJjcmVhdGVFbmNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0VOQ19YRk9STV9NT0RFLHQsZSl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0RFQ19YRk9STV9NT0RFLHQsZSl9fSx7a2V5OiJfY3JlYXRlSGVscGVyIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT1mdW5jdGlvbih0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/U2c6a2d9O3JldHVybntlbmNyeXB0OmZ1bmN0aW9uKHIsbixpKXtyZXR1cm4gZShuKS5lbmNyeXB0KHQscixuLGkpfSxkZWNyeXB0OmZ1bmN0aW9uKHIsbixpKXtyZXR1cm4gZShuKS5kZWNyeXB0KHQscixuLGkpfX19fV0pLG59KGVnKTtkZy5fRU5DX1hGT1JNX01PREU9MSxkZy5fREVDX1hGT1JNX01PREU9MixkZy5rZXlTaXplPTQsZGcuaXZTaXplPTQ7dmFyIHBnPWZ1bmN0aW9uKHQpe28obix0KTt2YXIgZT1oKG4pO2Z1bmN0aW9uIG4odCxpKXt2YXIgYTtyZXR1cm4gcih0aGlzLG4pLChhPWUuY2FsbCh0aGlzKSkuX2NpcGhlcj10LGEuX2l2PWksYX1yZXR1cm4gaShuLG51bGwsW3trZXk6ImNyZWF0ZUVuY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5FbmNyeXB0b3IuY3JlYXRlKHQsZSl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuRGVjcnlwdG9yLmNyZWF0ZSh0LGUpfX1dKSxufShYeSk7ZnVuY3Rpb24gdmcodCxlLHIpe3ZhciBuLGk9dCxhPXRoaXMuX2l2O2E/KG49YSx0aGlzLl9pdj12b2lkIDApOm49dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgbz0wO288cjtvKz0xKWlbZStvXV49bltvXX12YXIgeWc9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbigpe3JldHVybiByKHRoaXMsbiksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIGkobil9KHBnKTt5Zy5FbmNyeXB0b3I9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbigpe3JldHVybiByKHRoaXMsbiksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIGkobixbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixuPXIuYmxvY2tTaXplO3ZnLmNhbGwodGhpcyx0LGUsbiksci5lbmNyeXB0QmxvY2sodCxlKSx0aGlzLl9wcmV2QmxvY2s9dC5zbGljZShlLGUrbil9fV0pLG59KHlnKSx5Zy5EZWNyeXB0b3I9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbigpe3JldHVybiByKHRoaXMsbiksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIGkobixbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixuPXIuYmxvY2tTaXplLGk9dC5zbGljZShlLGUrbik7ci5kZWNyeXB0QmxvY2sodCxlKSx2Zy5jYWxsKHRoaXMsdCxlLG4pLHRoaXMuX3ByZXZCbG9jaz1pfX1dKSxufSh5Zyk7dmFyIGdnPXtwYWQ6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9NCplLG49ci10LnNpZ0J5dGVzJXIsaT1uPDwyNHxuPDwxNnxuPDw4fG4sYT1bXSxvPTA7bzxuO28rPTQpYS5wdXNoKGkpO3ZhciBzPVF5LmNyZWF0ZShhLG4pO3QuY29uY2F0KHMpfSx1bnBhZDpmdW5jdGlvbih0KXt2YXIgZT10LHI9MjU1JmUud29yZHNbZS5zaWdCeXRlcy0xPj4+Ml07ZS5zaWdCeXRlcy09cn19LG1nPWZ1bmN0aW9uKHQpe28obix0KTt2YXIgZT1oKG4pO2Z1bmN0aW9uIG4odCxpLGEpe3ZhciBvO3JldHVybiByKHRoaXMsbiksKG89ZS5jYWxsKHRoaXMsdCxpLE9iamVjdC5hc3NpZ24oe21vZGU6eWcscGFkZGluZzpnZ30sYSkpKS5ibG9ja1NpemU9NCxvfXJldHVybiBpKG4sW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O3AocyhuLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpO3ZhciBlPXRoaXMuY2ZnLHI9ZS5pdixpPWUubW9kZTt0aGlzLl94Zm9ybU1vZGU9PT10aGlzLmNvbnN0cnVjdG9yLl9FTkNfWEZPUk1fTU9ERT90PWkuY3JlYXRlRW5jcnlwdG9yOih0PWkuY3JlYXRlRGVjcnlwdG9yLHRoaXMuX21pbkJ1ZmZlclNpemU9MSksdGhpcy5fbW9kZT10LmNhbGwoaSx0aGlzLHImJnIud29yZHMpLHRoaXMuX21vZGUuX19jcmVhdG9yPXR9fSx7a2V5OiJfZG9Qcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW9kZS5wcm9jZXNzQmxvY2sodCxlKX19LHtrZXk6Il9kb0ZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0LGU9dGhpcy5jZmcucGFkZGluZztyZXR1cm4gdGhpcy5feGZvcm1Nb2RlPT09dGhpcy5jb25zdHJ1Y3Rvci5fRU5DX1hGT1JNX01PREU/KGUucGFkKHRoaXMuX2RhdGEsdGhpcy5ibG9ja1NpemUpLHQ9dGhpcy5fcHJvY2VzcyghMCkpOih0PXRoaXMuX3Byb2Nlc3MoITApLGUudW5wYWQodCkpLHR9fV0pLG59KGRnKSxiZz1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKHQpe3ZhciBpO3JldHVybiByKHRoaXMsbiksKGk9ZS5jYWxsKHRoaXMpKS5taXhJbih0KSxpfXJldHVybiBpKG4sW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4odHx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19XSksbn0oWHkpLHdnPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dC5jaXBoZXJ0ZXh0LHI9dC5zYWx0O3JldHVybihyP1F5LmNyZWF0ZShbMTM5ODg5MzY4NCwxNzAxMDc2ODMxXSkuY29uY2F0KHIpLmNvbmNhdChlKTplKS50b1N0cmluZyhpZyl9LHBhcnNlOmZ1bmN0aW9uKHQpe3ZhciBlLHI9aWcucGFyc2UodCksbj1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT09blswXSYmMTcwMTA3NjgzMT09PW5bMV0mJihlPVF5LmNyZWF0ZShuLnNsaWNlKDIsNCkpLG4uc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLGJnLmNyZWF0ZSh7Y2lwaGVydGV4dDpyLHNhbHQ6ZX0pfX0sa2c9ZnVuY3Rpb24odCl7byhuLHQpO3ZhciBlPWgobik7ZnVuY3Rpb24gbigpe3JldHVybiByKHRoaXMsbiksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIGkobixudWxsLFt7a2V5OiJlbmNyeXB0Iix2YWx1ZTpmdW5jdGlvbih0LGUscixuKXt2YXIgaT1PYmplY3QuYXNzaWduKG5ldyBYeSx0aGlzLmNmZyxuKSxhPXQuY3JlYXRlRW5jcnlwdG9yKHIsaSksbz1hLmZpbmFsaXplKGUpLHM9YS5jZmc7cmV0dXJuIGJnLmNyZWF0ZSh7Y2lwaGVydGV4dDpvLGtleTpyLGl2OnMuaXYsYWxnb3JpdGhtOnQsbW9kZTpzLm1vZGUscGFkZGluZzpzLnBhZGRpbmcsYmxvY2tTaXplOmEuYmxvY2tTaXplLGZvcm1hdHRlcjppLmZvcm1hdH0pfX0se2tleToiZGVjcnlwdCIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbil7dmFyIGk9ZSxhPU9iamVjdC5hc3NpZ24obmV3IFh5LHRoaXMuY2ZnLG4pO3JldHVybiBpPXRoaXMuX3BhcnNlKGksYS5mb3JtYXQpLHQuY3JlYXRlRGVjcnlwdG9yKHIsYSkuZmluYWxpemUoaS5jaXBoZXJ0ZXh0KX19LHtrZXk6Il9wYXJzZSIsdmFsdWU6ZnVuY3Rpb24odCxlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/ZS5wYXJzZSh0LHRoaXMpOnR9fV0pLG59KFh5KTtrZy5jZmc9T2JqZWN0LmFzc2lnbihuZXcgWHkse2Zvcm1hdDp3Z30pO3ZhciB4Zz17ZXhlY3V0ZTpmdW5jdGlvbih0LGUscixuKXt2YXIgaT1uO2l8fChpPVF5LnJhbmRvbSg4KSk7dmFyIGE9aGcuY3JlYXRlKHtrZXlTaXplOmUrcn0pLmNvbXB1dGUodCxpKSxvPVF5LmNyZWF0ZShhLndvcmRzLnNsaWNlKGUpLDQqcik7cmV0dXJuIGEuc2lnQnl0ZXM9NCplLGJnLmNyZWF0ZSh7a2V5OmEsaXY6byxzYWx0Oml9KX19LFNnPWZ1bmN0aW9uKHQpe28obix0KTt2YXIgZT1oKG4pO2Z1bmN0aW9uIG4oKXtyZXR1cm4gcih0aGlzLG4pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBpKG4sbnVsbCxbe2tleToiZW5jcnlwdCIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbil7dmFyIGk9T2JqZWN0LmFzc2lnbihuZXcgWHksdGhpcy5jZmcsbiksYT1pLmtkZi5leGVjdXRlKHIsdC5rZXlTaXplLHQuaXZTaXplKTtpLml2PWEuaXY7dmFyIG89a2cuZW5jcnlwdC5jYWxsKHRoaXMsdCxlLGEua2V5LGkpO3JldHVybiBvLm1peEluKGEpLG99fSx7a2V5OiJkZWNyeXB0Iix2YWx1ZTpmdW5jdGlvbih0LGUscixuKXt2YXIgaT1lLGE9T2JqZWN0LmFzc2lnbihuZXcgWHksdGhpcy5jZmcsbik7aT10aGlzLl9wYXJzZShpLGEuZm9ybWF0KTt2YXIgbz1hLmtkZi5leGVjdXRlKHIsdC5rZXlTaXplLHQuaXZTaXplLGkuc2FsdCk7cmV0dXJuIGEuaXY9by5pdixrZy5kZWNyeXB0LmNhbGwodGhpcyx0LGksby5rZXksYSl9fV0pLG59KGtnKTtTZy5jZmc9T2JqZWN0LmFzc2lnbihrZy5jZmcse2tkZjp4Z30pO2Zvcih2YXIgQWc9W10sX2c9W10sVGc9W10sRWc9W10sT2c9W10sSWc9W10sQ2c9W10sTWc9W10sUmc9W10sUGc9W10sQmc9W10sVWc9MDtVZzwyNTY7VWcrPTEpQmdbVWddPVVnPDEyOD9VZzw8MTpVZzw8MV4yODM7Zm9yKHZhciBEZz0wLGpnPTAsemc9MDt6ZzwyNTY7emcrPTEpe3ZhciBMZz1qZ15qZzw8MV5qZzw8Ml5qZzw8M15qZzw8NDtMZz1MZz4+PjheMjU1JkxnXjk5LEFnW0RnXT1MZyxfZ1tMZ109RGc7dmFyIEZnPUJnW0RnXSxWZz1CZ1tGZ10sTmc9QmdbVmddLEhnPTI1NypCZ1tMZ11eMTY4NDMwMDgqTGc7VGdbRGddPUhnPDwyNHxIZz4+PjgsRWdbRGddPUhnPDwxNnxIZz4+PjE2LE9nW0RnXT1IZzw8OHxIZz4+PjI0LElnW0RnXT1IZyxIZz0xNjg0MzAwOSpOZ142NTUzNypWZ14yNTcqRmdeMTY4NDMwMDgqRGcsQ2dbTGddPUhnPDwyNHxIZz4+PjgsTWdbTGddPUhnPDwxNnxIZz4+PjE2LFJnW0xnXT1IZzw8OHxIZz4+PjI0LFBnW0xnXT1IZyxEZz8oRGc9RmdeQmdbQmdbQmdbTmdeRmddXV0samdePUJnW0JnW2pnXV0pOkRnPWpnPTF9dmFyIEtnPVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XSxZZz1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKCl7cmV0dXJuIHIodGhpcyxuKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gaShuLFt7a2V5OiJfZG9SZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighdGhpcy5fblJvdW5kc3x8dGhpcy5fa2V5UHJpb3JSZXNldCE9PXRoaXMuX2tleSl7dGhpcy5fa2V5UHJpb3JSZXNldD10aGlzLl9rZXk7dmFyIGU9dGhpcy5fa2V5UHJpb3JSZXNldCxyPWUud29yZHMsbj1lLnNpZ0J5dGVzLzQ7dGhpcy5fblJvdW5kcz1uKzY7dmFyIGk9NCoodGhpcy5fblJvdW5kcysxKTt0aGlzLl9rZXlTY2hlZHVsZT1bXTtmb3IodmFyIGE9dGhpcy5fa2V5U2NoZWR1bGUsbz0wO288aTtvKz0xKW88bj9hW29dPXJbb106KHQ9YVtvLTFdLG8lbj9uPjYmJm8lbj09NCYmKHQ9QWdbdD4+PjI0XTw8MjR8QWdbdD4+PjE2JjI1NV08PDE2fEFnW3Q+Pj44JjI1NV08PDh8QWdbMjU1JnRdKToodD1BZ1sodD10PDw4fHQ+Pj4yNCk+Pj4yNF08PDI0fEFnW3Q+Pj4xNiYyNTVdPDwxNnxBZ1t0Pj4+OCYyNTVdPDw4fEFnWzI1NSZ0XSx0Xj1LZ1tvL258MF08PDI0KSxhW29dPWFbby1uXV50KTt0aGlzLl9pbnZLZXlTY2hlZHVsZT1bXTtmb3IodmFyIHM9dGhpcy5faW52S2V5U2NoZWR1bGUsdT0wO3U8aTt1Kz0xKXt2YXIgYz1pLXU7dD11JTQ/YVtjXTphW2MtNF0sc1t1XT11PDR8fGM8PTQ/dDpDZ1tBZ1t0Pj4+MjRdXV5NZ1tBZ1t0Pj4+MTYmMjU1XV1eUmdbQWdbdD4+PjgmMjU1XV1eUGdbQWdbMjU1JnRdXX19fX0se2tleToiZW5jcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbih0LGUpe3RoaXMuX2RvQ3J5cHRCbG9jayh0LGUsdGhpcy5fa2V5U2NoZWR1bGUsVGcsRWcsT2csSWcsQWcpfX0se2tleToiZGVjcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbih0LGUpe3ZhciByPXQsbj1yW2UrMV07cltlKzFdPXJbZSszXSxyW2UrM109bix0aGlzLl9kb0NyeXB0QmxvY2socixlLHRoaXMuX2ludktleVNjaGVkdWxlLENnLE1nLFJnLFBnLF9nKSxuPXJbZSsxXSxyW2UrMV09cltlKzNdLHJbZSszXT1ufX0se2tleToiX2RvQ3J5cHRCbG9jayIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbixpLGEsbyxzKXtmb3IodmFyIHU9dCxjPXRoaXMuX25Sb3VuZHMsZj11W2VdXnJbMF0sbD11W2UrMV1eclsxXSxoPXVbZSsyXV5yWzJdLGQ9dVtlKzNdXnJbM10scD00LHY9MTt2PGM7dis9MSl7dmFyIHk9bltmPj4+MjRdXmlbbD4+PjE2JjI1NV1eYVtoPj4+OCYyNTVdXm9bMjU1JmRdXnJbcF07cCs9MTt2YXIgZz1uW2w+Pj4yNF1eaVtoPj4+MTYmMjU1XV5hW2Q+Pj44JjI1NV1eb1syNTUmZl1ecltwXTtwKz0xO3ZhciBtPW5baD4+PjI0XV5pW2Q+Pj4xNiYyNTVdXmFbZj4+PjgmMjU1XV5vWzI1NSZsXV5yW3BdO3ArPTE7dmFyIGI9bltkPj4+MjRdXmlbZj4+PjE2JjI1NV1eYVtsPj4+OCYyNTVdXm9bMjU1JmhdXnJbcF07cCs9MSxmPXksbD1nLGg9bSxkPWJ9dmFyIHc9KHNbZj4+PjI0XTw8MjR8c1tsPj4+MTYmMjU1XTw8MTZ8c1toPj4+OCYyNTVdPDw4fHNbMjU1JmRdKV5yW3BdO3ArPTE7dmFyIGs9KHNbbD4+PjI0XTw8MjR8c1toPj4+MTYmMjU1XTw8MTZ8c1tkPj4+OCYyNTVdPDw4fHNbMjU1JmZdKV5yW3BdO3ArPTE7dmFyIHg9KHNbaD4+PjI0XTw8MjR8c1tkPj4+MTYmMjU1XTw8MTZ8c1tmPj4+OCYyNTVdPDw4fHNbMjU1JmxdKV5yW3BdO3ArPTE7dmFyIFM9KHNbZD4+PjI0XTw8MjR8c1tmPj4+MTYmMjU1XTw8MTZ8c1tsPj4+OCYyNTVdPDw4fHNbMjU1JmhdKV5yW3BdO3ArPTEsdVtlXT13LHVbZSsxXT1rLHVbZSsyXT14LHVbZSszXT1TfX1dKSxufShtZyk7WWcua2V5U2l6ZT04O3ZhciAkZz1tZy5fY3JlYXRlSGVscGVyKFlnKSxXZz1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKCl7cmV0dXJuIHIodGhpcyxuKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gaShuKX0ocGcpO1dnLkVuY3J5cHRvcj1mdW5jdGlvbih0KXtvKG4sdCk7dmFyIGU9aChuKTtmdW5jdGlvbiBuKCl7cmV0dXJuIHIodGhpcyxuKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gaShuLFt7a2V5OiJwcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dCxuPXRoaXMuX2NpcGhlcixpPW4uYmxvY2tTaXplLGE9dGhpcy5faXYsbz10aGlzLl9jb3VudGVyO2EmJih0aGlzLl9jb3VudGVyPWEuc2xpY2UoMCksbz10aGlzLl9jb3VudGVyLHRoaXMuX2l2PXZvaWQgMCk7dmFyIHM9by5zbGljZSgwKTtuLmVuY3J5cHRCbG9jayhzLDApLG9baS0xXT1vW2ktMV0rMXwwO2Zvcih2YXIgdT0wO3U8aTt1Kz0xKXJbZSt1XV49c1t1XX19XSksbn0oV2cpLFdnLkRlY3J5cHRvcj1XZy5FbmNyeXB0b3I7dmFyIEdnPXtwYWQ6ZnVuY3Rpb24oKXt9LHVucGFkOmZ1bmN0aW9uKCl7fX0scWc9e2RlY3J5cHRXb3JkQXJyYXk6ZnVuY3Rpb24odCxlLHIpe3ZhciBuPUp5LnBhcnNlKGUpLGk9SnkucGFyc2UodHkocikpLGE9UXkuY3JlYXRlKG5ldyBVaW50OEFycmF5KHQpKSxvPSRnLmRlY3J5cHQoYmcuY3JlYXRlKHtjaXBoZXJ0ZXh0OmF9KSxuLHtpdjppLG1vZGU6V2cscGFkZGluZzpHZ30pO3JldHVybiBxZy53b3JkQXJyYXlUb1VpbnQ4QXJyYXkobyl9LHdvcmRBcnJheVRvVWludDhBcnJheTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5zaWdCeXRlcyxyPXQud29yZHMsbj1uZXcgVWludDhBcnJheShlKSxpPTAsYT0wO2khPT1lOyl7dmFyIG89clthKytdO2lmKG5baSsrXT0oNDI3ODE5MDA4MCZvKT4+PjI0LGk9PT1lKWJyZWFrO2lmKG5baSsrXT0oMTY3MTE2ODAmbyk+Pj4xNixpPT09ZSlicmVhaztpZihuW2krK109KDY1MjgwJm8pPj4+OCxpPT09ZSlicmVhaztuW2krK109MjU1Jm99cmV0dXJuIG59LGRlY29kZXJBRVNDVFJEYXRhOmZ1bmN0aW9uKHQsZSl7aWYodC52aWRlb1NlbmMpe3ZhciByPXQua2lkVmFsdWUsbj10LnZpZGVvU2VuYzt0LnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSxpKXt2YXIgYT1uW2ldLG89ZS5kYXRhLHM9W10sdT1bXSxjPWEuSW5pdGlhbGl6YXRpb25WZWN0b3I7aWYoYS5zdWJzYW1wbGVzJiZhLnN1YnNhbXBsZXMubGVuZ3RoKWEuc3Vic2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgZT10LkJ5dGVzT2ZDbGVhckRhdGErdC5CeXRlc09mUHJvdGVjdGVkRGF0YSxyPW8uc2xpY2UoMCxlKTtzLnB1c2goci5zbGljZSgwLHQuQnl0ZXNPZkNsZWFyRGF0YSkpLHUucHVzaChyLnNsaWNlKHQuQnl0ZXNPZkNsZWFyRGF0YSkpLG89by5zbGljZShlKX0pKTtlbHNle3ZhciBmPWUuc2l6ZTtzLnB1c2goby5zbGljZSgwLDApKSx1LnB1c2goby5zbGljZSgwLGYpKSxvPW8uc2xpY2UoZil9dmFyIGw9bmV3IEJ5O2wud3JpdGUuYXBwbHkobCx1KTt2YXIgaD1xZy5kZWNyeXB0V29yZEFycmF5KGwuYnVmZmVyLHIsYyksZD1uZXcgQnk7cy5mb3JFYWNoKChmdW5jdGlvbih0LGUpe3ZhciByPXVbZV0ubGVuZ3RoLG49aC5zbGljZSgwLHIpO2Qud3JpdGUodCksZC53cml0ZShuKSxoPWguc2xpY2Uocil9KSksdC5zYW1wbGVzW2ldLmRhdGE9ZC5idWZmZXJ9KSl9aWYoZS5hdWRpb1NlbmMpe3ZhciBpPWUua2lkVmFsdWUsYT1lLmF1ZGlvU2VuYztlLnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24odCxyKXt2YXIgbj1hW3JdLG89cWcuZGVjcnlwdFdvcmRBcnJheSh0LmRhdGEsaSxuLkluaXRpYWxpemF0aW9uVmVjdG9yKTtlLnNhbXBsZXNbcl0uZGF0YT1vfSkpfX19LFhnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHIsbixpKXt2YXIgYT10aGlzO25wKHRoaXMsdCksb3AodGhpcywiX3ZpZGVvU2FtcGxlcyIsW10pLG9wKHRoaXMsIl9hdWRpb1NhbXBsZXMiLFtdKSxvcCh0aGlzLCJfbGFzdFJlbWFpbkJ1ZmZlciIsW10pLG9wKHRoaXMsIl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MiLDApLHRoaXMudmlkZW9UcmFjaz1uZXcgYnAsdGhpcy5hdWRpb1RyYWNrPW5ldyB3cCx0aGlzLm1ldGFkYXRhVHJhY2s9bnx8bmV3IFNwLHRoaXMubG9nPW5ldyBqeSgiTVA0RGVtdXhlciIsIWl8fCFpLm9wZW5Mb2d8fCFpLm9wZW5Mb2cpLGUmJmUuZm9yRWFjaCgoZnVuY3Rpb24odCl7dmFyIGU7KGU9YS5fdmlkZW9TYW1wbGVzKS5wdXNoLmFwcGx5KGUsdXAodC5mcmFtZXMpKX0pKSxyJiZyLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBlOyhlPWEuX2F1ZGlvU2FtcGxlcykucHVzaC5hcHBseShlLHVwKHQuZnJhbWVzKSl9KSl9cmV0dXJuIGFwKHQsW3trZXk6InBhcnNlU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoIXQpdGhyb3cgbmV3IEVycm9yKCJtb292IGlzIHJlcXVpcmVkIik7aWYodGhpcy52aWRlb1RyYWNrLmNvZGVjfHx0aGlzLmF1ZGlvVHJhY2suY29kZWN8fChTeS5tb292VG9UcmFjayh0LHRoaXMudmlkZW9UcmFjayx0aGlzLmF1ZGlvVHJhY2spLHRoaXMudmlkZW9TZW5jPXRoaXMudmlkZW9UcmFjay52aWRlb1NlbmMsdGhpcy5hdWRpb1NlbmM9dGhpcy5hdWRpb1RyYWNrLmF1ZGlvU2VuYyksIXRoaXMuX2F1ZGlvU2FtcGxlcy5sZW5ndGgmJiF0aGlzLl92aWRlb1NhbXBsZXMubGVuZ3RoKXt2YXIgZT1TeS5tb292VG9TYW1wbGVzKHQpO2lmKCFlKXRocm93IG5ldyBFcnJvcigiY2Fubm90IHBhcnNlIHNhbXBsZXMgZnJvbSBtb292IGJveCIpO3RoaXMuX3ZpZGVvU2FtcGxlcz1lLnZpZGVvU2FtcGxlc3x8W10sdGhpcy5fYXVkaW9TYW1wbGVzPWUuYXVkaW9TYW1wbGVzfHxbXX19fSx7a2V5OiJkZW11eCIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbixpKXt0aGlzLnBhcnNlU2FtcGxlcyhpKTt2YXIgYSxvLHMsdT10aGlzLnZpZGVvVHJhY2ssYz10aGlzLmF1ZGlvVHJhY2s7aWYodS5zYW1wbGVzPVtdLGMuc2FtcGxlcz1bXSxyKXtmb3IodmFyIGYsbD0wLGg9clswXSxkPXJbMV07aDw9ZDtoKyspe2lmKCEoYT10aGlzLl92aWRlb1NhbXBsZXNbaF0pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGZvdW5kIHZpZGVvIGZyYW1lICMiLmNvbmNhdChoKSk7cz1hLm9mZnNldC1lLG89dC5zdWJhcnJheShzLHMrYS5zaXplKSwoZj1uZXcga3AoYS5wdHN8fGEuZHRzLGEuZHRzKSkuZHVyYXRpb249YS5kdXJhdGlvbixmLmdvcElkPWEuZ29wSWQsYS5rZXlmcmFtZSYmZi5zZXRUb0tleWZyYW1lKCk7Zm9yKHZhciBwPTAsdj1vLmxlbmd0aC0xO3A8djspbD1KdihvLHApLHArPTQsZi51bml0cy5wdXNoKG8uc3ViYXJyYXkocCxwK2wpKSxwKz1sO3Uuc2FtcGxlcy5wdXNoKGYpfXUuYmFzZU1lZGlhRGVjb2RlVGltZT11LnNhbXBsZXNbMF0uZHRzfWlmKG4pe2Zvcih2YXIgeT1uWzBdLGc9blsxXTt5PD1nO3krKyl7aWYoIShhPXRoaXMuX2F1ZGlvU2FtcGxlc1t5XSkpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZm91bmQgdmlkZW8gZnJhbWUgIyIuY29uY2F0KHkpKTtzPWEub2Zmc2V0LWUsbz10LnN1YmFycmF5KHMscythLnNpemUpLGMuc2FtcGxlcy5wdXNoKG5ldyB4cChhLmR0cyxvLGEuZHVyYXRpb24pKX1jLmJhc2VNZWRpYURlY29kZVRpbWU9Yy5zYW1wbGVzWzBdLmR0c31yZXR1cm57dmlkZW9UcmFjazp1LGF1ZGlvVHJhY2s6YyxtZXRhZGF0YVRyYWNrOnRoaXMubWV0YWRhdGFUcmFja319fSx7a2V5OiJkZW11eFBhcnQiLHZhbHVlOmZ1bmN0aW9uKHQsZSxyLG4saSxhLG8pe2lmKHRoaXMucGFyc2VTYW1wbGVzKGkpLHRoaXMudmlkZW9UcmFjay51c2VFTUU9YSx0aGlzLmF1ZGlvVHJhY2sudXNlRU1FPWEsdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlciYmdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoPjAmJmU+dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zJiZlPD10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MrdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoKWZvcih2YXIgcz0wO3M8MjA7KXRyeXt2YXIgdT10aGlzLl9sYXN0UmVtYWluQnVmZmVyLnN1YmFycmF5KDAsZS10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MpLGM9bmV3IFVpbnQ4QXJyYXkodC5ieXRlTGVuZ3RoK3UuYnl0ZUxlbmd0aCk7Yy5zZXQodSwwKSxjLnNldChuZXcgVWludDhBcnJheSh0KSx1LmJ5dGVMZW5ndGgpLHQ9YyxlLT11LmJ5dGVMZW5ndGgsdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wO2JyZWFrfWNhdGNoKFQpe2lmKCEoczwyMCkpdGhyb3cgbmV3IEVycm9yKCJuZXcgVWludDhBcnJheSBlcnJvcjosIitULmVycm9yTWVzc2FnZSk7cysrfXZhciBmLGwsaCxkPXRoaXMudmlkZW9UcmFjayxwPXRoaXMuYXVkaW9UcmFjaztkLnNhbXBsZXM9W10scC5zYW1wbGVzPVtdLGQudmlkZW9TZW5jPW51bGwscC5hdWRpb1NlbmM9bnVsbDt2YXIgdj0wLHk9MDtpZih0aGlzLl92aWRlb1NhbXBsZXMubGVuZ3RoPjAmJnIubGVuZ3RoPjApe2Zvcih2YXIgZyxtPXQuYnl0ZUxlbmd0aCtlLGI9clswXTtiPD1yWzFdO2IrKyl7aWYoIShmPXRoaXMuX3ZpZGVvU2FtcGxlc1tiXSkpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZm91bmQgdmlkZW8gZnJhbWUgIyIuY29uY2F0KGIpKTtmLm9mZnNldD49ZSYmZi5vZmZzZXQrZi5zaXplPD1tJiYodj0oaD1mLm9mZnNldC1lKStmLnNpemUsbD10LnN1YmFycmF5KGgsdiksKGc9bmV3IGtwKGYucHRzfHxmLmR0cyxmLmR0cykpLmR1cmF0aW9uPWYuZHVyYXRpb24sZy5nb3BJZD1mLmdvcElkLGcuc2FtcGxlT2Zmc2V0PWYuaW5kZXgsZi5rZXlmcmFtZSYmZy5zZXRUb0tleWZyYW1lKCksZy5kYXRhPWwsZy5zaXplPWYuc2l6ZSxkLnNhbXBsZXMucHVzaChnKSl9ZC5zYW1wbGVzLmxlbmd0aD4wJiYoZC5nb3BJZD1kLnNhbXBsZXNbMF0uZ29wSWQsZC5iYXNlTWVkaWFEZWNvZGVUaW1lPWQuc2FtcGxlc1swXS5kdHMsZC5zdGFydFB0cz1kLnNhbXBsZXNbMF0ucHRzL2QudGltZXNjYWxlLGQuZW5kUHRzPWQuc2FtcGxlc1tkLnNhbXBsZXMubGVuZ3RoLTFdLnB0cy9kLnRpbWVzY2FsZSx0aGlzLnZpZGVvU2VuYyYmKGQudmlkZW9TZW5jPXRoaXMudmlkZW9TZW5jLnNsaWNlKGQuc2FtcGxlc1swXS5zYW1wbGVPZmZzZXQsZC5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCtkLnNhbXBsZXMubGVuZ3RoKSxkLmtpZFZhbHVlPW8pKX1pZih0aGlzLl9hdWRpb1NhbXBsZXMubGVuZ3RoPjAmJm4ubGVuZ3RoPjApe2Zvcih2YXIgdz1uWzBdO3c8PW5bMV07dysrKXtpZighKGY9dGhpcy5fYXVkaW9TYW1wbGVzW3ddKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQodykpO2Yub2Zmc2V0Pj1lJiZmLm9mZnNldCtmLnNpemU8PXQuYnl0ZUxlbmd0aCtlJiYoeT0oaD1mLm9mZnNldC1lKStmLnNpemUsbD10LnN1YmFycmF5KGgseSkscC5zYW1wbGVzLnB1c2gobmV3IHhwKGYuZHRzLGwsZi5kdXJhdGlvbixmLmluZGV4KSkpfXAuc2FtcGxlcy5sZW5ndGg+MCYmKHAuZ29wSWQ9cC5zYW1wbGVzWzBdLmdvcElkfHxkLmdvcElkLHAuYmFzZU1lZGlhRGVjb2RlVGltZT1wLnNhbXBsZXNbMF0uZHRzLHAuc3RhcnRQdHM9cC5zYW1wbGVzWzBdLnB0cy9wLnRpbWVzY2FsZSxwLmVuZFB0cz1wLnNhbXBsZXNbcC5zYW1wbGVzLmxlbmd0aC0xXS5wdHMvcC50aW1lc2NhbGUsdGhpcy5hdWRpb1NlbmMmJihwLmF1ZGlvU2VuYz10aGlzLmF1ZGlvU2VuYy5zbGljZShwLnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0LHAuc2FtcGxlc1swXS5zYW1wbGVPZmZzZXQrcC5zYW1wbGVzLmxlbmd0aCkscC5raWRWYWx1ZT1vKSl9dGhpcy5kZWNvZGVyRGF0YShkLHApO2Zvcih2YXIgaz0wLHg9MDt4PGQuc2FtcGxlcy5sZW5ndGg7eCsrKWZvcih2YXIgUz0wLEE9ZC5zYW1wbGVzW3hdLmRhdGEsXz1BLmxlbmd0aC0xO1M8Xzspaz1KdihBLFMpLFMrPTQsZC5zYW1wbGVzW3hdLnVuaXRzLnB1c2goQS5zdWJhcnJheShTLFMraykpLFMrPWs7cmV0dXJuIHRoaXMuX2xhc3RSZW1haW5CdWZmZXI9dC5zdWJhcnJheShNYXRoLm1heCh2LHkpKSx0aGlzLl9sYXN0UmVtYWluQnVmZmVyLmJ5dGVMZW5ndGg+MD90aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3M9ZSt0LmJ5dGVMZW5ndGgtdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoOnRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wLHt2aWRlb1RyYWNrOmQsYXVkaW9UcmFjazpwLG1ldGFkYXRhVHJhY2s6dGhpcy5tZXRhZGF0YVRyYWNrfX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3ZpZGVvU2FtcGxlcz1bXSx0aGlzLl9hdWRpb1NhbXBsZXM9W10sdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wLHRoaXMudmlkZW9UcmFjay5yZXNldCgpLHRoaXMuYXVkaW9UcmFjay5yZXNldCgpLHRoaXMubWV0YWRhdGFUcmFjay5yZXNldCgpfX0se2tleToiZGVjb2RlckRhdGEiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7dC51c2VFTUV8fGUudXNlRU1FfHxxZy5kZWNvZGVyQUVTQ1RSRGF0YSh0LGUpfX1dLFt7a2V5OiJwcm9iZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIFN5LnByb2JlKHQpfX1dKSx0fSgpLFFnPXhyLmV4cG9ydHMsSmc9cnAsWmc9Yix0bT1OdCxlbT1aLHJtPXRtKCJzcGVjaWVzIiksbm09UmVnRXhwLnByb3RvdHlwZSxpbT0hWmcoKGZ1bmN0aW9uKCl7dmFyIHQ9Ly4vO3JldHVybiB0LmV4ZWM9ZnVuY3Rpb24oKXt2YXIgdD1bXTtyZXR1cm4gdC5ncm91cHM9e2E6IjcifSx0fSwiNyIhPT0iIi5yZXBsYWNlKHQsIiQ8YT4iKX0pKSxhbT0iJDAiPT09ImEiLnJlcGxhY2UoLy4vLCIkMCIpLG9tPXRtKCJyZXBsYWNlIiksc209ISEvLi9bb21dJiYiIj09PS8uL1tvbV0oImEiLCIkMCIpLHVtPSFaZygoZnVuY3Rpb24oKXt2YXIgdD0vKD86KS8sZT10LmV4ZWM7dC5leGVjPWZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt2YXIgcj0iYWIiLnNwbGl0KHQpO3JldHVybiAyIT09ci5sZW5ndGh8fCJhIiE9PXJbMF18fCJiIiE9PXJbMV19KSksY209ZnVuY3Rpb24odCxlLHIsbil7dmFyIGk9dG0odCksYT0hWmcoKGZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIGVbaV09ZnVuY3Rpb24oKXtyZXR1cm4gN30sNyE9IiJbdF0oZSl9KSksbz1hJiYhWmcoKGZ1bmN0aW9uKCl7dmFyIGU9ITEscj0vYS87cmV0dXJuInNwbGl0Ij09PXQmJigocj17fSkuY29uc3RydWN0b3I9e30sci5jb25zdHJ1Y3RvcltybV09ZnVuY3Rpb24oKXtyZXR1cm4gcn0sci5mbGFncz0iIixyW2ldPS8uL1tpXSksci5leGVjPWZ1bmN0aW9uKCl7cmV0dXJuIGU9ITAsbnVsbH0scltpXSgiIiksIWV9KSk7aWYoIWF8fCFvfHwicmVwbGFjZSI9PT10JiYoIWltfHwhYW18fHNtKXx8InNwbGl0Ij09PXQmJiF1bSl7dmFyIHM9Ly4vW2ldLHU9cihpLCIiW3RdLChmdW5jdGlvbih0LGUscixuLGkpe3ZhciBvPWUuZXhlYztyZXR1cm4gbz09PUpnfHxvPT09bm0uZXhlYz9hJiYhaT97ZG9uZTohMCx2YWx1ZTpzLmNhbGwoZSxyLG4pfTp7ZG9uZTohMCx2YWx1ZTp0LmNhbGwocixlLG4pfTp7ZG9uZTohMX19KSx7UkVQTEFDRV9LRUVQU18kMDphbSxSRUdFWFBfUkVQTEFDRV9TVUJTVElUVVRFU19VTkRFRklORURfQ0FQVFVSRTpzbX0pLGM9dVswXSxmPXVbMV07UWcoU3RyaW5nLnByb3RvdHlwZSx0LGMpLFFnKG5tLGksMj09ZT9mdW5jdGlvbih0LGUpe3JldHVybiBmLmNhbGwodCx0aGlzLGUpfTpmdW5jdGlvbih0KXtyZXR1cm4gZi5jYWxsKHQsdGhpcyl9KX1uJiZlbShubVtpXSwic2hhbSIsITApfSxmbT0kaC5jaGFyQXQsbG09ZnVuY3Rpb24odCxlLHIpe3JldHVybiBlKyhyP2ZtKHQsZSkubGVuZ3RoOjEpfSxobT1mdCxkbT1NYXRoLmZsb29yLHBtPSIiLnJlcGxhY2Usdm09L1wkKFskJidgXXxcZHsxLDJ9fDxbXj5dKj4pL2cseW09L1wkKFskJidgXXxcZHsxLDJ9KS9nLGdtPWssbW09cnAsYm09ZnVuY3Rpb24odCxlKXt2YXIgcj10LmV4ZWM7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHIpe3ZhciBuPXIuY2FsbCh0LGUpO2lmKCJvYmplY3QiIT10eXBlb2Ygbil0aHJvdyBUeXBlRXJyb3IoIlJlZ0V4cCBleGVjIG1ldGhvZCByZXR1cm5lZCBzb21ldGhpbmcgb3RoZXIgdGhhbiBhbiBPYmplY3Qgb3IgbnVsbCIpO3JldHVybiBufWlmKCJSZWdFeHAiIT09Z20odCkpdGhyb3cgVHlwZUVycm9yKCJSZWdFeHAjZXhlYyBjYWxsZWQgb24gaW5jb21wYXRpYmxlIHJlY2VpdmVyIik7cmV0dXJuIG1tLmNhbGwodCxlKX0sd209Y20sa209Tix4bT1HdCxTbT1ZdCxBbT1fLF9tPWxtLFRtPWZ1bmN0aW9uKHQsZSxyLG4saSxhKXt2YXIgbz1yK3QubGVuZ3RoLHM9bi5sZW5ndGgsdT15bTtyZXR1cm4gdm9pZCAwIT09aSYmKGk9aG0oaSksdT12bSkscG0uY2FsbChhLHUsKGZ1bmN0aW9uKGEsdSl7dmFyIGM7c3dpdGNoKHUuY2hhckF0KDApKXtjYXNlIiQiOnJldHVybiIkIjtjYXNlIiYiOnJldHVybiB0O2Nhc2UiYCI6cmV0dXJuIGUuc2xpY2UoMCxyKTtjYXNlIiciOnJldHVybiBlLnNsaWNlKG8pO2Nhc2UiPCI6Yz1pW3Uuc2xpY2UoMSwtMSldO2JyZWFrO2RlZmF1bHQ6dmFyIGY9K3U7aWYoMD09PWYpcmV0dXJuIGE7aWYoZj5zKXt2YXIgbD1kbShmLzEwKTtyZXR1cm4gMD09PWw/YTpsPD1zP3ZvaWQgMD09PW5bbC0xXT91LmNoYXJBdCgxKTpuW2wtMV0rdS5jaGFyQXQoMSk6YX1jPW5bZi0xXX1yZXR1cm4gdm9pZCAwPT09Yz8iIjpjfSkpfSxFbT1ibSxPbT1NYXRoLm1heCxJbT1NYXRoLm1pbjt3bSgicmVwbGFjZSIsMiwoZnVuY3Rpb24odCxlLHIsbil7dmFyIGk9bi5SRUdFWFBfUkVQTEFDRV9TVUJTVElUVVRFU19VTkRFRklORURfQ0FQVFVSRSxhPW4uUkVQTEFDRV9LRUVQU18kMCxvPWk/IiQiOiIkMCI7cmV0dXJuW2Z1bmN0aW9uKHIsbil7dmFyIGk9QW0odGhpcyksYT1udWxsPT1yP3ZvaWQgMDpyW3RdO3JldHVybiB2b2lkIDAhPT1hP2EuY2FsbChyLGksbik6ZS5jYWxsKFN0cmluZyhpKSxyLG4pfSxmdW5jdGlvbih0LG4pe2lmKCFpJiZhfHwic3RyaW5nIj09dHlwZW9mIG4mJi0xPT09bi5pbmRleE9mKG8pKXt2YXIgcz1yKGUsdCx0aGlzLG4pO2lmKHMuZG9uZSlyZXR1cm4gcy52YWx1ZX12YXIgdT1rbSh0KSxjPVN0cmluZyh0aGlzKSxmPSJmdW5jdGlvbiI9PXR5cGVvZiBuO2Z8fChuPVN0cmluZyhuKSk7dmFyIGw9dS5nbG9iYWw7aWYobCl7dmFyIGg9dS51bmljb2RlO3UubGFzdEluZGV4PTB9Zm9yKHZhciBkPVtdOzspe3ZhciBwPUVtKHUsYyk7aWYobnVsbD09PXApYnJlYWs7aWYoZC5wdXNoKHApLCFsKWJyZWFrOyIiPT09U3RyaW5nKHBbMF0pJiYodS5sYXN0SW5kZXg9X20oYyx4bSh1Lmxhc3RJbmRleCksaCkpfWZvcih2YXIgdix5PSIiLGc9MCxtPTA7bTxkLmxlbmd0aDttKyspe3A9ZFttXTtmb3IodmFyIGI9U3RyaW5nKHBbMF0pLHc9T20oSW0oU20ocC5pbmRleCksYy5sZW5ndGgpLDApLGs9W10seD0xO3g8cC5sZW5ndGg7eCsrKWsucHVzaCh2b2lkIDA9PT0odj1wW3hdKT92OlN0cmluZyh2KSk7dmFyIFM9cC5ncm91cHM7aWYoZil7dmFyIEE9W2JdLmNvbmNhdChrLHcsYyk7dm9pZCAwIT09UyYmQS5wdXNoKFMpO3ZhciBfPVN0cmluZyhuLmFwcGx5KHZvaWQgMCxBKSl9ZWxzZSBfPVRtKGIsYyx3LGssUyxuKTt3Pj1nJiYoeSs9Yy5zbGljZShnLHcpK18sZz13K2IubGVuZ3RoKX1yZXR1cm4geStjLnNsaWNlKGcpfV19KSk7dmFyIENtPU4sTW09R3QsUm09XyxQbT1sbSxCbT1ibTtjbSgibWF0Y2giLDEsKGZ1bmN0aW9uKHQsZSxyKXtyZXR1cm5bZnVuY3Rpb24oZSl7dmFyIHI9Um0odGhpcyksbj1udWxsPT1lP3ZvaWQgMDplW3RdO3JldHVybiB2b2lkIDAhPT1uP24uY2FsbChlLHIpOm5ldyBSZWdFeHAoZSlbdF0oU3RyaW5nKHIpKX0sZnVuY3Rpb24odCl7dmFyIG49cihlLHQsdGhpcyk7aWYobi5kb25lKXJldHVybiBuLnZhbHVlO3ZhciBpPUNtKHQpLGE9U3RyaW5nKHRoaXMpO2lmKCFpLmdsb2JhbClyZXR1cm4gQm0oaSxhKTt2YXIgbz1pLnVuaWNvZGU7aS5sYXN0SW5kZXg9MDtmb3IodmFyIHMsdT1bXSxjPTA7bnVsbCE9PShzPUJtKGksYSkpOyl7dmFyIGY9U3RyaW5nKHNbMF0pO3VbY109ZiwiIj09PWYmJihpLmxhc3RJbmRleD1QbShhLE1tKGkubGFzdEluZGV4KSxvKSksYysrfXJldHVybiAwPT09Yz9udWxsOnV9XX0pKTt2YXIgVW09e307ZnVuY3Rpb24gRG0odCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KS5tYXRjaCgvKFteXHMuKl0rKSg/PV0kKS9nKVswXX1VbS5maW5kQm94PWZ1bmN0aW9uKHQsZSl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0/YXJndW1lbnRzWzJdOltdO2lmKHQudHlwZSE9PWUpe2lmKHQmJnQuc3ViQm94KXt2YXIgbj10LnN1YkJveC5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiB0LnR5cGU9PT1lfSkpO24ubGVuZ3RoP24uZm9yRWFjaCgoZnVuY3Rpb24odCl7cmV0dXJuIHIucHVzaCh0KX0pKTp0LnN1YkJveC5mb3JFYWNoKChmdW5jdGlvbih0KXtyZXR1cm4gVW0uZmluZEJveCh0LGUscil9KSl9fWVsc2Ugci5wdXNoKHQpO3JldHVybihyPVtdLmNvbmNhdChyKSkubGVuZ3RoPjE/cjpyWzBdfSxVbS5wYWRTdGFydD1mdW5jdGlvbih0LGUscil7Zm9yKHZhciBuPVN0cmluZyhyKSxpPWU+PjAsYT1NYXRoLmNlaWwoaS9uLmxlbmd0aCksbz1bXSxzPVN0cmluZyh0KTthLS07KW8ucHVzaChuKTtyZXR1cm4gby5qb2luKCIiKS5zdWJzdHJpbmcoMCxpLXMubGVuZ3RoKStzfSxVbS50b0hleD1mdW5jdGlvbigpe2Zvcih2YXIgdD1bXSxlPWFyZ3VtZW50cy5sZW5ndGgscj1uZXcgQXJyYXkoZSksbj0wO248ZTtuKyspcltuXT1hcmd1bWVudHNbbl07cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5wdXNoKFVtLnBhZFN0YXJ0KE51bWJlcihlKS50b1N0cmluZygxNiksMiwwKSl9KSksdH0sVW0uc3VtPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAsZT1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KGUpLG49MDtuPGU7bisrKXJbbl09YXJndW1lbnRzW25dO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QrPWV9KSksdH0sVW0uU3RyaW5nVG9BcnJheUJ1ZmZlcj1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IEFycmF5QnVmZmVyKHQubGVuZ3RoKSxyPW5ldyBVaW50OEFycmF5KGUpLG49MDtuPHQubGVuZ3RoO24rKylyW25dPXQuY2hhckNvZGVBdChuKTtyZXR1cm4gZX0sVW0uZnJvbUhleD1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgvMikscj0wO3I8dC5sZW5ndGg7cis9MillW3IvMl09d2luZG93LnBhcnNlSW50KHQuc3Vic3RyKHIsMiksMTYpO3JldHVybiBlfSxVbS5mcm9tQ2hhckNvZGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPSIiLHI9MDtyPHQubGVuZ3RoO3IrPTE2ZTMpe3ZhciBuPXQuc3ViYXJyYXkocixyKzE2ZTMpO2UrPVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxuKX1yZXR1cm4gZX0sVW0uQXJyYXlCdWZmZXJUb1N0cmluZz1mdW5jdGlvbih0KXtmb3IodmFyIGU9IiIscj1uZXcgVWludDhBcnJheSh0KSxuPTA7bjxyLmxlbmd0aDtuKyspZSs9U3RyaW5nLmZyb21DaGFyQ29kZShyW25dKTtyZXR1cm4gZX0sVW0uQmFzZTY0VG9IZXg9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXdpbmRvdy5hdG9iKHQucmVwbGFjZSgvLS9nLCIrIikucmVwbGFjZSgvXy9nLCIvIikpLHI9IiIsbj0wO248ZS5sZW5ndGg7bisrKXIrPSgiMCIrZS5jaGFyQ29kZUF0KG4pLnRvU3RyaW5nKDE2KSkuc3Vic3RyKC0yKTtyZXR1cm4gcn0sVW0udG9CYXNlNjQ9ZnVuY3Rpb24odCxlKXt2YXIgcj1VbS5mcm9tQ2hhckNvZGUodCk7ZT12b2lkIDA9PT1lfHxlO3ZhciBuPXdpbmRvdy5idG9hKHIpLnJlcGxhY2UoL1wrL2csIi0iKS5yZXBsYWNlKC9cLy9nLCJfIik7cmV0dXJuIGU/bjpuLnJlcGxhY2UoLz0qJC8sIiIpfSxVbS50b1VURjg9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPWVuY29kZVVSSUNvbXBvbmVudCh0KSxyPXVuZXNjYXBlKGUpLG49bmV3IFVpbnQ4QXJyYXkoci5sZW5ndGgpLGk9MDtpPHIubGVuZ3RoOysraSluW2ldPXIuY2hhckNvZGVBdChpKTtyZXR1cm4gbi5idWZmZXJ9LFVtLmJ1ZmZlclRvU3RyaW5nPWZ1bmN0aW9uKHQpe3JldHVybigiMCIrTnVtYmVyKHQpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpLnRvVXBwZXJDYXNlKCl9LFVtLnN0clRvQnVmPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxyPTA7cjx0Lmxlbmd0aDtyKz0yKWUucHVzaChwYXJzZUludCh0W3JdK3RbcisxXSwxNikpO3JldHVybiBuZXcgVWludDhBcnJheShlKX0sVW0uZm9ybWF0SVY9ZnVuY3Rpb24odCl7dmFyIGU9IiI7aWYodC5mb3JFYWNoKChmdW5jdGlvbih0KXtlKz1VbS5idWZmZXJUb1N0cmluZyh0KX0pKSxlLmxlbmd0aDw9MzIpZm9yKHZhciByPTMyLWUubGVuZ3RoLG49MDtuPHI7bisrKWUrPSIwIjtyZXR1cm4gZX0sVW0uc3RyMmhleD1mdW5jdGlvbih0KXtpZigiIj09PXQpcmV0dXJuIiI7Zm9yKHZhciBlPVtdLHI9MDtyPHQubGVuZ3RoO3IrKyllLnB1c2godC5jaGFyQ29kZUF0KHIpKTtyZXR1cm4gZX0sVW0ucGFyc2U9ZnVuY3Rpb24odCl7aWYoIUFycmF5LmlzQXJyYXkodCkpe2Zvcih2YXIgZT1bXSxyPSIiLG49MDtuPHQubGVuZ3RoO24rKyluJTImJihyPXRbbi0xXSt0W25dLGUucHVzaChwYXJzZUludChyLDE2KSkscj0iIik7cmV0dXJuIGV9cmV0dXJuIHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gcGFyc2VJbnQodCwxNil9KSl9LFVtLmdlbmVyYXRlVW5pcXVlS2V5PWZ1bmN0aW9uKHQpe3ZhciBlPXQudmlkO3Quc3RhcnQsdC5lbmQ7dmFyIHI9dC5tZWRpYVR5cGUsbj10LmRlZmluaXRpb247cmV0dXJuIHQucHJlbG9hZFRpbWUscj1yfHwidmlkZW8iLG49bnx8IjAiLGU/IiIuY29uY2F0KGUsIiMiKS5jb25jYXQociwiIyIpLmNvbmNhdChuLCIjbXA0Iik6bnVsbH0sVW0udmFsaWRhdGVGcmFnbWVudD1mdW5jdGlvbih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06W107aWYodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXt0cnl7aWYoMj09PWUubGVuZ3RoKXt2YXIgcj1lWzFdLWVbMF0rMTtpZighKHQuYnl0ZUxlbmd0aD09PXIpKXJldHVybn19Y2F0Y2gobil7cmV0dXJuIGNvbnNvbGUuZXJyb3IobiksITF9cmV0dXJuITB9cmV0dXJuITF9LFVtLnR5cGVPZj1mdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpLm1hdGNoKC8oW15ccy4qXSspKD89XSQpL2cpWzBdfSxVbS5nZXRCdWZmZXJTcGxpdHM9ZnVuY3Rpb24odCxlKXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06NWU1LG49ZS10O2lmKG4tcjxyLzJ8fCFlKXJldHVybltbdCxlXV07Zm9yKHZhciBpPVtdO3Q8ZTspe3ZhciBhPXQrcjsoYT5lfHxlLWE8ci8yKSYmKGE9ZSksaS5wdXNoKFt0LGFdKSx0PWErMX1yZXR1cm4gaX0sVW0ubm93VGltZT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gcGFyc2VJbnQocGVyZm9ybWFuY2Uubm93KCksMTApfWNhdGNoKHQpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfX0sVW0uZXh0VXJsPWZ1bmN0aW9uKHQsZSl7dHJ5e3ZhciByPXQuaW5kZXhPZigiPyIpO3JldHVybiByPDA/T2JqZWN0LmtleXMoZSkubWFwKChmdW5jdGlvbihyLG4pe3QrPTA9PT1uPyI/Ii5jb25jYXQociwiPSIpLmNvbmNhdChlW3JdKToiJiIuY29uY2F0KHIsIj0iKS5jb25jYXQoZVtyXSl9KSk6T2JqZWN0LmtleXMoZSkubWFwKChmdW5jdGlvbihuLGkpe3I9PT10Lmxlbmd0aC0xP3QrPSIiLmNvbmNhdChuLCI9IikuY29uY2F0KGVbbl0pOnQrPSImIi5jb25jYXQobiwiPSIpLmNvbmNhdChlW25dKX0pKSx0fWNhdGNoKG4pe3JldHVybiB0fX0sVW0uZGVlcE1lcmdlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUpLmZvckVhY2goKGZ1bmN0aW9uKHIpe3ZhciBuLGk9RG0oZVtyXSksYT1EbSh0W3JdKTsiQXJyYXkiPT09aT8oIkFycmF5IiE9PWEmJih0W3JdPVtdKSwobj10W3JdKS5wdXNoLmFwcGx5KG4sdihlW3JdKSkpOiJPYmplY3QiPT09aT8oIk9iamVjdCIhPT1hJiYodFtyXT17fSksVW0uZGVlcE1lcmdlKHRbcl0sZVtyXSkpOnRbcl09ZVtyXX0pKSx0fSxVbS5nZXRGaWxlU2l6ZT1mdW5jdGlvbih0LGUpe3RyeXtyZXR1cm4gdCYmZT9wYXJzZUludChlKnQvOCwxMCk6MH1jYXRjaChyKXtyZXR1cm4gMH19LFVtLmhhc2hWYWw9ZnVuY3Rpb24odCl7dmFyIGUscj0wO2lmKDA9PT10Lmxlbmd0aClyZXR1cm4gcjtmb3IoZT0wO2U8dC5sZW5ndGg7ZSsrKXI9KHI8PDUpLXIrdC5jaGFyQ29kZUF0KGUpLHJ8PTA7cmV0dXJuIHJ9LFVtLmdldEZpbGVTaXplPWZ1bmN0aW9uKHQsZSl7dHJ5e3JldHVybiB0JiZlP3BhcnNlSW50KGUqdC84LDEwKTowfWNhdGNoKHIpe3JldHVybiAwfX0sVW0uY29uY2F0RGF0YT1mdW5jdGlvbih0LGUpe3ZhciByPVtdLG49MDt0JiZyLnB1c2godCksZSYmci5wdXNoKGUpLHIuZXZlcnkoKGZ1bmN0aW9uKHQpe3JldHVybiB0JiYobis9dC5ieXRlTGVuZ3RoKSwhMH0pKTt2YXIgaT1uZXcgVWludDhBcnJheShuKSxhPTA7cmV0dXJuIHIuZXZlcnkoKGZ1bmN0aW9uKHQpe3JldHVybiB0JiYoaS5zZXQodCxhKSxhKz10LmJ5dGVMZW5ndGgpLCEwfSkpLGl9LFVtLmdldEZyYWdSYW5nZT1mdW5jdGlvbih0LGUscil7dmFyIG49dDxlLmxlbmd0aD9lW3RdOm51bGwsaT10PHIubGVuZ3RoP3JbdF06bnVsbCxhPTAsbz0wO3JldHVybiB0PT09ZS5sZW5ndGgtMSYmKGE9LTEpLHQ9PT1yLmxlbmd0aC0xJiYobz0tMSksW01hdGgubWluKChudWxsPT1uP3ZvaWQgMDpuLnJhbmdlWzBdKXx8MS8wLChudWxsPT1pP3ZvaWQgMDppLnJhbmdlWzBdKXx8MS8wKSxNYXRoLm1heCgobnVsbD09bj92b2lkIDA6bi5yYW5nZVsxXSkrYXx8MCwobnVsbD09aT92b2lkIDA6aS5yYW5nZVsxXSkrb3x8MCldfSxvbm1lc3NhZ2U9ZnVuY3Rpb24odCl7dmFyIHI9dC5kYXRhO3N3aXRjaChyLm1ldGhvZCl7Y2FzZSJpbml0Ijp0aGlzLmNvZGVjVHlwZT1yLmFyZ3MuY29kZWNUeXBlLHRoaXMub3BlbmxvZz1yLmFyZ3Mub3BlbkxvZyx0aGlzLk1QNERlbXV4ZXI9bnVsbCx0aGlzLkZNUDRSZW11eGVyPW51bGwsdGhpcy5fbmVlZEluaXRTZWdtZW50PSEwLHRoaXMuc3VwcG9ydEhldmM9ci5hcmdzLnN1cHBvcnRIZXZjO2JyZWFrO2Nhc2UidHJhbnNtdXgiOnZhciBuPXQuZGF0YS5hcmdzLGk9bmV3IFVpbnQ4QXJyYXkodC5kYXRhLmJ1ZmZlcik7dGhpcy5NUDREZW11eGVyfHwodGhpcy5NUDREZW11eGVyPW5ldyBYZyhudWxsLG51bGwsbnVsbCx7b3BlbmxvZzp0aGlzLm9wZW5sb2d9KSk7dmFyIGEsbz10aGlzLk1QNERlbXV4ZXIuZGVtdXhQYXJ0KGksbi5zdGFydCxuLnZpZGVvSWR4LG4uYXVkaW9JZHgsbi5tb292LG4udXNlRU1FLG4ua2lkVmFsdWUpO2lmKHRoaXMuRk1QNFJlbXV4ZXJ8fCJoMjY1Ij09PXRoaXMuY29kZWNUeXBlJiYhdGhpcy5zdXBwb3J0SGV2Y3x8KHRoaXMuRk1QNFJlbXV4ZXI9bmV3IHp5KHRoaXMuTVA0RGVtdXhlci52aWRlb1RyYWNrLHRoaXMuTVA0RGVtdXhlci5hdWRpb1RyYWNrLHtvcGVuTG9nOnRoaXMub3BlbmxvZ30pKSx0aGlzLkZNUDRSZW11eGVyKXt2YXIgcz10aGlzLkZNUDRSZW11eGVyLnJlbXV4KHRoaXMuX25lZWRJbml0U2VnbWVudCx7aW5pdE1lcmdlOiEwfSk7cy5pbml0U2VnbWVudCYmKHRoaXMuX25lZWRJbml0U2VnbWVudD0hMSksYT17YnVmZmVyOlVtLmNvbmNhdERhdGEocy5hdWRpb1NlZ21lbnQscy52aWRlb1NlZ21lbnQpLHJhbmdlOm4uY29udGV4dC5yYW5nZSxzdGF0ZTpuLmNvbnRleHQuc3RhdGUsY29udGV4dDp7cmFuZ2U6bi5jb250ZXh0LnJhbmdlLGZyYWdJbmRleDpuLmNvbnRleHQuZnJhZ0luZGV4LHN0YXJ0UHRzOk1hdGgubWluKG8udmlkZW9UcmFjay5zdGFydFB0cyxvLmF1ZGlvVHJhY2suc3RhcnRQdHMpLGVuZFB0czpNYXRoLm1heChvLnZpZGVvVHJhY2suZW5kUHRzLG8uYXVkaW9UcmFjay5lbmRQdHMpfSxpbml0U2VnOnMuaW5pdFNlZ21lbnR9fXRoaXMucG9zdE1lc3NhZ2Uoe21ldGhvZDoidHJhbnNtdXgiLGlkOnQuZGF0YS5pZCxhcmdzOmUoe30sYSl9KTticmVhaztjYXNlInJlc2V0Ijp0aGlzLkZNUDRSZW11eGVyJiZ0aGlzLkZNUDRSZW11eGVyLnJlc2V0KCksdGhpcy5NUDREZW11eGVyJiZ0aGlzLk1QNERlbXV4ZXIucmVzZXQoKSx0aGlzLkZNUDRSZW11eGVyPW51bGwsdGhpcy5NUDREZW11eGVyPW51bGwsdGhpcy5fbmVlZEluaXRTZWdtZW50PSEwfX19KCk7Cg==",Ve="undefined"!=typeof window&&window.Blob&&new Blob([atob(Pe)],{type:"text/javascript;charset=utf-8"});function Me(){var e=Ve&&(window.URL||window.webkitURL).createObjectURL(Ve);try{return e?new Worker(e,{}):new Worker("data:application/javascript;base64,"+Pe,{type:"module"})}finally{!("undefined"!=typeof window&&navigator.userAgent.indexOf("Trident/")>0)&&e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}var Ke=function(e){f(i,e);var t=g(i);function i(e){var r;return d(this,i),(r=t.call(this)).openlog=e.openLog,r.codecType=e.codecType,r.supportHevc=e.supportHevc,r.worker=new Me,r.worker.onmessage=function(e){r.emit(e.data.method,e.data)},r.worker.postMessage({method:"init",id:e.id||0,args:{openlog:r.openlog,supportHevc:r.supportHevc,codecType:r.codecType}}),r}return u(i,[{key:"transmux",value:function(e,t,i,r,n,a,o,s,l){var d=t.buffer;this.worker&&this.worker.postMessage({method:"transmux",id:e,buffer:d,args:{start:i,videoIdx:r,audioIdx:n,moov:a,useEME:o,kidValue:s,context:l}},[d])}},{key:"reset",value:function(){this.worker&&this.worker.postMessage({method:"reset"})}},{key:"destroy",value:function(){this.worker&&this.worker.terminate()}}]),i}(me()),Ye="error",De="metaReady",Fe="moov_request_Progress",He="progress_event",Ne="updateEME",Ue="chaneg_url",Oe="update_load_fragmentIdx",Ae=function(e){f(T,e);var t,i,r,o,s,c,m,p,y,v,Z=g(T);function T(e,t,i){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;if(d(this,T),h(b(r=Z.call(this)),"onprogressDataArrive",function(){var e=l(a().mark((function e(t,i,n){var o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.byteLength>0&&((o=r.timeRange[n.index].range)&&n.range[1]>=o[1]&&!i&&(i=!0),r.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",n.index,",range,",JSON.stringify(n.range),", dataLen,",t.byteLength),r._mux(t,n.range[0],n.index,i)),i&&(r.timeRange[n.index].downloaded=!0,r.bufferLoadedPos=-1,r.log("[FragLoadDowned],fragmentIdx,",n.index,",rangeEnd,",n.range[1]));case 2:case"end":return e.stop()}}),e)})));return function(t,i,r){return e.apply(this,arguments)}}()),r.timeRecord={startMuxTime:-1,startLoadTime:-1,newMP4Time:xe.nowTime(),startLoadMetaTime:-1},r.url=e,r.backUrl=o||[],r._bitRate=t,r.options=T.getDefaultConfig(),Object.keys(i).map((function(e){void 0!==i[e]&&null!==i[e]&&(r.options[e]=i[e])})),r.timeRange=[],r.firstFrameTime=s||{},r._logTag=c||"",r.CHUNK_SIZE=Ce(i.duration,r.options.chunkSize,i.fileSize),r.bufferLoaded=new Uint8Array(0),r.bufferLoadedPos=0,r.meta=null,r.preloadCache=null,r.videoTrak=null,r.audioTrak=null,r.canDownload=!0,r._loadSuccessCallBack=null,r._isPending=!1,r._metaLoading=!1,r.MP4Loader=new Ie.b(n(n({segmentDuration:i.segmentDuration,url:e,vid:i.vid+"-"+t,retry:i.retryCount||2,retryDelay:i.retryDelay||1e3,timeout:3e3},i.reqOptions),{},{openLog:we()})),r.MP4Demuxer=null,r.FMP4Remuxer=null,r._needInitSegment=!0,r._bitRateInfoMap=new Map,r._switchBitRate=!1,r._segmentToBitRateMap=new Map,r.useEME=!1,r.kidValue=null,r.enableWorker=i.enableWorker&&("h265"!==i.codecType||i.supportHevc),r.enableWorker&&"undefined"!=typeof Worker)try{r.workerSequence=0,r.transmuxerWorkerControl=new Ke({id:r.workerSequence,codecType:i.codecType,supportHevc:r.options.supportHevc,openLog:we()}),r.transmuxerWorkerControl.on("transmux",(function(e){var t=e.args;r.log("[transmuxerworker end] ,range, ",JSON.stringify(t.range),",dataLen,",t.buffer.byteLength,t.context),r.firstFrameTime.firstmux<0&&r.timeRecord.startMuxTime>0&&(r.firstFrameTime.firstmux=xe.nowTime()-r.timeRecord.startMuxTime),r._loadSuccessCallBack&&r._loadSuccessCallBack(t)}))}catch(e){r.log("Error in worker:",e),r.enableWorker=!1,r.transmuxerWorkerControl=null}return r.enableWorker||(r.MP4Demuxer=null,r.FMP4Remuxer=null),r.seekTime=-1,r.changeBitRateTime=-1,r}return u(T,[{key:"changeBitRate",value:(v=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.bitrate===this._bitRate){e.next=9;break}return this.url=t.url,this._bitRate=t.bitrate,this.backUrl=t.backupURL,e.next=6,this.MP4Loader.changeUrl(this.url,this.options.vid+"-"+this._bitRate,this.CHUNK_SIZE);case 6:this.emit(Ue,this.url),this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this._bitRate,this.url);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"_getByPreload",value:function(e,t,i,r){try{if(e&&e.byteLength>=t){var n={endTime:(new Date).getTime(),startTime:(new Date).getTime(),index:r,range:[],vid:this.options.vid,from:"local"};if(i<=e.byteLength){var a=e.slice(t,i);return n.range=[t,i],n.state=!0,{buffer:a,context:n,state:!0}}var o=e.byteLength-1,s=e.slice(t,o);return n.range=[t,o],{context:n,buffer:s,state:!1}}return null}catch(e){return console.error("[MP4] _getByPreload",t,i,e),null}}},{key:"log",value:function(e){for(var t=this.options,i=t&&t.vid?"[MP4]".concat(this._logTag," ").concat(t.vid," ").concat(e):"[MP4]".concat(this._logTag," ").concat(e),r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ge.apply(void 0,[i].concat(n))}},{key:"errorHandler",value:(y=l(a().mark((function e(t,i){var r,n,o,s,l,d,c,u,h,f=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>2&&void 0!==f[2]?f[2]:{},n=t.response,o=t.message,s=this.options?this.options.vid:"",l=null,this._isPending=!0,!n){e.next=34;break}if(d=Ee(n.headers),l=new Le("network",n.status,{httpText:n.httpText,message:o,url:n.url,headers:d}),this.log("[MP4] [".concat(s,"] errorHandler error state:[").concat(i,"], _isPending:[").concat(this._isPending,"] "),l),!(this.backUrl&&this.backUrl.length>0)){e.next=30;break}if(this.log("[MP4] [".concat(s,"] errorHandler start backUpUrl retry"),this.backUrl.length,this.backUrl),c=this.backUrl.shift(),this.update(c),this._isPending=!1,!this.MP4Loader){e.next=18;break}return e.next=17,this.MP4Loader.changeUrl(this.url,this.url+"-"+this._bitRate,this.CHUNK_SIZE);case 17:this.emit(Ue,this.url);case 18:if(this.emit(He,{type:"error",error:t}),"getMetaInfo"!==i){e.next=24;break}return this.getMetaInfo(),e.abrupt("return");case 24:if("loadFragment"!==i){e.next=30;break}if(u=r.fragIndex,h=r.range,!u||!h){e.next=30;break}return this.resetFragmentLoadState(u),this.loadFragment(u,h),e.abrupt("return");case 30:this.log("[MP4] [".concat(s,"] errorHandler backUpUrl is null emit error")),this.emit(Ye,l),e.next=37;break;case 34:this.log("[MP4] [".concat(s,"] errorHandler,"),t),l=t,this.emit(Ye,l);case 37:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"init",value:(p=l(a().mark((function e(t){var i,r,n,o,s,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.url){e.next=3;break}return e.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+"-"+this._bitRate,this.CHUNK_SIZE);case 3:if(this.emit(Ue,this.url),this.meta=null,i=t.meta,r=t.mediaSegList,n=t.buffer,o=t.fileSize,s=t.initSeg,l=t.bitrate,!i||!i.ext){e.next=18;break}this.meta=i,this._bitRate=l,this.videoTrak=i.ext.videoTrak,this.audioTrak=i.ext.audioTrak,this.timeRange=this.getTimeRange(),r?this.preloadCache={segList:r||[],initSeg:s}:n&&(this.size=o,this.bufferLoaded=n),d={meta:i,videoSegments:i.ext.videoTrak,audioSegments:i.ext.audioTrak,bufferLoaded:n||null},this._bitRateInfoMap.set(this._bitRate,d),this.emit(De,this.meta),e.next=20;break;case 18:return e.next=20,this.getMetaInfo();case 20:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getTimeRange",value:function(){for(var e=[],t=null,i=0;this.videoTrak&&i<this.videoTrak.length;i++)t={startTime:this.videoTrak[i].startTime,endTime:this.videoTrak[i].endTime,downloaded:!1,isLoading:!1},e.push(t);if(this.audioTrak&&this.audioTrak.length>e.length)for(var r=e.length;r<this.audioTrak.length;r++)t={startTime:Math.max(this.audioTrak[r].startTime,t?t.endTime:0),endTime:Math.max(this.audioTrak[r].endTime,t?t.endTime:0),downloaded:!1,isLoading:!1},e.push(t);return e}},{key:"getMetaInfo",value:(m=l(a().mark((function e(){var t,i,r,o,s=this,d=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(d.length>0&&void 0!==d[0])||d[0],e.prev=1,i=xe.nowTime(),this._metaLoading=!0,this.log("getMetaInfo start, bitRate,",this._bitRate),this.bufferLoaded=new Uint8Array(0),r=0,o=function(){var e=l(a().mark((function e(o,l,d,c){var u,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.log("getMetaInfo onProgressHandle, dataLen,",o?o.byteLength:-1,", state,",l,",range,",JSON.stringify(d.range)),!c){e.next=7;break}return e.next=4,s.cancelLoading();case 4:return u=new Se(Te.demux,Ze.metaError,{msg:JSON.stringify(c)}),s.errorHandler(u,"getMetaInfo"),e.abrupt("return");case 7:o&&d.range[0]===r&&(s.bufferLoaded=be()(Uint8Array,s.bufferLoaded,new Uint8Array(o)),r+=o.byteLength),d.meta&&!s.meta&&(s.firstFrameTime.metaload=xe.nowTime()-i,h=d.meta,s.videoTrak=h.videoSegments,s.audioTrak=h.audioSegments,s.timeRange=s.getTimeRange(),s.meta=n(n({},h.meta),{},{ext:{videoTrak:s.videoTrak,audioTrak:s.audioTrak}}),h.bufferLoaded=s.bufferLoaded,s._bitRateInfoMap.set(s._bitRate,h),s.log("meta reach, bitRate,",s._bitRate),t&&s.emit(De,s.meta)),s.meta&&l&&(s.log("[getMetaInfo req end]"),s._metaLoading=!1),s.meta&&(o||l)&&(s.log("emit moov_req_progress"),s.emit(Fe));case 11:case"end":return e.stop()}}),e)})));return function(t,i,r,n){return e.apply(this,arguments)}}(),e.next=10,this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],o);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("[MP4] trigger errorHandler getMetaInfo",null===e.t0||void 0===e.t0?void 0:e.t0.message),this.loadError(e.t0,"getMetaInfo");case 16:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return m.apply(this,arguments)})},{key:"getFragmentIdx",value:function(e){var t,i;if(this.videoTrak.length){if(t=this.videoTrak.find((function(t){return t.startTime<=e&&t.endTime>e})),i=this.audioTrak.find((function(t){return t.startTime<=e&&t.endTime>e})),t&&i)return Math.min(t.index,i.index);if(t||i)return t?t.index:i.index;var r=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(r=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(r=Math.min(this.audioTrak.length-1,r)),r}return(i=this.audioTrak.find((function(t){return t.startTime<=e&&t.endTime>e})))?i.index:0}},{key:"_checkHasMeta",value:(c=l(a().mark((function e(){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._bitRateInfoMap.get(this._bitRate)){e.next=19;break}return this.log("[ABR], need load InitSegment, bitRate, ",this._bitRate),this._metaLoading=!0,e.next=6,this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));case 6:return i=e.sent,this._metaLoading=!1,this.videoTrak=i.videoSegments,this.audioTrak=i.audioSegments,this.meta=n(n({},i.meta),{},{ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}}),this.emit(Ne,this.meta),this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),i.bufferLoaded=this.bufferLoaded,this._bitRateInfoMap.set(this._bitRate,i),e.abrupt("return",!0);case 19:return this.log("[ABR], not need load InitSegment, bitRate, ",this._bitRate),this.videoTrak=t.videoSegments,this.audioTrak=t.audioSegments,this.meta=t.meta,this.emit(Ne,this.meta),this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),e.abrupt("return",!0);case 27:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"resetFragmentLoadState",value:function(e){for(var t=0;t<this.timeRange.length;t++)t<e?(this.timeRange[t].downloaded=!0,this.timeRange[t].isLoading=!0):(this.timeRange[t].downloaded=!1,this.timeRange[t].isLoading=!1)}},{key:"getFragRange",value:function(e){var t,i,r,n,a=null;this.videoTrak&&(a=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1]);var o=null;this.audioTrak&&(o=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1]);var s=0,l=0;this.videoTrak&&e>=this.videoTrak.length-1&&(s=-1),this.audioTrak&&e>=this.audioTrak.length-1&&(l=-1);var d=[Math.min((null===(t=a)||void 0===t?void 0:t.range[0])||1/0,(null===(i=o)||void 0===i?void 0:i.range[0])||1/0),Math.max((null===(r=a)||void 0===r?void 0:r.range[1])+s||0,(null===(n=o)||void 0===n?void 0:n.range[1])+l||0)];return e<this.timeRange.length&&(this.timeRange[e].range=d),d}},{key:"load",value:(s=l(a().mark((function e(t,i){var r,n,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._loadSuccessCallBack=i,!this._switchBitRate||this._metaLoading){e.next=12;break}return this.log("[switchBitrate], switch bitRate start load, bitRate,",this._bitRate,", time,",t>=this.videoTrak.length?this.audioTrak[t].startTime:this.videoTrak[t].startTime,", fragIndex,",t),e.next=5,this._checkHasMeta();case 5:r=e.sent,this.changeBitRateTime>0&&(this.timeRange[t].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[t].endTime?this.log("[switchBitrate], not need update load fragIndex",t,",stTime,",this.changeBitRateTime):(t=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",t,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[t].startTime,"-",this.timeRange[t].endTime),this.emit(Oe,t)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(t),this.log("[switchBitrate], reset timerange state,",t),this._needInitSegment=!0,this.resetTansmuxer(),r&&(this._switchBitRate=!1);case 12:if(!this._switchBitRate||!this._metaLoading){e.next=14;break}return e.abrupt("return");case 14:n=this.getFragRange(t),(o=this.getFragmentFromCache(t,n))?(this.log("[mp4.load], segment ,",t,"Data In Cache",JSON.stringify(n),", needInit,",this._needInitSegment),this.timeRange[t].downloaded=!0,this.timeRange[t].isLoading=!1,this._needInitSegment=!1,this._loadSuccessCallBack&&this._loadSuccessCallBack(o)):(this.log("loadFragment,",t,",bitRate,",this._bitRate,",range,",JSON.stringify(n)),this.seekTime>0?(s=this.getSubRange(t,this.seekTime,n),this.loadFragment(t,s),this.seekTime=-1):this.loadFragment(t,n));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getSubRange",value:function(e,t,i){var r=i[0],n=i[0],a=1,o=!1;if(this.log(">>>>>getSubRange time,",t,JSON.stringify(i)),this.videoTrak){var s=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1],l=s.frames.filter(Je),d=this.meta.videoTimescale,c=l[0].startTime/d;this.log(">>>>>getSubRange video, startTime,",s.startTime,",endTime,",s.endTime);for(var u=0;u<l.length;u++)this.log(">>>>>getSubRange video keyFrameList, startTime,",l[u].startTime/d,",range,",l[u].offset);for(;a<l.length;a++){var h=l[a].startTime/d;if(c<=t&&t<h&&i[0]<l[a-1].offset){r=l[a-1].offset,o=!0,this.log(">>>>>getSubRange video end, startTime,",c,",endTime,",h,",startRange,",r,", keyFrameIndex,",a-1);break}c=h}!o&&c<=t&&t<s.endTime+.8&&(r=l[a-1].offset,this.log(">>>>>getSubRange video last, startTime,",c,",endTime,",s.endTime,",startRange,",r))}if(a=1,this.audioTrak){var f=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1],m=f.frames,p=this.meta.audioTimescale;a=Math.floor((t*p-m[0].startTime)/f.frames[0].duration);for(var b=(a=Math.min(m.length-1,a))>0?m[a-1].startTime/p:m[0].startTime/p;a>=0&&a<m.length;)if(a>0&&b>t)b=m[a-=1].startTime/p;else{var y=(m[a].startTime+m[a].duration)/p;if(b<=t&&t<y&&i[0]<m[a].offset){n=m[a].offset,o=!0,this.log(">>>>>getSubRange audio end, startTime,",b,",endTime,",y,",startRange,",n,", index,",a);break}b=y,a++}}var g=[Math.min(n,r),i[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(g),",oldRange,",JSON.stringify(i)),g}},{key:"getFragmentFromCache",value:function(e,t){var i=this.preloadCache;if(!i||!i.segList)return null;for(var r=-1,n=i.segList,a=i.initSeg,o=0;o<n.length;o++)if(n[o].index===e){r=o;break}if(r<0)return null;var s=n[r];if(this.log(">>>>preloadCache",r,s,s.range,t[1],s.range[1]>=t[1]),s.range[1]>=t[1]){var l=[this.timeRange[e].startTime,this.timeRange[e].endTime];return{buffer:s.buffer,range:t,context:{range:t,fragIndex:e,state:!0,timeRange:[l[0],l[1]]},state:!0,initSeg:this._needInitSegment?a:void 0}}return null}},{key:"_mux",value:function(e,t,i,r){this.firstFrameTime.firstmux<0&&this.timeRecord.startMuxTime<0&&(this.timeRecord.startMuxTime=xe.nowTime(),this.firstFrameTime.startMuxTime=xe.nowTime()-this.timeRecord.startLoadTime);var n=this.getSamplesRange(i,"video"),a=this.getSamplesRange(i,"audio"),o=[t,t+e.byteLength];if(this.transmuxerWorkerControl){var s={range:o,state:r,fragIndex:i};this.log("[transmuxerworker start] ,range, ",JSON.stringify(o),",dataLen,",e.byteLength,s),this.transmuxerWorkerControl.transmux(this.workerSequence,e,t,n,a,this.meta.moov,this.useEME,this.kidValue,s)}else try{this.MP4Demuxer||(this.MP4Demuxer=new ye._(this.videoTrak,this.audioTrak,null,{openLog:we()}));var l,d=this.MP4Demuxer.demuxPart(e,t,n,a,this.meta.moov,this.useEME,this.kidValue);this.FMP4Remuxer||this.checkCodecH265()&&!this.options.supportHevc||(this.FMP4Remuxer=new ge.N(this.MP4Demuxer.videoTrack,this.MP4Demuxer.audioTrack,{openLog:we()})),this.log("[mux], videoTimeRange,",d.videoTrack?[d.videoTrack.startPts,d.videoTrack.endPts]:null,",audioTimeRange,",d.audioTrack?[d.audioTrack.startPts,d.audioTrack.endPts]:null);var c=[Math.min(d.videoTrack.startPts,d.audioTrack.startPts),Math.max(d.videoTrack.endPts,d.audioTrack.endPts)];if(this.FMP4Remuxer){var u=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:o});u.initSegment&&(this._needInitSegment=!1),l={buffer:xe.concatData(u.audioSegment,u.videoSegment),range:o,state:r,context:{range:o,fragIndex:i,timeRange:c},initSeg:u.initSegment}}else l={videoTrack:d.videoTrack,audioTrack:d.audioTrack,buffer:null,range:o,state:r,context:{range:o,fragIndex:i,timeRange:c}};this.firstFrameTime.firstmux<0&&this.timeRecord.startMuxTime>0&&(this.firstFrameTime.firstmux=xe.nowTime()-this.timeRecord.startMuxTime),this._loadSuccessCallBack&&this._loadSuccessCallBack(l)}catch(r){console.error("mux err:",r);var h=new Se(Te.remux,Ze.muxError,{msg:JSON.stringify(r)});this.errorHandler(h,"mux",{fragIndex:i,range:[t,t+e.byteLength]})}}},{key:"getSamplesRange",value:function(e,t){var i=[];switch(t){case"video":if(this.videoTrak&&e<this.videoTrak.length){var r=this.videoTrak[e].frames;i.push(r[0].index),i.push(r[r.length-1].index)}break;case"audio":if(this.audioTrak&&e<this.audioTrak.length){var n=this.audioTrak[e].frames;i.push(n[0].index),i.push(n[n.length-1].index)}break;default:console.warn("[getSamplesRange] type ",t," is invalid")}return i}},{key:"loadFragment",value:(o=l(a().mark((function e(t,i){var r,n,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPending&&i!==[0,0]&&!this.timeRange[t].isLoading){e.next=2;break}return e.abrupt("return");case 2:if(this.log("[MP4.loadFragment] ,fragIndex,",t,",range ",i,",len ,",i[1]-i[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),this._segmentToBitRateMap.set(t,this._bitRate),this.timeRecord.startLoadTime<0&&(this.timeRecord.startLoadTime=xe.nowTime()),!(i.length>=2&&i[1]&&i[1]>0&&i[1]<=this.bufferLoaded.byteLength)){e.next=15;break}this.timeRange[t].isLoading=!0,r=Math.max(i[0],this.bufferLoadedPos),n=new Uint8Array(this.bufferLoaded.slice(r,i[1])),this.log("[mp4.loadFragment] has all data: ",r,i[1]),this.timeRange[t].downloaded=!0,this.bufferLoadedPos=-1,this._mux(n,r,t,!0),e.next=36;break;case 15:if(!(i.length>=2&&i[0]&&i[0]<=this.bufferLoaded.byteLength)){e.next=31;break}if(this.timeRange[t].isLoading){e.next=29;break}if(o=Math.max(i[0],this.bufferLoadedPos),!((s=new Uint8Array(this.bufferLoaded.slice(o,i[1]))).byteLength>0)){e.next=24;break}return this.bufferLoadedPos=o+s.byteLength,this.log("[mp4.loadFragment] has part data: ",o,o+s.byteLength),this._mux(s,o,t,i[1]<=this.bufferLoadedPos),e.abrupt("return");case 24:if(this._metaLoading||this.timeRange[t].isLoading){e.next=29;break}return this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,i[1]),this.timeRange[t].isLoading=!0,e.next=29,this.startLoad([this.bufferLoaded.byteLength,i[1]],t);case 29:e.next=36;break;case 31:if(this._metaLoading&&!(i[0]>=this.CHUNK_SIZE)||this.timeRange[t].isLoading){e.next=36;break}return this.timeRange[t].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",t,",range >>> ",JSON.stringify(i)),e.next=36,this.startLoad(i,t);case 36:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"startLoad",value:(r=l(a().mark((function e(t,i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.MP4Loader.loadData(t,this.MP4Loader.cache,{index:i,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("[MP4] trigger errorHandler getMetaInfo",null===e.t0||void 0===e.t0?void 0:e.t0.message),this.loadError(e.t0,"loadFragment",{range:t,fragIndex:i});case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t){return r.apply(this,arguments)})},{key:"loadError",value:function(e,t,i){var r;!e.response&&(e.response={}),e.isTimeout?e.response.status="timeout":null!=e&&null!==(r=e.response)&&void 0!==r&&r.status||(e.response.status="networkError"),this.errorHandler(e,t,i)}},{key:"loadAllFragmentData",value:(i=l(a().mark((function e(t,i,r){var n,o,s,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasDestroyed){e.next=2;break}return e.abrupt("return");case 2:return n=this.getFragRange(t),e.prev=3,e.next=6,this.MP4Loader.loadData(n,this.MP4Loader.cache,{index:t});case 6:if(o=e.sent,this.log("loadAllFragmentData after",JSON.stringify(n),o),o&&o.data){e.next=12;break}return s=new Error("response null"),r?r(s):this.loadError(s,"loadFragment",{range:n,fragIndex:t}),e.abrupt("return");case 12:l=o.data,this._loadSuccessCallBack=i,this._mux(l,n[0],t,!0),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),console.error("[MP4] loadAllFragmentData error",e.t0),r(e.t0);case 21:case"end":return e.stop()}}),e,this,[[3,17]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"cancelLoading",value:(t=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.MP4Loader;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.MP4Loader.cancel();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"update",value:function(e){this.url=e}},{key:"getDataBitRate",value:function(e){return this._segmentToBitRateMap.get(e)}},{key:"checkCodecH265",value:function(){return this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1)}},{key:"destroy",value:function(){this.hasDestroyed||(this.resetTansmuxer(),this.transmuxerWorkerControl&&this.transmuxerWorkerControl.destroy(),this.size=0,this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this._bitRateInfoMap.clear(),this._segmentToBitRateMap.clear(),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}},{key:"resetTansmuxer",value:function(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null,this.transmuxerWorkerControl&&this.transmuxerWorkerControl.reset()}}],[{key:"getDefaultConfig",value:function(){return{onProcessMinLen:1024,xhrSetup:null,chunkSize:8e5,loadSize:800,isCache:!1,playerId:"",vid:"",ext:{}}}}]),T}(me());function Je(e){if(e.keyframe)return e}var je={playBtnClick:function(e,t,i,r){e.paused||e.waitingMoreBuffer&&(e.waitingMoreBuffer=!1),r.call(e,t,i)}},Be={waiting:function(e,t){var i=e.player,r=e.eventName;i.waitingMoreBuffer=!0,t(r,e)},play:function(e,t){var i=e.player,r=e.eventName;i.waitingMoreBuffer||t(r,e)},pause:function(e,t){var i=e.player,r=e.eventName;i.waitingMoreBuffer||t(r,e)},seeking:function(e,t){var i=e.player,r=e.eventName;i.isSeekingStart=!0,t(r,e)},progress:function(e,t){Ge(">>>>progress");var i=e.player,r=e.eventName;if(i.waitingMoreBuffer){var n=i.getBufferedRange(i.buffered2);0===n[0]&&0===n[1]||(void 0===i.inWaitingStart||i.isSeekingStart?(Ge("progress 起播或seek结束"),n[1]-i.currentTime>=(i.config.canplayWaterLevel||1)||n[1]>i.duration-1?(Ge("progress 出起播水位"),i.play()):(Ge("progress 未出起播水位"),i.emit("waiting"))):(Ge("progress video卡顿结束"),n[1]-i.currentTime>=(i.config.bufferWaterLevel||5)||n[1]>i.duration-1?(Ge("progress 出卡顿水位"),i.play()):(Ge("progress 未出卡顿水位"),i.emit("waiting"))))}t(r,e)},playing:function(e,t){var i=e.player,r=e.eventName;Ge("playing");var n=i.getBufferedRange(i.buffered2);if(0===n[0]&&0===n[1])return Ge("playing 当前播放时刻没有缓存 未出水位"),i.waitingMoreBuffer=!0,i.pause(),void t.call("waiting",e);void 0===i.inWaitingStart||i.isSeekingStart?(Ge("playing 起播或seek结束"),n[1]-i.currentTime>=(i.config.canplayWaterLevel||1)||n[1]>i.duration-1?(Ge("playing 出起播水位"),i.waitingMoreBuffer=!1,i.isSeekingStart=!1,t(r,e)):(Ge("playing 未出起播水位"),i.waitingMoreBuffer=!0,i.pause(),t.call("waiting",e))):(Ge("playing video卡顿结束"),n[1]-i.currentTime>=(i.config.bufferWaterLevel||5)||n[1]>i.duration-1?(Ge("playing 出卡顿水位"),i.waitingMoreBuffer=!1,t(r,e)):(Ge("playing 未出卡顿水位"),i.waitingMoreBuffer=!0,i.pause(),t.call("waiting",e)))}},ze=function(e){f(i,e);var t=g(i);function i(e){var r;return d(this,i),(r=t.call(this)).drm=e,r.KEYSYSTEM_TYPE="",r.keys={},r.drm.clearKeys&&(r.KEYSYSTEM_TYPE="org.w3.clearkey",r.keys=r.drm.clearKeys),r.options=[],r.ensurePromise=void 0,r}return u(i,[{key:"updateDrm",value:function(e){this.drm=e,this.keys=this.drm.clearKeys}},{key:"setOptions",value:function(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/mp4; codecs="hev1.1.6.L120.90"'},{contentType:'video/webm; codecs="vp8"'}],t={videoCapabilities:e},i={videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]};this.options=[i,t]}},{key:"bail",value:function(e){console.error("[EME]",e),this.emit("error",e)}},{key:"UpdateSessionFunc",value:function(e){var t=this;return function(i){var r=[],n=[];Object.keys(e).forEach((function(t){var i=e[t],a=xe.fromHex(t),o=xe.fromHex(i),s={kty:"oct",kid:xe.toBase64(a,!1),k:xe.toBase64(o,!1)};r.push(s),n.push(s.kid)}));var a={keys:r},o=JSON.stringify(a);i.target.update(xe.StringToArrayBuffer(o)).then((function(){}),(function(e){return t.bail(" MediaKeySession update failed")}))}}},{key:"KeysChange",value:function(e){}},{key:"EnsureMediaKeysCreated",value:function(e,t,i){var r=this;return this.ensurePromise||(this.ensurePromise=navigator.requestMediaKeySystemAccess(t,i).then((function(e){return e.createMediaKeys()}),(function(e){return r.bail(" Failed to request key system access.")})).then((function(t){return e.setMediaKeys(t)}),(function(e){return r.bail(" failed to create MediaKeys object")}))),this.ensurePromise}},{key:"SetupEME",value:function(e,t){var i,r,n=this;e.sessions=[],i="encrypted",r=function(){var t=JSON.stringify({kids:["0123456789abcdef0123456789abcdef"]}),i=new Uint8Array(xe.toUTF8(t));n.EnsureMediaKeysCreated(e,n.KEYSYSTEM_TYPE,n.options).then((function(){var t=e.mediaKeys.createSession();return e.sessions.push(t),t.addEventListener("message",n.UpdateSessionFunc(n.keys)),t.addEventListener("keystatuseschange",n.KeysChange),t.generateRequest("keyids",i.buffer)}),(function(e){return n.bail(" failed to ensure MediaKeys on HTMLMediaElement")})).then((function(){}),(function(e){return n.bail(" Failed to generate request.")}))},this.on(i,(function(e){r()}))}}]),i}(me());function Qe(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),i=e.indexOf("Trident/");return t>0||i>0}function qe(){var e,t,i,r,n,a,o,s;return!(!navigator.requestMediaKeySystemAccess||(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),n=Qe(),e=navigator.mimeTypes,t=navigator.userAgent,i=!1,e&&t.indexOf("Chrome")>1&&(i=Object.keys(e).some((function(t){return!!(e[t].type&&e[t].type.indexOf("360")>-1)||!!(e[t].type&&e[t].type.indexOf("application/vnd.chromium.remoting-viewer")>-1)||!!(e[t].description&&e[t].description.indexOf("360")>-1)}))),a=i,o=navigator.userAgent.indexOf("Firefox")>0,s=navigator.userAgent.indexOf("Edge")>0,r||n||a||o||s))}function $e(){try{if("object"===("undefined"==typeof WebAssembly?"undefined":o(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){console.log(e)}return!1}function et(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported}i(37369),i(66440);var tt=function(){function e(){var t,i;d(this,e);var r=new Promise((function(e,r){t=e,i=r}));return r.resolve=function(e){t(e),r.state="fulfilled"},r.reject=function(e){i(e),r.state="rejected",r.isBreak="DESTROYED"===e},r.state="pending",r}return u(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}(),it=function(){function e(t){d(this,e),this.onTick_=t,this.cancelPending_=null}return u(e,[{key:"tickAfter",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stop();var r=!0,n=null;this.cancelPending_=function(){window.clearTimeout(n),r=!1};var a=function(){r&&(t.onTick_(),i&&i())};return n=window.setTimeout(a,1e3*e),this}},{key:"tickEvery",value:function(e){var t=this;this.tickAfter(e,(function(){t.tickEvery(e)}))}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}]),e}(),rt={MEDIA_EXPIRED:"MEDIA_EXPIRED",INIT_FAIL:"INIT_FAIL",PARSE_ERROR:"PARSE_ERROR",PLAYER_LOG:"PLAYER_LOG",BUFFERED_RESET:"BUFFERED_RESET"},nt=i(28311),at=i(8850),ot=(i(88089),function(){function e(){(0,nt.Z)(this,e),this.timeID=null,this.func=null}return(0,at.Z)(e,[{key:"repeat",value:function(e,t){this.timeID=1,this.repeatInterval(e,t)}},{key:"repeatInterval",value:function(e,t){var i=this;this.timeID&&(null===this.func&&(this.func=e),this.func===e&&(this.timeID&&clearTimeout(this.timeID),this.timeID=null,this.timeID=setTimeout((function(){e(),i.repeatInterval(e,t)}),t)))}},{key:"clear",value:function(){clearTimeout(this.timeID),this.timeID=null}}]),e}()),st=function(){function e(t,i){d(this,e),this.player=t,this.mediaElem=t.video,this.config=i,this.timer=new ot,this.prevReadyState=this.mediaElem.readyState,this.didFireLargeGap=!1,this.seekingEventReceived=!1,this.onWaitFunc=this._onWaiting.bind(this),this.onPlayFunc=this._onPlay.bind(this),this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),!1!==this.config.useGapJump&&this._start(),this.hasPlayed=!1}return u(e,[{key:"_onWaiting",value:function(){this.onGapJump()}},{key:"_onPlay",value:function(){this.hasPlayed=!0}},{key:"_start",value:function(){this.mediaElem.addEventListener("waiting",this.onWaitFunc),this.mediaElem.addEventListener("play",this.onPlayFunc)}},{key:"onSegmentAppend",value:function(e){if(this.config.enableCheckBufferDiff&&this.mediaElem){var t=e.reduce((function(e,t){return e+t.downloaded?t[1]-t[0]:0}),0);this._getBuffered(this.mediaElem.buffered).reduce((function(e,t){return e+(t.end-t.start)}),0)/t<.8&&(Ge("onSegmentAppend detectGap"),this.player&&this.player.emit("detectGap"))}this.onGapJump()}},{key:"onSeeking",value:function(){this.seekingEventReceived=!0,this.didFireLargeGap=!1}},{key:"onGapJump",value:function(){if(this.mediaElem.readyState!==HTMLMediaElement.HAVE_NOTHING){if(this.mediaElem.seeking){if(!this.seekingEventReceived)return}else this.seekingEventReceived=!1;if(!this.mediaElem.paused||0===this.mediaElem.currentTime||!this.hasPlayed){this.mediaElem.readyState!==this.prevReadyState&&(this.didFireLargeGap=!1,this.prevReadyState=this.mediaElem.readyState);var t=this.mediaElem.buffered,i=this.config.smallGapLimit||.5,r=this.config.gapDetectionThreshold||.1,n=this.mediaElem.currentTime,a=this._getIndex(t,n,r);if(null!==a&&(0!==a||t&&t.length)){var o=t.start(a)+.1;if(!(o>this.mediaElem.duration)){var s=o-n,l=s<=i;s<e.BROWSER_GAP_TOLERANCE||l&&(!0!==this.config.disableGapSetPosition&&(Ge("onGapJump this.mediaElem.currentTime"),this.mediaElem.currentTime=this.isSafari?o+.1:o),this.player&&this.player.emit("detectGap"),Ge("gapJump gapIndex",a,"isGapSamll",l,"jumpLargeGap",!1,"currentTime",this.mediaElem.currentTime),.08!==o&&this.player&&this.player.emit("log",{type:"oneevent",end_type:"gap",vid:this.player.config.vid,ext:{video_postion:Math.floor(1e3*o)}}))}}}}}},{key:"_getIndex",value:function(e,t,i){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;for(var r=this._getBuffered(e),n=null,a=0;a<r.length;a++)if(r[a].start>t&&(0===a||r[a-1].end-t<=i)){n=a;break}return n}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}},{key:"destroy",value:function(){this.mediaElem.removeEventListener("waiting",this.onWaitFunc),this.mediaElem.removeEventListener("play",this.onPlayFunc),this.timer.clear(),this.timer=null}}]),e}();st.BROWSER_GAP_TOLERANCE=.001,i(9989);var lt=i(87205),dt=i(22047),ct=i(34862),ut=i(56671),ht=i(62087),ft=(i(68117),i(89475),i(13948),i(52835),i(82584),i(58785),i(8994),i(11824),function(){function e(){(0,nt.Z)(this,e)}return(0,at.Z)(e,null,[{key:"install",value:function(){if(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame,!window.requestAnimationFrame){var e=Date.now();window.requestAnimationFrame=function(t){var i=Date.now(),r=Math.max(16.7-(i-e),0),n=setTimeout(t,r);return e=i+r,n}}window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}}]),e}()),mt=function(){function e(){(0,nt.Z)(this,e),this.fps=0,this.isStoped=!0,this.ticks=[],this.isSupport=!0,this.maxFps=0,this.step=this._step.bind(this),this.rafId=null}return(0,at.Z)(e,[{key:"_step",value:function(e){var t=this.ticks;if(t.unshift(e),t.length>10){var i=t.pop();i&&(this.fps=Math.floor(1e4/(e-i)),this.updateFpsInfo())}this.isStoped||(this.rafId=window.requestAnimationFrame(this.step))}},{key:"updateFpsInfo",value:function(){this.fps>this.maxFps&&(this.maxFps=this.fps)}},{key:"start",value:function(){void 0!==window.requestAnimationFrame&&(this.isStoped=!1,this.rafId=window.requestAnimationFrame(this.step))}},{key:"stop",value:function(){window.cancelAnimationFrame(this.rafId),this.isStoped=!0}}],[{key:"install",value:function(){ft.install()}}]),e}();i(95660);var pt=function(){function e(){var t,i;(0,nt.Z)(this,e);var r=new Promise((function(e,r){t=e,i=r}));return r.resolve=t,r.reject=i,r}return(0,at.Z)(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}(),bt=(i(6962),function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}&&!function(){var e="_localstorage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}());bt&&localStorage.length;var yt=function(e){try{return localStorage.getItem(e)}catch(e){return null}},gt=function(e,t){try{localStorage.setItem(e,t)}catch(e){}},vt="danger_d_speed",Zt=function(){function e(t,i,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{logger:function(){},openLog:!1};(0,nt.Z)(this,e),this.bitrate=i,this.segment_duration=n||5e3,this.logger=a.logger,this.openLog=a.openLog,this.cdnHost=t.cdnHost,this._loadedPromise=new pt,this._wasmPromise=new pt,this.config=t,this.autoBitrateOpts=t.autoBitrateOpts||{},this.stall_penalty=this.autoBitrateOpts.stall_penalty||11,this.switch_penalty=this.autoBitrateOpts.switch_penalty||4,this.interval=this.autoBitrateOpts.interval||1e3;var o=t.progressTimer||1e3,s=this.autoBitrateOpts.startInterval||o;this.initInterval=.8*s,this._prealodMethod=t.preloadmethod||0,this._videoWidth=0,this._videoHeight=0,this._hasDeviceInfoChanged=!0,this.updateMediaInfos(r,!1)}return(0,at.Z)(e,[{key:"onLoadWasm",value:function(){var e=this,t=this.module={onRuntimeInitialized:function(){e._wasmPromise.resolve()}};return(0,this.autoBitrateOpts.module)(t),this._wasmPromise}},{key:"updateMediaInfos",value:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._heightToDefitionConfig=new Map,this._bitrateToDefitionConfig=new Map,e?(this.mediaInfos=e,this.mediaInfos.dynamic_video_list.forEach((function(e){t._heightToDefitionConfig.set(e.vheight,e),t._bitrateToDefitionConfig.set(e.bitrate,e)}))):i&&console.error("baseAbr mediaInfos null")}},{key:"parseMPD",value:function(){if(this.setDebugModel(this.openLog),this.mediaInfos){this.logger("mediaInfos",this.mediaInfos);try{for(var e=[],t=this.mediaInfos.dynamic_video_list,i=0;i<t.length;i++){var r=t[i];e.push({stream_id:"s".concat(i),bandwidth:r.bitrate||r.bandwidth,width:r.vwidth||r.width,height:r.vheight||r.height,codec:r.codecs||r.codec_type||"h264",frame_rate:Number(r.fps)||-1,segment_duration:this.segment_duration})}var n={v_adaptation:e},a=JSON.stringify(n);this.module.ccall("parseMPD","null",["string"],[a])}catch(e){}}else console.warn("mediaInfos is null")}},{key:"_getDefautSpeed",value:function(e){var t=0,i=window.navigator.connection;if(i&&i.downlink)t=1024*navigator.connection.downlink/8,this.logger("initSpeed connect",t);else try{t=parseFloat(yt(vt))||0,this.logger("initSpeed connect",t)}catch(e){}return 0===t&&(t=e&&e.historyAvspeed||0,this.logger("initSpeed history",t)),t}},{key:"setDebugModel",value:function(e){this.module._setDebugModel(e)}},{key:"updateBitrate",value:function(e){this.bitrate=e}},{key:"_updatePreloadSupplier",value:function(e,t){this.module._updatePreloadSupplier(e,t)}},{key:"updatePreloadSupplier",value:function(e){var t=this._getDefautSpeed();this._updatePreloadSupplier(t,e)}},{key:"getPreloadBitrate",value:function(){var e,t=null,i=[];try{this.logger("preloadMethod",this._prealodMethod),e=this.module._getPreloadBitrate(this._prealodMethod);for(var r=0;r<5;r++)i.push(this.module.HEAP32[e/Int32Array.BYTES_PER_ELEMENT+r]);var n={bitrate:i[0],pduration:i[1],preloadType:i[2],size:i[3],mediaType:i[4]};return this.logger("getPreloadBitrate",n),n}catch(e){t=null,console.log("getPreloadBitrate",e)}finally{this.module._free(e)}return t}},{key:"_updateDeviceInfo",value:function(e){try{if(this._hasDeviceInfoChanged){var t=window.devicePixelRatio||1;this.module._updateDeviceInfo(this._videoWidth||Number(this.config.width),this._videoHeight||Number(this.config.height),t,e||-1)}this._hasDeviceInfoChanged=!1}catch(e){console.log("_updateDeviceInfo")}}},{key:"preload",value:function(e){this.parseMPD(),this.updatePreloadSupplier(e),this._updateDeviceInfo(-1);var t=window.devicePixelRatio||1;return this.logger("baseAbr updateDeviceInfo width",this._videoWidth||Number(this.config.width),"height",this._videoHeight||Number(this.config.height),"dpr",t),this.getPreloadBitrate()}}]),e}();Zt.SPPED_CACHE=vt;var Tt="ABR_CHANGE_A",Lt="UPDATE_AUTO_DESC",St="MAX_BUFFER_CHANGE",xt={PLAYBACK_BITRATE:"avg_play_bitrate",DOWNLOAD_BITRATE:"avg_download_bitrate",DOWNLOAD_NETWORK_SPEED:"avg_download_speed",PREDICT_NETWORK_SPEED:"avg_predict_speed",BUFFER_LENGTH:"avg_buffer_length",QOE:"avg_qoe"},kt=function(e){(0,ct.Z)(n,e);var t,i,r=(t=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,ht.Z)(t);if(i){var n=(0,ht.Z)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return(0,ut.Z)(this,e)});function n(e,t,i,a,o){var s,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{logger:function(){},openLog:!1};(0,nt.Z)(this,n),(s=r.call(this,t,i,a,o,l)).player=e,s.timerId=0,s.isOpenAutoDefi=!!s.autoBitrateOpts.isOpenAutoDefi,s.onPlayrateChange=s._onPlayrateChange.bind((0,dt.Z)(s)),s.onPlay=s._onPlay.bind((0,dt.Z)(s)),s._stop=s.stop.bind((0,dt.Z)(s)),s._bufferRange=new Map,s._sortedBufferRange=[],s._lastCheckResolutionStamp=0,s._currentDefinition=null,s._isSeeking=!1,s._waitingStartTime=0,s._stallCount=0,s._seekState=0,s._stallState=0,s._videoCurrentTime=0,s.listeners=[{evt:"playbackrateChange",handler:s.onPlayrateChange},{evt:"ended",handler:s._stop},{evt:"error",handler:s._stop},{evt:"timeupdate",handler:s._onTimeUpdate.bind((0,dt.Z)(s))},{evt:"addVideoBufferEnd",handler:s._bufferRangeUpdate.bind((0,dt.Z)(s))},{evt:"canplay",handler:s._updateAutoDesc.bind((0,dt.Z)(s))},{evt:"play",handler:s._onplayStart.bind((0,dt.Z)(s))},{evt:St,handler:s._onMaxBufferChange.bind((0,dt.Z)(s))},{evt:"seeking",handler:s._onSeeking.bind((0,dt.Z)(s))},{evt:"seeked",handler:s._onSeekEnd.bind((0,dt.Z)(s))},{evt:"waiting",handler:s._onWaiting.bind((0,dt.Z)(s))},{evt:"playing",handler:s._onPlaying.bind((0,dt.Z)(s))}],s._hasStart=!1,s.listeners.forEach((function(e){var t=e.evt,i=e.handler;s.player.on(t,i)})),s._isPaused=!1,s._hasAddFrament=!1,s._eventInfo={local_time_ms:0,internet_speed:0,buffer_length:0,last_bitrate:0,now_bitrate:0,play_speed:1},s._bitrateSet=[],s._generalInfo={},s._currentInAbr=!1,s._hasCalcTimelineLog=!1,s._abr_play_info={start_play_time_ms:0,is_hint:0,playback_info:{internet_speed_record:[],play_bitrate_record:[],buffer_length_record:[],play_speed_record:[],qoe_record:[],qoe_a_record:[],qoe_b_record:[],qoe_c_record:[]}},s._abrMethod=s.autoBitrateOpts.method||0,s.logger("abr: constructor"),s._loopInterval=s.initInterval,s._tickCount=0,s._fps=30,mt.install(),s.startTime=performance.now(),s.logger("time abr",(new Date).getTime()),s._maxCacheTimeVideo=s.config.maxBufferLength||s.config.preloadTime||50,s._maxCacheTimeAudio=s._maxCacheTimeVideo,s._prevDefinitionItem=null,s._currentItem=null,s._switchCount=0,s._switchBitrate=0,s._avgStatItems={};for(var d=Object.keys(xt),c=0;c<d.length;c++){var u=d[c],h=xt[u];s._avgStatItems[h]=new It}return s._qoeArgs=[0,0,0,0],s._abrUsed=-1,s._abrAlwaysOn=1,s._prelaodInfo=null,s._hasLogStartInfo=!1,s._hasExecuteAbrAlgo=!1,s._lastExecuteTimeInMs=0,s}return(0,at.Z)(n,[{key:"init",value:function(e){return this._mediaList=e,this.isOpenAutoDefi?this.onLoadWasm():this._wasmPromise.resolve(),this._wasmPromise}},{key:"execute",value:function(){return this.listenSize(),this.initFps(),this.onWinElemSizeChange(),this.onPlay()}},{key:"_onSeeking",value:function(){this._isSeeking=!0,this.player.currentTime<this._videoCurrentTime?this._seekState=-1:this._seekState=1,this.logger("seekState",this._seekState)}},{key:"_onSeekEnd",value:function(){this._isSeeking=!1}},{key:"_onWaiting",value:function(){var e=this;this._isSeeking||this._waitingStartTime>0||(this._waitingStartTime=(new Date).getTime(),this._stallId=setTimeout((function(){clearTimeout(e._stallId),e._stallCount++,e._stallState=1}),200))}},{key:"_onPlaying",value:function(){this._waitingStartTime=0,this._stallState=0,clearTimeout(this._stallId)}},{key:"initFps",value:function(){this.fpsDetection=new mt,this.fpsDetection.start(),this._fps=this.fpsDetection.fps,this._hasDeviceInfoChanged=!0}},{key:"listenSize",value:function(){var e,t,i;this.mediaElem=this.player.video,this._onWinSizeChange=(e=this.onWinElemSizeChange.bind(this),1e3,t=!1,function(){var r=this,n=arguments,a=function(){i=null,e.apply(r,n)},o=t;clearTimeout(i),i=setTimeout(a,1e3),o&&e.apply(r,n)}),window.addEventListener("resize",this._onWinSizeChange)}},{key:"onWinElemSizeChange",value:function(){if(this.mediaElem){var e=this.mediaElem.getBoundingClientRect();this._videoWidth=Math.floor(e.width),this._videoHeight=Math.floor(e.height),this._hasDeviceInfoChanged=!0}}},{key:"_onMaxBufferChange",value:function(e){var t=e.videoCacheTime,i=e.audioCacheTime;this._maxCacheTimeAudio=i,this._maxCacheTimeVideo=t}},{key:"_onTimeUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._sortedBufferRange&&0!==this._sortedBufferRange.length&&this._currentInAbr){this._videoCurrentTime=this.player.currentTime;var i=Date.now();if(!(i-this._lastCheckResolutionStamp<1e3&&0!==this._lastCheckResolutionStamp)||t){this._lastCheckResolutionStamp=i;for(var r=this.player.currentTime,n=0,a=this._sortedBufferRange.length-1,o=null;n<=a;){var s=Math.floor(n+(a-n)/2),l=this._sortedBufferRange[s];if(r<l.start)a=s-1;else{if(!(r>=l.end)){o=l;break}n=s+1}}if(o){var d=this._bitrateToDefitionConfig.get(o.bandwidth),c=d&&d.definition;if(this._currentDefinition===c&&!t||!c)return void(c||this.logger("error defintion, mpd配置与接口配置不一致"));this._currentDefinition=c,this._prevDefinitionItem=this._currentItem,this._currentFps=d.fps,this._currentItem=d,this._emitAutoDescChange(c,!1,this._currentFps,d)}}}}},{key:"_emitAutoDescChange",value:function(e,t,i,r){console.log("[ABR],emitAutoDescChange, definition, ",e,",item,",r,",pre_item,",this._prevDefinitionItem),this.player.emit(Lt,{definition:e,reset:t,fps:i,item:r,pre_item:this._prevDefinitionItem})}},{key:"_onplayStart",value:function(){this._hasStart=!0,this.logger("onplaystart")}},{key:"_updateAutoDesc",value:function(){var e=this;this._currentInAbr&&this._currentDefinition&&(this._updateId=setTimeout((function(){clearTimeout(e._updateId),e._emitAutoDescChange(e._currentDefinition,!1,e._currentFps,e._currentItem)}),0))}},{key:"_bufferRangeUpdate",value:function(e){if(void 0!==e.start){null===this._currentItem&&this._onTimeUpdate(null,!0);var t=e.start;this._hasAddFrament=!0,this._bufferRange.set(t,e);var i=(0,lt.Z)(this._bufferRange.values());this._sortedBufferRange=i.sort((function(e,t){return e.start-t.start})),this.avgStat(xt.DOWNLOAD_BITRATE,e.bandwidth)}}},{key:"_onPlayrateChange",value:function(){this.module&&this.updateBufferInfo()}},{key:"_onPlay",value:function(){var e=this;if(!this.isOpenAutoDefi)return this.logger("onPlay"),0;var t=0;try{this.logger("abr: loadeddata"),this.updateSwitchInfo(),this.parseMPD(),this.updateDeviceInfo();var i=n.getIsPlayAutoDefi(this.autoBitrateOpts);if(this.isOpenAutoDefi&&i){this._abrUsed=1;var r=this._getDefautSpeed(this.player);t=this._loopAbr(r),this.start(),this.logger("time abr start prgress",(new Date).getTime()),this.logger("time abr costTime",performance.now()-this.startTime),this.logger("abr onplay"),this.startTimer=setTimeout((function(){e._loopInterval=e.interval,clearTimeout(e.startTimer),e.logger("interval change")}),5e3)}}catch(e){this.logger("abr: loadeddata error",e),this.logger("time abr costTime err",performance.now()-this.startTime)}return t}},{key:"start",value:function(){if(this.logger("abr: start"),this._isPaused=!1,!this._hasCalcTimelineLog){var e=1===Math.floor(100*Math.random());this._abr_play_info.is_hint=e?1:0}this._hasCalcTimelineLog=!0,this._loop()}},{key:"_loop",value:function(){var e=this;this._isPaused||(clearTimeout(this.timerId),this.timerId=setTimeout((function(){if(!e.player.paused||!e.player.config.autoplay&&!e._hasStart){var t=e._hasAddFrament?void 0:e._getDefautSpeed(e.player);e._loopAbr(t)}e._loop()}),this._loopInterval))}},{key:"updateDeviceInfo",value:function(){try{if(this.fpsDetection){var e=this.fpsDetection.fps;e!==this._fps&&(this._fps=e,this._hasDeviceInfoChanged=!0)}this._updateDeviceInfo(this._fps)}catch(e){}}},{key:"updateBufferInfo",value:function(e){var t=this.player.playbackRate,i=this.bufferLength,r=e||Math.floor(this.player.downloadSpeed);return this._tickCount<5&&0===r&&(r=this._getDefautSpeed(this.player),this.logger("initSpeed fix")),this.logger("maxCacheTimeAudio:",this._maxCacheTimeAudio,"maxCacheVideoTime",this._maxCacheTimeVideo,"seekState",this._seekState,"stallState",this._stallState),this.module._updateBufferInfo(t,this._maxCacheTimeAudio,this._maxCacheTimeVideo,i,i,r,this._seekState,this.player.currentTime,this._stallState),this._seekState=0,this._eventInfo={internet_speed:r,buffer_length:i,last_bitrate:this.bitrate,play_speed:t},this.logger("playRate:",t,"buff:",i,"downloadSpeed:",r),{buffer:i,downloadSpeed:r}}},{key:"updateSwitchInfo",value:function(){var e=(new Date).getTime();this._openTimeMs=e,this._abr_play_info.start_play_time_ms=e;var t,i,r=this.player.config.preloadTime||50,n=(i=(t=e).toString(16)).length<=8?{high:0,low:t}:{high:parseInt(i.substr(0,i.length-8),16),low:parseInt(i.substr(i.length-8),16)},a=this.autoBitrateOpts.noStallCheckTime||5,o=this.openLog;this.logger("openTime:",e,"this.logger",o),this.module._updateSwitchInfo(n.low,n.high,a,o,this.stall_penalty,this.switch_penalty);var s=this._mediaList.video,l=s.map((function(e){var t=e.bandwidth,i=e.bitrate;return t||i}));this._bitrateSet=l.map((function(e,t){return{bitrate:e,codecs:s[t].codecs||s[t].codec_type}})),this._generalInfo={max_cache_time:r,bitrate_set:this._bitrateSet,segment_duration:this.segment_duration,preload_info:{},startup_info:{}}}},{key:"updatePreloadCacheInfo",value:function(e){try{this._prelaodInfo=e,this.logger("update preloadInfo",e),e&&e.item_num!==e.items.length&&(this.logger("preloadInfo invalid"),this._prelaodInfo=null)}catch(e){this.logger("updatePreloadCacheInfo",e),this._prelaodInfo=null}}},{key:"updatePreloadLogInfo",value:function(e){this._generalInfo.preload_info=e||{}}},{key:"_updatePreloadInfo",value:function(){try{var e=this.player.getPreloadInfos();if(e){var t=e.preloadInfo,i=e.abr;this.updatePreloadLogInfo(t),i&&this.updatePreloadCacheInfo(t)}if(this.logger("_updatePreloadInfo preloadinfos",e),null!=this._prelaodInfo){var r=JSON.stringify(this._prelaodInfo);this.module.ccall("updatePreloadInfo","null",["string"],[r])}else this.logger("_updatePreloadInfo preloadinfo null, no preload")}catch(e){this.logger("_updatePreloadInfo err",e)}}},{key:"_loopAbr",value:function(e){var t;this._tickCount++;var i=[];try{this.updateDeviceInfo();var r=this.updateBufferInfo(e),n=r.downloadSpeed,a=r.buffer;t=this.module._getPredictedBitrate(this.bitrate,this._abrMethod);for(var o=0;o<7;o++)i.push(this.module.HEAP32[t/Int32Array.BYTES_PER_ELEMENT+o]);var s=i[0],l=1===i[1];this._eventInfo.now_bitrate=s,this._eventInfo.local_time_ms=(new Date).getTime();var d=0;if(s!==this.bitrate&&0!==s){var c=this.bitrate;d=Math.abs(c-s);for(var u=[],h=this.player.video.buffered,f=0;f<h.length;f++)u.push({start:h.start(f),end:h.end(f)});var m=this._videoWidth||Number(this.config.width),p=this._videoHeight||Number(this.config.height),b=(new Date).getTime(),y={speed:"".concat(n," KB/s"),buffer_length:"".concat(a," s"),video_pos:this.player.currentTime,all_buffers:u,seek_state:this._seekState,stall_state:this._stallState,screen_width:m,screen_height:p,dpr:window&&window.devicePixelRatio,playbackRate:this.player.playbackRate,bitrateSet:this._bitrateSet,abrMethod:this._abrMethod,delta:this._hasExecuteAbrAlgo?b-this._lastExecuteTimeInMs:0};this._lastExecuteTimeInMs=b,this._hasExecuteAbrAlgo=!0,this.player.emit(Tt,this.bitrate,s,l,JSON.stringify(y)),this.logger("abr loop predicte:",s,"willStall:",l,"switchBitrate",d,"cur",c),this.bitrate=s}this._hasLogStartInfo||(this._hasLogStartInfo=!0,this._generalInfo.startup_info={predict_bitrate:s,download_speed:n,screen_width:this._videoWidth||Number(this.config.width),screen_height:this._videoHeight||Number(this.config.height),device_pixel_ratio:window&&window.devicePixelRatio,screen_fps:this._fps,startup_method:this._abrMethod}),this.player.emit("ABR_LOOP"),this.onAbrLoop(n,i[2],d,i.slice(3))}catch(e){this.logger("abr error",e),console.log("error",e)}finally{this.module._free(t)}return this.bitrate}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===e&&(this._abrAlwaysOn=-1),clearTimeout(this.timerId),this._isPaused=!0,this.logger("abr: stop")}},{key:"destroy",value:function(){var e=this;this._stop(),this.listeners.forEach((function(t){var i=t.evt,r=t.handler;e.player.off(i,r)})),this.player=null,this._heightToDefitionConfig=null,this._bitrateToDefitionConfig=null,this._bufferRange=null,this._sortedBufferRange=null,this.module=null,clearTimeout(this._stallId),clearTimeout(this._updateId),clearTimeout(this.startTimer),window.removeEventListener("resize",this._onWinSizeChange),this.fpsDetection&&this.fpsDetection.stop(),this.player=null}},{key:"eventInfo",get:function(){return this._eventInfo}},{key:"generalInfo",get:function(){return this._generalInfo}},{key:"bufferLength",get:function(){var e=this.player.getBufferedRange(),t=this.player.video.currentTime,i=e[1]-Math.max(e[0],t);return i=Math.max(0,i).toFixed(2),parseFloat(i)}},{key:"downloadSpeed",get:function(){return Math.floor(this.player.downloadSpeed)}},{key:"nowBitrate",get:function(){return this.bitrate}},{key:"openTimeMs",get:function(){return this._openTimeMs}},{key:"isCurrentInAbr",get:function(){return this._currentInAbr},set:function(e){this._currentInAbr=e}},{key:"onAbrLoop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(this._qoeArgs=r,this._currentItem&&this.avgStat(xt.PLAYBACK_BITRATE,this._currentItem.bitrate),this.avgStat(xt.DOWNLOAD_NETWORK_SPEED,1e3*e*8),this.avgStat(xt.PREDICT_NETWORK_SPEED,t),this.avgStat(xt.BUFFER_LENGTH,this.bufferLength),this.avgStat(xt.QOE,this.getQoeRelValue(0)),i>0&&(this._switchCount++,this._switchBitrate+=i),this._abr_play_info.is_hint){var n=this,a=((new Date).getTime()-this.openTimeMs)/1e3;a=parseFloat(a.toFixed(2)),this._abr_play_info.playback_info.internet_speed_record.push([a,n.downloadSpeed]),this._abr_play_info.playback_info.play_bitrate_record.push([a,n.nowBitrate]),this._abr_play_info.playback_info.buffer_length_record.push([a,n.bufferLength]),this._abr_play_info.playback_info.play_speed_record.push([a,this.player.playbackRate]),this._abr_play_info.playback_info.qoe_record.push([a,this.getQoeRelValue(0)]),this._abr_play_info.playback_info.qoe_a_record.push([a,this.getQoeRelValue(1)]),this._abr_play_info.playback_info.qoe_b_record.push([a,this.getQoeRelValue(2)]),this._abr_play_info.playback_info.qoe_c_record.push([a,this.getQoeRelValue(3)])}}},{key:"getQoeRelValue",value:function(e){return this._qoeArgs[e]/100}},{key:"avgStat",value:function(e,t){var i=this._avgStatItems[e];i&&i.add(t)}},{key:"getAbrPlayInfo",value:function(){return this._abr_play_info}},{key:"updateAbrMethod",value:function(e){this._abrMethod=e}},{key:"getAbrMethod",value:function(){return this._abrMethod}},{key:"getAbrVVStats",value:function(){for(var e={},t=Object.keys(xt),i=0;i<t.length;i++){var r=t[i],n=xt[r],a=this._avgStatItems[n];e[n]=a.avg()}return e.switch_counts=this._switchCount,e.avg_switch_bitrate=0===this._switchCount?0:this._switchBitrate/this._switchCount,e.abr_qoe=this.getQoeRelValue(0),e.abr_qoe_a=this.getQoeRelValue(1),e.abr_qoe_b=this.getQoeRelValue(2),e.abr_qoe_c=this.getQoeRelValue(3),e.abr_method=this._abrMethod,e.abr_used=this._abrUsed,e.abr_always_on=this._abrAlwaysOn,this.logger("abrVVStats",e),e}}],[{key:"getIsPlayAutoDefi",value:function(e){return!!e.isPlayAutoDefi}}]),n}(Zt),It=function(){function e(){(0,nt.Z)(this,e),this.total=0,this.count=0}return(0,at.Z)(e,[{key:"add",value:function(e){this.total+=e,this.count++}},{key:"avg",value:function(){if(0===this.count)return 0;var e=this.total/this.count;return Math.floor(e)}}]),e}(),Xt="FIXED",Rt=function(){function e(t,i){var r=this;d(this,e),h(this,"_onAbrChange",(function(e,t,i,n){var a=r._pluginInst.player,o=r.bitrateMap[e],s=r.bitrateMap[t],l=o.definition,d=s&&s.definition?s.definition:l;console.log("[ABR] _onAbrChange ",l,d),l!==d&&(r._abrSwitchHandler(s),a.emit("ABR_CHANGE",{prev:l,cur:d,prevName:o.definitionName,curName:s.definitionName,abrInfo:n}))})),h(this,"_onAutoDescChange",(function(e){var t=e.definition,i=e.reset,n=e.fps,a=e.item;r.updateAutoDefiDesc(t,i,n,a)})),this._pluginInst=t;var n=this._pluginInst.config.autoBitrateOpts||{};this.isPlayAutoDefi=kt.getIsPlayAutoDefi(n),this.isOpenAutoDefi=!!n.isOpenAutoDefi,this.isCurrentAutoDefi=this.isOpenAutoDefi&&this.isPlayAutoDefi,this.bitrateMap={},this.defiIdMap={},this._abrSwitchHandler=i}var t;return u(e,[{key:"_destroyAbr",value:function(){var e=this._pluginInst.player;this.abrInstance&&(e&&e.off(Lt,this._onAutoDescChange),this.abrInstance.destroy(),this.abrInstance=null)}},{key:"init",value:(t=l(a().mark((function e(t){var i,r,n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOpenAutoDefi){e.next=2;break}return e.abrupt("return",{type:Xt});case 2:return i=this._pluginInst,r=i.player,n=i.playerConfig,o=i.config,r.on(Lt,this._onAutoDescChange),this.bitrateMap={},this.defiIdMap={},this.abrInstance=new kt(r,o,0,{dynamic_video_list:n.definition.list.concat()},5e3,{logger:Ge,openLog:Re}),e.next=9,this.abrInstance.init(t);case 9:r.on(Tt,this._onAbrChange),this.abrInstance.isCurrentInAbr=this.isCurrentAutoDefi;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"execute",value:function(){var e=this.abrInstance.execute();return{bitrate:e,type:-1===e?Xt:"AUTO"}}},{key:"updateBitrate",value:function(e){this.abrInstance&&this.abrInstance.updateBitrate(e)}},{key:"enable",value:function(){this.abrInstance.start(),this.isCurrentAutoDefi=!0,this.abrInstance.isCurrentInAbr=!0,this.abrInstance._onTimeUpdate(null,!0)}},{key:"disable",value:function(){this.abrInstance&&(this.updateAutoDefiDesc("",!0),this.isCurrentAutoDefi=!1,this.abrInstance.isCurrentInAbr=!1,this.abrInstance.stop(!0))}},{key:"isCurrentInAbr",value:function(){return!!this.abrInstance&&this.abrInstance.isCurrentInAbr}},{key:"updateAutoDefiDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this._pluginInst,a=n.player,o=n.config,s=o.autoBitrateOpts||{},l=s.autoDefiText||"auto";a.emit("ABR_AUTO_DESC_CHANGE",l,t?void 0:e,i,r)}},{key:"updateAbrCacheData",value:function(){var e=this,t=this._pluginInst,i=t.player,r=t.config,n=t.playerConfig,a=r.autoBitrateOpts||{},o=n.definition.list,s=!1;if(o.forEach((function(t){e.bitrateMap[t.bitrate]={url:t.url,definition:t.definition,definitionName:t.text},e.defiIdMap[t.definition]={bitrate:t.bitrate,definition:t.definition},"auto"!==t.definition&&"自动"!==t.definition||(s=!0)})),this.isOpenAutoDefi,this.isOpenAutoDefi&&!s){var l=a.autoDefiText||"auto",d={definition:"自动",bitrate:i.curDefinition.bitrate,text:l,url:"__auto__",selected:this.isPlayAutoDefi,name:"自动",vwidth:i.curDefinition.vwidth,vheight:i.curDefinition.vheight};n.definition.list.push(d)}}},{key:"destroy",value:function(){this._pluginInst.player.off(Tt,this._onAbrChange),this._destroyAbr()}}]),e}(),wt="real_time_speed",Gt=null,Wt=null,Et=null,_t=null,Ct="h264",Pt="h265",Vt=0,Mt=function(e){f(c,e);var t,i,r,s=g(c);function c(e){var t;return d(this,c),h(b(t=s.call(this,e)),"_replayHook",(function(e){if("xgmse-video"===t.player.config.mediaType)t._onReplay();else if(!t.useVideoLoad)return t._defInited=!1,t.player.play(),!1})),h(b(t),"_retryHook",(function(){var e=b(t),i=e.player,r=e.playerConfig,n=e.config,a=i.currentTime;if(t.codecType!==Pt||n.supportHevc){t._defInited=!1;var o=t.config,s=o.drm,l=o.kid,d=o.secretKey,c=o.keyValue,u=o.drmKeyToken;if(s||l||d||c||u)t.playerStartInit(r.url);else{if(t.useVideoLoad=!0,"Array"===x.ZP.typeOf(r.url)){var h=r.url.length;i.video.src=r.url[h-1].src}else i.video.src=r.url;i.currentTime=a,i.play()}}else t.log("h265 retryHook ",r.vid),t._onDegrade("retry");return!1})),h(b(t),"_playHook",(function(e){t._usePaused=!1})),h(b(t),"_pauseHook",(function(e){t._usePaused=!0})),h(b(t),"abrSwitchURL",function(){var e=l(a().mark((function e(i){var r,n,o,s,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b(t),n=r.playerConfig,o=n.definition.list,s=0,l=0;case 4:if(!(l<o.length)){e.next=11;break}if(i.definition!==o[l].definition){e.next=8;break}return s=l,e.abrupt("break",11);case 8:l++,e.next=4;break;case 11:d=t.player.curDefinition,t.changeDefinition(o[s],d,!0);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h(b(t),"changeDefineCanPlay",(function(e,i,r,n){var a=b(t).player;a.ended?a.currentTime=0:(t.log("[oldChangeDefinition],this._changeDefState,",t._changeDefState),a.currentTime=t._changeDefState?t._changeDefState.currentTime:e,(t._changeDefState?t._changeDefState.paused:i)?a.pause():a.play(),t._changeDefState=null,a.emit(k.AFTER_DEFINITION_CHANGE,{from:r,to:n}))})),h(b(t),"changeDefinition",(function(e,i,r){var n=b(t),o=n.player,s=n.playerConfig,d=n.mp4;if(i||(i=o.curDefinition),t._MSEError=!1,t.useVideoLoad)return"__auto__"===e.url&&(e.url=o.config.definition.list[0].url),void Et.call(t.player,e,i);if(t._switchBitRateWay&&!r)return t.log("changeDefinition old"),void t.oldChangeDefinition(e,i);var c="自动"===e.definition||"auto"===e.definition;if(r)t.log("[switchBitrate:ABR], ready to switch bitRate, ",e.bitrate);else{var u=!1;if(c)t._abrService&&t._abrService.enable(),u=!0;else if(t._abrService&&t._abrService.disable(),!e.bitrate||e.bitrate<=0)for(var h=0;h<s.definition.list.length;h++)e.definition===s.definition.list[h].definition&&(e.bitrate=s.definition.list[h].bitrate);o.emit(k.DEFINITION_CHANGE,{from:i,to:e}),setTimeout((function(){t._abrService&&t._abrService.updateAutoDefiDesc(o.curDefinition.definition,!c)})),u&&(e=o.curDefinition),t.log("[switchBitrate:CBS],switch bitRate, ",e.bitrate)}o.curDefinition=e;var f=o.definitionList.filter((function(e){return e.definition===o.curDefinition.definition}));f.length>0&&(e=f[0]),d&&(t.config.keyValue=e.keyValue,t.config.kid=e.kid,t.config.secretKey=e.secretKey,t.config.drm=e.drm,t.config.getLicenseUrl=e.getLicenseUrl,t.config.drmKeyToken=e.drmKeyToken,t.config.sessionId=e.sessionId,t._secretkey?t._secretkey.updateConfig(t.config):t._secretkey=new he(t.config),t._secretkey.getLicense().then(function(){var i=l(a().mark((function i(n){var l,c,u,h,f,m,p;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null!=n&&null!==(l=n.drm)&&void 0!==l&&l.clearKeys?t.config.drm=n.drm:null!=n&&n.keyValue&&(t.config.keyValue=n.keyValue),s.url=e.url,s.backupURL=e.backupURL,c=0,u=!1,t._abrService&&t._abrService.isCurrentInAbr()?(h=o.getBufferedRange(o.buffered2),(c=h[1])<o.currentTime&&(c=o.currentTime,t.log("bufferRange is invaild,adjust",h,",timeStart,",c)),t.log("[switchBitrate:ABR],switch bufferedList, ",t.player.buffered2?t.player.buffered2.bufferedList:null,",curtime,",o.currentTime,",bufferRange,",h)):(c=o.currentTime,u=!0),(f=d.getFragmentIdx(c))<0&&(f=t._curLoadSegmentIdx),t.log("switchBitrate:point,fragIndex,",f,",startTime,",d.timeRange[f].startTime,",currentTime,",o.currentTime),u&&o.emit("definitionSwitchTime",d.timeRange[f].startTime+1),t.changeState("changeDefinition",{abr:r,fragIndex:f,startTime:d.timeRange[f].startTime,currentTime:o.currentTime}),!d){i.next=16;break}return t.mp4.changeBitRateTime=c,i.next=15,d.cancelLoading();case 15:d._metaLoading&&(d._metaLoading=!1);case 16:return!((m=o.getBufferedRange(o.buffered))[1]>0&&m[1]-o.currentTime>5)||t._abrService&&t._abrService.isCurrentInAbr()||(t.mse.clearOpQueues(w.d1.VIDEO),t.mse.remove(w.d1.VIDEO,o.currentTime+5,m[1])),t.log("switchBitrate: resetFragmentLoadState,",f),d.resetFragmentLoadState(f),t._curLoadSegmentIdx=f,i.next=23,t.mp4.changeBitRate(e);case 23:t._onTimeUpdate(),p={width:e.width||e.vwidth,height:e.height||e.vheight},o.emit("RESOLUTION_UPDATE",p);case 26:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()).catch((function(i){console.error(i),i.errorType="GET_LICENSE_ERROR",t.emit("error",i),t.changeState("LICENSE_ERROR",{d:e.definition})})))})),h(b(t),"_onVideoError",(function(e){t.log("video err,",e)})),h(b(t),"_onPlaying",(function(){t._waitAdjustTimeCnt>0&&t._waitInBufferTimer&&(t._waitAdjustTimeCnt-=1,t.log("[waitInBuffer resume play], waitAdjustTimeCnt,",t._waitAdjustTimeCnt)),clearTimeout(t._waitInBufferTimer),t._waitInBufferTimer=null,t.log("[Index] onPlaying, timeNow,",xe.nowTime());var e=b(t),i=e.mp4,r=e.player,n=t.config.resumePlayWaterLevel;if(i){if(!t.playFlag||r.currentTime<1)t.playFlag=!0;else if(!(i&&i.meta&&i.meta.duration-r.currentTime<=n)&&n>0&&t.playFlag){var a=r.getBufferedRange(r.buffered2);a[1]-r.currentTime<n?(r.paused||(r.pause(),t.log("[!!!!!buffer not rich, pause],time,",xe.nowTime(),", currentTime, ",r.currentTime,", bufferEnd,",a[1])),clearTimeout(t.checkResumePlayTimer),t.checkResumePlayTimer=setTimeout(t._onPlaying,n/2*1e3)):r.paused&&(t.log("[!!!!!buffer rich, play],time,",xe.nowTime(),", currentTime, ",r.currentTime,", bufferEnd,",a[1]),clearTimeout(t.checkResumePlayTimer),t.checkResumePlayTimer=null,r.play())}}else t.checkResumePlayTimer>0&&(clearTimeout(t.checkResumePlayTimer),t.checkResumePlayTimer=null,r.paused&&r.play())})),h(b(t),"_lowDecoder",(function(){var e="function"==typeof t.player.video.getStats?t.player.video.getStats():null;t.log("H265 lowdecode: ".concat(t.playerConfig.vid," "),e,", h265Degrade, ",t.config.h265Degrade),t.config.h265Degrade&&t._onDegrade()})),h(b(t),"_onError",(function(e){t.log("H265 onError: ".concat(t.playerConfig.vid," "),e,", h265Degrade, ",t.config.h265Degrade),t._onDegrade(e)})),h(b(t),"_onDegrade",(function(e){var i,r,n=b(t),a=n.player,o=n.playerConfig,s=n.config;a.video.removeEventListener("lowdecode",t._onDegrade),a.video.removeEventListener("error",t._onError),null===(i=t.mp4)||void 0===i||i.destroy();var l=a.currentTime;if(t.log("[h265 degrade], vid,",o.vid,",currtime,",l),t.emit("H265_DEGRADE",{reason:e?"error":"lowdecode",currentTime:l}),null!=s&&s.H264Config){var d=s.H264Config;s.drm=(null==d?void 0:d.drm)||null,s.getLicenseUrl=(null==d?void 0:d.getLicenseUrl)||null,s.kid=(null==d?void 0:d.kid)||null,s.keyValue=(null==d?void 0:d.keyValue)||null,s.secretKey=(null==d?void 0:d.secretKey)||null,s.isEncrypt=(null==d?void 0:d.isEncrypt)||null,s.useEME=(null==d?void 0:d.useEME)||null}var c={mp4encryptplayer:s,mediaType:"video",codecType:Ct};(null==o||null===(r=o.H264DefinitionList)||void 0===r?void 0:r.length)>0?(a.config.definition.list=o.H264DefinitionList,a.config.url=o.H264DefinitionList[0].url,a.config.defaultBitrate=o.H264DefinitionList[0].bitrate,a.config.defaultDefinition=o.H264DefinitionList[0].definition,a.playNext(c),a.once("canplay",(function(){a.currentTime=l}))):(console.error("H265 error,degrade h264 but no h264 url"),t.emit("error",e))})),h(b(t),"_onMp4MetaReady",(function(e){t.log(">>>>_onMp4MetaReady",xe.nowTime()),t.firstFrameTime.metaload=t.mp4.firstFrameTime.metaload,t.firstFrameTime.bitrate=t.player.curDefinition.bitrate;var i=t.playerConfig.vid,r=t._checkMetaInfo(e),n=t.mp4.checkCodecH265();if(t.changeState("MP4_META_READY",{is265:n?1:0}),r)return t.removeAndRejectInitPromise(r),void t._errorHandler(r);try{if(t._initEME(t.mp4,e),t.codecType!==Pt||t.config.supportHevc){if(!(t.player.video instanceof HTMLVideoElement))return void console.error("".concat(t.player.config.mediaType," is not match"));t._initMse(e)}else{if(!n||t.player.video instanceof HTMLVideoElement)return void console.error("[Index] ".concat(i," config_codec ").concat(t.codecType," and meta_codec ").concat(e.videoCodec," is not match or supportHevc is ").concat(t.config.supportHevc));t._initH265MseProxy()}t._initPromise.resolve()}catch(e){t.removeAndRejectInitPromise(e),console.error("[Index] ".concat(i," _initEME error"),e);var a=new I.ZP(t.player,{errorType:"runtime",errorTypeCode:Te.runtime,errorCode:Ze.other1,errorMessage:null==e?void 0:e.message,vid:i,mediaError:{code:Ze.other1,message:null==e?void 0:e.message}});t._errorHandler(a)}if(t.mp4&&t.mp4.timeRange){var o=[];t.mp4.timeRange.every((function(e){return o.push({startTime:e.startTime,endTime:e.endTime}),!0})),t.emit("KEYFRAMETIME",o)}t._loadData()})),h(b(t),"_onMp4Error",(function(e){var i=t.playerConfig.vid;console.error("[Index] _onMp4Error",i,e),t.changeState("MP4_ERROR",e),t._initPromise&&"pending"===t._initPromise.state&&t.removeAndRejectInitPromise(e),t._errorHandler(e)})),h(b(t),"_onMp4Progress",(function(e){t.emit("progress_event",e)})),h(b(t),"_onMp4DataCallBack",(function(){t._isMseInit&&t._onTimeUpdate()})),h(b(t),"_updateDrmConfig",(function(e){var i=b(t),r=i.config,n=i.mp4;e.kid&&r.keyValue?r.drm={clearKeys:h({},e.kid,r.keyValue)}:!e.kid&&r.keyValue&&(r.useEME=!1),n.useEME=r.useEME;var a=r.drm;r.useEME||(n.kidValue=r.keyValue||(a&&a.clearKeys?a.clearKeys[Object.keys(a.clearKeys)[0]]:null)),t.eme&&a&&a.clearKeys&&r.useEME&&t.eme.updateDrm(a)})),h(b(t),"_onVideoTimeUpdate",(function(){t.useVideoLoad||null!==t._requestTimer||!t._offineLine&&t._startProgress()})),h(b(t),"_onBufferedReset",(function(e){t.mp4&&t.mp4.videoTrak&&t.mp4.resetFragmentLoadState(0)})),h(b(t),"_onOnlineHandler",(function(){t._offineLine=!1;var e=b(t).config;t.log("online useVideoLoad:",t.useVideoLoad,t._hasStartProgressBack),t.useVideoLoad?t.player.src=e._mainURL:(t._hasStartProgressBack&&t._startProgress(),t._hasStartProgressBack=!1)})),h(b(t),"_onOfflineHandler",(function(){t._offineLine=!0,t.log("offline, ",t._hasStartProgress),t._hasStartProgress&&(t._stopProgress(),t._hasStartProgressBack=!0)})),h(b(t),"_loadDataSuccess",(function(e){if(!t.isDestroy&&(t.mse||t.mseProxy)){e.state&&t._firstSegState<0&&(t._firstSegState=1),t.log("[loadFragment] _loadDataSuccess ",JSON.stringify(e.context.range),",dataLen,",e.buffer?e.buffer.byteLength:0,e.state),t.firstFrameTime.startload_stmux<0&&(t.firstFrameTime.startload_stmux=t.mp4.firstFrameTime.startMuxTime,t.firstFrameTime.firstmux=t.mp4.firstFrameTime.firstmux),t.firstFrameTime.loadst_loadeddata<0&&(t.firstFrameTime.loaddata=xe.nowTime()-t.loadstart);try{e.initSeg&&(t._appendInitSeg(e.initSeg),(!e.buffer||e.buffer.byteLength<1)&&(t.log("no data, must load data"),t._onTimeUpdate()));var i=e.buffer,r=e.state,n=e.context,a=e.videoTrack,o=e.audioTrack;if(t.debugInfo.loadIndx=n?n.fragIndex:-1,t.mse&&r&&(!i||i.byteLength<=0)&&n.fragIndex===t.mp4.timeRange.length-1){var s=t.player.buffered;s&&s.length>0&&(t.bufferEndTime=s.end(s.length-1)),t._isEnded(),t.log("loaded ended !!!==>>>",JSON.stringify(n.range),", fragIndex,",n.fragIndex,", bufferEndTime,",t.bufferEndTime,",meta_duration,",t.mp4.meta.duration)}if(t.mse&&r&&n.fragIndex===t.mp4.timeRange.length-1&&(!i||i.byteLength<=0)){var l=t.player.buffered;l&&l.length>0&&(t.bufferEndTime=l.end(l.length-1)),t._isEnded(),t.log("load ended !!!==>>>",t.playerConfig.vid,JSON.stringify(n.range),", fragIndex,",n.fragIndex,", bufferEndTime,",t.bufferEndTime,",meta_duration,",t.mp4.meta.duration)}if(i&&t.mse){if(i&&i.byteLength>0){t._appendBuffer(w.d1.VIDEO,i,n,r);var d=t.getDataBitRate(n.fragIndex);t.player.emit("addVideoBufferEnd",{start:Math.floor(n.startPts),end:n.endPts,bandwidth:d.bitrate})}}else if(t.mseProxy&&(a&&a.samples.length>0||o&&o.samples.length>0)){var c=a.samples.length>0?a.samples[0].sampleOffset:-1,u=a.samples.length>0?a.samples[a.samples.length-1].sampleOffset:-1,h=o.samples.length>0?o.samples[0].sampleOffset:-1,f=o.samples.length>0?o.samples[o.samples.length-1].sampleOffset:-1;t.log("[livevideo] appendBuffer,index,",n.fragIndex,",range,",JSON.stringify(e.context.range),",videoIdxRange,",c,"-",u,",audioIdxRange,",h,"-",f,", timeRange,",n.timeRange),t.mseProxy.appendBuffer(a,o)}}catch(e){t.changeState("APPEND_DATA_ERROR"),t.log("appendBuffer error",e);var m=new I.ZP(t.player,{errorType:"runtime",errorTypeCode:Te.runtime,errorCode:Ze.mse,vid:t.player.config.vid,errorMessage:e.message,mediaError:{code:Ze.mse,message:e.message}});t._errorHandler(m)}null!=e&&e.state&&t._onTimeUpdate()}})),h(b(t),"_onWaiting",(function(){var e=b(t),i=e.player,r=e.config,n=e.playerConfig;clearTimeout(t._waitInBufferTimer),t._waitInBufferTimer=null;var a=i.currentTime;t.log("[>>>>onWaiting],currentTime, ",a,xe.nowTime());var o=i.bufferedPoint;o.end>0&&o.end-i.currentTime>=2&&(t._waitAdjustTimeCnt<r.waitJampBufferMaxCnt?t._waitInBufferTimer=setTimeout((function(){t._waitAdjustTimeCnt++,i.currentTime=i.currentTime+.5,t.log("[waitInBufferTimeout], waitAdjustTimeCnt,",t._waitAdjustTimeCnt,",curtime,",a,xe.nowTime())}),r.waitingInBufferTimeOut):t._errorHandler(new I.ZP(t.player,{errorType:"waitInBuffer",errorTypeCode:Te.runtime,errorCode:Ze.onWaitInBufferRange,errorMessage:"onWait_in_buffer",vid:n.vid})))})),h(b(t),"_onEnded",(function(){t.log("[player.onEnded], stopProgress"),t.player&&t.off("waiting",t._onWaiting),t._stopProgress()})),h(b(t),"_onReplay",(function(){var e=b(t),i=e.playerConfig,r=e.player;t._reset(),t._init(i.url).then((function(e){var i=e[0],n=e[1];r.video.src=n.url,t._startProgress(),t.mp4=i,t.mse=n,t.log("_replay play"),t.once("canplay",(function(){r.play(),t.on("waiting",t._onWaiting)}))}),(function(e){t.log("_errorHandler6",e),t._errorHandler(e)}))})),h(b(t),"_onSeeking",l(a().mark((function e(){var i,r,n,o,s,l,d,c,u,h,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.useVideoLoad){e.next=2;break}return e.abrupt("return");case 2:if(i=b(t),r=i.player,n=i.mp4,o=r.currentTime,t.changeState("seeking",{curTime:o}),t.log("[seekTime], curTime,",o,",buffer,",r.buffered2.bufferedList),n&&n.meta){e.next=8;break}return e.abrupt("return");case 8:if(t.endofstream=!1,n.bufferLoadedPos=-1,n._metaLoading=!1,s=r.bufferedPoint,l=!1,d=0,!(s.end>0)){e.next=26;break}if(l=!0,!(n.meta.duration-s.end<.5)){e.next=19;break}return t.log("[seeking in buffered range], buffer end,",s.end,", duration,",n.meta.duration),e.abrupt("return");case 19:if(d=n.getFragmentIdx(s.end),t._curLoadSegmentIdx!==d){e.next=23;break}return t.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",d),e.abrupt("return");case 23:n.seekTime=s.end,d<0&&(d=t._curLoadSegmentIdx),t.log("[seeking in buffered range], seekTime ",o,",bufferRange,",s.start,"-",s.end,", fragIndex,",d);case 26:return l||(n.seekTime=o,(d=n.getFragmentIdx(o))<0&&(d=t._curLoadSegmentIdx),t.log("[seekTime out buffer range], curTime,",o,", Idx,",d),c=b(t),(u=c.mse)&&u.isFull()&&(h=r.buffered2.bufferedList,f=h[h.length-1],u.clearOpQueues(w.d1.VIDEO),t._checkRemoveSourceBuffer([f.start,f.end],r.currentTime,!0,!0))),e.next=29,n.cancelLoading();case 29:n.resetFragmentLoadState(d),t._curLoadSegmentIdx=d,t._onTimeUpdate(),t._startProgress(),t._isEnded();case 34:case"end":return e.stop()}}),e)})))),t._pendingPromises=[],t._allInitPromise=new tt,t._isInit=!1,t._isEventInit=!1,t.playerId=t.player._pluginInfoId,t.preloader=null,t.gapJumpInst=null,t.log("playerId",t.playerId),t._tickInSeconds=t.config.tickInSeconds,t._useVideoLoad=!1,t.mse=null,t.mp4=null,t.eme=null,t._isMseInit=!1,t._awPromise=null,t._corePromise=null,t._initPromise=null,t._hasStartProgress=!1,t._hasStartProgressBack=!1,t._maxBufferLength=t.config.maxBufferLength,t._minBufferLength=t.config.minBufferLength,t._switchBitRateWay=t.config.switchBitRateWay,t._curLoadSegmentIdx=0,t._abrService=null,t._checkRemoveBufferLastTime=xe.nowTime(),t.playFlag=!1,t.config.resumePlayWaterLevel=Math.min(t.config.minBufferLength,t.config.resumePlayWaterLevel),t.checkResumePlayTimer=null,t._MSEError=!1,t.loadstart=-1,t._loadStartEventTime=-1,t._waitAdjustTimeCnt=0,t._waitInBufferTimer=null,t._firstSegState=-1,t.codecType=t.playerConfig.codecType?t.playerConfig.codecType.toLowerCase():Ct,t.playerConfig.vtype&&(t._vtype=t.playerConfig.vtype.toUpperCase()),t.firstFrameTime={newplayer:xe.nowTime(),newplayer_initkernel:-1,initkernel_initmp4:-1,initmse_sbopen:-1,mseopen:-1,initmse_sbopendone:-1,metaload:-1,metaready_mseisopen:-1,metaready_initsegend:-1,startload_stmux:-1,firstmux:-1,apcnt:0,aplen:0,data_ap:-1,loadst_loadeddata:-1,loaddata:-1,new_loadeddata:-1,bitrate:-1},t.debugInfo={},t.states=[],t.removeVideo=null,t._lastCheckTime=xe.nowTime(),t._changeDefState=null,t._defInited=!1,t.preLoadData=null,t.forPreloadTimeCache=null,t._usePaused=!1,t.endofstream=!1,t.bufferEndTime=-1,t.hitpreload=!1,t._lastCheckLagTime=0,window&&window.location.href.indexOf("playerInstance=true")>-1&&(void 0===window.mp4PlayerInstanceList&&(window.mp4PlayerInstanceList=[]),window.mp4PlayerInstanceList.push(t.player)),t}return u(c,[{key:"setConfig",value:function(e){this.config=Object.assign(this.config,e)}},{key:"afterCreate",value:function(){var e=this,t=this.playerConfig,i=this.config,r=this.player;i.width=t.width||0,i.height=t.height||0,t.vid=t.vid||i.vid,w.d1.isSupported('video/mp4; codecs="avc1.64001E, mp4a.40.5"')&&(void 0===i.supportHevc&&null!==X.Z&&void 0!==X.Z&&X.Z.isHevcSupported&&null!==X.Z&&void 0!==X.Z&&X.Z.isHevcSupported()&&this.player.video instanceof HTMLVideoElement&&(i.supportHevc=!0),qe()||(i.useEME=!1),this.checkConfig(),i.onlyInit&&(t.autoplay=!1,t.videoInit=!1,this._hasStartProgress=!1,this._hasStartProgressBack=!1),t.useWaterLevel&&(!t.userGestureEventMiddleware&&(t.userGestureEventMiddleware=je),!t.videoEventMiddleware&&r.setEventsMiddleware(Be)),this.gapJumpInst=new st(this.player,this.playerConfig),this._proxyPlayer(),r.useHooks("replay",this._replayHook),r.useHooks("play",this._playHook),r.useHooks("pause",this._pauseHook),r.useHooks("retry",this._retryHook),r.video.addEventListener(rt.BUFFERED_RESET,this._onBufferedReset),this._bindNetworkStateChange(),this.on(k.TIME_UPDATE,this._onVideoTimeUpdate),this.on(k.LOADED_DATA,(function(){e.changeState("LOADED_DATA"),e.deleteVideo(),e._firstSegState=2,e._onTimeUpdate(),e._firstFrameTime()})),this.on(k.LOAD_START,(function(){e.changeState("LOAD_START"),e._loadStartEventTime=xe.nowTime(),e.codecType!==Pt||e.config.supportHevc||(e._isMseInit=!0,e._onTimeUpdate())})),this.on("xglog",(function(t){if("firstFrame"===t.eventType){var i=e.preLoadData&&e.preLoadData.definition?e.preLoadData.definition:-1;e.codecType===Ct?e.log("[xgplayer-encrypt-mp4]>>>>firstFrame ",e.playerConfig.vid,t.fvt,", codectype: ",e.codecType,", hitpreload: ",e.hitpreload,", video: ",e._useVideoLoad,",curPlayBitrate: ",e.player.curDefinition.definition,", preloadBitrate: ",i,",metaLoad, ",e.firstFrameTime.metaload,", mseOpen: ",e.firstFrameTime.mseopen,",appendInit: ",e.firstFrameTime.metaready_initsegend):e.log("[xgplayer-encrypt-mp4]>>>>firstFrame ",e.playerConfig.vid,t.fvt,", codectype: ",e.codecType,", hitpreload: ",e.hitpreload,",curPlayBitrate: ",e.player.curDefinition.definition,", preloadBitrate: ",i,",metaLoad, ",e.firstFrameTime.metaload)}})),r.mp4MseFlag=!0)}},{key:"_startBufferCheck",value:function(){var e=this.player;if(e.video){var t=[];if(e.video.buffered){for(var i=0,r=e.video.buffered.length;i<r;i++)t.push([e.video.buffered.start(i),e.video.buffered.end(i)]);t.toString()!==this.lastBuffer&&(this.lastBuffer=t.toString(),this._onBufferReachThreshold())}}}},{key:"_onBufferReachThreshold",value:function(){var e=this.player,t=this.config;if(e.video){for(var i=e.video.buffered,r=0,n=0,a=0;a<i.length&&(r=i.start(a),n=i.end(a),!(r<=e.video.currentTime&&e.video.currentTime<=n));a++);n-e.video.currentTime>=t.bufferThreshold&&!this._hasTriggerBufferThreshold&&(this._hasTriggerBufferThreshold=!0,e.emit("BUFFER_THRESHOLD",n-e.video.currentTime))}}},{key:"_startUrlExpiredCheck",value:function(){var e=this.player.config;e.definition&&e.definition.list&&e.definition.list.length>0&&(this.urlExpireTimestamp=e.definition.list[0].url_expire||0,this._handleUrlExpire())}},{key:"checkConfig",value:function(){var e=this.playerConfig,t=this.config,i=e.defaultDefinition,r=e.defaultBitrate;if(!i){var n=this.playerConfig.definition;i=n&&n.defaultDefinition?n.defaultDefinition:t.definition}!r&&t.bitrate&&(r=t.bitrate),e.defaultDefinition=i,e.defaultBitrate=r}},{key:"beforePlayerInit",value:function(){var e=this,t=this.player,i=this;this._isInit||(R.ZP.defineGetterOrSetter(t,{__url:{get:function(){return i.mse?i.mse.url:t.config.url},configurable:!0},downloadSpeed:{get:function(){return Vt/8},configurable:!0},playerVersion:{get:function(){return ve},configurable:!0},menuCodeType:{get:function(){return i.mp4&&i.mp4.meta?i.mp4.meta.videoCodec:"avc"},configurable:!0},playerType:{get:function(){return"MP4"},configurable:!0},supportMenus:{get:function(){return{speed:t.mp4MseFlag,cdn:t.mp4MseFlag,resolution:t.mp4MseFlag}},configurable:!0},preloadActive:{get:function(){return!!e.preloader&&e.preloader.isActive},set:function(t){e.preloader&&(e.preloader.isActive=t)},configurable:!0},performance:{get:function(){return e.firstFrameTime},configurable:!0},CDNUrl:{get:function(){return i.CDNUrl},configurable:!0},abrInstance:{get:function(){return i.abrInstance},configurable:!0},ext:{get:function(){var e,t,r,n,a,o,s,l,d=[];if(null!==(e=i.player)&&void 0!==e&&null!==(t=e.video)&&void 0!==t&&t.buffered)for(var c=i.player.video.buffered,u=0,h=c.length;u<h;u++)d.push([c.start(u),c.end(u)]);var f=[];if(i.mse&&i.mse.opQueues&&i.mse.opQueues.video)for(var m=Math.min(i.opQueueLen,5),p=0;p<m;p++)f.push(i.mse.opQueues.video[p].context);return{type:"MP4",usevideo:i.useVideoLoad?1:0,curTime:null===(r=i.player)||void 0===r?void 0:r.currentTime,duration:(null===(n=i.mp4)||void 0===n||null===(a=n.meta)||void 0===a?void 0:a.duration)||(null===(o=i.player)||void 0===o?void 0:o.duration),loadIdx:i._curLoadSegmentIdx,curload:null!==(s=i.mp4)&&void 0!==s&&s.timeRange?i.mp4.timeRange[i._curLoadSegmentIdx]:{},waitIdx:i.debugInfo.loadIndx,waitload:null!==(l=i.mp4)&&void 0!==l&&l.timeRange&&void 0!==i.debugInfo.loadIndx?i.mp4.timeRange[i.debugInfo.loadIndx]:{},bufffer:d,speed:i.debugInfo.speed,states:i.states,mseque:f,url:i.playerConfig.url}},configurable:!0}}),this._isInit=!0)}},{key:"destroy",value:function(){var e=this.player;this.log("[Index] destroy",this.playerId),e.preloader&&e.preloader.destroy(this.playerId),e.removeHooks("replay",this._replayHook),e.removeHooks("play",this._playHook),e.removeHooks("pause",this._pauseHook),e.removeHooks("retry",this._retryHook),this._reset(),this._secretkey&&this._secretkey.destroy(),this.player.playNext=Gt,this.player._startInit=Wt,this.player.changeDefinition=Et,this.player.switchURL=_t,this._unbindNetworkStateChange(),e.video&&e.video.removeEventListener(rt.BUFFERED_RESET,this._onBufferedReset),this._bufferCheckTimer&&clearInterval(this._bufferCheckTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null)}},{key:"_proxyPlayer",value:function(){var e=this;"function"==typeof this.player.playNext&&(Gt=this.player.playNext),this.player.playNext=function(){e.playNext.apply(e,arguments)},Wt=this.player._startInit,_t=this.player.switchURL,Et=this.player.changeDefinition,this.player._startInit=this.playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this)}},{key:"getInitBitrate",value:function(){var e=this.player,t=this.config,i=this.playerConfig,r=null,n=e.definitionList;return n&&n.length>0&&(e.preloader&&n.map((function(t){var n=e.preloader.generateUniqueKey({vid:i.vid,definition:t.definition||"",vtype:i.vtype,codecType:i.codecType});t.cacheKey=n,n&&!r&&e.preloader&&e.preloader.hasItemSameVid(n)&&((r=t).type="preload")})),r&&i.userSelectDefinition&&t.focusUserDefinition&&(this.log("[Index] getInitBitrate","preloadDefinition: ".concat(r.definition," userSelectDefinition:").concat(i.userSelectDefinition)),i.userSelectDefinition!==r.definition&&(r=null)),!r&&this.bitRateAdapter&&(this.bitRateAdapter.speed=Ae.speed,(r=this.getDefinitonFromAdapter(n,i.userSelectDefinition))&&(r.type="bitRateAdapter"))),r&&r.url||(r="Array"===x.ZP.typeOf(i.url)&&i.url.length>0||"String"===x.ZP.typeOf(i.url)&&i.url?{url:i.url,definition:i.defaultDefinition,duration:i.duration||this.config.duration||0,bitrate:i.defaultBitrate||this._getBitrateByDefition(i.defaultDefinition),type:"default"}:n[n.length-1]),this.playerConfig.url=r.url,r.networkSpeed=Ae.speed,r.fileSize=xe.getFileSize(r.bitrate,i.duration),e.curDefinition=r,r}},{key:"_setPlayerSrc",value:function(e){var t=this.player;this._removeVideoSource(),"Array"===x.ZP.typeOf(e)?(t.video.removeAttribute("src"),!t._detachSourceEvents&&e.forEach((function(e){t.video.appendChild(x.ZP.createDom("source","",{src:"".concat(e.src),type:"".concat(e.type||"")}))})),t._attachSourceEvents(t.video,e),t.play()):(t.video.src=e,t.play()),t.mp4MseFlag=!1,t.emit("playertypechange")}},{key:"_removeVideoSource",value:function(e){var t=this.player,i=(e=e||t.video).children;if(i.length>0)for(t._detachSourceEvents(e);i.length>0;)e.removeChild(i[0])}},{key:"_getBitrateByDefition",value:function(e){var t=this.playerConfig,i=0;if(!t.definition||!t.definition.list)return i;for(var r=0;r<t.definition.list.length;r++){var n=t.definition.list[r];n.definition===e&&(i=n.bitrate)}return i}},{key:"_getDefinitionItem",value:function(e){for(var t=this.playerConfig,i=0;i<t.definition.list.length;i++){var r=t.definition.list[i];if(r.definition===e)return r}return null}},{key:"_initAbrDefinition",value:function(){var e=this.player,t=this.playerConfig;if(t.definition.list.length>0&&(e.curDefinition||(e.curDefinition=t.definition.list[0]),e.curDefinition.vwidth||Object.assign(e.curDefinition,this._getDefinitionItem(e.curDefinition.definition)),this._abrService.updateAbrCacheData()),this._abrService&&this._abrService.isCurrentAutoDefi){var i=t.definition.list.length;e.curDefinition=t.definition.list[i-1]}for(var r=0;r<t.definition.list.length;r++){var n=t.definition.list[r];e.curDefinition.definition===n.definition?n.selected=!0:n.selected=!1}this.log("resourceReady",t.definition.list.concat()),this.player.emit("resourceReady",t.definition.list);var a=e.curDefinition.bitrate;if(!a)for(var o=0;o<t.definition.list.length;o++){var s=t.definition.list[o];s.definition===e.curDefinition.definition&&(a=s.bitrate)}this._abrService.updateBitrate(a)}},{key:"_initAbrService",value:(r=l(a().mark((function e(){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.playerConfig,(i=this.config).autoBitrateOpts&&i.autoBitrateOpts.isOpenAutoDefi){e.next=3;break}return e.abrupt("return");case 3:return this._abrService=new Rt(this,this.abrSwitchURL),e.next=6,this._abrService.init({video:t.definition.list.concat()});case 6:this._initAbrDefinition();case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_initMp4Kernel",value:function(){var e=this;this.firstFrameTime.newplayer_initkernel=xe.nowTime()-this.firstFrameTime.newplayer,this.log("[===========], initMp4Kernel,",xe.nowTime());var t=this.playerConfig,i=this.config,r=new tt;try{var n=this._defInited?null:this.getInitBitrate();if(this._defInited=!0,this.log("curDefinition",n),this.log("[_initMp4Kernel] ".concat(t.vid," curDefinition"),n),!this._handlerUrl(t.url))return r.reject(new Error("emptyUrl")),r;if(i.forceVideoPlay&&(this.codecType===Ct||i.supportHevc))return this.useVideoLoad=!0,r.reject("forceVideoPlay"),r;var a=[];this._secretkey&&a.push(this._secretkey.getLicense()),a.push(this._checkPreloader()),Promise.all(a).then((function(t){e.isDestroy&&r.reject(new Error("destroy"));var a=null;if(t&&t.length>0){if(t.length>1){var o=t[0].drm;null!=o&&o.clearKeys?e.config.drm=o:t[0].keyValue&&(e.config.keyValue=t[0].keyValue)}a=t[t.length-1].data}if(a||!i.needPreloadCheck||e.codecType===Pt&&!i.supportHevc)if(e._vtype&&"MP3"===e._vtype)e.useVideoLoad=!0,r.reject(new Error("vtype_not_MP4"));else{var s=i._mainURL;e._initMp4(s,a,{fileSize:n?n.fileSize:0}),e._initAbrService()}else e.useVideoLoad=!0,r.reject(new Error("no_preload"))})).catch((function(t){console.error(t),t.errorType="GET_LICENSE_ERROR",e.emit("error",t),e.changeState("LICENSE_ERROR",{d:n?n.definition:0}),r.reject(t)}))}catch(e){r.reject(e)}return r}},{key:"playerStartInit",value:function(e){var t=this;if(this.log("playerStartInit",this.player.hasStart),!this.isDestroy){var i=this.config,r=i.kid,n=i.drmKeyToken,a=i.secretKey,o=i.keyValue,s=i.drm;if((r||n||a||o||s)&&(this._secretkey=new he(this.config)),!e||"__auto__"===e||"anytext"===e){var l=this.playerConfig,d=l.definition;if(d&&d.list&&d.list.length>0&&d.defaultDefinition&&(d.list.map((function(e){e.definition===d.defaultDefinition&&(l.url=e.url,t.player.curDefinition=e)})),!l.url||"__auto__"===e||"anytext"===e)){var c=d.list[0];e=c.url,l.url=c.url,this.player.curDefinition=c}}if(this.useVideoLoad)Wt.call(this.player,e);else{this.player.mp4MseFlag=!0,this.bufferEndTime=-1,this._tm=(new Date).getTime(),this._reset();var u=this.playerConfig.vid,h=this.player.preloader;if(h&&(h.cancelPreloadByVid(this.player.playerId,u),h.attachPlayer(this.player.video)),this.changeState("PLAYER_START_INIT"),!this.isDestroy){this.changeState("AW_OK INIT_MP4_KERNEL");var f=this._initMp4Kernel();this._initPromise=f,this._addPendingPromise(this._initPromise),f.then((function(i){t.isDestroy||(t.log("[Index] _initMp4Kernel.then vid:".concat(u," isDestroy").concat(t.isDestroy),i,t.mse?t.mse.url:""),t.mse&&(e=t.mse.url),t.changeState("PLAY_INIT_OK"),t._bindEvents(),t._startProgress())})).catch((function(i){var r=!!t._initPromise&&t._initPromise.isBreak;if(!t.isDestroy&&!r)if(-499897!==i.errorCode){var n=i;n.errorCode||((n=new I.ZP(t.player,{errorType:"runtime",errorTypeCode:Te.runtime,errorCode:Ze.other,vid:t.playerConfig.vid,errorMessage:null==i?void 0:i.message,mediaError:{code:Ze.other,message:null==i?void 0:i.message}})).url=e),t.changeState("PLAY_INIT_CATCH",{c:n.errorCode,m:n.message}),t.player.vtype="MP4_1",t.player.emit("playCatch",t.player.vtype,n)}else t._emitExpireEvent(i)})).finally((function(){if(t._initPromise){var i=t._initPromise.isBreak;t._initPromise&&t._removePendingPromise(t._initPromise),t._initPromise=null,t._usePaused&&(t.playerConfig.autoplay=!1),t.codecType===Pt&&"Array"===x.ZP.typeOf(e)&&(e=e[0].src),t.log("_initMp4Kernel.finally:isDestroy".concat(t.isDestroy," _initPromise.isBreak:").concat(i)),t.log("[===========], playerStartInit,",xe.nowTime()),t.changeState("PLAY_INIT_FINALLY"),!t.isDestroy&&!i&&Wt.call(t.player,e)}})),this._abrService&&this._abrService.isCurrentInAbr()&&(this._abrService.enable(),this._abrService.execute())}}}}},{key:"playNext",value:function(e){var t=this.player;this._defInited=!1,t.resetState(),t._currentTime=0,t._duration=0,t.isPlaying=!1,this._useVideoLoad=!1,this._MSEError=!1,t.pause(),this._reset(),e.vtype&&(this._vtype=e.vtype.toUpperCase()),t.setConfig(e);var i=this.codecType;this.codecType=e.codecType?e.codecType.toLowerCase():Ct,i!==this.codecType&&this.h265_h264_switch(this.playerConfig.mediaType||"video"),this.checkConfig(),this.log("[Index] playNext",e),t.play(),this.emit("playnext")}},{key:"h265_h264_switch",value:function(e){this.log("h265_switch_h264");var t=this.player,i=x.ZP.createDom(e,"",this.getVideoConfig(this.playerConfig),"xgplayer-".concat(e,"-img"));this.removeVideo=t.video,i.muted=t.video.muted,i.volume=t.video.volume,t.video=i,t.attachVideoEvents(t.video)}},{key:"getVideoConfig",value:function(e){var t=Object.assign({},{controls:!1,autoplay:e.autoplay,playsinline:e.playsinline,"x5-playsinline":e.playsinline,"webkit-playsinline":e.playsinline,"x5-video-player-fullscreen":e["x5-video-player-fullscreen"]||e.x5VideoPlayerFullscreen,"x5-video-orientation":e["x5-video-orientation"]||e.x5VideoOrientation,airplay:e.airplay,"webkit-airplay":e.airplay,tabindex:2,mediaType:e.mediaType||"video"},e.videoConfig,e.videoAttributes);return e.loop&&(t.loop="loop"),t}},{key:"next",value:function(e){this.playNext(e)}},{key:"oldChangeDefinition",value:function(e,t){var i=this,r=this.config,n=this.player,a=this.playerConfig;n.emit(k.DEFINITION_CHANGE,{from:t,to:e}),n.emit(k.WAITING);var o=n.definitionList.filter((function(t){return t.definition===e.definition||t.definition===Number(e.definition)})),s=n.definitionList.filter((function(e){return e.definition===t.definition||e.definition===Number(t.definition)}));if(s.length>0&&(s[0].selected=!1),o.length>0){(e=o[0]).selected=!0,n.curDefinition=e,this.log("[oldChangeDefinition],currentTime,",n.currentTime,",from,",t,",to,",e);var l=n.currentTime,d=n.paused;this._changeDefState||(this._changeDefState={currentTime:l,paused:d},this.log("[oldChangeDefinition],currentTime,",n.currentTime,",pause,",d)),r.definition=e.definition,this.config.keyValue=e.keyValue,this.config.kid=e.kid,this.config.secretKey=e.secretKey,this.config.drm=e.drm,this.config.getLicenseUrl=e.getLicenseUrl,this.config.drmKeyToken=e.drmKeyToken,a.url=e.url,a.backupURL=e.backupURL,a.userSelectDefinition=e.definition,a.defaultDefinition=e.definition,r.focusUserDefinition=!0,n.currentTime=0,n.pause(),this._reset(),this._isMseInit=!1,this.eme=null,this._handlerUrl(e.url),this._changeDefineCanPlay&&n.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=function(){i.changeDefineCanPlay(l,d,t,e),i._changeDefineCanPlay=null},n.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.playerStartInit(a.url)}}},{key:"switchURL",value:function(e){if(this.useVideoLoad)_t.call(this.player,e);else{var t=this.player,i=this.playerConfig;this.config.keyValue=e.keyValue,i.url=e.url,i.backupURL=e.backupURL,t.currentTime=0,t.pause(),this.reset(),this._isMseInit=!1,this._MSEError=!1,this.eme=null,this._handlerUrl(e.url),t.video.removeAttribute("src"),this._removeVideoSource(),t.resetState()}}},{key:"_handlerUrl",value:function(e){var t,i=this.config,r=this.playerConfig;if(!e)return!1;var n=[];if("String"===x.ZP.typeOf(e))t=e,r.backupURL&&n.push(r.backupURL);else if("Array"===x.ZP.typeOf(e)&&e.length>0&&(t=e[0].src,e.length>1))for(var a=1;a<e.length;a++)n.push(xe.extUrl(e[a].src,{__vid:r.vid}));return!(!t&&0===n.length||(i._mainURL=xe.extUrl(t,{__vid:r.vid}),i._backupURL=n,0))}},{key:"_firstFrameTime",value:function(){if(this.codecType===Ct||this.config.supportHevc){if(this.firstFrameTime.new_loadeddata<0){this.firstFrameTime.loadst_loadeddata=xe.nowTime()-this.loadstart,this.firstFrameTime.new_loadeddata=xe.nowTime()-this.firstFrameTime.newplayer;var e={};for(var t in this.firstFrameTime)Object.prototype.hasOwnProperty.call(this.firstFrameTime,t)&&(this.log("======this.firstFrameTime======",t,", ",this.firstFrameTime[t]),e[t]=this.firstFrameTime[t])}}else if(this.codecType===Pt){var i=this.player.video.getStats(),r=this.firstFrameTime.metaload,n=this.firstFrameTime.startMuxTime;this.firstFrameTime=i,this.firstFrameTime.metaload=r,this.firstFrameTime.startload_stmux=n,this.firstFrameTime.firstmux=this.mp4?this.mp4.firstFrameTime.firstmux:-1;for(var a=0;a<i.bootStats.length;a++)this.firstFrameTime[i.bootStats[a].action]=i.bootStats[a].dot;delete this.firstFrameTime.bootStats,this.log("======this.firstFrameTime===>>",JSON.stringify(this.firstFrameTime))}}},{key:"_bindEvents",value:function(){var e=this,t=this.config,i=this.player;this._isEventInit||(this.on("seeking",this._onSeeking),this.on("waiting",this._onWaiting),this.on("ended",this._onEnded),this.on("error",this._onVideoError),this.on("playing",this._onPlaying),this.on("detectGap",(function(){t.gapDegrade&&t.useEME&&(t.useEME=!1,e._replay())})),this.on("error",(function(t){e.changeState("video_error",{code:t.code,message:t.message,videoType:e.useVideoLoad})})),i.setEventsMiddleware({error:function(t,i){var r=t.originalEvent;e.changeState("video_error",{code:r.code,message:r.message,videoType:e.useVideoLoad}),e.log("error middleware",t,",useVideoLoad,",e.useVideoLoad),e.useVideoLoad&&i(t.eventName,r)}})),this._isEventInit=!0}},{key:"deleteVideo",value:function(){if(this.removeVideo){var e=this.removeVideo.parentNode;e&&e.removeChild(this.removeVideo),this.removeVideo=null,this.log("[_removeVideoSource]")}}},{key:"_unbindEvents",value:function(){this.off("seeking",this._onSeeking),this.off("waiting",this._onWaiting),this.off("ended",this._onEnded),this.off("playing",this._onPlaying),this._isEventInit=!1}},{key:"changeState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pTime||(this._pTime=xe.nowTime());var i=xe.nowTime()-this._pTime,r=xe.nowTime()-this._sTime;this.log(">>>changeState[".concat(e,"]"),i,r,t),this.states.push({state:e,t1:i,t2:r,data:t}),this._pTime=xe.nowTime();var n=xe.nowTime()-this._pTime;t.state=e,n&&(t.t=n)}},{key:"softDecode",get:function(){var e,t;return"xg-video"===(null===(e=this.player)||void 0===e||null===(t=e.config)||void 0===t?void 0:t.mediaType)}},{key:"_initH265MseProxy",value:function(){this.player.video instanceof HTMLVideoElement&&this.h265_h264_switch(this.playerConfig.mediaType);var e=this.player.video;this.softDecode&&e.setPlayMode&&e.setPlayMode("VOD"),this.mseProxy=e,this.softDecode&&(this.player.forceDegradeToVideo=function(){},this.player.video.addEventListener("lowdecode",this._lowDecoder),this.player.video.addEventListener("error",this._onError))}},{key:"removeAndRejectInitPromise",value:function(e){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(e))}},{key:"_initMp4",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.firstFrameTime.initkernel_initmp4=xe.nowTime()-this.firstFrameTime.newplayer-this.firstFrameTime.newplayer_initkernel;var n=this.config,a=this.player,o=this.playerConfig;this.mp4&&(this.mp4.off(De,this._onMp4MetaReady),this.mp4.off(Ye,this._onMp4Error),this.mp4.off(Ne,this._updateDrmConfig),this.mp4.off(He,this._onMp4Progress),this.mp4.off(Fe,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.changeState("MP4_NEW",{}),this.mp4=new Ae(e,a.curDefinition.bitrate,{segmentDuration:n.segmentMinDuration,enableWorker:n.enableWorker,codecType:this.codecType,chunkSize:n.preloadSize,loadSize:800,duration:o.duration||0,fileSize:r.fileSize||0,playerId:this.playerId,vid:o.vid,useUrlRange:n.useUrlRange,retryCount:n.retryCount,retryDelay:n.retryDelay,onProcessMinLen:n.onProcessMinLen,supportHevc:n.supportHevc,reqOptions:n.reqOptions},this.config._backupURL,this.firstFrameTime,""),this.mp4.once(De,this._onMp4MetaReady),this.mp4.on(Ye,this._onMp4Error),this.mp4.on(Ne,this._updateDrmConfig),this.mp4.on(He,this._onMp4Progress),this.mp4.on(Fe,this._onMp4DataCallBack),this.mp4.on(Ue,(function(e){t.player&&t.player.emit("initialUrl",{url:e})})),this.mp4.on(Oe,(function(e){t._curLoadSegmentIdx=e,t.log("[update curLoadSegmentIdx]",e)})),this.mp4.MP4Loader.on(wt,(function(e){Vt=e.speed,t.debugInfo.speed||(t.debugInfo.speed=[]),t.debugInfo.speed.push(Vt),t.debugInfo.speed.length>10&&t.debugInfo.speed.shift(),t.emit(wt,e)})),this.changeState("MP4_INIT",{}),this.emit("loadstart_mse"),i||(i={}),this.mp4.init(i)}},{key:"_checkPreloader",value:function(){var e=this,t=this.playerConfig,i=new tt,r={method:"checkPreloader",success:0,type:"error",cacheKey:""};this.changeState("CHECK_PRELOAD");var n=this.player,a=n.curDefinition,o=n.preloader;if(!o)return this.changeState("PRELOAD_ERROR",{t:2}),r.success=0,r.error=new Error("no_preloader"),i.resolve(r),i;var s=a.cacheKey?a.cacheKey:o.generateUniqueKey({vid:t.vid,definition:a.definition||"",vtype:t.vtype,codecType:t.codecType});return r.cacheKey=s,s?o.getPreLoadData(s).then((function(t){if(t){var n=t.bitrate;if(n&&a.bitrate&&n!==a.bitrate)return e.preLoadData=null,r.success=0,r.error=new Error("bitrate_not_match_cut_".concat(a.bitrate,"_cache_").concat(n)),e.changeState("PRELOAD_ERROR",{bitrate:n,ck:s}),i.resolve(r),void e.log(">>>check Preloader bitrate_not_match cacheKey".concat(s," curDefinition:").concat(a.bitrate,"  cache:").concat(n));e.preLoadData=t,e.emit("PRELOAD_INFO",e.preLoadData),r.success=1,r.data=t,e.changeState("PRELOAD_OK",{l:e.preLoadData.byteLength,ck:s}),t.mediaSegList&&t.mediaSegList.length>0||t.buffer&&t.buffer.byteLength>0?e.hitpreload=!0:e.hitpreload=!1,i.resolve(r)}else e.preLoadData=null,e.changeState("PRELOAD_ERROR",{t:0}),r.success=0,r.error=new Error("none_preload"),i.resolve(r)})):(this.changeState("PRELOAD_ERROR",{t:2}),r.success=0,r.error=new Error("none_preload"),i.resolve(r)),i}},{key:"_initEME",value:function(e,t){var i=this,r=this.player,n=this.config;n.useEME=!(!1===n.useEME||void 0!==n.supportHevc&&!n.supportHevc),this._updateDrmConfig(t),this.log("config.useEME: ",n.useEME);var a=n.drm;!this.eme&&a&&a.clearKeys&&n.useEME&&(this.eme=new ze(a),this.eme.on("error",(function(e){console.error("EME err,",e),i._errorHandler(e)})),this.eme.setOptions('video/mp4; codecs="avc1.64001E"','audio/mp4; codecs="mp4a.40.2"'),this.eme.SetupEME(r.video))}},{key:"_initMse",value:(i=l(a().mark((function e(t){var i,r,n,o,s,l=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mse){e.next=4;break}return e.next=3,this.mse.unbindMedia();case 3:this.mse=null;case 4:i=this.mp4&&this.mp4.checkCodecH265(),r=!!t.videoCodec,n=!!t.audioCodec,o=r&&n?i?'video/mp4; codecs="hev1.1.6.L93.B0, mp4a.40.5"':'video/mp4; codecs="avc1.64001E, mp4a.40.5"':r?i?'video/mp4; codecs="hev1.1.6.L93.B0"':'video/mp4; codecs="avc1.64001E"':'video/mp4; codecs="mp4a.40.5"',s=h({},w.d1.VIDEO,{mimeType:"video/mp4",codec:o}),this.mse=new w.d1,this.mse.bindMedia(this.player.video).then((function(e){l.changeState("MSE_OPEN"),l.firstFrameTime.initmse_sbopen=e.costtime,l._loadStartEventTime>0&&(l.firstFrameTime.mseopen=xe.nowTime()-l._loadStartEventTime);var t=Object.keys(s);try{for(var i=0;i<t.length;i++){var r=t[i];l.mse.createSource(r,s[r].codec)}}catch(e){console.error("MSE error: ",e),l._errorHandler(e)}l.changeState("MSE_OPEN_DONE"),l._isMseInit=!0,l._onTimeUpdate()})),this.changeState("MSE_INIT");case 13:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_appendInitSeg",value:function(e){var t=this;this.mp4&&this.mse&&!this._MSEError&&(this.changeState("MSE_INITSEG"),this.log("[=======ready_append_init]",xe.nowTime(),",isopen,",!!this.mse&&this.mse.isOpened),this.firstFrameTime.metaready_mseisopen=this.mse&&this.mse.ready?1:0,this.mse.append(w.d1.VIDEO,e,{vid:this.playerConfig.vid,range:null,dataLen:e.byteLength,isinit:!0}).then((function(e){t.firstFrameTime.metaready_initsegend=e.costtime,t.log("appendInitSeg end ==>>>",e.context?e.context:null,", costTime,",e.costtime),t.changeState("MSE_INITSEG_OK",{costtime:e.costtime})})),this.mp4.useEME&&this.eme&&this.eme.emit("encrypted"))}},{key:"_checkMetaInfo",value:function(e){var t=null;return e?null:(t={errorCode:Ze.metaError,errorMessage:"meta is null",errorType:"demux",errorTypeCode:Te.demux},new I.ZP(this.player,n(n({},t),{},{vid:this.playerConfig.vid,mediaError:{code:t.errorCode,message:t.errorMessage}})))}},{key:"_stopProgress",value:function(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}},{key:"_bindNetworkStateChange",value:function(){window.addEventListener("online",this._onOnlineHandler),window.addEventListener("offline",this._onOfflineHandler)}},{key:"_unbindNetworkStateChange",value:function(){window.removeEventListener("online",this._onOnlineHandler),window.removeEventListener("offline",this._onOfflineHandler)}},{key:"_onSuperStart",value:function(e){var t=this,i=this.player;Ge("_onSuperStart:".concat(e),this.mse),i.video.src=e,this.once("canplay",(function(){i.play(),t.on("waiting",t._onWaiting)}))}},{key:"_appendBuffer",value:function(e,t){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,a=this.mse,o=this.playerConfig,s=o.vid;this.log("player appendBuffer start ==>>>",s,r.range,t.byteLength,", queueLen,",a&&a._queue[e]?a._queue[e].length:null),a.append(e,t,{vid:s,fragIndex:r.fragIndex,range:r.range,dataLen:t.byteLength,state:n}).then((function(e){if(i.log("player appendBuffer end ==>>>",e.context?e.context:null,", costTime,",e.costtime,", opt,",e.name,",bufferRange,",i.player.getBufferedRange()),i.firstFrameTime.loadst_loadeddata<0&&(i._firstSegState<0&&i._onTimeUpdate(),i.firstFrameTime.apcnt++,i.firstFrameTime.aplen+=e.context?e.context.dataLen:0,i.firstFrameTime.data_ap+=e.costtime,i.changeState("APPEND_DATA_OK",{costime:e.costtime,dataLen:e.context?e.context.dataLen:0})),i.mse&&r.state&&r.fragIndex===i.mp4.timeRange.length-1){var t=i.player.buffered;t&&t.length>0&&(i.bufferEndTime=t.end(t.length-1)),i._isEnded(),i.log("loaded ended !!!==>>>",r.range,", fragIndex,",r.fragIndex,", bufferEndTime,",i.bufferEndTime,",meta_duration,",i.mp4.meta.duration)}})).catch((function(e){if(i.log("[MSE error]",e),e&&i.mse.isFull()){var t=i.player.getBufferedRange(i.player.buffered2);i._checkRemoveSourceBuffer(t,i.player.currentTime,!0)}}))}},{key:"_loadData",value:(t=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mp4&&this._isMseInit){e.next=3;break}return this.log("loadData, player.mp4 null",this._isMseInit),e.abrupt("return");case 3:return this.loadstart<0&&(this.loadstart=xe.nowTime()),e.prev=4,e.next=7,this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error("[Index] _loadData error",this.playerConfig.vid,e.t0);case 12:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(){return t.apply(this,arguments)})},{key:"getDataBitRate",value:function(e){var t=this.mp4,i=this.playerConfig;if(!t)return 0;for(var r=t.getDataBitRate(e),n=i.definition.list,a=0,o=0;o<n.length;o++)if(n[o].bitrate===r){a=n[o];break}return a}},{key:"_loadStuckCheck",value:function(){var e=this,t=this.config,i=this.playerConfig,r=this.player;t.disableBufferBreakCheck||(r.currentTime-(this._lastCurrentTime||0)>.1||r.paused?1!==this._bufferBreakFlag&&2!==this._bufferBreakFlag||(this.log("视频没有卡死,重置卡死标记"),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log("卡死计时开始! 持续".concat(1e4,"毫秒则确认卡死")),this._bufferBreakTimer=setTimeout((function(){e.isDestroy||(1===e._bufferBreakFlag&&(e._bufferBreakFlag=2,e.log("确认卡死!!!"),e.emit("waittimeout"),e._errorHandler(new I.ZP(e.player,{errorType:"runtime",errorTypeCode:Te.runtime,errorCode:Ze.waitTimeout,errorMessage:"wait_timeout",vid:i.vid}))),e._bufferBreakTimer=null)}),1e4)),this._lastCurrentTime=r.currentTime)}},{key:"_isInBuffer",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=!1,r=this.player.video.buffered,n=0;n<r.length;n++){var a=r.start(n)-t,o=r.end(n)+t;if(a<=e.startTime&&e.endTime<=o){i=!0;break}}return i}},{key:"_doubleCheckBuffer",value:function(e){var t=this.player;return!(e.startTime>t.currentTime)||!t.video||!t.video.buffered||1===t.video.buffered.length||this._isInBuffer(e,.2)}},{key:"_onTimeUpdate",value:function(){var e=this,t=this.mse,i=this.mp4,r=this.player;if(i&&!this.useVideoLoad&&i){var n=i.timeRange;if(n&&!(n.length<1)&&1!==this._firstSegState){var a=r.getBufferedRange(r.buffered2);if((t||this.mseProxy)&&i&&i.canDownload){xe.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=xe.nowTime(),this._loadStuckCheck(),this._startUrlExpiredCheck(),this._checkRemoveSourceBuffer(a,r.currentTime));var o=r.paused?r.currentTime+this._minBufferLength:r.currentTime+this._maxBufferLength;a[1]-o<0&&n.every((function(t,i){if(t.downloaded){if(e._doubleCheckBuffer(t))return!0;t.downloaded=!1,t.isLoading=!1,e.log("onTimeUpdate, ".concat(i," download state error, no buffer, download again"))}if(t.endTime-t.startTime>1&&e._isInBuffer(t))return t.downloaded=!0,t.isLoading=!0,e.log("onTimeUpdate, ".concat(i," download segment, has buffer"),t.startTime,t.endTime),!0;t.startTime-r.currentTime<e._maxBufferLength&&(e._curLoadSegmentIdx=i,e.log("[onTimeUpdate],load index==>>>, ",i,",IdxTimeRange, ",t.startTime,"-",t.endTime,",buffEnd, ",a[1],",playCurTime,",r.currentTime,", bufferLen,",a[1]-r.currentTime,",bufferRangeList,",e.player.buffered2?e.player.buffered2.bufferedList:null),e._loadData())})),this.playFlag&&!this._hasTriggerBufferThreshold&&this._startBufferCheck(),this._isEnded()}}}}},{key:"_reset",value:function(){for(var e in this.states=[],this.hitpreload=!1,this._sTime=xe.nowTime(),this._usePaused=!1,this._firstSegState=-1,this.useVideoLoad=!1,this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this.preLoadData=null,this.forPreloadTimeCache=null,this.playFlag=!1,this._waitAdjustTimeCnt=0,this._initPromise&&"pending"===this._initPromise.state&&this._initPromise.reject("DESTROYED"),clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=null,this._stopProgress(),this.mp4&&(this.mp4.off(De,this._onMp4MetaReady),this.mp4.off(Ye,this._onMp4Error),this.mp4.off(Ne,this._updateDrmConfig),this.mp4.off(He,this._onMp4Progress),this.mp4.off(Fe,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),this.mseProxy&&(this.player.video.removeEventListener("lowdecode",this._onDegrade),this.player.video.removeEventListener("error",this._onError)),this._unloadVideo(),this._cancelPendingPromises(),this._abrService&&(this._abrService.destroy(),this._abrService=null),this.firstFrameTime)Object.prototype.hasOwnProperty.call(this.firstFrameTime,e)&&(this.firstFrameTime[e]="apcnt"===e||"aplen"===e?0:"newplayer"===e?xe.nowTime():-1);clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null,this.loadstart=-1,this._loadStartEventTime=-1,this.startLoadData=-1}},{key:"removeErrorUrls",value:function(e,t,i){return-499897===e.errorCode&&this._emitExpireEvent(e),i}},{key:"_errorHandler",value:function(e){var t=this.player,i=this.playerConfig,r=this.preLoadData;if(t){if(this.useVideoLoad)return this.log("useVideoLoad final error!!!!, ",i.vid,e),void this.emit("error",e);if("object"!==o(e)){var n={};n.err=e,e=n}var a=t.paused;e.vid=i.vid,e.preloadHit=r&&r.byteLength>0?1:0,e.preloadCached=r?r.duration:0,e=new I.ZP(t,e),this.log("_errorHandle","preState is ".concat(a),e),!e.url&&(e.url=t.src),this.player.vtype="MP4_2",this.player.emit("playCatch",this.player.vtype,e),e.errd&&"object"===o(e.errd)&&this.mp4&&(e.errd.url=this.mp4.url,e.url=this.mp4.url),e.codectype=this.codecType,this.emit("DATA_REPORT",e),this.mp4&&this.mp4.url&&this.removeErrorUrls(e,this.mp4.url,i.url),this.log("error task cancel"),this.mp4&&this.mp4.cancelLoading(),this._abrService&&this._abrService.disable(),this.mp4&&(this.mp4.canDownload=!1),this.mp4&&this.mp4.bufferCache&&this.mp4.bufferCache.clear(),this.config.closeDowngrade||this._startDegradedPlayback(e)}}},{key:"_startDegradedPlayback",value:function(e){var t=this;this.mp4&&(this.mp4.canDownload=!1);var i=this.player,r=this.playerConfig;if(this.endofstream=!1,this._currentTime=i.currentTime||0,this.player.pause(),this._reset(),this._replay=null,this.codecType===Pt)this.log("h265 err,degrade use 264 play",r.vid),this._onDegrade(e);else if(this.codecType===Ct){var n=this.config,a=n.drm,o=n.kid,s=n.drmKeyToken,l=n.keyValue,d=n.secretKey;a||o||s||l||d?(a&&Object.keys(a).map((function(t){a&&(e[t]=a[t])})),console.error("final error !!!!, ",r.vid,e),this.emit("error",e)):(this.emit("H264_DEGRADE",e),this.useVideoLoad=!0,this._setPlayerSrc(r.url),this.once("canplay",(function(){t._currentTime&&(i.currentTime=t._currentTime),!i.paused&&i.play()})))}}},{key:"_startProgress",value:function(){var e=this;this._hasStartProgress||(this._stopProgress(),this._requestTimer=new it((function(){e._requestTimer&&e._onTimeUpdate()})),this._requestTimer.tickEvery(this._tickInSeconds),this._hasStartProgress=!0)}},{key:"_unloadVideo",value:function(){var e=this.player;try{this.log("unloadVideo src ".concat(e.video.src)),e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(e){this.log("unloadVideo error",e)}}},{key:"_addPendingPromise",value:function(e){this._pendingPromises.push(e)}},{key:"_removePendingPromise",value:function(e){this.log("removePendingPromise",e.id);var t=this._pendingPromises.indexOf(e);t>-1&&this._pendingPromises.splice(t,1)}},{key:"_cancelPendingPromises",value:function(){this._pendingPromises.length>0&&this._pendingPromises.forEach((function(e){e.reject("DESTROYED")})),this._pendingPromises=[]}},{key:"_onMediaExpired",value:function(){this._stopProgress(),this.emit(rt.MEDIA_EXPIRED)}},{key:"_isEnded",value:function(){var e=this.player,t=this.mp4,i=e.bufferedPoint,r=i?i.end:0,n=e.currentTime;return r>n&&(r-n>=2||e.duration-n<1)&&2===e.video.readyState&&(xe.nowTime()-this._lastCheckLagTime>=3e3?(e.currentTime=e.currentTime+.2,this._lastCheckLagTime=xe.nowTime()):this._lastCheckLagTime=xe.nowTime()),!this.endofstream&&this.bufferEndTime>0&&this.mse&&this.bufferEndTime-e.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",e.currentTime,", bufferend,",r,", duration,",t.meta.duration),this.endofstream=!0,this.mse.endOfStream()),!!(t&&t.meta&&t.meta.duration-e.currentTime<.5)&&(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",e.currentTime,", bufferend,",r,", duration,",t.meta.duration),this.mse&&this.mse.endOfStream(),!0)}},{key:"_clearMediaKeys",value:function(){var e=this.player;e.video&&"function"==typeof e.video.setMediaKeys&&e.video.setMediaKeys(null).catch((function(){}))}},{key:"_checkRemoveSourceBuffer",value:function(e,t,i,r){var n=this,a=this.mse,o=this.mp4,s=this.player;if(a&&o&&s&&(i&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),e||(e=s.getBufferedRange(s.buffered2)),t||(t=s.currentTime),!(!i&&xe.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=xe.nowTime(),e&&e[0]>=0&&(t-e[0]>this.config.removeBufferLen||a.isFull())))){var l=r?e[1]:t-(a.isFull()?0:15),d=o.getFragmentIdx(l);if(d>=0&&(r||o.timeRange[d].startTime<t)){var c=Math.floor(Math.min(o.timeRange[d].startTime,e[1]));e[0]<c?(this.log("[checkremoveSourceBuffer], remove range==>>>",e[0],c),a.remove(w.d1.VIDEO,e[0],c)):a.isFull()&&!this._removeBufferTimer&&(this.log("[after 10s, go on checkremoveSourceBuffer], currentTime==>>>",t,", buffer start,",e[0]),this._removeBufferTimer=setTimeout((function(){n._checkRemoveSourceBuffer(null,null,!0)}),1e4))}}}},{key:"onMediaUpdate",value:function(e){var t=e.vid,i=e.kid,r=e.url,n=this.player,a=this.config;if(t===this.playerConfig.vid&&i===a.kid&&r){this.playerConfig.url=r,this._handlerUrl(r);var o=a._mainURL;return this.useVideoLoad?n.src=r:this.mp4&&this.mp4.update(o),!0}return!1}},{key:"enableAutoBuffer",value:function(e){var t=this;if(e){if(!this._allInitPromise)return void this.log("player destroyed!!");this._allInitPromise.then((function(){t.log("enableAutoBuffer true"),t._startProgress()}))}else this._stopProgress(),this.log("enableAutoBuffer false")}},{key:"bitRateAdapter",get:function(){return this.player&&this.player.plugins&&this.config.needAutoBitrate?this.player.plugins.bitrateselector:null}},{key:"getDefinitonFromAdapter",value:function(e,t){if(!this.bitRateAdapter)return null;var i=this.bitRateAdapter;return i.getSuitableBitrate?i.getSuitableBitrate(e,t):i.bitRateAdapter?i.bitRateAdapter.select(e):null}},{key:"addPreloader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.playerId=this.playerId,this.player.preloader?this.player.preloader.addPreloader(e,this.playerId,this.playerConfig.vid):this.log("preloader has destroyed")}},{key:"addPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.player.preloader?this.player.preloader.addPreloaderList(e,this.playerId,this.playerConfig.vid):this.log("preloader has destroyed")}},{key:"log",value:function(e){for(var t=this.playerConfig,i=t&&t.vid?"[Index]".concat(t.vid," ").concat(e):"[Index] ".concat(e),r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ge.apply(void 0,[i].concat(n))}},{key:"_emitInitFail",value:function(e){this.log("initFail, reason:",e),this.emit(rt.INIT_FAIL,e)}},{key:"emitParseError",value:function(){this.log("parseError"),this.emit(rt.PARSE_ERROR)}},{key:"useVideoLoad",get:function(){return this._useVideoLoad},set:function(e){this._useVideoLoad=e}},{key:"ready",get:function(){return this._allInitPromise}},{key:"speed",get:function(){return parseInt(Ae.speed,10)}},{key:"version",get:function(){return ve}},{key:"realTimeSpeed",get:function(){return Vt}},{key:"opQueueLen",get:function(){var e=this.mse&&this.mse._queue?this.mse._queue[w.d1.VIDEO]:[];return e?e.length:0}},{key:"loadSegmentTimeRange",get:function(){if(!this.mp4)return[0,0,0,0];var e=this.mp4.timeRange;if(e&&e.length>0&&this._curLoadSegmentIdx&&this._curLoadSegmentIdx<e.length){var t=e[this._curLoadSegmentIdx];if(t.isLoading){var i=this.mp4.getFragRange(this._curLoadSegmentIdx);return[Number(t.startTime),Number(t.endTime)].concat(T(i))}}return[0,0,0,0]}},{key:"preloadState",get:function(){return this.player.preloader&&this.player.preloader.loadingCount}},{key:"moovSize",get:function(){return 0}},{key:"isDestroy",get:function(){return!this.player}},{key:"cancelPreloadTask",value:function(){this.player.preloader&&this.player.preloader.cancelLoading(this.player.playerId)}},{key:"CDNUrl",get:function(){var e=this.playerConfig.url,t=document.createElement("a");return t.href=e,t.host}},{key:"abrInstance",get:function(){return this._abrService?this._abrService.abrInstance:null}},{key:"_handleUrlExpire",value:function(){var e=this,t=this.config,i=this.player,r=i.paused;(new Date).getTime()/1e3>=this.urlExpireTimestamp&&this.urlExpireTimestamp>0&&!r&&t.getServerTime&&(i.serverTimeDiffPromise=i.serverTimeDiffPromise||t.getServerTime().catch((function(){return 0})),i.serverTimeDiffPromise.then((function(t){if(t&&(i.serverTimeDiff=(new Date).getTime()/1e3-t),(new Date).getTime()/1e3>=e.urlExpireTimestamp+i.serverTimeDiff){e.urlExpireTimestamp=(new Date).getTime()/1e3+86400;var r=new Le("network",Ze[403]);e._emitExpireEvent(r)}})))}},{key:"_emitExpireEvent",value:function(e){var t=this.player,i=(new Date).getTime()/1e3;this.emitExpireTimestamp?i-this.emitExpireTimestamp>300&&(this.emitExpireTimestamp=i,t.emit("MEDIA_EXPIRED",e)):(this.emitExpireTimestamp=i,t.emit("MEDIA_EXPIRED",e))}}],[{key:"pluginName",get:function(){return"Mp4EncryptPlayer"}},{key:"defaultConfig",get:function(){return{onlyInit:!1,useWaterLevel:!1,maxBufferLength:10,minBufferLength:5,tickInSeconds:.2,getLicenseUrl:"",xhrSetup:{},retryCount:1,retryDelay:1e3,preloadCacheType:1,needPreloadRangeList:!1,isOpenPreload:!0,needPreloadCheck:!1,preloadTime:0,preloadMaxCacheCount:0,needAutoBitrate:!0,keyValue:null,drm:null,switchBitRateWay:!1,enableWorker:!1,bufferThreshold:10,removeBufferLen:40,focusUserDefinition:!1,resumePlayWaterLevel:2,waitJampBufferMaxCnt:3,waitingInBufferTimeOut:5e3,h265Degrade:!1,forceVideoPlay:!1,segmentMinDuration:2,supportHevc:void 0,H264Config:null,reqOptions:{},getRequestOptionsCallback:null,closeDowngrade:!1}}},{key:"speed",get:function(){return Vt}},{key:"realTimeSpeed",get:function(){return Vt}},{key:"version",get:function(){return ve}}]),c}(R.ZP);Mt.isSupported=function(){return et()&&$e()&&!Qe()},Mt.isEMESupported=qe,Mt.isSupportedWithXgmse=function(){return $e()&&!Qe()},Mt.isMediaSourceSupported=et,Mt.isWebAssemblySupported=$e,Mt.CUSTOM_EVENTS=rt,Mt.updateUnionInfo=he.updateUnionInfo;var Kt="PRELOAD_NEXT",Yt="PRELOAD_SEG_DONE",Dt="PREPARE",Ft="IDLE",Ht="FINISH",Nt="MP4";function Ut(e){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jt(e,t,i){return t&&At(e.prototype,t),i&&At(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var jt=function(){function e(){Ot(this,e),this.bandwidth2item={},this._mediaInfos=null,this.__p__=!0}return Jt(e,[{key:"init",value:function(){throw new Error("init func not implement, return promise")}},{key:"preloadPredict",value:function(e){throw new Error("preloadPredict error",e)}},{key:"updateMediaInfos",value:function(e){if(this._mediaInfos=e,this.bandwidth2item={},this.dynamic_video=e&&e.dynamic_video_list,this.dynamic_video&&this.dynamic_video.length>0)for(var t=0;t<this.dynamic_video.length;t++){var i=this.dynamic_video[t];this.bandwidth2item[i.bitrate||i.bandwidth]=i}}},{key:"getIdx",value:function(e,t){var i=0;return e.forEach((function(e,r){e.definition===t&&(i=r)})),i}},{key:"cachedData",get:function(){return null}}]),e}(),Bt=i(18035),zt=i.n(Bt),Qt=(i(92188),i(68785)),qt=i.n(Qt),$t=function(){function e(t,i,r,n,a){Ot(this,e),zt()(this),this.state=Dt,this.options=t||{},this.logger=t.logger||function(){},this._preloadManager=i,this.player=i.player;var o=r.handlers,s=r.predictInst,l=r.readyPromise;this._predictInst=s,this._handlers=o,this._predictInstReadyPromise=l,this._toLoadList=[],this.retryCount=0,this._cachedHandler=n,this._cachedDataHanlder=a,this.cnt=0}return Jt(e,[{key:"start",value:function(){var e=this,t=new pt;return this._handlers.start(this.options).then((function(i){i.onObtain().then((function(r){e._predictInstReadyPromise.then((function(){e._predictInst.updateMediaInfos(r);var n=e._predictInst.preloadPredict(e.options),a=e._predictInst.cachedData;e._cachedDataHanlder(Object.assign({vid:e.options.vid},{data:a}));var o=Object.assign(n,e.options);i.onTransform(o).then((function(i){e._toLoadList=i,t.resolve(i)}))}))}))})).catch((function(e){t.reject(new Error("preload unit start error"))})),t}},{key:"preloadSeg",value:function(){var e=this;if(0===this._toLoadList.length)return this.state=Ht,void this.emit(Yt,!0);this.state="PRELOADING";var t=this._toLoadList.shift();this._handlers.onRequest(t,(function(i){var r=Object.assign({},t.extData,i);e._cachedHandler(r)})).then((function(){e.state=Ft,e.emit(Yt)})).catch((function(t){e.requestError(),e.emit(Yt,!1)}))}},{key:"requestError",value:function(){this.retryCount++,this.state=Ft,this.retryCount>=10&&(this.state=Ht),this.emit("ONE_STEP_DONE"),this.logger("preload request error")}},{key:"cancelLoading",value:function(){this._toLoadList=[]}},{key:"destroy",value:function(){qt()(this)}}]),e}(),ei=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();function ti(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function ii(e){return"string"!=typeof e&&(console.warn("".concat(e," used as a key, but it is not a string.")),e=String(e)),e}var ri={},ni="readonly",ai="readwrite";function oi(e){var t=ri[e.name],i={};i.promise=new Promise((function(e,t){i.resolve=e,i.reject=t})),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then((function(){return i.promise})):t.dbReady=i.promise}function si(e,t){return new Promise((function(i,r){if(ri[e.name]=ri[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return i(e.db);oi(e),e.db.close()}var n=[e.name];t&&n.push(e.version);var a=ei.open.apply(ei,n);t&&(a.onupgradeneeded=function(t){var i=a.result;try{i.createObjectStore(e.storeName)}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(e){e.preventDefault(),r(a.error)},a.onsuccess=function(){i(a.result),function(e){var t=ri[e.name].deferredOperations.pop();t&&(t.resolve(),t.promise)}(e)}}))}function li(e){return si(e,!1)}function di(e){return si(e,!0)}function ci(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,n=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),n||i){if(i){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function ui(e,t,i,r){void 0===r&&(r=1);try{var n=e.db.transaction(e.storeName,t);i(null,n)}catch(n){if(r>0&&(!e.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return Promise.resolve().then((function(){if(!e.db||"NotFoundError"===n.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),di(e)})).then((function(){return function(e){oi(e);for(var t=ri[e.name],i=t.forages,r=0;r<i.length;r++){var n=i[r];n._dbInfo.db&&(n._dbInfo.db.close(),n._dbInfo.db=null)}return e.db=null,li(e).then((function(t){return e.db=t,ci(e)?di(e):t})).then((function(r){e.db=t.db=r;for(var n=0;n<i.length;n++)i[n]._dbInfo.db=r})).catch((function(t){throw function(e,t){var i=ri[e.name].deferredOperations.pop();i&&(i.reject(t),i.promise)}(e,t),t}))}(e).then((function(){ui(e,t,i,r-1)}))})).catch(i);i(n)}}var hi=function(){function e(){Ot(this,e)}return Jt(e,[{key:"ready",value:function(){return this._ready}},{key:"_initStorage",value:function(e){var t=this;t._defaultConfig=e;var i={db:null};if(e)for(var r in e)i[r]=e[r];var n=ri[i.name];n||(n={forages:[],db:null,dbReady:null,deferredOperations:[]},ri[i.name]=n),n.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=t._fullyReady);var a=[];function o(){return Promise.resolve()}for(var s=0;s<n.forages.length;s++){var l=n.forages[s];l!==t&&a.push(l._initReady().catch(o))}var d=n.forages.slice(0);return t._ready=Promise.all(a).then((function(){return i.db=n.db,li(i)})).then((function(e){return i.db=e,ci(i,t._defaultConfig.version)?di(i):e})).then((function(e){i.db=n.db=e,t._dbInfo=i;for(var r=0;r<d.length;r++){var a=d[r];a!==t&&(a._dbInfo.db=i.db,a._dbInfo.version=i.version)}})),t._ready}},{key:"probeSupport",get:function(){return function(){try{if(!ei||!ei.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}()}},{key:"getItem",value:function(e,t){var i=this;e=ii(e);var r=new Promise((function(t,r){i.ready().then((function(){ui(i._dbInfo,ni,(function(n,a){if(n)return r(n);try{var o=a.objectStore(i._dbInfo.storeName).get(e);o.onsuccess=function(){var e=o.result;void 0===e&&(e=null),t(e)},o.onerror=function(){r(o.error)}}catch(e){r(e)}}))})).catch(r)}));return ti(r,t),r}},{key:"setItem",value:function(e,t,i){var r=this;e=ii(e);var n=new Promise((function(i,n){r.ready().then((function(){return r._dbInfo,t})).then((function(t){ui(r._dbInfo,ai,(function(a,o){if(a)return n(a);try{var s=o.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=s.put(t,e);o.oncomplete=function(){void 0===t&&(t=null),i(t)},o.onabort=o.onerror=function(){var e=l.error?l.error:l.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return ti(n,i),n}},{key:"removeItem",value:function(e,t){var i=this;e=ii(e);var r=new Promise((function(t,r){i.ready().then((function(){ui(i._dbInfo,ai,(function(n,a){if(n)return r(n);try{var o=a.objectStore(i._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){r(o.error)},a.onabort=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return ti(r,t),r}},{key:"clear",value:function(e){var t=this,i=new Promise((function(e,i){t.ready().then((function(){ui(t._dbInfo,ai,(function(r,n){if(r)return i(r);try{var a=n.objectStore(t._dbInfo.storeName).clear();n.oncomplete=function(){e()},n.onabort=n.onerror=function(){var e=a.error?a.error:a.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return ti(i,e),i}},{key:"length",value:function(e){var t=this,i=new Promise((function(e,i){t.ready().then((function(){ui(t._dbInfo,ni,(function(r,n){if(r)return i(r);try{var a=n.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){i(a.error)}}catch(e){i(e)}}))})).catch(i)}));return ti(i,e),i}},{key:"all",value:function(e){var t=this,i=new Promise((function(e,i){t.ready().then((function(){ui(t._dbInfo,ni,(function(r,n){if(r)return i(r);try{var a=n.objectStore(t._dbInfo.storeName).openCursor(),o=[];a.onsuccess=function(){var t=a.result;t?(o.push({key:t.key,value:t.value}),t.continue()):e(o)},a.onerror=function(){i(a.error)}}catch(e){i(e)}}))})).catch(i)}));return ti(i,e),i}},{key:"_fullyReady",value:function(e){var t=this,i=t._initReady().then((function(){var e=ri[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return function(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}(i,e,e),i}}]),e}(),fi=function(){function e(){Ot(this,e)}return Jt(e,[{key:"_initStorage",value:function(e){var t=e.name+"_"+e.storeName;return this.key=t,window[t]&&"object"===Ut(window[t])||(window[t]={}),this.store=window[t],Promise.resolve()}},{key:"getItem",value:function(e,t){var i=this.store[e];return void 0===i&&(i=null),this._internalPromise(t,i)}},{key:"setItem",value:function(e,t,i){return this.store[e]=t,this._internalPromise(i)}},{key:"removeItem",value:function(e,t){return delete this.store[e],this._internalPromise(t)}},{key:"clear",value:function(e){return this.store={},window[this.key]={},this._internalPromise(e)}},{key:"length",value:function(e){var t=Object.keys(this.store).length;return this._internalPromise(e,t)}},{key:"_internalPromise",value:function(e,t){var i=t?Promise.resolve(t):Promise.resolve();return ti(i,e),i}},{key:"all",value:function(e){for(var t=[],i=Object.keys(this.store),r=0;r<i.length;r++){var n=i[r];t.push({key:n,value:this.store[n]})}return this._internalPromise(e,t)}},{key:"probeSupport",value:function(){return!0}}]),e}(),mi={description:"",name:"__PRE_CACHE__",storeName:"keyvaluepairs",version:1},pi="__PRE_CACHE__KEYS",bi=function(){function e(t,i){Ot(this,e);var r=1===i?fi:hi;this._driver=new r,this._driver._initStorage(mi).catch((function(){})),this._hasIdbForbidden=!1,this._maxCache=!t||t<=0?200:t,this.setMaxCache(this._maxCache),this._allCachedKeys={},this._allCachedTimeKeys={},this.getCachedKeysFromLocal(),this._readyPromise=new pt,this.init()}return Jt(e,[{key:"getCachedKeysFromLocal",value:function(){var e=yt(pi);if(e)for(var t=e.split("|"),i=0;i<t.length;i++){var r=t[i],n=this._getCacheKeyInfos(r),a=n.time,o=n.cachedKey;this._allCachedKeys[o]=1,this._allCachedTimeKeys[o]=a}}},{key:"_getCacheKeyInfos",value:function(e){var t,i=e.split("$");return 2===i.length&&(t=i[0],e=i[1]),{time:t,cachedKey:e}}},{key:"writeCachedKeysToLocal",value:function(e){var t=[];this._allCachedKeys={},this._allCachedTimeKeys={};for(var i=0;i<e.length;i++){var r=e[i].key,n=this._getCacheKeyInfos(r),a=n.time,o=n.cachedKey;this._allCachedKeys[o]=1,this._allCachedTimeKeys[o]=a,t.push(r)}var s=t.join("|");gt(pi,s)}},{key:"init",value:function(){var e=this;this._driver.setItem("test","test").then((function(){})).catch((function(){e._hasIdbForbidden=!0})).finally((function(){e._driver.removeItem("test").catch((function(){})),e._hasIdbForbidden&&(e._driver=new fi,e._driver._initStorage(mi)),e._getAll(),e._readyPromise.resolve()}))}},{key:"_getAll",value:function(){var e=this;this._driver.all().then((function(t){e._cachedLength=t.length;var i=t.length-e._maxCache,r=t;if(i>0){var n=t.slice(0,i);r=t.slice(i);for(var a=0;a<n.length;a++)e.removeItem(n[a].key).then((function(){}))}e.writeCachedKeysToLocal(r)})).catch((function(){}))}},{key:"getItem",value:function(e,t){if(!this.hasItem(e))return Promise.resolve(!1);var i=this._getTimeKey(e).timeKey;return this._driver.getItem(i,t)}},{key:"setItem",value:function(e,t,i){var r=this;this._getTimeKey(e).timeKey&&this.removeItem(e);var n=(new Date).getTime();this._allCachedKeys[e]=1,this._allCachedTimeKeys[e]=n;var a=this._genTimeKey(e,n);return i=i?function(){r._getAll(),i()}:function(){r._getAll()},this._driver.setItem(a,t,i)}},{key:"_getTimeKey",value:function(e){var t=this._allCachedTimeKeys[e],i=e;return t&&(i=this._genTimeKey(e,t)),{timeKey:i,time:t}}},{key:"_genTimeKey",value:function(e,t){return"".concat(t).concat("$").concat(e)}},{key:"removeItem",value:function(e,t){var i=this._getTimeKey(e).timeKey,r=this._driver.removeItem(i,t);return delete this._allCachedKeys[e],delete this._allCachedTimeKeys[e],r}},{key:"hasItem",value:function(e){return!!this._allCachedKeys[e]}},{key:"clear",value:function(e){return this._driver.clear(e)}},{key:"length",value:function(e){return this._driver.length(e)}},{key:"setMaxCache",value:function(e){"number"==typeof e&&e>0&&(this._maxCache=e)}}]),e}(),yi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Ot(this,e),zt()(this),this._preloadDataList=[],this._currentPreloadInst=null,this._dashPreloadList=[],this.autoPreload=t.autoPreload||!1,this._autoCheck=t.autoCheck||{enable:!1,interval:1e3},this._onPreloadNext=this.onPreloadNextReady.bind(this),this.on(Kt,this._onPreloadNext),this._preloaderConfigs={},this.update(t,i,r),this._cacheInst=new bi(t.preloadMaxCacheCount,t.preloadCacheType),this._preloadCacheProgress={},this._ptag_=!0,this._cachedDatas={},this._taskIntervalId=null}return Jt(e,[{key:"startCheckTask",value:function(){var e=this,t=this._autoCheck,i=this._preloadDataList;this._taskIntervalId&&(window.clearTimeout(this._taskIntervalId),this._taskIntervalId=null),0!==i.length&&(this._checkIfCanPreload()&&this.onPreloadNext(),this._taskIntervalId=window.setTimeout((function(){e.startCheckTask()}),t.interval||1e3))}},{key:"stopCheckTask",value:function(){this._taskIntervalId&&(window.clearTimeout(this._taskIntervalId),this._taskIntervalId=null)}},{key:"_checkIfCanPreload",value:function(){if(null==this._currentPreloadInst&&this._preloadDataList.length>0){var e=this._preloadDataList[0].data;if(e.payload){var t=this._getProloaderKey(e),i=this._preloaderConfigs[t];if(i&&i.handlers){var r=i.handlers.checkIfCanPreload;return r?r(e):(this.stopCheckTask(),!1)}return console.warn("need to set vtype, no preloader",e),this.stopCheckTask(),!1}}return!1}},{key:"_getProloaderKey",value:function(e){return e.vtype?e.vtype:"DEFAULT"}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!i)throw new Error("PreloaderManager predictInst is null");var r=this._getProloaderKey(e);this._preloaderConfigs[r]={predictInst:i,readyPromise:i.init(e),handlers:t}}},{key:"cachedDatas",get:function(){return this._cachedDatas}},{key:"onCacheSegment",value:function(e){var t=e.vid,i=e.format,r=e.cacheKey,n=e.total,a=e.loaded,o=e.isInitSegment,s=e.mediaType,l=this.getProgressCacheKey(t,i,s),d=this._preloadCacheProgress[l];d||(d=this._preloadCacheProgress[l]={}),d[r]={total:n,loaded:a,isInitSegment:o}}},{key:"onCachePredict",value:function(e){var t=e.vid,i=e.data;t&&i&&(this._cachedDatas[t]=i)}},{key:"getProgressCacheKey",value:function(e,t,i){return"".concat(e,"-").concat(t,"-").concat(i)}},{key:"onPreloadNextReady",value:function(){this.onPreloadNext()}},{key:"onPreloadSegDone",value:function(){this.autoPreload&&this.emit(Kt)}},{key:"onPreloadNext",value:function(){var e=this;if(null==this._currentPreloadInst&&this._preloadDataList.length>0){if(this._preloadDataList.length>0){var t=this._preloadDataList.shift().data;if(t.payload){var i=this._getProloaderKey(t),r=this._preloaderConfigs[i];if(!r)return void console.warn("need to set vtype, no preloader",t);this._currentPreloadInst=new $t(t,this,r,(function(t){e.onCacheSegment(t)}),(function(t){e.onCachePredict(t)})),this._currentPreloadInst.on(Yt,this.onPreloadSegDone.bind(this)),this._currentPreloadInst.start().then((function(){e._currentPreloadInst.preloadSeg()})).catch((function(){e._currentPreloadInst=null}))}}}else null!=this._currentPreloadInst&&(this._currentPreloadInst.state===Ft?this._currentPreloadInst.preloadSeg():this._currentPreloadInst.state===Ht?(this._currentPreloadInst.destroy(),this._currentPreloadInst=null):this._currentPreloadInst.state===Dt&&(this._currentPreloadInst.cnt++,this._currentPreloadInst.cnt>2&&(this._currentPreloadInst.destroy(),this._currentPreloadInst=null)))}},{key:"addDashPreloader",value:function(e){e&&e.data&&(this._preloadDataList.push(e),this.sort(this._preloadDataList),this.autoPreload&&this.emit(Kt),this._autoCheck.enable&&!this._taskIntervalId&&this.startCheckTask())}},{key:"_addDashPreloader",value:function(e){e&&e.data&&this._preloadDataList.push(e)}},{key:"addDashPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.sort(e);for(var t=0;t<e.length;t++)this._addDashPreloader(e[t]);this._autoCheck.enable&&!this._taskIntervalId&&this.startCheckTask()}},{key:"sort",value:function(e){e.sort((function(e,t){return void 0===e.order&&void 0===e.order||e.order<t.order?-1:1}))}},{key:"destroy",value:function(){this.off(Kt,this._onPreloadNext)}},{key:"cancelLoading",value:function(){this._currentPreloadInst&&(this._currentPreloadInst.cancelLoading(),this._currentPreloadInst=null),this._preloadDataList=[]}},{key:"preloadCacheProgress",value:function(e){var t=e.vid,i=e.format,r=e.mediaType,n=e.prelaodType,a=e.bitrate,o=e.set_duration,s=e.set_size,l=e.media_type,d=e.start_time,c=this.getProgressCacheKey(t,i,r),u=this._preloadCacheProgress[c];if(u){for(var h=Object.values(u),f=0,m=0,p=0,b=0,y=0,g=0;g<h.length;g++){var v=h[g];v.isInitSegment&&(f=v.total,p=v.loaded,b=v.loaded===v.total?0:1),m+=v.total,y+=v.loaded}return{media_type:l,preload_type:n,stream_bitrate:a,header_size:f,content_total_size:m,start_time:d||-1,state_info:{set_duration:o,set_size:s,current_header_download_size:p,current_content_download_size:y,header_download_state:b,content_download_state:y===m?0:1}}}return null}},{key:"getPreloadTaskInfos",value:function(){}},{key:"getItem",value:function(e,t){return this._cacheInst.getItem(e,t)}},{key:"setItem",value:function(e,t,i){return this._cacheInst.setItem(e,t,i)}},{key:"removeItem",value:function(e,t){return this.removeItem(e,t)}}],[{key:"getInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.GLOBAL_KEY+(t.globalKey?t.globalKey:""),a=window[n];if(a&&a._ptag_)return a.update(t,i,r),a;var o=new e(t,i,r);return window[n]=o,o}}]),e}();yi.GLOBAL_KEY="__preloadcontext__";var gi=function(){function e(t){Ot(this,e),zt()(this),this.options=t,this.promisePolyfill(),this.before(),this.check(),this._preloadManager=yi.getInstance(t,this.handlers,this.predictInst),this.loadingTasks=[]}return Jt(e,[{key:"promisePolyfill",value:function(){Promise.prototype.finally||(Promise.prototype.finally={finally:function(e){var t=function(t){return Promise.resolve(e()).then(t)};return this.then((function(e){return t((function(){return e}))}),(function(e){return t((function(){return Promise.reject(e)}))}))}}.finally)}},{key:"before",value:function(){throw new Error("need")}},{key:"check",value:function(){if(!this.handlers)throw new Error("handlers null");if(!this.handlers.start||!this.handlers.onRequest)throw new Error("handlers callback null");if(!this.predictInst)throw new Error("predictInst null");if(!this.predictInst.__p__)throw new Error("predictInst need extends predictbase")}},{key:"preloadNext",value:function(){this._preloadManager.emit(Kt)}},{key:"preloadManager",get:function(){return this._preloadManager}},{key:"start",value:function(e){throw new Error("start need implment, return Promise")}},{key:"cancelLoading",value:function(){for(var e=0;e<this.loadingTasks.length;e++)try{var t=this.loadingTasks[e];"function"==typeof t.cancel&&t.cancel()}catch(e){}this.loadingTasks=[],this._preloadManager.cancelLoading()}},{key:"addTasker",value:function(e){this.loadingTasks.push(e)}},{key:"removeTasker",value:function(e){var t=this;setTimeout((function(){for(var i=t.loadingTasks.length-1;i>-1;i--)if(t.loadingTasks[i]===e){t.loadingTasks.splice(i,1);break}}))}},{key:"addDashPreloader",value:function(e){this._preloadManager.addDashPreloader(e)}},{key:"addDashPreloaderList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._preloadManager.addDashPreloaderList(e)}}]),e}(),vi="h264",Zi={supportHevc:!1,preloadTime:5,segmentMinDuration:5,preloadSize:0,vtype:"MP4",preloadCacheType:1,preloadMaxCacheCount:5,globalKey:null,autoPreload:!1,reqOptions:null,getRequestOptionsCallback:null,minBufferLength:5,autoCheck:{enable:!0,interval:1e3}},Ti={DURATION:0,SIZE:1},Li="real_time_speed",Si=0,xi=null,ki=function(e){f(i,e);var t=g(i);function i(){return d(this,i),t.apply(this,arguments)}return u(i,[{key:"init",value:function(){return Promise.resolve()}},{key:"preloadPredict",value:function(e){return e}}]),i}(jt);function Ii(e,t,i){void 0===e[t]&&(e[t]=i)}var Xi=function(e){f(c,e);var t,i,r,o,s=g(c);function c(e,t){var i;d(this,c);var r=c.getDefaultConfig(e);return Object.keys(e).forEach((function(t){r[t]=e[t]})),h(b(i=s.call(this,r)),"_updateRealTimeSpeed",(function(e){Si=e.speed,i.emit(Li,e)})),i.video=null,Ii(i._preloadManager,"loadingCount",0),Ii(i._preloadManager,"_playingVids",[]),i._mp4=null,i._loader=null,i._pendingPromise=null,i.playerId=t.playerId||"default",i.isActive=!0,i}return u(c,[{key:"log",value:function(e){for(var t,i="[Preloader] ".concat(e),r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];this.options.debugger&&console.log&&(t=console).log.apply(t,["[logger]",xe.nowTime(),i].concat(n))}},{key:"loadingCount",get:function(){return this._preloadManager.loadingCount},set:function(e){this._preloadManager.loadingCount=e}},{key:"startCheckTask",value:function(){this._preloadManager.startCheckTask()}},{key:"stopCheckTask",value:function(){this._preloadManager.stopCheckTask()}},{key:"generateUniqueKey",value:function(e){var t=e.vid,i=e.mediaType,r=e.definition,n=e.codecType,a=e.vtype;return i=i||"video",r=r||"-1",n=n||vi,a=a||Nt,t?"".concat(t,"#").concat(i,"#").concat(n,"#").concat(a,"#").concat(r):null}},{key:"addPlayingItem",value:function(e,t){var i=this._preloadManager,r=this.checkPlaying("_playerId",e);r>-1?i._playingVids[r].vid=t:i._playingVids.push({vid:t,_playerId:e})}},{key:"delPlayingItem",value:function(e){var t=this._preloadManager,i=this.checkPlaying("_playerId",e);i>-1&&t._playingVids.splice(i,1)}},{key:"checkPlaying",value:function(e,t){for(var i=this._preloadManager._playingVids,r=0;r<i.length;r++)if(t===i[r][e])return r;return-1}},{key:"checkPlayingByVid",value:function(e){return this.checkPlaying("vid",e)>-1}},{key:"before",value:function(){var e=this;this.handlers={checkIfCanPreload:function(t){return e.checkIfCanPreload()},start:function(t){var i=t.payload||[];if(0===i.length)return Promise.reject();var r=t.vid,a=t.vtype||Nt,o=t.codecType||vi,s=e.getUserSelectDefinition(),l=e.checkCacheKey(r,i,s,a,o);if(e.log("[Preloader] ".concat(e.playerId," ").concat(r),"codecType:".concat(o," vtype:").concat(a," hasCache:").concat(l)),l||"MP3"===a)return Promise.reject();var d=e.getInitDefinition(i,e.options.definition,s);if(e.log("[Preloader] ".concat(e.playerId," ").concat(r," getInitDefinition"),d),!d)return Promise.reject();var c=d.definition,u=t.preloadTime||e.options.preloadTime,h=t.preloadSize||e.options.preloadSize||Math.pow(25,4)-1,f=e.generateUniqueKey({vid:r,definition:c,vtype:a,codecType:o});e.log("[Preloader] ".concat(r," start duration:").concat(d.duration," cacheKey:").concat(f));var m=n({vid:r,definition:c,preloadTime:u,preloadSize:h,cacheKey:f,codecType:o,vtype:a},d);return t.reqOptions&&(m.reqOptions=t.reqOptions),e.loadingCount++,e.start(m)},onRequest:function(t,i){var r=t.url,n=t.range,a=t.extData;return e.getData(r,n,a,i)}},this.loggerConfig={logger:function(){},openLog:!1},this.predictInst=new ki(this.loggerConfig)}},{key:"start",value:function(e){var t=this,i={mediaInfos:{dynamic_video_list:[],dynamic_audio_list:[]},onObtain:function(){var e=new tt;return e.resolve(i.mediaInfos),e},onTransform:function(i){var r=new tt;t._pendingPromise=r;var n=e.preloadTime,a=e.codecType;return n&&("h265"!==a||t.options.supportHevc)?t.loadByPreloadTime(e,r):t.loadByChunkSize(e,r),r}};return Promise.resolve(i)}},{key:"getInitDefinition",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null;if(c.BitRateAdapter)r=c.BitRateAdapter.getSuitableBitrate(e,i),this.log("Mp4Preloader.BitRateAdapter",r);else{for(var n=0,a=0;a<e.length;a++){var o=e[a];if(o.definition===t){n=a;break}}r=e[n]}return r||(r=e[0]),r}},{key:"getPreLoadData",value:function(e){var t=this,i=new tt;return this.getItemSameVid(e).then((function(e){if(t.log("getPreLoadData",e.value),e.value){var r=e.value,n=r.mediaSegList,a=r.meta,o=r.type,s=r.buffer,l=r.preloadTime,d=r.vid,c=r.cacheKey,u=r.definition,h=r.byteLength,f=r.duration,m=r.fileSize,p=r.from,b=r.vtype,y=r.codecType,g=r.initSeg,v={vid:d,type:o,vtype:b,codecType:y,definition:u,bitrate:r.bitrate,cacheKey:c,duration:f||0,byteLength:h,from:p,meta:a};o===Ti.SIZE?(v.buffer=s,v.fileSize=m||0):(v.mediaSegList=n,v.preloadTime=l,v.initSeg=g),i.resolve(v)}else i.resolve(null)})).catch((function(e){i.reject(e)})),i}},{key:"setPreLoadData",value:(o=l(a().mark((function e(t,i){var r,n,o,s,l,d,c,u,h,f,m,p,b,y,g,v,Z,T,L=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new tt,n=i.mediaSegList,o=i.meta,s=i.vid,l=i.definition,d=i.type,c=i.buffer,u=i.duration,h=i.byteLength,f=i.preloadTime,m=i.preloadSize,p=i.fileSize,b=i.from,y=i.vtype,g=i.codecType,v=i.initSeg,Z=i.bitrate,T={codecType:g,vtype:y,vid:s,definition:l,cacheKey:t,type:d,from:b,meta:o,fileSize:p,bitrate:Z},d===Ti.SIZE?(T.buffer=c,T.byteLength=h||0,T.preloadSize=m||0,T.fileSize=p,T.buffer&&T.buffer.byteLength>0&&(this.setItem(t,T),r.resolve(!0))):(T.mediaSegList=n||[],T.duration=u,T.byteLength=h||0,T.preloadTime=f||0,T.initSeg=v,o&&0===n.length?(this.setItem(t,T),r.resolve(!0)):(n.every((function(e){return!!e.buffer&&e.state}))||r.resolve(!1),this.setItem(t,T).then((function(){L.log("setPreLoadData1 success",t,(new Date).getTime())})),r.resolve(!0))),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getInitCacheData",value:function(e,t){var i={type:e,meta:null,byteLength:0,fileSize:0,bitrate:0};return e===Ti.DURATION?(i.mediaSegList=[],i.initSeg=null,i.duration=0):i.buffer=null,Object.keys(t).map((function(e){i[e]=t[e]})),i}},{key:"updatePreCacheData",value:function(e,t,i,r,n,a,o){var s=e.mediaSegList;if(e.type===Ti.SIZE||-1===n)return e.buffer=be()(Uint8Array,e.buffer.buffer||[],new Uint8Array(t)),e;for(var l=-1,d=0;d<s.length;d++)if(s[d].index===n){l=d;break}var c=a||[0,0];return l>-1?(t&&(s[l].buffer=be()(Uint8Array,s[l].buffer||[],new Uint8Array(t))),i.length>1&&(s[l].range.length>1?s[l].range[1]=i[1]:s[l].range=i),-1!==o[1]&&(r=s[l].range[1]>=o[1]),s[l].state=r):(e.duration=c[1],s.push({buffer:t,range:i||[],index:n,totalRange:o||[],timeRange:[c[0],c[1]],state:r})),r&&(e.byteLength=i[1]),r}},{key:"checkCacheKey",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nt,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vi;if(i){var a=this.generateUniqueKey({vid:e,definition:i,vtype:r,codecType:n});return this.hasItemSameVid(a)?a:null}for(var o=0;o<t.length;o++){var s=this.generateUniqueKey({vid:e,definition:t[o].definition,vtype:r,codecType:n}),l=this.hasItemSameVid(s);if(l)return s}return null}},{key:"attachPlayer",value:function(e){this.video=e.video?e.video:e}},{key:"checkIfCanPreload",value:function(e,t){var i;return this.loadingCount>=1||!this.isActive?i=!1:(i=function(e,t){if(!e)return!1;var i=e.currentTime+t,r=e.duration>t+5?t:e.duration/2;i=i>e.duration?e.duration:i;var n=function(e,t){var i=[0,0];if(e)for(var r=0,n=e.length;r<n&&(i[0]=e.start(r),i[1]=e.end(r),!(i[0]<=t&&t<=i[1]));r++);return i[0]-t<=0&&t-i[1]<=0?i:[0,0]}(e.buffered,e.currentTime)[1]-i;return e.currentTime>r&&(n>0||Math.abs(n)<1)}(this.video,this.options.minBufferLength),i)}},{key:"checkCanPreloadNext",value:function(){var e=!0;return(this.loadingCount>=1||!this.isActive)&&(e=!1),e&&this.preloadNext(),e}},{key:"realTimeSpeed",get:function(){return Si}},{key:"getRequestOption",value:function(e){var t=this.options,i=t.getRequestOptionsCallback,r=t.reqOptions;return(e.reqOptions?e.reqOptions:"Function"===xe.typeOf(i)?i(e):r)||{}}},{key:"loadByPreloadTime",value:function(e,t){var i=this,r=e.vid,a=e.cacheKey,o=e.preloadTime,s=e.definition,l=e.duration,d=e.bitrate,c=e.codecType,u=e.vtype,h=null;if(h="Array"===xe.typeOf(e.url)?e.url.length>1?e.url[1].src:e.url[0].src:e.url){h=xe.extUrl(h,{__vid:r}),this.log("[Preloader] loadByPreloadTime",e.cacheKey,e.definition);var f=o>=this.options.segmentMinDuration?this.options.segmentMinDuration:o;this.log("loadByPreloadTime","".concat(e.cacheKey,", definition:").concat(e.definition,",segmentMinDuration:").concat(f),e);var m=xe.getFileSize(d,l),p=this.getRequestOption(n(n({},e),{},{url:h}));this._mp4=new Ae(h,d,{segmentDuration:f,codecType:this.codecType,chunkSize:this.options.preloadSize,duration:l,fileSize:m,playerId:this.playerId,vid:r,useUrlRange:!1,retryCount:1,retryDelay:1e3,supportHevc:this.options.supportHevc,reqOptions:p},[],this.firstFrameTime,"[Preloader]"),this._mp4.MP4Loader.on(Li,this._updateRealTimeSpeed);var b=this.getInitCacheData(Ti.DURATION,{vid:r,preloadTime:o,definition:s,cacheKey:a,codecType:c,vtype:u,bitrate:d||0});this._mp4.once("metaReady",(function(n){i.log("".concat(r," metaReady this._pendingPromise"),i._pendingPromise.state),b.meta=n,b.from=2,i._mp4.cancelLoading(),i.startLoadByFragments(b,e,t)})),this._mp4.on("error",(function(e){console.error("[Preloader] ".concat(r," loadByPreloadTime error"),e),i._endLoadFragments()})),this._mp4.init({})}else this._endLoadFragments()}},{key:"loadByChunkSize",value:(r=l(a().mark((function e(t){var i,r,o,s,l,d,c,u,h,f,m,p,b,y,g,v,Z,T,L=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.vid,r=t.cacheKey,o=t.definition,s=t.duration,l=t.bitrate,d=t.codecType,c=t.vtype,u=this.options,h="Array"===xe.typeOf(t.url)?t.url[0].src:t.url){e.next=6;break}return this._endLoadChunk(),e.abrupt("return");case 6:return h=xe.extUrl(h,{__vid:i}),f=xe.getFileSize(l,s),m=Ce(s,8e5,f),this.log("".concat(i,"loadByChunkSize"),t.cacheKey,t.definition,m,t),p=this.getInitCacheData(Ti.SIZE,{vid:i,definition:o,cacheKey:r,codecType:d,vtype:c,fileSize:f,bitrate:l||0}),b=this.getRequestOption(n(n({},t),{},{url:h})),this.MP4Loader=new Ie.b({url:h,retry:u.retry||2,retryDelay:u.retryDelay||1e3,timeout:3e3,reqOptions:b,segmentDuration:u.segmentDuration}),this.MP4Loader.on(Li,this._updateRealTimeSpeed),e.prev=14,y=new Uint8Array(0),g=0,v=null,Z=null,T=function(e,t,i){if(e&&i.range[0]===g&&(y=be()(Uint8Array,y,new Uint8Array(e)),g+=e.byteLength),i.meta){L.MP4Loader.cancel();var a=i.meta,o=a.videoSegments,s=a.audioSegments;Z=n(n({},a.meta),{},{ext:{videoTrak:o,audioTrak:s}}),p.meta=Z,p.buffer=y,p.byteLength=y.byteLength,L.setPreLoadData(r,p),v=xe.getFragRange(0,o,s),L.log("".concat(r," onProgressHandle4 meta"),t,v,g,y.byteLength),v[0]<g&&(v[0]=g),L._loadOneChunk(p,v)}},e.next=22,this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,m],T);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(14),console.error("[Preloader] ".concat(r," loadByChunkSize error"),e.t0),this._endLoadChunk();case 28:case"end":return e.stop()}}),e,this,[[14,24]])}))),function(e){return r.apply(this,arguments)})},{key:"_loadOneChunk",value:(i=l(a().mark((function e(t,i){var r,n,o,s,l,d,c,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.vid,n=t.cacheKey,o=t.buffer,e.prev=1,e.next=4,this.MP4Loader.loadData(i,this.MP4Loader.cache,{});case 4:s=e.sent,this.log("".concat(r," _loadOneChunk"),i,s),l=s.response,(d=s.data)?(this._endLoadChunk(),l&&l.headers&&(c=xe.getFileSize(l.headers))&&(t.fileSize=c),u=be()(Uint8Array,o,new Uint8Array(d)),t.buffer=u,t.byteLength=u.byteLength,this.log("".concat(r," _loadOneChunk ret"),n,u.byteLength,t),t.from=4,this.setPreLoadData(n,t)):this._endLoadChunk(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("[Preloader] ".concat(r," loadByChunkSize error"),e.t0),this._endLoadChunk();case 14:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e,t){return i.apply(this,arguments)})},{key:"_endLoadChunk",value:function(){this.log("_endLoadChunk loadingCount:".concat(this.loadingCount),this._pendingPromise?this._pendingPromise.state:null),this._pendingPromise&&(this._pendingPromise.resolve(),this._pendingPromise=null),this.loadingCount>0&&this.loadingCount--,this.MP4Loader&&(this.MP4Loader.off(Li,this._updateRealTimeSpeed),this.MP4Loader.cancel(),this.MP4Loader.destroy(),this.MP4Loader=null)}},{key:"startLoadByFragments",value:(t=l(a().mark((function e(t,i,r){var n,o,s,d,c,u,h=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=i.preloadTime,o=i.vid,this.log("[Preloader] ".concat(o," startLoadByFragments")),s=[],d=0;d<this._mp4.timeRange.length;d++)this._mp4.timeRange[d].startTime<=n&&s.push(d);return c=function(e){h.log("[Preloader] _failedCallback",e),h._endLoadFragments()},u=function(){var e=l(a().mark((function e(i){var r,n,o,l,d,f,m,p,b;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h._mp4){e.next=2;break}return e.abrupt("return");case 2:if(r=i.buffer,n=i.context,o=i.state,l=i.initSeg,d=n.fragIndex,f=n.range,m=n.timeRange,p=h._mp4.getFragRange(d),!t.initSeg&&l&&(t.initSeg=l),b=h.updatePreCacheData(t,r,f,o,d,m,p),h.log("".concat(t.cacheKey," _successCallback"),d,o,b,f,m,p,i),t.from=3,!b){e.next=20;break}return e.next=12,h.setPreLoadData(t.cacheKey,t);case 12:if(!(d>=s.length-1)){e.next=17;break}h.log("".concat(t.cacheKey," mp4.load end"),d),h._endLoadFragments(),e.next=20;break;case 17:return h.log("".concat(t.cacheKey," mp4.load start"),d+1),e.next=20,h._mp4.loadAllFragmentData(d+1,u,c);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=8,this._mp4.loadAllFragmentData(0,u,c);case 8:case"end":return e.stop()}}),e,this)}))),function(e,i,r){return t.apply(this,arguments)})},{key:"_endLoadFragments",value:function(){this.log("_endLoadFragments loadingCount:".concat(this.loadingCount),this._pendingPromise?this._pendingPromise.state:null),this._pendingPromise&&(this._pendingPromise.resolve(),this._pendingPromise=null),this.loadingCount>0&&this.loadingCount--,this._mp4&&(this._mp4.MP4Loader.off(Li,this._updateRealTimeSpeed),this._mp4.destroy(),this._mp4.cancelLoading(),this._mp4=null)}},{key:"hasItemSameVid",value:function(e){if(!e)return null;for(var t=e.split("#"),i=Object.keys(this.allCachedKeys),r=0;r<i.length;r++){var n=i[r];if(n===e)return n;var a=n.split("#");if(a.length>=4&&t.length>=4&&a[0]===t[0]){if(0===a[2].indexOf("pretime")&&0===t[2].indexOf("pretime"))return n;var o=[parseInt(a[2]),parseInt(a[3])],s=[parseInt(t[2]),parseInt(t[3])];if(s[0]>=o[0]&&s[1]>s[0]&&s[1]<=o[1])return n}}return null}},{key:"removeOthers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.allCachedKeys,r=function(){if(i.hasOwnProperty(n)&&n.split("#").length>=1){var r=n.split("#")[0];t.every((function(e){return e.split("#").length>=1&&e.split("#")[0]!==r}))&&(e.log("remove cache:".concat(n)),e.cacheInst.removeItem(n))}};for(var n in i)r()}},{key:"getItemSameVid",value:function(e,t){var i=this.hasItemSameVid(e);return this.log("getItemSameVid: key:".concat(e," checkResult:").concat(i)),i?this.cacheInst.getItem(i,t).then((function(e){return{value:e,key:i}})):Promise.resolve({})}},{key:"setItem",value:function(e,t){return this.cacheInst.setItem(e,t)}},{key:"allCachedKeys",get:function(){return this.cacheInst._allCachedKeys}},{key:"cacheInst",get:function(){return this._preloadManager._cacheInst}},{key:"cancelPreloadByVid",value:function(e,t){if(t){for(var i=this._preloadManager._preloadDataList,r=[],n=0;n<i.length;n++)i[n].data.vid!==t?r.push(i[n]):this.log("cancelPreloadByVid",t);this._preloadManager._preloadDataList=r,this.addPlayingItem(e,t)}}},{key:"cancelLoading",value:function(){this._endLoadFragments(),this._endLoadChunk()}},{key:"clearTaskItem",value:function(e){var t=this._preloadManager;if(t._currentPreloadInst){var i=t._currentPreloadInst._toLoadList,r=[];i.map((function(t){return t._playerId!==e&&r.push(t),t})),t._currentPreloadInst._toLoadList=r}var n=[],a=[];t._preloadDataList.map((function(t){return t._playerId!==e?n.push(t):a.push(t.data.vid),t})),this.log("[Preloader] cancelLoading",e,a.join(",")),t._preloadDataList=n}},{key:"checkIfExistInList",value:function(e){for(var t=this._preloadManager._preloadDataList,i=0;i<t.length;i++)if(e===t[i].data.vid)return!0;return!1}},{key:"addPreloader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;if(e.data){var r=e.data.vid,n=this.checkIfExistInList(r);if(this.log("[Preloader] addPreloader checkIfExistInList",r,n),!(t&&r===t||n)){var a=xe.deepMerge({},e);a.vtype||(a.vtype=Nt),a._playerId=i,this.addDashPreloader(a)}}}},{key:"addPreloaderList",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,r=[],n=0;n<e.length;n++){var a=e[n].data,o=a.vid,s=a.vtype,l=this.checkIfExistInList(o,i);if(this.log("[Preloader] addPreloaderList checkIfExistInList",o,o===t,l),!(t&&o===t||l)){var d=xe.deepMerge({},e[n]);s||(d.data.vtype=Nt),d._playerId=i,r.push(d)}}this.log("[Preloader] addPreloaderList length is ".concat(r.length)),this.addDashPreloaderList(r)}},{key:"setUserSelectDefinition",value:function(e){this._preloadManager&&(this._preloadManager.userDefinition=e)}},{key:"getUserSelectDefinition",value:function(){return this._preloadManager.userDefinition||null}},{key:"destroy",value:function(){this.cancelLoading(),this.clearTaskItem(this.playerId),this.delPlayingItem(this.playerId,null)}},{key:"on",value:function(e,t){for(var i,r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];(i=Z(m(c.prototype),"on",this)).call.apply(i,[this,e,t].concat(n))}},{key:"off",value:function(e,t){for(var i,r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];(i=Z(m(c.prototype),"off",this)).call.apply(i,[this,e,t].concat(n))}}],[{key:"PRELOAD_TYPES",get:function(){return Ti}},{key:"BitRateAdapter",get:function(){return xi},set:function(e){xi=e}},{key:"getDefaultConfig",value:function(){return Zi}},{key:"registerPreloader",value:function(e,t){return e.vtype=Nt,c.BitRateAdapter=t,new c(e,this)}},{key:"getInfoByUniqueKey",value:function(e){var t=e.split("#"),i=["vid","mediaType","codecType","vtype","definition"],r={};return t.forEach((function(e,t){r[i[t]]=e})),r}}]),c}(gi)},27359:(e,t,i)=>{"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function s(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function f(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,{Z:()=>V}),i(29832),i(14643),i(91170),i(3495),i(94609),i(82584),i(67825);var m=i(39776),p=i(41107),b=(i(34895),i(62180),i(96761),i(58067),i(17021),new(function(){function e(t){a(this,e),this._queue=[],this._current={},this._config={},this.setConfig(t)}return s(e,[{key:"setConfig",value:function(e){this._config=Object.assign({},e)}},{key:"appendPlayInfo",value:function(e,t){var i=e.duration,r=e.endBufferTime,n=e.stalledTime,a=e.downloadDuration,o=e.bitrate;if(i&&o&&r){var s=this._config,l=s.slidingWindowWeight,d=s.slidingWindowType,c=s.slidingWindowWeightThreshold,u=s.slidingWindowCountThreshold,h=this.getAdjust(this._config,e),f=0;if(f="time"===l?Math.min(a,i+n):Math.min(a,i)*o,f=parseInt(f,10),this._queue.push([h,f,e]),"by_weight"===d){this._queue=this._queue.slice(-30);for(var m=this._queue.reduce((function(e,t){return e+t[1]}),0)-c;m>0;){var p=this._queue.shift();if(!p)break;if(p[1]>m){p[1]-=m,this._queue.unshift(p);break}m-=p[1]}}else this._queue=this._queue.slice(-u)}}},{key:"getAdjust",value:function(e,t){var i=t.startBufferTime,r=t.endBufferTime,n=t.leaveWithBlock,a=t.stalledTime,o=t.pausedTime,s=t.downloadDuration,l=t.bitrate,d=e.paramBf,c=e.paramBp,u=e.paramUpperBl,h=e.paramUpper,f=1+((r-i)*d-(a+o)*c)/s;return n&&(f=Math.min(f,u)),n&&(f=Math.min(f,u)),parseInt(l*Math.max(h,f),10)}},{key:"getDefaultBitrate",value:function(e){if(!e||0===e.length)return 0;for(var t=this._config.defaultTargetBitrate||1e6,i=0,r=0;r<e.length;r++)e[r].bitrate<=t&&e[r].bitrate>=i&&(i=e[r].bitrate);return i||(i=e[e.length-1].bitrate),i}},{key:"getTargetBitrate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.duration;if(!this._queue.length||!r)return 0;var a=n(n({},this._config),t),o=a.paramVlLower,s=a.paramVlUpper,l=a.paramVl1,d=a.paramVl2,c=a.bitrateLower,u=a.bitrateUpper,h=a.slidingWindowExtraction,f=0,m=this._queue.reduce((function(e,t){return e+t[1]}),0);if("weighted_median"===h){var p=m/2,b=1/0,y=0;this._queue.forEach((function(t){var i=e.getAdjust(a,t[2]);(y=Math.abs(p-t[1]))<b&&(f=i,b=y)}))}else f=this._queue.reduce((function(e,t){return e+t[1]/m*t[0]}),0);var g=Math.min(s,Math.max(o,l+d/r));return parseInt(Math.max(c,Math.min(u,f*g)),10)}}]),e}()));function y(){return b}var g=i(85634),v=y(),Z=function(){function e(t){var i=this;a(this,e),l(this,"_onEnded",(function(){i._updateInfo()})),l(this,"_onPlayNext",(function(){i._updateInfo()})),this._rule=v,this._bindEvent(),v.setConfig(t)}return s(e,[{key:"select",value:function(e,t,i){if(e.length){var r,n=e[0].duration||0,a=0|v.getTargetBitrate(t,{duration:n});return(r=a?(0,g.v2)(e,a,t.selectAlgType):e[0]).targetBitrate=a,r}}},{key:"getTargetBitrate",value:function(e,t){return 0|v.getTargetBitrate(e,t)}},{key:"_bindEvent",value:function(){}},{key:"destroy",value:function(){}},{key:"_updateInfo",value:function(){this._playingInfo.endPlay();var e=this._playingInfo.getInfo();this._playingInfo.resetInfo(),v.setCurrent({downloadDuration:e.downloadDuration||v.getCurrent().duration,startBufferTime:e.startBufferTime,endBufferTime:e.endBufferTime,pausedTime:e.pausedTime,stalledTime:e.stalledTime,leaveWithBlock:e.leaveWithBlock}),this._prevPlayInfo=v.getCurrent(),v.calcAndReset()}}]),e}(),T=function(){function e(t){var i=this;a(this,e),l(this,"_onPlay",(function(){i._calcPausedTime()})),l(this,"_onPause",(function(){i._prevPauseTime=Date.now()})),l(this,"_onEnded",(function(){!i._info.downloadDuration&&i._info.canPlayTime&&(i._info.downloadDuration=(Date.now()-i._info.canPlayTime)/1e3),i.disable()})),l(this,"_canPlay",(function(){i._info.canPlayTime=Date.now();var e=i.video.buffered;e.length&&(i._info.startBufferTime=e.end(e.length-1))})),l(this,"_onProgress",(function(){var e=i.video.buffered;i._info.canPlayTime&&e.length&&e.end(e.length-1)+.8>i.video.duration&&(i._info.downloadDuration=(Date.now()-i._info.canPlayTime)/1e3)})),l(this,"_onTick",(function(){var e=i.video;if(e){i._timer=setTimeout(i._onTick,500);var t=e.currentTime;!e.paused||e.ended||0===e.playbackRate||0===e.readyState?(i._prevCurrentTime===t?i._prevStallTime||(i._prevStallTime=Date.now()):i._calcStallTime(),i._prevCurrentTime=t):i._prevCurrentTime=t}})),this.video=t,this._timer=null,this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this.resetInfo(),this.enable()}return s(e,[{key:"isStalling",get:function(){return!!this._prevStallTime}},{key:"enable",value:function(){this.disable();var e=this.video;e&&(e.addEventListener("play",this._onPlay),e.addEventListener("pause",this._onPause),e.addEventListener("canplay",this._canPlay),e.addEventListener("progress",this._onProgress),e.addEventListener("ended",this._onEnded),this._timer=setTimeout(this._onTick,500))}},{key:"disable",value:function(){clearTimeout(this._timer),this.resetInfo();var e=this.video;e&&(e.removeEventListener("play",this._onPlay),e.removeEventListener("pause",this._onPause),e.removeEventListener("canplay",this._canPlay),e.removeEventListener("progress",this._onProgress),e.removeEventListener("ended",this._onEnded))}},{key:"endPlay",value:function(){if(this.video){var e=this.video.buffered;if(e.length)try{this._info.endBufferTime=e.end(e.length-1)}catch(e){}this._info.leaveWithBlock=this.isStalling,this._calcPausedTime(),this._calcStallTime(),!this._info.downloadDuration&&this._info.canPlayTime&&(this._info.downloadDuration=(Date.now()-this._info.canPlayTime)/1e3)}}},{key:"getInfo",value:function(){return this._info}},{key:"resetInfo",value:function(){this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this._info={pausedTime:0,stalledTime:0,downloadDuration:0,startBufferTime:0,endBufferTime:0,canPlayTime:0,leaveWithBlock:!1}}},{key:"destroy",value:function(){this.disable(),this.video=null}},{key:"_calcStallTime",value:function(){this._prevStallTime&&(this._info.stalledTime+=(Date.now()-this._prevStallTime)/1e3,this._prevStallTime=0)}},{key:"_calcPausedTime",value:function(){this._prevPauseTime&&(this._info.pausedTime+=(Date.now()-this._prevPauseTime)/1e3,this._prevPauseTime=0)}}]),e}(),L=new(function(){function e(t){a(this,e),this._queue=[],this._current={},this.setConfig(t)}return s(e,[{key:"setConfig",value:function(e){this._config=Object.assign({},e)}},{key:"setCurrent",value:function(e){Object.assign(this._current,e)}},{key:"getCurrent",value:function(){return this._current}},{key:"resetCurrent",value:function(){this._current={}}},{key:"calcAndReset",value:function(){var e=this._current,t=e.startBufferTime,i=e.duration,r=e.endBufferTime,n=e.leaveWithBlock,a=e.stalledTime,o=e.pausedTime,s=e.downloadDuration,l=e.bitrate;if(i&&l&&r){var d=this._config,c=d.paramBf,u=d.paramBp,h=d.paramUpperBl,f=d.paramUpper,m=d.slidingWindowWeight,p=d.slidingWindowType,b=d.slidingWindowWeightThreshold,y=d.slidingWindowCountThreshold,g=1+((r-t)*c-(a+o)*u)/s;n&&(g=Math.min(g,h));var v,Z=l*Math.max(f,g);if(v="time"===m?Math.min(s,i+a):Math.min(s,i)*l,this._queue.push([Z,v,this._current]),"by_weight"===p){this._queue=this._queue.slice(-30);for(var T=this._queue.reduce((function(e,t){return e+t[1]}),0)-b;T>0;){var L=this._queue.shift();if(!L)break;if(L[1]>T){L[1]-=T,this._queue.unshift(L);break}T-=L[1]}}else this._queue=this._queue.slice(-y);this.resetCurrent()}else this.resetCurrent()}},{key:"getDefaultBitrate",value:function(e){if(!e||0===e.length)return 0;for(var t=this._config.defaultTargetBitrate||1e6,i=0,r=0;r<e.length;r++)e[r].bitrate<=t&&e[r].bitrate>=i&&(i=e[r].bitrate);return i||(i=e[e.length-1].bitrate),i}},{key:"getTargetBitrate",value:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.duration;if(!this._queue.length||!t)return 0;var i=this._config,r=i.paramVlLower,n=i.paramVlUpper,a=i.paramVl1,o=i.paramVl2,s=i.bitrateLower,l=i.bitrateUpper,d=i.slidingWindowExtraction,c=0,u=this._queue.reduce((function(e,t){return e+t[1]}),0);if("weighted_median"===d){var h=u/2,f=1/0,m=0;this._queue.forEach((function(e){(m=Math.abs(h-e[1]))<f&&(c=e[0],f=m)}))}else c=this._queue.reduce((function(e,t){return e+t[1]/u*t[0]}),0);var p=Math.min(n,Math.max(r,a+o/t));return Math.max(s,Math.min(l,c*p))}}]),e}()),S=function(){function e(t,i){var r=this;a(this,e),l(this,"_onEnded",(function(){r._updateInfo()})),l(this,"_onPlayNext",(function(){r._updateInfo()})),this._rule=L,this._player=t,t&&(this._playingInfo=new T(t.video)),this._bindEvent(),L.setConfig(i),this._selectAlgType=i.selectAlgType}return s(e,[{key:"select",value:function(e,t,i){if(e.length){var r,a=e[0].duration||0;1===e.length&&(r=e[0]);var o=0;return r||((r=(o=L.getTargetBitrate(n({},t),{duration:a}))?(0,g.v2)(e,o,t.selectAlgType):e[0]).targetBitrate=o),L.resetCurrent(),L.setCurrent({bitrate:r.bitrate,duration:a}),this._playingInfo&&this._playingInfo.enable(),r}}},{key:"getTargetBitrate",value:function(e,t){return L.getTargetBitrate(e,t)}},{key:"_bindEvent",value:function(){if(!this._player)return this._player;this._player.on("ended",this._onEnded),this._player.on("playnext",this._onPlayNext)}},{key:"destroy",value:function(){this._endPlay(),this._player&&(this._playingInfo.destroy(),this._player.off("ended",this._onEnded),this._player.off("playnext",this._onPlayNext))}},{key:"_updateInfo",value:function(){this._playingInfo.endPlay();var e=this._playingInfo.getInfo();this._playingInfo.resetInfo(),L.setCurrent({downloadDuration:e.downloadDuration||L.getCurrent().duration,startBufferTime:e.startBufferTime,endBufferTime:e.endBufferTime,pausedTime:e.pausedTime,stalledTime:e.stalledTime,leaveWithBlock:e.leaveWithBlock}),this._prevPlayInfo=L.getCurrent(),L.calcAndReset()}},{key:"_endPlay",value:function(){this._updateInfo(),this._playingInfo.disable()}}]),e}(),x=function(){function e(t){a(this,e),this.config=n(n({},{defaultBitrate:1e6,autoBitrateParams:{paramA:0,paramB:1.537664e-8,paramC:.470864,paramD:128e3,minBitrate:2e5}}),t)}return s(e,[{key:"select",value:function(e,t,i){var r=this.getTargetBitrate(t,i)||0,n=(0,g.v2)(e,r,t.selectAlgType);return(0,g.cM)("BandWidthSelector>select after",t.selectAlgType,e.length,r,n),n||(n=e[e.length-1]),n.targetBitrate=r,n}},{key:"getTargetBitrate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.defaultBitrate,r=e.autoBitrateParams,a=r||{},o=n(n({},this.config.autoBitrateParams),a),s=t.bandwidth,l=o.paramA,d=o.paramB,c=o.paramC,u=o.paramD,h=e.defaultBitrate||i,f=s<=0||!s?h:parseInt(l*Math.pow(s,3)+d*Math.pow(s,2)+c*s+u,10);return parseInt(f,10)}}],[{key:"defaultConfig",get:function(){return{defaultBitrate:1e6,autoBitrateParams:{paramA:0,paramB:1.537664e-8,paramC:.470864,paramD:128e3,minBitrate:2e5}}}}]),e}(),k=function(){function e(t){a(this,e),this.config=t}return s(e,[{key:"select",value:function(e,t,i){var r=this.getTargetBitrate(t,i);(0,g.cM)("MixBufferBandwidth>select",r);var n=(0,g.v2)(e,r,t.selectAlgType);return n||(n=e[e.length-1]),n.targetBitrate=r,n}},{key:"getTargetBitrate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.bTargetBuffer,r=t.bTargetBandWidth,n=t.bandwidth,a=e.mixFactor||this.config.mixFactor,o=i;return!n||n<0?o:o=a>=0&&a<=1?r*a+i*(1-a):a>1?Math.max(r,i):Math.min(r,i)}}]),e}(),I=i(31914),X={BANDWIDTH:"bandwidth",BUFFER_INFO:"buffer-info",BUFFER_INFO1:"buffer-info1",BANDWIDTH_BUFFER:"bandwidth-buffer",BANDWIDTH_BUFFER1:"bandwidth-buffer1"};function R(){return{paramBf:.3,paramBp:.5,paramUpper:1.5,paramLower:.6,paramUpperBl:.7,paramVl1:.7,paramVl2:1e3,paramVlUpper:.9,paramVlLower:.8,bitrateUpper:2e6,bitrateLower:2e5,slidingWindowType:"by_weight",slidingWindowWeight:"size",slidingWindowWeightThreshold:3e5,slidingWindowCountThreshold:30,slidingWindowExtraction:"weighted_median",bitrateRange:[1e3,25e7],defaultBitrate:1e6,autoBitrateParams:{paramA:0,paramB:1.537664e-8,paramC:.470864,paramD:128e3,minBitrate:2e5},selectAlgType:0,mixFactor:1,multiFactors:[],mode:X.BANDWIDTH}}var w=[],G="[PlayingInfo]",W=function(){function e(t){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),l(this,"_onPlay",(function(){i._calcPausedTime()})),l(this,"_onPause",(function(){i._prevPauseTime=Date.now()})),l(this,"_onEnded",(function(){!i._info.downloadDuration&&i._info.canPlayTime&&(i._info.downloadDuration=parseInt(Date.now()-i._info.canPlayTime,10)/1e3),i.endPlay(),i.disable()})),l(this,"_canPlay",(function(){i._info.canPlayTime=Date.now(),i._info.duration=i.video.duration;var e=i.video.buffered;e.length&&(i._info.startBufferTime=e.end(e.length-1))})),l(this,"_onProgress",(function(){var e=i.video.buffered;i._info.canPlayTime&&e.length&&e.end(e.length-1)+.8>i.video.duration&&(i._info.downloadDuration=parseInt(Date.now()-i._info.canPlayTime,10)/1e3)})),l(this,"_onTick",(function(){var e=i.video;if(e){i._timer=setTimeout(i._onTick,500);var t=e.currentTime;!e.paused||e.ended||0===e.playbackRate||0===e.readyState?(i._prevCurrentTime===t?i._prevStallTime||(i._prevStallTime=Date.now()):i._calcStallTime(),i._prevCurrentTime=t):i._prevCurrentTime=t}})),this.video=t,this._videoId=t.getAttribute("data-xgplayerid")||(new Date).getTime(),this._timer=null,this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this.resetInfo(),this.enable(),r&&r.bitrate&&(this.bitrate=r.bitrate)}return s(e,[{key:"isStalling",get:function(){return!!this._prevStallTime}},{key:"bitrate",set:function(e){this._info.bitrate=e}},{key:"enable",value:function(){this.disable();var e=this.video;e&&(e.addEventListener("play",this._onPlay),e.addEventListener("pause",this._onPause),e.addEventListener("loadeddata",this._canPlay),e.addEventListener("progress",this._onProgress),e.addEventListener("ended",this._onEnded),this._timer=setTimeout(this._onTick,500))}},{key:"disable",value:function(){clearTimeout(this._timer),this.resetInfo();var e=this.video;e&&(e.removeEventListener("play",this._onPlay),e.removeEventListener("pause",this._onPause),e.removeEventListener("loadeddata",this._canPlay),e.removeEventListener("progress",this._onProgress),e.removeEventListener("ended",this._onEnded))}},{key:"endPlay",value:function(){if(this.video){var e=this.video.buffered;if(e.length)try{this._info.endBufferTime=e.end(e.length-1)}catch(e){}this._info.leaveWithBlock=this.isStalling,this._calcPausedTime(),this._calcStallTime(),!this._info.downloadDuration&&this._info.canPlayTime&&(this._info.downloadDuration=parseInt(Date.now()-this._info.canPlayTime,10)/1e3),!this._info.downloadDuration&&this._info.canPlayTime&&(this._info.downloadDuration=parseInt(Date.now()-this._info.canPlayTime,10)/1e3),this.updateRuleByPlayInfo()}}},{key:"updateRuleByPlayInfo",value:function(){var e=this.getInfo(),t=y();(0,g.cM)(G,"updateRuleByPlayInfo",e,e.bitrate,"stalledTime",e.stalledTime),t.appendPlayInfo({duration:e.duration,bitrate:e.bitrate,downloadDuration:e.downloadDuration,startBufferTime:e.startBufferTime,endBufferTime:e.endBufferTime,pausedTime:e.pausedTime,stalledTime:e.stalledTime,leaveWithBlock:e.leaveWithBlock})}},{key:"getInfo",value:function(){return this._info}},{key:"resetInfo",value:function(){this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this._info={duration:0,pausedTime:0,stalledTime:0,downloadDuration:0,startBufferTime:0,endBufferTime:0,canPlayTime:0,leaveWithBlock:!1,bitrate:0}}},{key:"destroy",value:function(){this.endPlay(),this.disable(),this.video=null}},{key:"_calcStallTime",value:function(){this._prevStallTime&&(this._info.stalledTime+=parseInt(Date.now()-this._prevStallTime,10)/1e3,this._prevStallTime=0)}},{key:"_calcPausedTime",value:function(){this._prevPauseTime&&(this._info.pausedTime+=parseInt(Date.now()-this._prevPauseTime,10)/1e3,this._prevPauseTime=0)}}],[{key:"videoInfoList",get:function(){return w}},{key:"checkIsInList",value:function(e){for(var t=0;t<w.length;t++)if(w[t].video===e)return t;return-1}},{key:"attachVideo",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){var r=e.checkIsInList(t);(0,g.cM)(G,"attachVideo",r),r<0?w.push({video:t,playInfo:new e(t,i)}):i.bitrate&&(w[r].playInfo.bitrate=i.bitrate)}}},{key:"detachVideo",value:function(t){if(t){var i=e.checkIsInList(t);if((0,g.cM)(G,"detachVideo",i),i>=0){var r=w.splice(i,1);r.length>0&&r[0].playInfo.destroy()}}}}]),e}(),E=function(){function e(t,i){var r=this;a(this,e),this.config=R();var n=t.config||{},o=t.extOptions;Object.keys(n).map((function(e){r.config[e]=n[e]})),this.config=this.updateParamsByFactor(this.config,o),this._selectorMap={},this._selectorMap[X.BANDWIDTH]=new x(this.config),this._selectorMap[X.BUFFER_INFO]=new S(i,this.config),this._selectorMap[X.BANDWIDTH_BUFFER]=new k(this.config),this._selectorMap[X.BUFFER_INFO1]=new Z(this.config)}return s(e,[{key:"updateParamsByFactor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.core=g.ZP.hardwareConcurrency,t.memory=g.ZP.deviceMemory;var i=this.config.multiFactors;return i&&i.length>0?(0,g.tg)(i,e,t):e}},{key:"select",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;t=t||this.config.mode;var a=this.updateParamsByFactor(this.config,r),o=a.bitrateRange,s=a.defaultBitrate,l=e.filter((function(e){return e.bitrate>=o[0]&&e.bitrate<=o[1]})).sort((function(e,t){return t.bitrate-e.bitrate}));if(!l.length){var d,c=1/0;e.forEach((function(e){var t=Math.abs(e.bitrate-s);t<c&&(d=e,c=t)})),d&&l.push(d)}var u=this._selectorMap[t]||this.selector,h=e.length>0?e[0].duration:0,f=n({duration:h,speed:I.Z.speed,bandwidth:I.Z.speed},i);if(t===X.BandwidthBuffer){var m=this.getMixTargetInfo(a,f);f.bBufferTarget=m.bBufferTarget,f.bBandWidthTarget=m.bBandWidthTarget}var p=u.select(l,a,f)||l[0];return(0,g.cM)("select",t,l,f,p.targetBitrate,p.bitrate,p.definition),p}},{key:"getTargetBitrate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=null,a=(e=e||this.config.mode)===X.BANDWIDTH_BUFFER||e===X.BANDWIDTH_BUFFER1;e&&this._selectorMap&&(r=a?this._selectorMap[X.BANDWIDTH_BUFFER]:this._selectorMap[e]),r||(r=this.selector);var o=this.updateParamsByFactor(this.config,i),s=n({speed:I.Z.speed,bandwidth:I.Z.speed},t);if(a){var l=this.getMixTargetInfo(o,s,e);s.bBufferTarget=l.bBufferTarget,s.bBandWidthTarget=l.bBandWidthTarget}return r.getTargetBitrate(o,s)}},{key:"getMixTargetInfo",value:function(e,t,i){return{bBufferTarget:(i===X.BANDWIDTH_BUFFER?this._selectorMap[X.BUFFER_INFO]:this._selectorMap[X.BUFFER_INFO1]).getTargetBitrate(e,t),bBandWidthTarget:this._selectorMap[X.BANDWIDTH].getTargetBitrate(e,t)}}},{key:"selector",get:function(){var e=this.config.mode;return this._selectorMap[e]||this._selectorMap[X.BANDWIDTH]}},{key:"addSelect",value:function(e,t){this._selectorMap[e||t.name]=t}},{key:"attachPlayer",value:function(e,t){var i=e.media||e.video||e;W.attachVideo(i,t)}},{key:"detachPlayer",value:function(e){var t=e.media||e.video||e;W.detachVideo(t)}},{key:"getVideoInfoList",value:function(){return W.videoInfoList}},{key:"getRule",value:function(){return y()}},{key:"destroy",value:function(){var e=this._selectorMap;Object.keys(e).forEach((function(t){"function"==typeof e[t].destroy&&e[t].destroy()}))}}],[{key:"defaultConfig",get:function(){return R()}}]),e}(),_=new(function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.config={size:30,severeBlockDuration:1500,slightBlockDuration:100,highBitrateRatio:1.5,lowBitrateRatio:.8,highLadderSelectedCnt:1,lowLadderSelectedCnt:1,blockSumMaxTime:6e5},Object.keys(i).map((function(e){t.config[e]=i[e]})),this.timerId=null,this.setTimer()}return s(e,[{key:"setConfig",value:function(e){var t=this;Object.keys(e).map((function(i){t.config[i]=e[i]}))}},{key:"resetCurrent",value:function(){this._info.currentBlockDur=0}},{key:"setTimer",value:function(){var e=this;this._blockQueue=[],this._tBQueue=[],this._sBQueue=[],this._hCount=0,this._lCount=0,this._info={blockDurationSum:0,currentBlockDur:0,targetBitrateAvg:0,selectedBitrateAvg:0,higherSelectedCnt:0,lowerSelectedCnt:0},this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.timerId=setTimeout((function(){e.setTimer()}),this.config.blockSumMaxTime)}},{key:"targetBitRate",set:function(e){if(e&&"number"==typeof e){this._tBQueue.push(parseInt(e,10)),this._tBQueue.length>this.config.size&&this._tBQueue.shift(0,1);var t=0;this._tBQueue.map((function(e){t+=e})),this._info.targetBitrateAvg=t/this._tBQueue.length}}},{key:"selectBitRate",set:function(e){if(e&&"number"==typeof e){this._sBQueue.push(e),this._sBQueue.length>this.config.size&&this._sBQueue.shift(0,1);var t=0;this._sBQueue.map((function(e){t+=e})),this._info.selectedBitrateAvg=t/this._sBQueue.length}}},{key:"blockDuration",set:function(e){this._blockQueue.push(e),this._blockQueue.length>this.config.size&&this._blockQueue.shift(0,1);var t=0;this._blockQueue.map((function(e){t+=e})),this._info.blockDurationSum=t}},{key:"currentBlockDur",set:function(e){this._info.currentBlockDur+=e}},{key:"updateBitRateInfo",value:function(e,t){e&&t&&(e>t?this._info.higherSelectedCnt++:e<t&&this._info.lowerSelectedCnt++)}},{key:"checkDefinition",value:function(){var e=this.config,t=this._info;return t.blockDurationSum>e.severeBlockDuration&&(t.selectedBitrateAvg>t.targetBitrateAvg*e.highBitrateRatio&&t.higherSelectedCnt>=e.highLadderSelectedCnt||t.currentBlockDur>e.severeBlockDuration)?1:t.blockDurationSum<e.slightBlockDuration&&t.selectedBitrateAvg<t.targetBitrateAvg*e.lowBitrateRatio&&t.lowerSelectedCnt>=e.lowLadderSelectedCnt?2:0}}]),e}())({}),C=null,P=R(),V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(o,e);var t,i,r=(t=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=d(t);if(i){var n=d(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return h(this,e)});function o(){var e;a(this,o);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return l(u(e=r.call.apply(r,[this].concat(i))),"_onXLog",(function(t){"waitingEnd"===t.eventType&&0===t.type&&(_.blockDuration=t.costTime,e.player.isUserActive&&(_.currentBlockDur=t.costTime))})),e}return s(o,[{key:"matchFactor",value:function(e,t,i){var r,n,a="Array"===m.ZP.typeOf(t)?t:[],o=!1;switch(e){case"core_cnt":i.core&&a.length>1&&i.core>=Number(a[0])&&i.core<=Number(a[1])&&(o=!0);break;case"memory":i.memory&&a.length>1&&i.memory>=Number(a[0])&&i.memory<=Number(a[1])&&(o=!0);break;case"video_screen_mode":a.length>0&&"landscape"===a[0]&&(r=i.videoHeight,n=i.videoWidth,r&&n&&n>r)&&(o=!0);break;case"encoder":a.length>0&&a[0]&&i.codecType&&a[0]===i.codecType&&(o=!0)}return o}},{key:"updateParamsByFactor",value:function(e){for(var t=this,i=this.playerConfig,r=i.codecType,n=i.videoHeight,a=i.videoWidth,o=0|window.navigator.deviceMemory,s=0|window.navigator.hardwareConcurrency,l=null,d={codecType:r,videoHeight:n,videoWidth:a,memory:o,core:s},c=0;c<e.length;c++){for(var u=e[c].factor||{},h=Object.keys(u),f=!0,m=0;m<h.length;m++)if(!this.matchFactor(h[m],u[h[m]],d)){f=!1;break}if(f){l=e[c].config;break}}l&&Object.keys(l).forEach((function(e){t.config[e]=l[e]}))}},{key:"getExtOptions",value:function(){var e=this.playerConfig;return{codecType:e.codecType,videoHeight:e.videoHeight,videoWidth:e.videoWidth}}},{key:"afterCreate",value:function(){var e=this.getExtOptions();this._bindEvent(),this.bitRateAdapter=new E({config:this.config,extOptions:e},this.player),C||(C=new E({config:this.config,extOptions:e})),_.setConfig(this.config.detectConfig||{}),_.resetCurrent(),this.curBitRate=this.getInitBitrate(),this.player.curDefinition=this.curBitRate,this.bitRateAdapter.attachPlayer(this.player,{bitrate:this.curBitRate.bitrate})}},{key:"beforePlayerInit",value:function(){this.curBitRate=this.getInitBitrate(),this.player.curDefinition=this.curBitRate,this.bitRateAdapter.attachPlayer(this.player,{bitrate:this.curBitRate.bitrate})}},{key:"_bindEvent",value:function(){this.on("xglog",this._onXLog)}},{key:"getInitBitrate",value:function(){if(!this.config.disabled){var e=this.player,t=this.config,i=this.playerConfig,r=this.getSuitableBitrate(e.definitionList,i.userSelectDefinition);return r?i.url=r.url:r={url:i.url,definition:i.defaultDefinition||t.definition,bitrate:i.defaultBitrate||i.bitrate,type:"default"},r.networkSpeed=e.speed,r}}},{key:"getSuitableBitrate",value:function(e,t){if(this.bitRateAdapter&&e&&!(e.length<1)){var i=this.config.mode,r=this.player,n=this.getExtOptions(),a={duration:e[0].duration||0,bandwidth:r.avgSpeed||r.speed||I.Z.speed},s=e.sort((function(e,t){return t.bitrate-e.bitrate})),l=this.getAdaptBitrate(s,i,a),d=this.bitRateAdapter.getTargetBitrate(i,a,n);if(d&&(_.targetBitRate=d),t){var c=o.getUserSelectBitrate(s,t);c&&(_.selectBitRate=c.bitrate,_.updateBitRateInfo(c.bitrate,d),l=c)}return l}}},{key:"getAdaptBitrate",value:function(e,t,i){if(!this.config.disabled){var r=this.player,a=null;t=t||this.config.mode;var o=this.getExtOptions();if(e&&e.length){var s=n({bandwidth:r.avgSpeed||r.speed||I.Z.speed,duration:e[0].duration},i);this.bitRateAdapter&&(this.bitRateAdapter.speed=r.avgSpeed||r.speed,a=this.bitRateAdapter.select(e,t,s,o))}return a&&(a.type="bitRateAdapter"),a}}},{key:"getDefinition",value:function(e,t,i){for(var r=-1,n=0;n<e.length;n++)e[n].bitrate===t&&(r=n);return-1===r?null:i&&e.length>r+1?e[r+1]:!i&&r-1>=0?e[r-1]:null}},{key:"needChangeDefinition",value:function(){var e=this.player,t=e.curDefinition,i=e.definitionList,r=this.playerConfig,n=r.userSelectDefinition,a=r.extDefinition,s=a&&a.length>0?a:i,l={type:0,message:"DO_NOT_UPDATE",targetDefinition:null};if(!n||s.length<2)return l;var d=t;n&&(d=o.getUserSelectBitrate(s,n));var c=_.checkDefinition();l.type=c;var u=this.getAdaptBitrate(s);if(u&&console.log("[BitrateAdapter] needChangeDefinition>>changeType: ".concat(c," targetDefinition"),u.definition,u.bitrate),!(u&&0!==c&&u&&u.bitrate&&d&&d.bitrate))return l.message="DO_NOT_UPDATE",l;var h=u.bitrate>=d.bitrate,f=u.bitrate<d.bitrate,m=null;switch(1===c?m=h?this.getDefinition(s,d.bitrate,!0):u:2===c&&(m=f?this.getDefinition(s,d.bitrate,!1):u),l.targetDefinition=m,l.targetDefinition&&l.targetDefinition.definition!==n||(l.type=0),l.type){case 1:l.message="NEED_TO_REDUCE_BITRATE";break;case 2:l.message="CAN_UPGRADE_BITRATE";break;default:l.message="DO_NOT_UPDATE"}return l}},{key:"detectDefInfo",get:function(){return _}},{key:"destroy",value:function(){this.bitRateAdapter&&(this.bitRateAdapter.detachPlayer(this.player),this.bitRateAdapter.destroy(),this.bitRateAdapter=null),this.off("xglog",this._onXLog),_&&_.resetCurrent()}}],[{key:"pluginName",get:function(){return"BitrateSelector"}},{key:"defaultConfig",get:function(){return R()},set:function(e){Object.keys(e).forEach((function(t){P[t]=e[t]}))}},{key:"getSuitableBitrate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e&&!(e.length<1)){var s=e.sort((function(e,t){return t.bitrate-e.bitrate})),l=null,d=Object.assign(i,P),c=n({},a),u={speed:r||I.Z.speed,bandwidth:r||I.Z.speed,duration:s[0].duration};C||(C=new E({config:d,extOptions:c})),s&&s.length&&C&&(l=C.select(s,d.mode,u,c)),l&&(l.type="bitRateAdapter");var h=C?C.getTargetBitrate(d.mode,u,c):null;if(h&&(_.targetBitRate=h),t){var f=o.getUserSelectBitrate(s,t);f&&(_.selectBitRate=f.bitrate,_.updateBitRateInfo(f.bitrate,h),l=f)}return l}}},{key:"getUserSelectBitrate",value:function(e,t){if(t&&e&&e.length>0){for(var i=null,r=null,n=0;n<e.length;n++){if(t===e[n].definition){i=e[n];break}!r&&t<e[n].definition&&(r=e[n])}return i||(i=r||e[e.length-1]),i.type="userSelect",i}return null}}]),o}(p.ZP)},31914:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n}),i(3495),i(94609),i(82584);var r=i(85634),n={maxQueueCapacity:20,mSpeedRecordValidThreshold:1,netRecords:[],weightedSpeedKB:0,weightedSpeed:0,speed:0,realTimeSpeed:0,getWeightedSpeed:function(){var e=-1;if(this.netRecords.length<this.mSpeedRecordValidThreshold)return e;var t=[];this.netRecords.forEach((function(e){t.push(e)})),t.sort((function(e,t){return e.mSpeed-t.mSpeed}));for(var i=t.length,r=0,n=0;n<i;n++)r+=t[n].mBytes;r/=2;for(var a=0;a<i;a++)(r-=t[a].mBytes)<=0&&(e=t[a].mSpeed);return e<0?-1:e},getAvgSpeed:function(){var e=0;return this.netRecords.forEach((function(t){e+=t.mSpeed})),parseInt(e/this.netRecords.length,10)},netSpeedSampling:function(e){this.netRecords.push(e),this.netRecords.length>this.maxQueueCapacity&&this.netRecords.shift(0),this.weightedSpeed=this.getWeightedSpeed(),this.weightedSpeedKB=this.weightedSpeed/8,this.realTimeSpeed=e.mSpeed,this.speed=this.getAvgSpeed(),(0,r.cM)("NetSpeedRecord> netSpeedSampling","weightedSpeed",this.weightedSpeed,"mSpeed",e.mSpeed,"speed",this.speed,e)}}},85634:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>r,v2:()=>s,cM:()=>n,tg:()=>d}),i(29832),i(71339),i(48612),i(3495),i(94609),i(14643),i(91170);var r={debugger:!1};function n(e){for(var t,i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];r.debugger&&(t=console).log.apply(t,["[LOG_BitrateSelector] ".concat(e)].concat(n))}function a(e,t){if(!e)return null;var i,r=1/0;return e.forEach((function(e){var n=Math.abs(e.bitrate-t);r>n&&(i=e,r=n)})),i||null}function o(e,t){if(!e)return null;for(var i=-1,r=1/0,n=-1,a=0;a<e.length;a++)(n=e[a].bitrate-t)>0&&n<r&&(r=n,i=a);return i<0?null:e[i]}function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return i?1===i?o(e,t):void 0:a(e,t)}function l(e,t,i){var n,a,o="Array"===r.typeOf(t)?t:[],s=!1;switch(e){case"core_cnt":i.core&&o.length>1&&i.core>=Number(o[0])&&i.core<=Number(o[1])&&(s=!0);break;case"memory":i.memory&&o.length>1&&i.memory>=Number(o[0])&&i.memory<=Number(o[1])&&(s=!0);break;case"video_screen_mode":o.length>0&&"landscape"===o[0]&&(n=i.videoHeight,a=i.videoWidth,n&&a&&a>n)&&(s=!0);break;case"encoder":o.length>0&&o[0]&&i.codecType&&o[0]===i.codecType&&(s=!0)}return s}function d(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null,n=0;n<e.length;n++){for(var a=e[n].factor||{},o=Object.keys(a),s=!0,d=0;d<o.length;d++)if(!l(o[d],a[o[d]],i)){s=!1;break}if(s){r=e[n].config;break}}return r&&Object.keys(r).forEach((function(e){t[e]=r[e]})),t}r.isBrowser="undefined"!=typeof window&&void 0!==window.navigator,r.hardwareConcurrency=r.isBrowser?0|window.navigator.hardwareConcurrency:0,r.deviceMemory=r.isBrowser?0|window.navigator.deviceMemory:0}}]);