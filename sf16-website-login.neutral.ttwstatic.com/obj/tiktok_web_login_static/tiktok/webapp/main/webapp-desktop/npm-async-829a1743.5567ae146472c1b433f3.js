/*! For license information please see npm-async-829a1743.5567ae146472c1b433f3.js.LICENSE.txt */
"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7939],{68880:(e,t,n)=>{n.d(t,{Z:()=>Re});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},s=function(){return s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function a(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function c(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}var l=function(e){function t(t,n,i){var o=e.call(this,n)||this;return o.code=t,o.message=n,o.originError=i,o.name="StarlingError",o.code=t,o.message=n,o.originError=i,Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),u={ERROR_CODE:103,ERROR_MESSAGE:"Request failed, confirm your apiKey and namespace is correct"},p={ERROR_CODE:110,ERROR_MESSAGE:"Check your params, parameter apiKey, namespace and zoneHost is required!"},h={ERROR_CODE:111,ERROR_MESSAGE:"Check your params, parameter request and store is required!"},f=112,d={ERROR_CODE:120,ERROR_MESSAGE:"Version is not found, please check your param [version]!"},g={zone:"CN",locale:"zh",timeout:15e3,test:!1,mode:"normal",format:"merged",lazyUpdate:!1,fallbackLang:["zh"],tracker:function(){},cache:!0},_=function(){function e(e){this.options=e,this.options=e}return e.prototype.getText=function(e,t){return a(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,this._request(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.getTexts=function(e){var t=this;return Promise.all(e.map((function(e){var n=e[0],i=e[1];return t.getText(n,i)})))},e.prototype._request=function(e,t){return a(this,void 0,void 0,(function(){var n,i,o,r,s,a,p,h,f,g,_,m,y,v;return c(this,(function(c){switch(c.label){case 0:return n=this.options.getReleaseVersion,i=n(e),e&&i&&t?[2,{}]:(o=this.getUrl(e,t),r=this.options,s=r.request,a=r.timeout,[4,s(o,{timeout:a})]);case 1:if(p=c.sent(),h=p.data,f=h.status,g=h.message,200==+f)return[2,this._mapResponse(g)];if(1001==+f)throw m=(_=d).ERROR_CODE,new l(m,_.ERROR_MESSAGE);throw v=(y=u).ERROR_CODE,new l(v,y.ERROR_MESSAGE)}}))}))},e.prototype.getUrl=function(e,t){var n=this.options,i=n.apiKey,o=n.locale,r=n.fallbackLang,s=n.zoneHost,a=n.mode,c=n.getReleaseVersion,l=[o].concat(r),u=s+"/check_and_get_text/"+i+"/"+a+"/"+e+"?lang="+l,p=c(e);return p&&(u=s+"/text_by_release_version/"+i+"/"+a+"/"+e+"/"+p+"?lang="+l),"string"==typeof t&&(u+="&version="+t),u},e.prototype._mapResponse=function(e){return e?Object.keys(e).reduce((function(t,n){return t[n.toLowerCase()]=e[n],t}),{}):{}},e}(),m=function(){function e(e){this.options=e,this.options=e}return e.prototype._setCache=function(e,t){try{return this.options.store.set(e,t)}catch(e){var n=f;return void this.options.tracker("cache_error",{code:n,message:e.message,stack:e.stack})}},e.prototype._getCache=function(e){var t=this.options,n=t.store,i=t.cache;try{return i&&n.get(e)}catch(e){var o=f;return void this.options.tracker("cache_error",{code:o,message:e.message,stack:e.stack})}},e.prototype.getVersion=function(e){var t=this.options,n="version."+t.apiKey+"."+e+"."+t.locale,i=(0,t.getReleaseVersion)(e);return i&&(n+="."+i),this.getText(e)?this._getCache(n):null},e.prototype.getVersions=function(e){var t=this;return Promise.all(e.map((function(e){return t.getVersion(e)})))},e.prototype.getText=function(e){var t=this.options,n="text."+t.apiKey+"."+e+"."+t.locale,i=(0,t.getReleaseVersion)(e);return i&&(n+="."+i),this._getCache(n)},e.prototype.getTexts=function(e){var t=this;return Promise.all(e.map((function(e){return t.getText(e)})))},e.prototype.refresh=function(e,t,n,i){return a(this,void 0,void 0,(function(){var o,r,s,a,l,u=this;return c(this,(function(c){switch(c.label){case 0:return o=this.options,r=o.apiKey,s=o.getReleaseVersion,a=o.cache,l=[],t.forEach((function(o,c){var p="text."+r+"."+e[c]+"."+i[c],h="version."+r+"."+e[c]+"."+i[c],f=s(e[c]);f&&(p+="."+f,h+="."+f),a&&(l.push(u._setCache(p,t[c])),l.push(u._setCache(h,n[c])))})),[4,Promise.all(l)];case 1:return c.sent(),[2,t.reduce((function(e,t){return Object.assign(e,t)}),{})]}}))}))},e}(),y=function(){function e(e){void 0===e&&(e=[]),this._list=[],this._list=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.getList=function(){return this._list},e.prototype.getNamespaces=function(){return this._list.map((function(e){return e.namespace}))},e.prototype.addNamespace=function(e){this._list.push(e)},e.prototype.insertTexts=function(e){this._list.forEach((function(t,n){t.texts=e[n]}))},e.prototype.sortByPrior=function(){return this._list.sort((function(e,t){return e.prior-t.prior})),this._list},e.prototype.concat=function(t){return new e(this._list.concat(t.getList()))},e}(),v=function(){function e(e,t,n){this._promiseRefresh=Promise.resolve(null),this.remote=e,this.local=t,this.options=n}return e.prototype._checkVersions=function(e){return a(this,void 0,void 0,(function(){var t,n,i,o,r,s;return c(this,(function(a){switch(a.label){case 0:return t=this.options.locale,[4,this.local.getVersions(e)];case 1:return n=a.sent(),i=e.map((function(e,t){return[e,n[t]]})),[4,this.remote.getTexts(i)];case 2:return o=a.sent(),r=new y,s=new y,e.forEach((function(e,i){var a=o[i],c=a.updated,l=a.version,u=a.data,p=a.lang;c?s.addNamespace({namespace:e,prior:i,version:l,texts:u,lang:p}):r.addNamespace({namespace:e,prior:i,version:n[i],lang:t})})),[2,{equalNs:r,diffNs:s}]}}))}))},e.prototype.waitForRefresh=function(){return this._promiseRefresh},e.prototype._refresh=function(e){var t=e.getList(),n=[],i=[],o=[],r=[];return t.forEach((function(e){n.push(e.namespace),i.push(e.version),o.push(e.texts),r.push(e.lang)})),this.local.refresh(n,o,i,r)},e.prototype._getLocalTexts=function(e){return a(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,this.local.getTexts(e.getNamespaces())];case 1:return t=n.sent(),e.insertTexts(t),[2,t]}}))}))},e.prototype.load=function(e){return a(this,void 0,void 0,(function(){var t,n,i,o,r;return c(this,(function(s){switch(s.label){case 0:return t=this.options.format,[4,this._checkVersions(e)];case 1:return n=s.sent(),i=n.equalNs,o=n.diffNs,i.length?[4,this._getLocalTexts(i)]:[3,3];case 2:return s.sent(),[3,4];case 3:s.label=4;case 4:return r=this._formatTexts(t,o.concat(i)),o.length?[4,this._refresh(o)]:[3,6];case 5:s.sent(),s.label=6;case 6:return[2,{texts:r,diffNs:o.getNamespaces(),equalNs:i.getNamespaces()}]}}))}))},e.prototype._getCacheText=function(e){return a(this,void 0,void 0,(function(){var t,n,i,o,r,s,a;return c(this,(function(c){switch(c.label){case 0:return t=this.options,n=t.locale,i=t.format,[4,this.local.getTexts(e)];case 1:return o=c.sent(),[4,this.local.getVersions(e)];case 2:return r=c.sent(),s=o.map((function(t,i){if(t)return{namespace:e[i],version:r[i],lang:n,texts:t}})).filter((function(e){return!!e})),a=new y(s),[2,this._formatTexts(i,a)]}}))}))},e.prototype.lazyLoad=function(e){return a(this,void 0,void 0,(function(){var t,n,i;return c(this,(function(o){switch(o.label){case 0:return[4,this._getCacheText(e)];case 1:return t=o.sent(),n=0===Object.keys(t).length,this._promiseRefresh=this.load(e),n?[4,this._promiseRefresh]:[3,3];case 2:i=o.sent(),t=i.texts,o.label=3;case 3:return[2,{texts:t,diffNs:n?i&&i.diffNs:[],equalNs:n?i&&i.equalNs:e}]}}))}))},e.prototype._formatTexts=function(e,t){if("splitted"===e)return t.getList().reduce((function(e,t){var n=t.namespace,i=t.lang,o=t.texts,r=t.version;return e[n]={lang:i,texts:o,version:r},e}),{});var n=t.sortByPrior().map((function(e){return e.texts}));return n.reduce((function(e,t){return Object.assign(e,t)}),{})},e}();"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},writable:!0,configurable:!0});var b,E="client_load";!function(e){e.AfterLoad="afterLoad"}(b||(b={}));var S=function(){function e(e){this.afterLoadPlugins=[],this.setConfig(e)}return e.prototype._init=function(e){var t=this;this.options=function(e){var t=(e=Object.assign({},g,e)).namespace,n=e.apiKey,i=e.request,o=e.store,r=e.zoneHost;if(e.test&&(e.mode="test"),e.namespace=t=t?Array.isArray(t)?t:[t]:[],e.apiKey=n=n||e.api_key,!i||!o){var s=h.ERROR_CODE,a=h.ERROR_MESSAGE;throw new l(s,a,null)}if(!n||!t.length||!r){throw new l(s=p.ERROR_CODE,a=p.ERROR_MESSAGE,null)}return e}(e);var n=this.options,i=n.apiKey,o=n.locale,r=n.zoneHost,a=n.request,c=n.timeout,u=n.fallbackLang,f=n.store,d=n.lazyUpdate,y=n.test,b=n.mode,E=n.format,S=n.cache,w={mode:d?"lazy":y?"test":"prod",zone:r,locale:o,apiKey:i};this._tracker=function(e,n){try{t.options.tracker(e,s(s({},w),n))}catch(e){console.log(e)}};var k=this._getReleaseVersionByNamespace.bind(this),z=new _({request:a,timeout:c,apiKey:i,locale:o,zoneHost:r,fallbackLang:u,mode:b,getReleaseVersion:k}),D=new m({apiKey:i,locale:o,store:f,tracker:this._tracker,getReleaseVersion:k,cache:S});this._textManager=new v(z,D,{locale:o,format:E}),this.initPlugin()},e.prototype.initPlugin=function(){var e=this,t=this.options.plugins||[];Array.isArray(t)&&t.every((function(e){return"object"==typeof e}))&&t.forEach((function(t){t.type===b.AfterLoad&&e.afterLoadPlugins.push(t)}))},e.prototype._getReleaseVersionByNamespace=function(e){var t=this.options.namespace,n=this.options.version,i=null;if(Array.isArray(n)){var o=t.findIndex((function(t){return t===e}));i=n[o]}else n&&"object"==typeof n?i=n[e]:"string"==typeof n&&(i=n);return i},e.prototype.setConfig=function(e){var t=Object.assign({},this.options,e);this._init(t)},e.prototype.waitForRefresh=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return[4,this._textManager.waitForRefresh()];case 1:return[2,(e=t.sent())?e.texts:null]}}))}))},e.prototype._load=function(){return a(this,void 0,void 0,(function(){var e,t,n,i,o;return c(this,(function(r){switch(r.label){case 0:return e=this.options,t=e.namespace,n=e.lazyUpdate,i=t,n?[4,this._textManager.lazyLoad(i)]:[3,2];case 1:return o=r.sent(),[3,4];case 2:return[4,this._textManager.load(i)];case 3:o=r.sent(),r.label=4;case 4:return[2,o]}}))}))},e.prototype.load=function(e,t){return a(this,void 0,void 0,(function(){var n,i,o,r,s,a,l,u,p,h,f,d,g,_,m=this;return c(this,(function(c){switch(c.label){case 0:n=Date.now(),i=this.options.namespace,c.label=1;case 1:return c.trys.push([1,5,,10]),this._tracker(E,{state:"start",version:"0.5.9"}),[4,this._load()];case 2:return o=c.sent(),r=o.diffNs,s=o.equalNs,a=o.texts,l=this.afterLoadPlugins,Array.isArray(l)&&l.length?[4,l.reduce((function(e,t){return e.then((function(e){return"function"==typeof t.process?t.process(e||a,m.options):e}))}),Promise.resolve(a))]:[3,4];case 3:u=c.sent(),a=u||a,c.label=4;case 4:return e&&e(a),this._tracker("client_load_time",{time:Date.now()-n}),this._tracker(E,{state:"success",version:"0.5.9"}),p=r.length,h=s.length,f=i.length,d=(h/f).toFixed(2),this._tracker("client_cache",{diffLen:p,diff:r.join(","),equalLen:h,equal:s.join(","),namespaces:s.join(","),namespacesLen:f,ratio:d}),[2,a];case 5:if(g=c.sent(),this._tracker(E,{state:"fail"}),this._tracker("client_exception",{code:g.code,message:g.message,stack:g.stack}),!(g||{}).useWebCache)return[3,9];c.label=6;case 6:return c.trys.push([6,8,,9]),[4,this._textManager._getCacheText(i)];case 7:return _=c.sent(),g.response.data=_&&"object"==typeof _?_:{},[3,9];case 8:return c.sent(),[3,9];case 9:return t?(t(g),[3,10]):[2,Promise.reject(g)];case 10:return[2]}}))}))},e}(),w=new(function(){function e(){}return e.prototype.get=function(e){if(localStorage&&localStorage.getItem)return function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}}(localStorage.getItem(e))},e.prototype.set=function(e,t){localStorage&&localStorage.setItem&&localStorage.setItem(e,function(e){return JSON.stringify(e)}(t))},e}()),k=function(e){function t(t,n,i,o,r,s){var a=e.call(this,t)||this;return a.url=n,a.code=i,a.request=o,a.response=r,a.useWebCache=s,a.url=n,a.code=i,a.request=o,a.response=r,a.useWebCache=!!s,a}return o(t,e),t}(Error);function z(e,t){var n=t.timeout;return new Promise((function(t,i){var o=new XMLHttpRequest;o.open("GET",e),o.withCredentials=!1,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var n=function(e){try{return JSON.parse(e)}catch(e){return{}}}(o.responseText),r=function(e){return e.message&&"object"==typeof e.message?e:null}(n);if(o.status<200||o.status>=300||!r)return function(e,t,n,i){var o=(i||{}).message||"";o=o?", reason is: ".concat(o):"",t(new k("Request failed with status code "+e.status+o,n,null,e,{data:{}},!0))}(o,i,e,n),void(o=null);var s={data:r,status:o.status,statusText:o.statusText,request:o};t(s),o=null}},o.onerror=function(){i(new k("Network Error",e,null,o,{data:{}},!0)),o=null},o.timeout=n,o.ontimeout=function(){i(new k("timeout of "+n+"ms exceeded",e,"ECONNABORTED",o)),o=null},o.send()}))}var D=function(e){function t(t){return t.store||(t.store=w),t.request||(t.request=z),e.call(this,t)||this}return o(t,e),t}(S),R=function(){return(R=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function A(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function G(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(A(arguments[t]));return e}var O,M,T,I,x=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,(function i(o){t(o),n.off(e,i)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,n){if(n){if(!e)return;-1!==this._cache.indexOf(n)?this._emit(e,t):(this._hooksCache.hasOwnProperty(n)||(this._hooksCache[n]={}),this._hooksCache[n].hasOwnProperty(e)||(this._hooksCache[n][e]=[]),this._hooksCache[n][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&G(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),C=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},B=(O=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return O+=1}),P=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var i,o=[];n=n<=25?n:n%25;var r=String.fromCharCode(n+97);i=e.split(r);for(var s=0;s<i.length;s++){var a=parseInt(i[s],n);a=1*a^64;var c=String.fromCharCode(a);o.push(c)}return o.join("")}}(e,0,25)},U=function(e){var t=document.createElement("a");return t.href=e,t},N=function(e){var t={};try{var n=U(e).search;(n=n.slice(1)).split("&").forEach((function(e){var n,i,o=e.split("=");o.length&&(n=o[0],i=o[1]);try{t[n]=decodeURIComponent(void 0===i?"":i)}catch(e){t[n]=i}}))}catch(e){}return t},j=function(e){for(var t=0,n=0,i=(e+="").length,o=0;o<i;o++)((t=31*t+e.charCodeAt(n++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},L=(function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function o(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,!0!==r[c]&&(a+="="+r[c].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var a=r[s].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(a[0]);if(c=(i.read||i)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[l]=c,e===l)break}catch(e){}}return e?o[e]:o}}return o.set=r,o.get=function(e){return s(e,!1)},o.getJSON=function(e){return s(e,!0)},o.remove=function(t,n){r(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},e.exports=n()}(M={exports:{}}),M.exports),K=function(e,t){try{return L.get(e,{domain:t||document.domain})}catch(e){return""}},V=function(e,t,n,i){try{var o=i||document.domain,r=+new Date+(n||6048e5);L.set(e,t,{expires:new Date(r),path:"/",domain:o})}catch(e){}},q=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return K(e,t)},e.prototype.setCookie=function(e,t,n,i){V(e,t,n,i)},e}(),W={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return K(e,t)},setCookie:function(e,t,n,i){V(e,t,n,i)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},J={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return K(e,t)},setCookie:function(e,t,n,i){V(e,t,n,i)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},H=function(){function e(e,t){this._storage=t&&"session"===t?J:!e&&W.isSupportLS?W:new q}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,i){this._storage.setCookie(e,t,n,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),$=function(){function e(e,t,n){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=n}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,n=document.referrer,i=n?U(n).hostname:"",o=N(window.location.href),r=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,n,i){var o=new H(!1),r=new H(!1,"session"),s=e?"_tea_utm_cache_"+e:"_tea_utm_cache",a=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],u={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var p=!1;for(var h in u)u[h]&&(-1!==l.indexOf(h)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[h]=u[h]):c[h]=u[h],p=!0);if(p)r.setItem(a,"1"),o.setCookie(s,JSON.stringify(c),i,n);else{var f=o.getCookie(s,n);f&&(c=JSON.parse(f))}r.getItem(a)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return u}return c}(this.appid,o,this.domain,this.cookie_expire);var s=this.browser(),a=this.os();return{browser:s.browser,browser_version:s.browser_version,platform:r,os_name:a.os_name,os_version:a.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(a.os_name),language:t,referrer:n,referrer_host:i,utm:this.utm,latest_data:this.last(n,i)}},e.prototype.last=function(e,t){var n="",i="",o="",r=location.hostname,s=!1;if(e&&t&&r!==t){n=e,i=t,s=!0;var a=N(e);a.keyword&&(o=a.keyword)}return{$latest_referrer:n,$latest_referrer_host:i,$latest_search_keyword:o,isLast:s}},e.prototype.browser=function(){var e,t,n="",i=""+parseFloat(this.appVersion),o=this.userAgent;return-1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(n="Microsoft Edge",-1!==o.indexOf("Edge")?(e=o.indexOf("Edge"),i=o.substring(e+5)):(e=o.indexOf("Edg"),i=o.substring(e+4))):-1!==(e=o.indexOf("MSIE"))?(n="Microsoft Internet Explorer",i=o.substring(e+5)):-1!==(e=o.indexOf("Lark"))?(n="Lark",i=o.substring(e+5,e+11)):-1!==o.indexOf("Chrome")?-1!==(e=o.indexOf("TTWebView"))?(n="TTWebView",i=o.substring(e+10,e+23)):(-1!==(e=o.indexOf("Chrome"))||-1!==(e=o.indexOf("Chrome")))&&(n="Chrome",i=o.substring(e+7)):-1!==o.indexOf("Safari")?-1!==(e=o.indexOf("Safari"))&&(n="Safari",i=o.substring(e+7),-1!==(e=o.indexOf("Version"))&&(i=o.substring(e+8))):-1!==(e=o.indexOf("Firefox"))&&(n="Firefox",i=o.substring(e+8)),-1!==(t=i.indexOf(";"))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(" "))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(")"))&&(i=i.substring(0,t)),{browser:n,browser_version:i}},e.prototype.os=function(){for(var e="",t="",n=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],i=0;i<n.length;i++){var o=n[i];if(o.r.test(this.userAgent)){"Mac OS X"===(e=o.s)&&this.isNewIpad()&&(e="iOS");break}}var r,s,a=function(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""},c=function(e,t){var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return n?n.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=a(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(s=a(/Android ([\.\_\d]+)/,r=this.userAgent))||(s=a(/Android\/([\.\_\d]+)/,r)),t=s,e="android";break;case"iOS":t=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios"}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var n=navigator.userAgent.replace("Mozilla/5.0 (",""),i=n.indexOf(";");t=n.slice(0,i)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),F={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},X={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Z={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k"},Y={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz4az1az1mz1k"},Q="5.0.34_oversea",ee=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var n=e[0];if(!n)return!1;var i=n.events,o=n.header;if(!i||!i.length)return!1;var r=!0;return i.forEach((function(e){if(!e)return r=!1,void(e.checkEvent="事件异常");t.checkEventName(e.event)||(r=!1,e.checkEvent="事件名不能以 $ or __开头"),t.checkEventParams(e.params)||(r=!1,e.checkParams="属性名不能以 $ or __开头")})),this.checkEventParams(o)||(r=!1),r},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var n in t)return!(!this.calculate(n,"params")||"string"==typeof t[n]&&t[n].length>1024&&(console.warn("params: "+n+" can not over 1024 byte, please check;"),1));return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||(console.warn(("event"===t?"event":"params")+" name: "+e+" can not start with $ or __, pleace check;"),!1)},e}();!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report"}(T||(T={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(I||(I={}));var te=T,ne=void 0,ie=(new Date).getTimezoneOffset(),oe=parseInt(""+-ie/60,10),re=60*ie,se=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var n=new $(t.app_id,t.cookie_domain||"",t.cookie_expire||6048e5).init();this.eventCheck=new ee(e,t);var i="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new H(!1,"session"),this.localStorage=new H(!1,"local"),this.channelUrl="tcpy"===t.channel_type||"ttp"===t.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(i);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(i,"1")),this.envInfo={user:{user_unique_id:ne,user_type:ne,user_id:ne,user_is_auth:ne,user_is_login:ne,device_id:ne,web_id:ne,ip_addr_id:ne,user_unique_id_type:ne},header:{app_id:ne,app_name:ne,app_install_id:ne,install_id:ne,app_package:ne,app_channel:ne,app_version:ne,ab_version:ne,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:ne,traffic_type:ne,client_ip:ne,device_brand:ne,os_api:ne,access:ne,language:n.language,region:ne,app_language:ne,app_region:ne,creative_id:n.utm.creative_id,ad_id:n.utm.ad_id,campaign_id:n.utm.campaign_id,log_type:ne,rnd:ne,platform:n.platform,sdk_version:Q,sdk_lib:"js",province:ne,city:ne,timezone:oe,tz_offset:re,tz_name:ne,sim_region:ne,carrier:ne,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm.utm_term,utm_content:n.utm.utm_content,utm_source:n.utm.utm_source,utm_medium:n.utm.utm_medium,utm_campaign:n.utm.utm_campaign,tracer_data:JSON.stringify(n.utm.tracer_data),custom:{},wechat_unionid:ne,wechat_openid:ne}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(n),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(e){var t=this.initConfig.channel_domain;if(t)this.domain=t;else{var n=e||this.initConfig.channel,i=this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?Z[n]:Y[n]:F[n];this.domain=P(i)}},e.prototype.setDomain=function(e){this.customDomain=!0,this.domain=e},e.prototype.getDomain=function(e){return this.customDomain||e&&this.initDomain(e),this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var n=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=n?JSON.parse(n):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.initConfig.report_url||this.channelUrl.REPORT_URL;break;case"webid":t=this.channelUrl.WEBID_URL;break;case"tobid":t=this.channelUrl.TOB_URL}var n="";return this.initConfig.caller&&(n="?sdk_version="+Q+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+n},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(n){void 0!==e[n]&&null!==e[n]||t.delete(n);try{t.eventCheck.calculate(n,"config")}catch(e){}if("traffic_type"===n&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[n]),"evtParams"===n)t.evtParams=R({},t.evtParams||{},e.evtParams||{});else if("_staging_flag"===n)t.evtParams=R({},t.evtParams||{},{_staging_flag:e._staging_flag});else if("reportErrorCallback"===n&&"function"==typeof e[n])t.reportErrorCallback=e[n];else{var i="",o="";if(n.indexOf(".")>-1){var r=n.split(".");i=r[0],o=r[1]}i?"user"===i||"header"===i?t.envInfo[i][o]=e[n]:t.envInfo.header.custom[o]=e[n]:Object.hasOwnProperty.call(t.envInfo.user,n)?["user_type","ip_addr_id"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?Number(e[n]):e[n]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?String(e[n]):e[n]:["user_is_auth","user_is_login"].indexOf(n)>-1?t.envInfo.user[n]=Boolean(e[n]):"device_id"===n&&(t.envInfo.user[n]=e[n]):Object.hasOwnProperty.call(t.envInfo.header,n)?t.envInfo.header[n]=e[n]:t.envInfo.header.custom[n]=e[n]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){console.log("setStore error"),this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message}),console.log("delete error")}},e}(),ae=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("[instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("[instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),ce=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,n){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):n(!1)})):n(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),n(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(n){"user_unique_id"===n?t.setUserUniqueId(e[n]):e[n]?t.addHeaderInfo(n,e[n]):t.removeHeaderInfo(n)}))}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge埋点上报",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}();function le(e,t,n,i,o,r,s,a,c){try{var l=new XMLHttpRequest,u=a||"POST";l.open(u,""+e,!0),l.setRequestHeader("Content-Type","application/json; charset=utf-8"),s&&l.setRequestHeader("X-MCS-AppKey",""+s),i&&(l.withCredentials=!0),l.onload=function(){if(o){var e=null;if(l.responseText){try{e=JSON.parse(l.responseText)}catch(t){e={}}o(e,t)}}},n&&(l.timeout=n,l.ontimeout=function(){r&&r(t,5005)}),l.onerror=function(){l.abort(),r&&r(t,500)},c?l.send(t):l.send(JSON.stringify(t))}catch(e){}}var ue=function(e,t,n,i){try{var o,r=e.match(/\/v\d\//);o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var s=e.split(o)[0];if(!s)return void i(e,t,4001);t.forEach((function(o){var r=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return"&"===t[0]?t.slice(1):t}(o),a=new Image(1,1);a.onload=function(){a=null,n&&n()},a.onerror=function(){a=null,i&&i(e,t,4e3)},a.src=s+"/gif?"+r}))}catch(n){i&&i(e,t,4002,n.message)}},pe=function(e,t,n,i,o,r,s,a){var c=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===c.indexOf("MSIE 8.0")&&-1===c.indexOf("MSIE 9.0")){if(s)return window.navigator&&window.navigator.sendBeacon?void(window.navigator.sendBeacon(e,JSON.stringify(t))?o():r(e,t,4003)):void ue(e,t,o,r)}else ue(e,t,o,r);le(e,t,n,i,o,r,"","",a)},he=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new ee(e,t),this.cacheStorgae=new H(!0),this.localStorage=new H(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.collect.on(te.Ready,(function(){n.reportAll(!1)})),this.collect.on(te.ConfigDomain,(function(){n.reportUrl=n.configManager.getUrl("event")})),this.collect.on(te.Event,(function(e){n.event(e)})),this.collect.on(te.BeconEvent,(function(e){n.beconEvent(e)})),this.collect.on(te.CleanEvents,(function(){n.reportAll(!1)})),this.linster()},e.prototype.linster=function(){var e=this;window.addEventListener("unload",(function(){e.reportAll(!0)}),!1),function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}((function(){e.reportAll(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.reportAll(!0)}),!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var n=G(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,n),this.reportTimeout&&clearTimeout(this.reportTimeout),n.length>=this.maxReport)this.report(!1);else{var i=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),i)}}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){var t=G(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.destroyInstance||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))},e.prototype.reportBecon=function(){if(!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var n=0;n<e.length;n+=this.eventLimit){var i;i=e.slice(n,n+this.eventLimit);var o=this.split(this.merge(i));this.send(o,t)}else o=this.split(this.merge(e)),this.send(o,t)},e.prototype.merge=function(e,t){var n=this,i=this.configManager.get(),o=i.header,r=i.user;o.custom=JSON.stringify(o.custom);var s=this.configManager.get("evtParams"),a=this.configManager.get("user_unique_id_type"),c=e.map((function(e){try{Object.keys(s).length&&!t&&(e.params=R({},s,e.params)),a&&(e.params.$user_unique_id_type=a);var i=n.configManager.getAbCache();return i&&i.uuid&&i.uuid===r.user_unique_id&&n.configManager.getAbVersion()&&(e.ab_sdk_version=n.configManager.getAbVersion()),e.session_id=n.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(t){return n.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:t.message}),e}})),l=JSON.parse(JSON.stringify({events:c,user:r,header:o}));l.local_time=Math.floor(Date.now()/1e3),l.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,l.verbose=1;var u=[];return u.push(l),u},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var n=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var i=JSON.parse(JSON.stringify(e));n.config.filter&&((i=n.config.filter(i))||console.warn("filter must return data !!")),n.collect.eventFilter&&i&&((i=n.collect.eventFilter(i))||console.warn("filterEvent api must return data !!"));var o=i||e,r=JSON.parse(JSON.stringify(o));if(n.eventCheck.checkVerify(r),!o.length)return;n.collect.emit(te.SubmitBefore,o),n.collect.emit(te.SubmitVerify,o),pe(n.reportUrl,o,n.timeout,n.enable_ttwebid,(function(e,t){e&&0!==e.e?(n.collect.emit(te.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),n.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_EVENT,info:"埋点上报失败",time:Date.now(),data:r,code:e.e,failType:"数据异常",status:"fail"})):(n.collect.emit(te.SubmitScuess,{eventData:t,res:e}),n.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_EVENT,info:"埋点上报成功",time:Date.now(),data:r,code:200,status:"success"}))}),(function(e,t){n.configManager.get("reportErrorCallback")(e,t),n.collect.emit(te.SubmitError,{type:"f_net",eventData:e,errorCode:t}),n.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_EVENT,info:"埋点上报网络异常",time:Date.now(),data:r,code:t,failType:"网络异常",status:"fail"})}),t,!1),n.collect.emit(te.SubmitAfter,o)}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),n.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}})))},e}(),fe=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},de=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new H(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(te.ConfigUuid,(function(e){n.setUuid(e)})),this.collect.on(te.ConfigWebId,(function(e){n.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(te.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(te.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:fe(),user_unique_id:this.configManager.get("user_unique_id")||fe()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=N(window.location.href);return!(!t||!t.Web_ID||(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),n={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 发起WEBID请求",logType:"fetch",level:"info",time:Date.now(),data:n});var i=fe();le(t,n,3e5,!1,(function(t){var n;t&&0===t.e?(n=t.web_id,e.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"WEBID请求成功",logType:"fetch",level:"info",time:Date.now(),data:t})):(n=i,e.collect.configManager.set({localWebId:i}),e.collect.emit(te.TokenError),e.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"WEBID请求返回值异常",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||n,user_unique_id:e.configManager.get("user_unique_id")||n})}),(function(){e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i}),e.collect.configManager.set({localWebId:i}),e.collect.emit(te.TokenError),e.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"WEBID请求网络异常",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")}))},e.prototype.complete=function(e){var t=e.web_id,n=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:n}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(te.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",n=this.configManager.get("user_unique_id");(n||t)&&this.configManager.set({user_unique_id:n||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(te.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),n=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;if(t===n&&t===i)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(te.TokenChange,"uuid"),this.collect.emit(te.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(te.TokenReset))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),n=this.configManager.get("user_unique_id");n&&n!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(te.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(te.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this,t=this.configManager.getUrl("tobid");return new Promise((function(n){le(t,{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},3e4,e.enable_ttwebid,(function(e){e&&0===e.e?n(e.tobid):n("")}),(function(){n("")}))}))},e}(),ge=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},_e=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.storage=new H(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(te.SessionReset,(function(){n.resetSessionId()})),this.collect.on(te.SessionResetTime,(function(){n.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:ge(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:ge(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime)},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(){var e={sessionId:ge(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:ge(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),me=function(){function e(e,t){this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.collect=e,this.config=t,this.app_id=t.app_id,this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],t.enable_debug&&this.load()}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.load=function(){try{this.loadBaseInfo(),this.loadHook();var e=N(window.location.href);if(!e.open_devtool_web||parseInt(e.app_id)!==this.app_id)return;this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(e){console.log("debug fail, "+e.message)}},e.prototype.loadDevTool=function(){this.loadScript("https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"基本信息",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,上报域名:this.collect.configManager.getDomain(),SDK版本:Q,SDK引入方式:"npm"}},{title:"用户信息",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"点击获取SSID"}},{title:"公共参数信息",type:2,infoName:{浏览器:this.collect.configManager.get("browser"),浏览器版本:this.collect.configManager.get("browser_version"),平台:this.collect.configManager.get("platform"),设备型号:this.collect.configManager.get("device_model"),操作系统:this.collect.configManager.get("os_name"),操作系统版本:this.collect.configManager.get("os_version"),屏幕分辨率:this.collect.configManager.get("os_version"),来源:this.collect.configManager.get("referrer"),自定义信息:""}},{title:"配置信息",type:3,infoName:{全埋点:!!this.config.autotrack,停留时长:!!this.config.enable_stay_duration}},{title:"A/B配置信息",type:4,infoName:{"A/B实验":!!this.config.enable_ab_test}},{title:"客户端信息",type:3,infoName:{打通开关:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(te.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["自定义信息"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["已曝光VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B域名"]=e.config.ab_channel_domain||P(X[e.config.channel]),e.info[4].infoName["全部配置"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["是否打通"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.on(I.DEBUGGER_MESSAGE,(function(t){switch(t.type){case I.DEBUGGER_MESSAGE_SDK:var n={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(n.desc={content:JSON.stringify(t.data)}),e.updateLog(n),t.secType&&"AB"===t.secType?(e.info[4].infoName["已曝光VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["全部配置"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case I.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var i=t.data[0],o=i.events;if(!o.length)return;o.forEach((function(n){n.checkShow=!0,n.searchShow=!0,n.success=t.status,n.type=-1!==e.filterEvent.indexOf(n.event)?"sdk":"cus",n.type=e.collect.bridgeReport?"bridge":n.type,n.info="","fail"===t.status&&(n.info={message:"code: "+t.code+"， msg: "+t.failType})})),e.updateEvent(i)}return}}))},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;console.log("inittttt"),e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()}))}}))},e.prototype.sendData=function(e,t){try{var n={type:e,payload:t};(window.opener||window.parent).postMessage(n,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode("#debugger-applog-web {\n      position: absolute;\n      width: 90px;\n      height: 30px;\n      background: #23c243;\n      border-radius: 6px;\n      color: #fff;\n      font-size: 12px;\n      bottom: 5%;\n      right: 10%;\n      text-align: center;\n      line-height: 30px;\n      cursor: pointer;\n      z-index:100;\n    }")),e.appendChild(t);var n=document.createElement("div");n.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web">AppLog调试</div>';var i=document.createElement("div");i.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(n),document.getElementsByTagName("body")[0].appendChild(i),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),ye=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.sdkReady=!1,this.adapters={},this.name=e,this.hook=new x,this.remotePlugin=new Map,this.Types=te,this.adapters.fetch=le,this.adapters.storage=H}return e.usePlugin=function(t,n,i){if(n){for(var o=!1,r=0,s=e.plugins.length;r<s;r++)if(e.plugins[r].name===n){e.plugins[r].plugin=t,e.plugins[r].options=i||{},o=!0;break}o||e.plugins.push({name:n,plugin:t,options:i})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,n){e&&(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:n}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var n,i=this;if(this.inited)console.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!");else if(t&&C(t))if(t.app_id&&"number"==typeof(n=t.app_id)&&!isNaN(n))if(!t.app_key||function(e){return"string"==typeof e}(t.app_key)){var o=t.channel_type&&"tcpy"===t.channel_type?["sg","va","in"]:["sg","va"];t.channel_domain||-1!==o.indexOf(t.channel)||(console.warn("channel must "+o.join(" ,")+"!!!"),t.channel="sg"),this.inited=!0,this.logger=new ae(this.name,t.log),this.appBridge=new ce(this,t.enable_native),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new se(this,t),this.debugger=new me(this,t),this.initConfig=t,this.emit(te.Init),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行INIT",data:t,level:"info",time:Date.now()}),t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new he,this.tokenManager=new de,this.sessionManager=new _e,Promise.all([new Promise((function(e){i.once(te.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){i.once(te.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var n=t.plugin,o=t.options,r=Object.assign(i.initConfig,o),s=new n;return s.apply(i,r),e.push(s),e}),i.pluginInstances)}catch(e){console.log("load plugin error, "+e.message),i.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}i.sdkReady=!0,i.emit(te.Ready),i.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 初始化完成",time:Date.now(),level:"info",data:i.configManager.get("user")}),i.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(i.configManager.get("user"))),i.logger.info("appid: "+t.app_id+", sdk is ready, version is "+Q+", you can report now !!!"),t.disable_auto_pv&&(i.disableAutoPageView=!0);try{(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){i.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}i.pageView(),i.on(te.TokenChange,(function(e){"webid"===e&&i.pageView(),i.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 设置了用户信息",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(te.TokenReset,(function(){i.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 重置了用户信息",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(te.RouteChange,(function(e){e.init||t.disable_route_report||i.pageView()}));try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0}else console.warn("app_key param is error, must be string, please check!");else console.warn("app_id param is error, must be number, please check!");else console.warn("init params error,please check")},e.prototype.config=function(e){if(this.inited)if(e&&C(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=R({},e);if(this.initConfig&&this.initConfig.configPersist){var n=this.configManager.getStore();n&&(t=Object.assign(n,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&(n[i[o]]=e[i[o]])}return n}(t,["web_id","user_unique_id"]);t.hasOwnProperty("web_id")&&this.emit(te.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(te.ConfigUuid,t.user_unique_id),this.configManager.set(i),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行CONFIG",level:"info",time:Date.now(),data:t})}else console.warn("config params is error, please check");else console.warn("config must be use after function init")},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(te.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(te.Start),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行START",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(te.Ready)))},e.prototype.event=function(e,t){var n=this;try{var i=[];if(Array.isArray(e))e.forEach((function(e){var t=n.processEvent(e[0],e[1]||{});t&&i.push(t)}));else{var o=this.processEvent(e,t);if(!o)return;i.push(o)}this.bridgeReport?i.forEach((function(e){var t=e.event,i=e.params;n.appBridge.onEventV3(t,JSON.stringify(i))})):i.length&&(this.emit(te.Event,i),this.emit(te.SessionResetTime))}catch(e){console.warn("something error, please check"),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e))console.warn("beconEvent not support batch report, please check");else{var n=[],i=this.processEvent(e,t||{});i&&(n.push(i),n.length&&(this.emit(te.BeconEvent,n),this.emit(te.SessionResetTime)))}},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return this.logger.warn("eventName is null， please check"),null;var n=e;/^event\./.test(e)&&(n=e.slice(6));var i=t;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=B();var o=void 0;return i.local_ms?(o=i.local_ms,delete i.local_ms):o=+new Date,{event:n,params:i,local_time_ms:o,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(n){return this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:n.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,n){this.hook.emit(e,t,n)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){void 0===e&&(e={});var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+this.configManager.is_first_time},n=R({},t,e);this.event("predefine_pageview",n)},e.prototype.clearEventCache=function(){this.emit(te.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=j(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(te.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=j(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(te.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.resetStayDuration=function(e,t,n){this.emit(te.ResetStay,{url_path:e,title:t,url:n},te.Stay)},e.prototype.resetStayParams=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.emit(te.SetStay,{url_path:e,title:t,url:n},te.Stay)},e.prototype.getToken=function(e,t){var n=this,i=!1,o=function(t){if(!i){i=!0;var o=n.configManager.get().user;return t&&(o.tobid=t,o["diss".split("").reverse().join("")]=t),e(R({},o))}},r=function(){n.tokenManager.getTobId().then((function(e){o(e)}))};this.sdkReady?r():(t&&setTimeout((function(){o()}),t),this.on(te.Ready,(function(){r()})))},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(te.ProfileSet,e,te.Profile),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行profileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(te.ProfileSetOnce,e,te.Profile),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行profileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(te.ProfileIncrement,e,te.Profile),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行profileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(te.ProfileUnset,e,te.Profile),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行profileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(te.ProfileAppend,e,te.Profile),this.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"SDK 执行profileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(te.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,te.Ab)},e.prototype.getVar=function(e,t,n){this.emit(te.AbVar,{name:e,defaultValue:t,callback:n},te.Ab)},e.prototype.getABconfig=function(e,t){this.emit(te.AbConfig,{params:e,callback:t},te.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(te.AbVersionChangeOn,e,te.Ab),function(){t.emit(te.AbVersionChangeOff,e,te.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(te.AbVersionChangeOff,e,te.Ab)},e.prototype.openOverlayer=function(){this.emit(te.AbOpenLayer,"",te.Ab)},e.prototype.closeOverlayer=function(){this.emit(te.AbCloseLayer,"",te.Ab)},e.prototype.getAllVars=function(e){this.emit(te.AbAllVars,e,te.Ab)},e.prototype.sessionRecordStart=function(){this.emit(te.SessionRecordStart,te.sessionRecord)},e.prototype.sessionRecordPause=function(){this.emit(te.SessionRecordPause,te.sessionRecord)},e.prototype.sessionRecordEnd=function(){this.emit(te.SessionRecordEnd,te.sessionRecord)},e.prototype.sessionRecordReport=function(e){this.emit(te.SessionRecordReport,{callback:e},te.sessionRecord)},e.prototype.autoInitializationRangers=function(e){var t,n,i,o,r,s,a,c;n=(t=e).app_id,i=t.channel,o=t.onTokenReady,r=F[i]+"/webid",s=new H(!1),a="__tea_cache_tokens_"+n,(c=s.getItem(a))&&c.web_id?o(c.web_id):pe(r,{app_key:"",app_id:n,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,(function(e){if(e&&0===e.e){o(e.web_id);var t={web_id:e.web_id,user_unique_id:e.web_id,timestamp:Date.now()};s.setItem(a,t)}else o("")}),(function(){o("")}),!0)},e.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(te.TokenComplete))},e.plugins=[],e}(),ve=function(){function e(){}return e.prototype.apply=function(e,t){var n=this,i=e.adapters.fetch;if(t.event_verify_url)if("string"==typeof t.event_verify_url){if(this.url=t.event_verify_url+"/v1/list_test",this.url){var o=e.Types;e.on(o.SubmitBefore,(function(e){i(n.url,e,3e4)}))}}else console.log("please use correct et_test url")},e}(),be=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var i=e.Types,o=e.adapters.fetch;this.eventCheck=new ee(e,t),this.fetch=o,this.cache={},this.collect.on(i.ProfileSet,(function(e){n.setProfile(e)})),this.collect.on(i.ProfileSetOnce,(function(e){n.setOnceProfile(e)})),this.collect.on(i.ProfileUnset,(function(e){n.unsetProfile(e)})),this.collect.on(i.ProfileIncrement,(function(e){n.incrementProfile(e)})),this.collect.on(i.ProfileAppend,(function(e){n.appendProfile(e)})),this.collect.on(i.ProfileClear,(function(){n.cache={}})),this.ready(i.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach((function(n){t.collect.hook.emit(e,n)}))};for(var o in n)i(o)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var n=[];n.push(this.collect.processEvent(e,t));var i=this.collect.eventManager.merge(n);this.fetch(this.reportUrl,i),this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_EVENT,info:"埋点上报成功",time:Date.now(),data:i,code:200,status:"success"})}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",R({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",R({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",R({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",R({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var n in e)"string"==typeof e[n]||"Array"===Object.prototype.toString.call(e[n]).slice(8,-1)?t[n]=e[n]:console.warn("please check the value of param: "+n+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",R({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach((function(n){t.cache[n]={val:t.clone(e[n]),timestamp:Date.now()}}))},e.prototype.formatParams=function(e,t){var n=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var i={};for(var o in e)"string"==typeof e[o]||"number"==typeof e[o]||"Array"===Object.prototype.toString.call(e[o]).slice(8,-1)?i[o]=e[o]:console.warn("please check the value of params:"+o+", must be string,number,Array !!!");var r=Object.keys(i);if(!r.length)return;if(!this.eventCheck.checkEventParams(i))return;var s=Date.now();return r.filter((function(i){var o=n.cache[i];return t?!o:!(o&&n.compare(o.val,e[i])&&s-o.timestamp<n.duration)})).reduce((function(e,t){return e[t]=i[t],e}),{})}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message}),console.log("error")}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:t.message}),e}},e.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),Ee=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var n,i=Date.now()+t;return n=window.setTimeout((function o(){var r=Date.now()-i;e(),i+=t,n=window.setTimeout(o,Math.max(0,t-r))}),t),function(){window.clearTimeout(n)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var i=this.collect.Types;this.collect.on(i.SessionReset,(function(){n.process()}))}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),Se=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,!this.config.channel_domain&&!t.disable_track_event&&!t.disable_sdk_monitor){var i=e.adapters.fetch;this.fetch=i,this.url=e.configManager.getUrl("event");var o=this.collect.Types;this.collect.on(o.Ready,(function(){n.sdkOnload()})),this.collect.on(o.SubmitError,(function(e){var t=e.type,i=e.eventData,o=e.errorCode;"f_data"===t&&n.sdkError(i,o)}))}},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),n=t.header,i=t.user,o=n.app_id,r=n.app_name,s=n.sdk_version,a=i.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:o,app_name:r||"",sdk_version:s,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:a},header:{}};setTimeout((function(){e.fetch(e.url,[c],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var n=this;try{var i=e[0],o=i.user,r=i.header,s=[];e.forEach((function(e){e.events.forEach((function(e){s.push(e)}))}));var a={events:s.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:r.app_id,app_name:r.app_name||"",error_event:e.event,sdk_version:r.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(r),user:JSON.stringify(o)}),local_time_ms:Date.now()}})),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout((function(){n.fetch(n.url,[a],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e}(),we={autotrack:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},visual:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},ke="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,ze=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,n){if("sdk"===t)if(we.hasOwnProperty(n)){var i=we[n].object,o=""+we[n].src[e.channel];e.exist(n,i,o)}else console.warn("your "+n+" is not exist，please check plugin name");else"object"==typeof t&&(t.src?e.exist(n,t.call,t.src):e.process(n,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,n){var i=this;ke[t]?(this.process(e,ke[t]),console.log("已有"+e+"插件，避免重复加载~")):this.loadPlugin(e,n,(function(){i.process(e,ke[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","–","load plugin:"+e+" success","-")}),(function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","–","load plugin:"+e+" error","-")}))},e.prototype.process=function(e,t,n){try{if(n){var i=new t;i.apply&&i.apply(this.collect,this.config),console.log("excude "+e+" success")}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,n,i){var o=this;try{var r=document.createElement("script");r.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(n),r.onerror=function(){i(t)},r.onload=function(){o._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(r)}catch(e){this.collect.emit(I.DEBUGGER_MESSAGE,{type:I.DEBUGGER_MESSAGE_SDK,info:"发生了异常",level:"error",time:Date.now(),data:e.message})}},e}();ye.usePlugin(ze,"extend"),ye.usePlugin(ve,"et"),ye.usePlugin(be,"profile"),ye.usePlugin(Ee,"heartbeat"),ye.usePlugin(Se,"monitor");var De=new ye("default"),Re=function(e){function t(t){var n=t.test,i=t.TEAChannelDomain,o=void 0===i?"":i,r=t.mode,s=t.TEAChannel,a=t.TEAChannelType;return t.tracker=o||a||s?function(e){var t=e.isTest,n=e.channel_domain,i=e.channel_type,o=e.channel,r=/snssdk|zijieapi/g.test(n)&&/ttp|tcpy/g.test(i)&&/va|sg|in/g.test(o)?3053:3297;return De.init({app_id:r,channel_type:i,channel:o,channel_domain:n}),De.config({_staging_flag:t?1:0,enable_et_test:t}),De.start(),De.event.bind(De)}({isTest:n||"test"===r,channel_domain:o,channel_type:a,channel:s}):function(){},e.call(this,t)||this}return o(t,e),t}(D)}}]);